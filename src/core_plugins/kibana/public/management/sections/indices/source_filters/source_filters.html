<h3>Source Filters</h3>

<p>
  Source filters can be used to exclude one or more fields when fetching the document source. This happens when viewing a document in the Discover app, or with a table displaying results from a saved search in the Dashboard app. Each row is built using the source of a single document, and if you have documents with large or unimportant fields you may benefit from filtering those out at this lower level.
</p>

<div ng-class="{ saving: sourceFilters.saving }" class="source-filters-container">

  <table class="table table-hover">
    <thead ng-if="sourceFilters.all().length">
      <tr>
        <td></td><td><h4 class="header">Known Matches</h4></td>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="filter in sourceFilters.all()">
        <td>
          <form
            ng-submit="sourceFilters.save(filter)"
            class="source-filter"
            name="form">

            <div class="value">
              <span ng-if="sourceFilters.editing !== filter">{{ filter.value }}</span>

              <input
                ng-model="filter.value"
                input-focus
                ng-if="sourceFilters.editing === filter"
                placeholder="sourceFilters.placeHolder"
                type="text"
                required
                class="form-control">
            </div>

            <div class="controls">
              <button
                aria-label="Edit source filter"
                ng-if="sourceFilters.editing !== filter"
                ng-click="sourceFilters.editing = filter"
                type="button"
                class="btn btn-default">
                <i aria-hidden="true" class="fa fa-pencil"></i>
              </button>
              <button
                aria-label="Save source filter"
                ng-if="sourceFilters.editing === filter"
                type="submit"
                class="btn btn-primary">
                <i aria-hidden="true" class="fa fa-save"></i>
              </button>
              <button
                aria-label="Delete source filter"
                ng-click="sourceFilters.delete(filter)"
                type="button"
                class="btn btn-danger">
                <i aria-hidden="true" class="fa fa-trash"></i>
              </button>
            </div>
          </form>
        </td>
        <td>
          <div class="known-matches">
            <p ng-if="!sourceFilters.sampleMatches[$index]">
              <em>The source filter doesn't match any known fields.</em>
            </p>
            <ul>
              <li ng-repeat="match in sourceFilters.sampleMatches[$index]">{{match}}</li>
            </ul>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td>
          <form name="form" ng-submit="sourceFilters.create()">
            <div class="input-group">
              <input
                ng-model="sourceFilters.newValue"
                placeholder="sourceFilters.placeHolder"
                type="text"
                class="form-control">

              <div class="input-group-btn" role="group" aria-label="Source Filter Editor Controls">
                <button
                  type="submit"
                  class="btn btn-primary"
                  ng-disabled="!sourceFilters.newValue">
                  Add
                </button>
              </div>
            </div>
          </form>
        </td>
      </tr>
    </tfoot>
  </table>
</div>
