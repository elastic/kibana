{
  "$ref": "#/definitions/Synthtrace DSL",
  "definitions": {
    "Synthtrace DSL": {
      "type": "object",
      "properties": {
        "timeWindow": {
          "type": "object",
          "properties": {
            "from": {
              "type": "string"
            },
            "to": {
              "type": "string"
            }
          },
          "required": [
            "from",
            "to"
          ],
          "additionalProperties": false
        },
        "seed": {
          "type": "integer"
        },
        "services": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "environment": {
                "type": "string"
              },
              "agentName": {
                "type": "string"
              },
              "instances": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "host": {
                      "type": "string"
                    },
                    "traces": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "interval": {
                            "type": "string",
                            "description": "Datemath or duration like 1m, 30s"
                          },
                          "rate": {
                            "type": "integer",
                            "exclusiveMinimum": 0,
                            "description": "Events per interval"
                          },
                          "count": {
                            "type": "integer",
                            "exclusiveMinimum": 0
                          },
                          "errorRate": {
                            "anyOf": [
                              {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 1
                              },
                              {
                                "anyOf": [
                                  {
                                    "type": "object",
                                    "properties": {
                                      "type": {
                                        "type": "string",
                                        "const": "constant"
                                      },
                                      "value": {
                                        "type": "number"
                                      }
                                    },
                                    "required": [
                                      "type",
                                      "value"
                                    ],
                                    "additionalProperties": false
                                  },
                                  {
                                    "type": "object",
                                    "properties": {
                                      "type": {
                                        "type": "string",
                                        "const": "normal"
                                      },
                                      "mean": {
                                        "type": "number"
                                      },
                                      "sd": {
                                        "type": "number"
                                      }
                                    },
                                    "required": [
                                      "type",
                                      "mean",
                                      "sd"
                                    ],
                                    "additionalProperties": false
                                  },
                                  {
                                    "type": "object",
                                    "properties": {
                                      "type": {
                                        "type": "string",
                                        "const": "uniform"
                                      },
                                      "min": {
                                        "type": "number"
                                      },
                                      "max": {
                                        "type": "number"
                                      }
                                    },
                                    "required": [
                                      "type",
                                      "min",
                                      "max"
                                    ],
                                    "additionalProperties": false
                                  },
                                  {
                                    "type": "object",
                                    "properties": {
                                      "type": {
                                        "type": "string",
                                        "const": "linear"
                                      },
                                      "from": {
                                        "type": "number"
                                      },
                                      "to": {
                                        "type": "number"
                                      }
                                    },
                                    "required": [
                                      "type",
                                      "from",
                                      "to"
                                    ],
                                    "additionalProperties": false
                                  },
                                  {
                                    "type": "object",
                                    "properties": {
                                      "type": {
                                        "type": "string",
                                        "const": "piecewise"
                                      },
                                      "segments": {
                                        "type": "array",
                                        "items": {
                                          "type": "object",
                                          "properties": {
                                            "from": {
                                              "type": "string",
                                              "pattern": "^([0-9]{1,2}|100)%$",
                                              "description": "Percent into the time window"
                                            },
                                            "to": {
                                              "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1/anyOf/4/properties/segments/items/properties/from",
                                              "description": "Percent into the time window"
                                            },
                                            "value": {
                                              "anyOf": [
                                                {
                                                  "type": "number"
                                                },
                                                {
                                                  "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1"
                                                }
                                              ]
                                            }
                                          },
                                          "required": [
                                            "value"
                                          ],
                                          "additionalProperties": false
                                        },
                                        "minItems": 1
                                      }
                                    },
                                    "required": [
                                      "type",
                                      "segments"
                                    ],
                                    "additionalProperties": false
                                  }
                                ]
                              }
                            ],
                            "description": "Error rate as a number (0-1) or a distribution with piecewise segments for time-varying error rates"
                          },
                          "spans": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "type": {
                                  "type": "string",
                                  "description": "Span type"
                                },
                                "subtype": {
                                  "type": "string",
                                  "description": "Span subtype"
                                },
                                "durationMs": {
                                  "type": "number",
                                  "exclusiveMinimum": 0
                                }
                              },
                              "required": [
                                "name"
                              ],
                              "additionalProperties": false
                            }
                          }
                        },
                        "required": [
                          "name"
                        ],
                        "additionalProperties": false
                      }
                    },
                    "logs": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "interval": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/interval",
                            "description": "Datemath or duration like 1m, 30s"
                          },
                          "rate": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/rate",
                            "description": "Events per interval"
                          },
                          "level": {
                            "type": "string",
                            "enum": [
                              "debug",
                              "info",
                              "warn",
                              "error"
                            ]
                          },
                          "message": {
                            "type": "string"
                          },
                          "dataset": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "minItems": 1
                              }
                            ],
                            "description": "Dataset name(s). If array, datasets will be rotated. If not provided, uses random dataset."
                          },
                          "namespace": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "minItems": 1
                              }
                            ],
                            "description": "Namespace(s) for data stream. If array, namespaces will be rotated."
                          },
                          "hostName": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "minItems": 1
                              }
                            ],
                            "description": "Host name(s). If array, host names will be rotated."
                          },
                          "containerId": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "minItems": 1
                              }
                            ],
                            "description": "Container ID(s). If array, container IDs will be rotated."
                          },
                          "customFields": {
                            "anyOf": [
                              {
                                "type": "object",
                                "additionalProperties": {},
                                "description": "Simple custom fields: { \"fieldName\": \"value\" }"
                              },
                              {
                                "type": "object",
                                "properties": {
                                  "count": {
                                    "type": "integer",
                                    "exclusiveMinimum": 0,
                                    "description": "Number of fields to generate (for bulk generation)"
                                  },
                                  "prefix": {
                                    "type": "string",
                                    "description": "Prefix for field names (e.g., \"field\" generates \"field-0\", \"field-1\", etc.)"
                                  },
                                  "valueType": {
                                    "type": "string",
                                    "enum": [
                                      "fixed",
                                      "random",
                                      "rotated",
                                      "dynamic",
                                      "sequential"
                                    ],
                                    "description": "Value generation type: fixed (use value), random (random value), rotated (rotate through values), dynamic (computed), sequential (0, 1, 2, ...)"
                                  },
                                  "value": {
                                    "anyOf": [
                                      {
                                        "type": "string"
                                      },
                                      {
                                        "type": "number"
                                      },
                                      {
                                        "type": "boolean"
                                      },
                                      {
                                        "type": "array",
                                        "items": {
                                          "type": [
                                            "string",
                                            "number",
                                            "boolean"
                                          ]
                                        },
                                        "minItems": 1
                                      }
                                    ],
                                    "description": "Value(s) for the field. For \"rotated\" type, provide array. For \"fixed\" type, provide single value. For \"random\", specify valueType only."
                                  },
                                  "valueConfig": {
                                    "type": "object",
                                    "properties": {
                                      "min": {
                                        "type": "number",
                                        "description": "Minimum value for random numbers"
                                      },
                                      "max": {
                                        "type": "number",
                                        "description": "Maximum value for random numbers"
                                      },
                                      "stringLength": {
                                        "type": "integer",
                                        "exclusiveMinimum": 0,
                                        "description": "Length for random strings"
                                      },
                                      "numericOnly": {
                                        "type": "boolean",
                                        "description": "If true, generate numeric values only (for random type)"
                                      },
                                      "alternating": {
                                        "type": "boolean",
                                        "description": "If true, alternate between numeric and string values (for random type)"
                                      },
                                      "valueTypeSpecific": {
                                        "type": "string",
                                        "enum": [
                                          "int",
                                          "bool",
                                          "double",
                                          "string"
                                        ],
                                        "description": "Generate type-specific values: int (integer), bool (boolean), double (float), string"
                                      },
                                      "asString": {
                                        "type": "boolean",
                                        "description": "If true, generate string representation of the value (e.g., \"6\" instead of 6, \"true\" instead of true)"
                                      }
                                    },
                                    "additionalProperties": false,
                                    "description": "Configuration for value generation"
                                  },
                                  "fields": {
                                    "type": "array",
                                    "items": {
                                      "type": "object",
                                      "properties": {
                                        "name": {
                                          "type": "string",
                                          "description": "Field name"
                                        },
                                        "valueType": {
                                          "type": "string",
                                          "enum": [
                                            "fixed",
                                            "random",
                                            "rotated",
                                            "dynamic",
                                            "sequential"
                                          ],
                                          "description": "Value generation type for this specific field"
                                        },
                                        "valueTypeSpecific": {
                                          "type": "string",
                                          "enum": [
                                            "int",
                                            "bool",
                                            "double",
                                            "string"
                                          ],
                                          "description": "Type-specific value generation"
                                        },
                                        "asString": {
                                          "type": "boolean",
                                          "description": "Generate as string representation"
                                        },
                                        "value": {
                                          "anyOf": [
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "array",
                                              "items": {
                                                "type": [
                                                  "string",
                                                  "number",
                                                  "boolean"
                                                ]
                                              },
                                              "minItems": 1
                                            }
                                          ],
                                          "description": "Value(s) for this field"
                                        },
                                        "valueConfig": {
                                          "type": "object",
                                          "properties": {
                                            "min": {
                                              "type": "number"
                                            },
                                            "max": {
                                              "type": "number"
                                            }
                                          },
                                          "additionalProperties": false,
                                          "description": "Value configuration for this field"
                                        }
                                      },
                                      "required": [
                                        "name"
                                      ],
                                      "additionalProperties": false
                                    },
                                    "description": "Explicit field definitions. If provided, overrides count/prefix-based generation. Useful for creating pairs or groups of related fields."
                                  },
                                  "fieldNames": {
                                    "type": "array",
                                    "items": {
                                      "type": "string"
                                    },
                                    "minItems": 1,
                                    "description": "Rotated field names (if provided, these will be used instead of prefix-based names)"
                                  },
                                  "namespace": {
                                    "type": "string",
                                    "description": "Namespace prefix (default: \"log.custom\"). Use empty string \"\" for no prefix, or specify custom namespace like \"custom\""
                                  },
                                  "degradeForFailed": {
                                    "type": "boolean",
                                    "description": "If true and document is failed, generate fields with values exceeding 1024 characters to cause mapping conflicts"
                                  }
                                },
                                "required": [
                                  "count"
                                ],
                                "additionalProperties": false,
                                "description": "Advanced custom field generation configuration"
                              }
                            ],
                            "description": "Custom fields under log.custom.* namespace. Can be simple object or advanced generation config."
                          },
                          "cloud": {
                            "type": "object",
                            "properties": {
                              "provider": {
                                "type": "string"
                              },
                              "region": {
                                "type": "string"
                              },
                              "availabilityZone": {
                                "type": "string"
                              },
                              "projectId": {
                                "type": "string"
                              },
                              "instanceId": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false,
                            "description": "Cloud provider fields"
                          },
                          "orchestrator": {
                            "type": "object",
                            "properties": {
                              "clusterName": {
                                "type": "string"
                              },
                              "clusterId": {
                                "type": "string"
                              },
                              "namespace": {
                                "type": "string"
                              },
                              "resourceId": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false,
                            "description": "Orchestrator fields (e.g., Kubernetes)"
                          },
                          "traceId": {
                            "type": "string",
                            "description": "Trace ID for correlation"
                          },
                          "transactionId": {
                            "type": "string",
                            "description": "Transaction ID for correlation"
                          },
                          "agentId": {
                            "type": "string",
                            "description": "Agent ID"
                          },
                          "agentName": {
                            "type": "string",
                            "description": "Agent name"
                          },
                          "logFilePath": {
                            "type": "string",
                            "description": "Log file path"
                          },
                          "degradedRate": {
                            "anyOf": [
                              {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 1
                              },
                              {
                                "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1"
                              }
                            ],
                            "description": "Degraded/Ignored rate as a number (0-1) or a distribution. Degraded documents are indexed but have non-empty _ignore property due to fields exceeding ignore_above limits (e.g., 1024 characters)."
                          },
                          "ignoredRate": {
                            "anyOf": [
                              {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 1
                              },
                              {
                                "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1"
                              }
                            ],
                            "description": "Ignored rate (alias for degradedRate). Documents are indexed but have non-empty _ignore property due to mapping conflicts."
                          },
                          "failureRate": {
                            "anyOf": [
                              {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 1
                              },
                              {
                                "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1"
                              }
                            ],
                            "description": "Failure rate as a number (0-1) or a distribution. Failed documents fail ingestion entirely and go to failure store (not indexed in normal indexes). Requires missing required fields or invalid values that trigger fail processors."
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "metrics": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "interval": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/interval",
                            "description": "Datemath or duration like 1m, 30s"
                          },
                          "rate": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/rate",
                            "description": "Events per interval"
                          },
                          "metrics": {
                            "type": "object",
                            "additionalProperties": {
                              "anyOf": [
                                {
                                  "type": "number"
                                },
                                {
                                  "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/errorRate/anyOf/1"
                                }
                              ]
                            }
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "synthetics": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "monitorId",
                          "origin"
                        ],
                        "properties": {
                          "interval": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/interval",
                            "description": "Datemath or duration like 1m, 30s"
                          },
                          "rate": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/rate",
                            "description": "Events per interval"
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "http",
                              "browser"
                            ]
                          },
                          "name": {
                            "type": "string"
                          },
                          "monitorId": {
                            "type": "string",
                            "description": "Required: Unique monitor identifier"
                          },
                          "origin": {
                            "type": "string",
                            "description": "Required: Location where monitor runs from (e.g., \"us-east-1\", \"eu-west-1\")"
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "hosts": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "interval": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/interval",
                            "description": "Datemath or duration like 1m, 30s"
                          },
                          "rate": {
                            "$ref": "#/definitions/Synthtrace DSL/properties/services/items/properties/instances/items/properties/traces/items/properties/rate",
                            "description": "Events per interval"
                          },
                          "metrics": {
                            "type": "array",
                            "items": {
                              "type": "string",
                              "enum": [
                                "cpu",
                                "memory",
                                "network",
                                "load",
                                "filesystem",
                                "diskio"
                              ]
                            }
                          }
                        },
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "additionalProperties": false
                },
                "minItems": 1
              }
            },
            "required": [
              "id",
              "name",
              "instances"
            ],
            "additionalProperties": false
          }
        }
      },
      "required": [
        "timeWindow"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}