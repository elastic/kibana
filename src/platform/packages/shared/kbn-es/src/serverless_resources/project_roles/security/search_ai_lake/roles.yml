# Predefined roles for "Security" "SearchAiLake" (tier) project types
# Source: https://github.com/elastic/elasticsearch-controller/blob/main/internal/config/roles/security.search_ai_lake.yaml

_search_ai_lake_analyst:
  metadata:
    _public: true
    _reserved: true
  cluster:
    - "manage_inference"
    - "monitor_connector"
    - "monitor_inference"
    - "monitor_ml"
  indices:
    - names:
        - ".alerts-security*"
        - ".internal.alerts-security*"
        - ".adhoc.alerts-security*"
        - ".internal.adhoc.alerts-security*"
      privileges:
        - "index"
        - "read"
        - "write"
        - "maintenance"
        - "view_index_metadata"
    - names:
        - ".siem-signals-*"
        - ".preview.alerts-security*"
        - ".internal.preview.alerts-security*"
        - "logs-*"
      privileges:
        - "read"
        - "view_index_metadata"
    - names:
        - ".lists*"
        - ".items*"
        - ".fleet-agents*"
        - ".fleet-actions*"
        - "risk-score.risk-score-*"
        - ".entities.v1.latest.security_*"
        - ".ml-anomalies-*"
        - "security_solution-*.misconfiguration_latest*"
      privileges:
        - "read"
  applications:
    - application: "kibana-.kibana"
      privileges:
        - "feature_ml.read"
        - "feature_siemV4.all"
        - "feature_securitySolutionCasesV2.all"
        - "feature_securitySolutionAssistant.all"
        - "feature_securitySolutionAttackDiscovery.minimal_all"
        - "feature_builtInAlerts.all"
        - "feature_actions.all"
        - "feature_discover_v2.read"
        - "feature_savedQueryManagement.read"
        - "feature_indexPatterns.read"
        - "feature_fleetv2.read"
      resources: "*"

_search_ai_lake_soc_manager:
  metadata:
    _public: true
    _reserved: true
  cluster:
    - "manage_inference"
    - "monitor_connector"
    - "monitor_inference"
    - "monitor_ml"
  indices:
    - names:
        - "apm-*-transaction*"
        - "traces-apm*"
        - "auditbeat-*"
        - "endgame-*"
        - "filebeat-*"
        - "packetbeat-*"
        - "winlogbeat-*"
        - "logstash-*"
        - ".asset-criticality.asset-criticality-*"
        - "security_solution-*.misconfiguration_latest*"
      privileges:
        - "read"
        - "write"
    - names:
        - "logs-*"
      privileges:
        - "read"
        - "view_index_metadata"
        - "write"
    - names:
        - ".alerts-security*"
        - ".siem-signals-*"
        - ".preview.alerts-security*"
        - ".internal.preview.alerts-security*"
        - ".adhoc.alerts-security*"
        - ".internal.adhoc.alerts-security*"
        - ".internal.alerts-security*"
      privileges:
        - "read"
        - "write"
        - "manage"
        - "view_index_metadata"
    - names:
        - ".lists*"
        - ".items*"
      privileges:
        - "read"
        - "write"
        - "view_index_metadata"
    - names:
        - "metrics-endpoint.metadata_current_*"
        - ".fleet-agents*"
        - ".fleet-actions*"
        - "risk-score.risk-score-*"
        - ".entities.v1.latest.security_*"
        - ".ml-anomalies-*"
      privileges:
        - "read"
  applications:
    - application: "kibana-.kibana"
      privileges:
        - "feature_siemV4.all"
        - "feature_siemV4.global_artifact_management_all"
        - "feature_siemV4.workflow_insights_all"
        - "feature_securitySolutionCasesV2.all"
        - "feature_securitySolutionAssistant.all"
        - "feature_securitySolutionAttackDiscovery.all"
        - "feature_actions.all"
        - "feature_builtInAlerts.all"
        - "feature_indexPatterns.all"
        - "feature_discover_v2.all"
        - "feature_savedQueryManagement.all"
        - "feature_ml.all"
        - "feature_fleetv2.all"
        - "feature_advancedSettings.all"
      resources: "*"
