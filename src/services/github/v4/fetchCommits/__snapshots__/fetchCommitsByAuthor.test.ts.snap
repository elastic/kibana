// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`fetchCommitsByAuthor when commit has an associated pull request should call with correct args to fetch author id 1`] = `
Array [
  Object {
    "query": "
    query AuthorId($author: String!) {
      user(login: $author) {
        id
      }
    }
  ",
    "variables": Object {
      "author": "sqren",
    },
  },
]
`;

exports[`fetchCommitsByAuthor when commit has an associated pull request should call with correct args to fetch commits 1`] = `
Array [
  Object {
    "query": "
    query CommitsByAuthor(
      $repoOwner: String!
      $repoName: String!
      $maxNumber: Int!
      $sourceBranch: String!
      $authorId: ID
      $commitPath: String
      $dateSince: GitTimestamp
      $dateUntil: GitTimestamp
    ) {
      repository(owner: $repoOwner, name: $repoName) {
        ref(qualifiedName: $sourceBranch) {
          target {
            ... on Commit {
              history(
                first: $maxNumber
                author: { id: $authorId }
                path: $commitPath
                since: $dateSince
                until: $dateUntil
              ) {
                edges {
                  node {
                    ...SourceCommitWithTargetPullRequest
                  }
                }
              }
            }
          }
        }
      }
    }

    
    fragment SourceCommitWithTargetPullRequest on Commit {
      # Source Commit
      repository {
        name
        owner {
          login
        }
      }
      sha: oid
      message
      committedDate

      # Source pull request: PR where source commit was merged in
      associatedPullRequests(first: 1) {
        edges {
          node {
            url
            number
            labels(first: 50) {
              nodes {
                name
              }
            }
            baseRefName

            # source merge commit (the commit that actually went into the source branch)
            mergeCommit {
              sha: oid
              message
            }

            # (possible) backport pull requests referenced in the source pull request
            timelineItems(last: 20, itemTypes: CROSS_REFERENCED_EVENT) {
              edges {
                node {
                  ... on CrossReferencedEvent {
                    targetPullRequest: source {
                      __typename

                      # Target PRs (backport PRs)
                      ... on PullRequest {
                        # target merge commit: the backport commit that was merged into the target branch
                        targetMergeCommit: mergeCommit {
                          sha: oid
                          message
                        }
                        repository {
                          name
                          owner {
                            login
                          }
                        }
                        url
                        title
                        state
                        baseRefName
                        number
                        commits(first: 20) {
                          edges {
                            node {
                              targetCommit: commit {
                                message
                                sha: oid
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  
  ",
    "variables": Object {
      "authorId": "myUserId",
      "commitPath": null,
      "dateSince": null,
      "dateUntil": null,
      "maxNumber": 10,
      "repoName": "kibana",
      "repoOwner": "elastic",
      "sourceBranch": "source-branch-from-options",
    },
  },
]
`;
