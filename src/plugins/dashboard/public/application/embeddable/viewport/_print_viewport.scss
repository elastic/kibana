
/*
Global print styling
*/
$a4PageHeight: 297mm;
$a4PageWidth: 210mm;
$a4PageMargin: 0;
$a4PagePadding: 0;
$a4PageFooterHeight: 10mm;

$a4PageContentHeight: $a4PageHeight - $a4PageFooterHeight;
$a4PageContentWidth: $a4PageWidth;

@page {
  size: A4;
  orientation: portrait;
  margin: $a4PageMargin;
  padding: $a4PagePadding;
  counter-increment: page;
}

@mixin globalScreenRules {
  @media screen, projection {
    .printFooter {
      bottom: 0;
    }

    .printHeader {
      display: none;
    }

  }
}

@mixin globalPrintRules {
  @media print {

    html {
      background-color: #FFF;
    }

    a[href]:after {
      content: ' [' attr(href) ']';
    }

    figure {
      break-inside: avoid;
    }

    * {
      -webkit-print-color-adjust: exact !important;   /* Chrome, Safari, Edge */
      color-adjust: exact !important;                 /*Firefox*/
    }

    .printHeader {
      position: fixed;
      top: 0;
    }

    // .printHeader:after {

    // }

    .printFooter {
      display: table-footer-group;
      position: fixed;
      bottom: 0;
      padding: 0 2mm 2mm 2mm;
      > img {
        height: 8mm;
      }
    }

    .printFooter:after {
      position: fixed;
      bottom: 2mm;
      left: 50%;
      transform: translateX(-50%);
      counter-increment: page;
      content: 'Page ' counter(page);
    }
  }
}

@mixin globalRules {
  @include globalScreenRules();
  @include globalPrintRules();
}

/*
Dashboard styling
*/
$visualisationsPerPage: 2;
$visPadding: 2mm;

/*
We set the same visual padding on the browser and print versions of the UI so that
we don't hit a race condition where padding is being updated while the print image
is being formed. This can result in parts of the vis being cut out.
*/
@mixin visualizationPadding {
  padding-left: $visPadding;
  padding-right: $visPadding;

  &:nth-child(#{$visualisationsPerPage}n - #{$visualisationsPerPage - 1}) {
    padding-top: $visPadding;
  }

  &:nth-child(#{$visualisationsPerPage}n) {
    page-break-after: always;
    padding-top: $visPadding;
    padding-bottom: $visPadding;
  }
}

@include globalRules();

@media screen, projection {
  .printViewport {
    &__vis {
      @include visualizationPadding();

      & .embPanel__header button {
        display: none;
      }

      margin: $euiSizeL auto;
      height: calc(#{$a4PageContentHeight} / #{$visualisationsPerPage});
      width: $a4PageContentWidth;
      padding: $visPadding;
    }
  }
}

@media print {

  .printViewport {
    &__vis {

      @include visualizationPadding();

      height: calc(#{$a4PageContentHeight} / #{$visualisationsPerPage});
      width: $a4PageContentWidth;

      & .euiPanel {
        box-shadow: none !important;
      }

      & .embPanel__header button {
        display: none;
      }

      page-break-inside: avoid;

      & * {
        overflow: hidden !important;
      }
    }
  }
}
