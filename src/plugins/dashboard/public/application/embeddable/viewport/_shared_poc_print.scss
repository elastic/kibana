
/*
Global print styling

This styling should be usable by an plugin/app that wants to provide print
functionality. The styling should be extremely unopinionated.

Observations:

1. It is possible to request a print before all ES searches have populated
  visualizations, this results in a borked print preview with half-rendered
  visualisations. The user will have to close the print dialog and re-open
  it. Not sure how to "fix" this UX.

2. We currently do not control the user-agent's header and footer content
   (including the style of fonts)

3. I could not see a way to get page numbering other than using the
   browser-provided footers :'(

4. Page box model is quite different from what we have in browsers - page
   margins define where the "no-mans-land" exists for actual content. Moving
   content into this space by, for example setting negative margins resulted
   in slightly unpredictable behaviour because the browser wants to either
   move this content to another page or it just looks broken/split across two
   pages

5. page-break-* is your friend!
*/
$a4PageHeight: 297mm;
$a4PageWidth: 210mm;
$a4PageMargin: 0;
$a4PagePadding: 0;
$a4PageHeaderHeight: 5mm;
$a4PageFooterHeight: 10mm;
$a4PageMarginBottom: 9mm;

$a4PageContentHeight: $a4PageHeight - $a4PageFooterHeight - $a4PageHeaderHeight - $a4PageMarginBottom;
$a4PageContentWidth: $a4PageWidth;

// Currently we cannot control or style the content the browser places in
// margins, this might change in the future:
// See https://drafts.csswg.org/css-page-3/#margin-boxes
@page {
  size: A4;
  orientation: portrait;
  padding: 0;
  margin: 0;
  margin-bottom: $a4PageMarginBottom;
}

@mixin globalScreenRules {
  @media screen, projection {
    .printFooter, .printHeader {
      display: none;
    }

    .printViewControls {
      position: fixed;
      top: $euiSizeL;
      right: $euiSizeL;
    }
  }
}

@mixin globalPrintRules {
  @media print {

    html {
      background-color: #FFF;
    }

    a[href]:after {
      content: ' [' attr(href) ']';
    }

    figure {
      break-inside: avoid;
    }

    * {
      -webkit-print-color-adjust: exact !important;   /* Chrome, Safari, Edge */
      color-adjust: exact !important;                 /*Firefox*/
    }

    .printViewControls {
      display: none;
    }

    .printHeader {
      display: table-header-group;
      position: fixed;
      top: 0;
      left: 50%;
      padding-top: 2mm;
      transform: translateX(-50%);
    }

    .printFooter {
      display: table-footer-group;
      position: fixed;
      bottom: 0;
      margin: 0 2mm 2mm 5mm;
      > img {
        height: 8mm;
      }
    }

    // There is a known limitation that Chrome does not increment the counter of fixed elements even though
    // they appear for each page. So we leave this out for now.
    // See https://bugs.chromium.org/p/chromium/issues/detail?id=774830
    // .printFooter::after {
    //   position: fixed;
    //   bottom: 2mm;
    //   left: 50%;
    //   transform: translateX(-50%);
    //   content: 'Page ' counter(x);
    // }
  }
}

@mixin globalSharedRules {
  @include globalScreenRules();
  @include globalPrintRules();
}
