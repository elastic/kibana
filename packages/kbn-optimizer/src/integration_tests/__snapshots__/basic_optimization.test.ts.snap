// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`builds expected bundles, saves bundle counts to metadata: OptimizerConfig 1`] = `
OptimizerConfig {
  "bundles": Array [
    Bundle {
      "cache": BundleCache {
        "path": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar/target/public/.kbn-optimizer-cache,
        "state": undefined,
      },
      "contextDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar,
      "entry": "./public/index",
      "id": "bar",
      "outputDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar/target/public,
      "sourceRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
      "type": "plugin",
    },
    Bundle {
      "cache": BundleCache {
        "path": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo/target/public/.kbn-optimizer-cache,
        "state": undefined,
      },
      "contextDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo,
      "entry": "./public/index",
      "id": "foo",
      "outputDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo/target/public,
      "sourceRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
      "type": "plugin",
    },
  ],
  "cache": true,
  "dist": false,
  "inspectWorkers": false,
  "maxWorkerCount": 1,
  "plugins": Array [
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar,
      "id": "bar",
      "isUiPlugin": true,
    },
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/baz,
      "id": "baz",
      "isUiPlugin": false,
    },
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo,
      "id": "foo",
      "isUiPlugin": true,
    },
  ],
  "profileWebpack": false,
  "repoRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
  "watch": false,
}
`;

exports[`prepares assets for distribution: 1 async bundle 1`] = `"(window.foo_bundle_jsonpfunction=window.foo_bundle_jsonpfunction||[]).push([[1],[,function(n,o,u){\\"use strict\\";function f(){}u.r(o),u.d(o,\\"foo\\",(function(){return f}))}]]);"`;

exports[`prepares assets for distribution: OptimizerConfig 1`] = `
OptimizerConfig {
  "bundles": Array [
    Bundle {
      "cache": BundleCache {
        "path": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar/target/public/.kbn-optimizer-cache,
        "state": undefined,
      },
      "contextDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar,
      "entry": "./public/index",
      "id": "bar",
      "outputDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar/target/public,
      "sourceRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
      "type": "plugin",
    },
    Bundle {
      "cache": BundleCache {
        "path": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo/target/public/.kbn-optimizer-cache,
        "state": undefined,
      },
      "contextDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo,
      "entry": "./public/index",
      "id": "foo",
      "outputDir": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo/target/public,
      "sourceRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
      "type": "plugin",
    },
  ],
  "cache": true,
  "dist": true,
  "inspectWorkers": false,
  "maxWorkerCount": 1,
  "plugins": Array [
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/bar,
      "id": "bar",
      "isUiPlugin": true,
    },
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/baz,
      "id": "baz",
      "isUiPlugin": false,
    },
    Object {
      "directory": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo/plugins/foo,
      "id": "foo",
      "isUiPlugin": true,
    },
  ],
  "profileWebpack": false,
  "repoRoot": <absolute path>/packages/kbn-optimizer/src/__fixtures__/__tmp__/mock_repo,
  "watch": false,
}
`;

exports[`prepares assets for distribution: bar bundle 1`] = `"var __kbnBundles__=\\"object\\"==typeof __kbnBundles__?__kbnBundles__:{};__kbnBundles__[\\"plugin/bar\\"]=function(e){function n(n){for(var t,o,i=n[0],a=n[1],c=0,s=[];c<i.length;c++)o=i[c],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&s.push(r[o][0]),r[o]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]);for(u&&u(n);s.length;)s.shift()()}var t={},r={0:0};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var n=[],t=r[e];if(0!==t)if(t)n.push(t[2]);else{var i=new Promise((function(n,o){t=r[e]=[n,o]}));n.push(t[2]=i);var a,c=document.createElement(\\"script\\");c.charset=\\"utf-8\\",c.timeout=120,o.nc&&c.setAttribute(\\"nonce\\",o.nc),c.src=function(e){return o.p+\\"\\"+({}[e]||e)+\\".plugin.js\\"}(e);var u=new Error;a=function(n){c.onerror=c.onload=null,clearTimeout(s);var t=r[e];if(0!==t){if(t){var o=n&&(\\"load\\"===n.type?\\"missing\\":n.type),i=n&&n.target&&n.target.src;u.message=\\"Loading chunk \\"+e+\\" failed.\\\\n(\\"+o+\\": \\"+i+\\")\\",u.name=\\"ChunkLoadError\\",u.type=o,u.request=i,t[1](u)}r[e]=void 0}};var s=setTimeout((function(){a({type:\\"timeout\\",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(n)},o.m=e,o.c=t,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){\\"undefined\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\\"Module\\"}),Object.defineProperty(e,\\"__esModule\\",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&\\"object\\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,\\"default\\",{enumerable:!0,value:e}),2&n&&\\"string\\"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,\\"a\\",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p=\\"\\",o.oe=function(e){throw console.error(e),e};var i=window.bar_bundle_jsonpfunction=window.bar_bundle_jsonpfunction||[],a=i.push.bind(i);i.push=n,i=i.slice();for(var c=0;c<i.length;c++)n(i[c]);var u=a;return o(o.s=9)}([function(e,n,t){\\"use strict\\";var r,o=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),i=[];function a(e){for(var n=-1,t=0;t<i.length;t++)if(i[t].identifier===e){n=t;break}return n}function c(e,n){for(var t={},r=[],o=0;o<e.length;o++){var c=e[o],u=n.base?c[0]+n.base:c[0],s=t[u]||0,l=\\"\\".concat(u,\\" \\").concat(s);t[u]=s+1;var f=a(l),d={css:c[1],media:c[2],sourceMap:c[3]};-1!==f?(i[f].references++,i[f].updater(d)):i.push({identifier:l,updater:h(d,n),references:1}),r.push(l)}return r}function u(e){var n=document.createElement(\\"style\\"),r=e.attributes||{};if(void 0===r.nonce){var i=t.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){n.setAttribute(e,r[e])})),\\"function\\"==typeof e.insert)e.insert(n);else{var a=o(e.insert||\\"head\\");if(!a)throw new Error(\\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\\");a.appendChild(n)}return n}var s,l=(s=[],function(e,n){return s[e]=n,s.filter(Boolean).join(\\"\\\\n\\")});function f(e,n,t,r){var o=t?\\"\\":r.media?\\"@media \\".concat(r.media,\\" {\\").concat(r.css,\\"}\\"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(n,o);else{var i=document.createTextNode(o),a=e.childNodes;a[n]&&e.removeChild(a[n]),a.length?e.insertBefore(i,a[n]):e.appendChild(i)}}function d(e,n,t){var r=t.css,o=t.media,i=t.sourceMap;if(o?e.setAttribute(\\"media\\",o):e.removeAttribute(\\"media\\"),i&&btoa&&(r+=\\"\\\\n/*# sourceMappingURL=data:application/json;base64,\\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i)))),\\" */\\")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,v=0;function h(e,n){var t,r,o;if(n.singleton){var i=v++;t=p||(p=u(n)),r=f.bind(null,t,i,!1),o=f.bind(null,t,i,!0)}else t=u(n),r=d.bind(null,t,n),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return r(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;r(e=n)}else o()}}e.exports=function(e,n){(n=n||{}).singleton||\\"boolean\\"==typeof n.singleton||(n.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var t=c(e=e||[],n);return function(e){if(e=e||[],\\"[object Array]\\"===Object.prototype.toString.call(e)){for(var r=0;r<t.length;r++){var o=a(t[r]);i[o].references--}for(var u=c(e,n),s=0;s<t.length;s++){var l=a(t[s]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}t=u}}}},function(e,n,t){\\"use strict\\";e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=function(e,n){var t,r,o,i=e[1]||\\"\\",a=e[3];if(!a)return i;if(n&&\\"function\\"==typeof btoa){var c=(t=a,r=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),o=\\"sourceMappingURL=data:application/json;charset=utf-8;base64,\\".concat(r),\\"/*# \\".concat(o,\\" */\\")),u=a.sources.map((function(e){return\\"/*# sourceURL=\\".concat(a.sourceRoot||\\"\\").concat(e,\\" */\\")}));return[i].concat(u).concat([c]).join(\\"\\\\n\\")}return[i].join(\\"\\\\n\\")}(n,e);return n[2]?\\"@media \\".concat(n[2],\\" {\\").concat(t,\\"}\\"):t})).join(\\"\\")},n.i=function(e,t,r){\\"string\\"==typeof e&&(e=[[null,e,\\"\\"]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&o[u[0]]||(t&&(u[2]?u[2]=\\"\\".concat(t,\\" and \\").concat(u[2]):u[2]=t),n.push(u))}},n}},function(e,n,t){\\"use strict\\";e.exports=function(e,n){return n||(n={}),\\"string\\"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['\\"].*['\\"]$/.test(e)&&(e=e.slice(1,-1)),n.hash&&(e+=n.hash),/[\\"'() \\\\t\\\\n]/.test(e)||n.needQuotes?'\\"'.concat(e.replace(/\\"/g,'\\\\\\\\\\"').replace(/\\\\n/g,\\"\\\\\\\\n\\"),'\\"'):e)}},function(e,n){e.exports=\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2ZXJzaW9uPSIxLjEiPjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjI1Ii8+PC9zdmc+\\"},function(e,n,t){window.__kbnDarkMode__?t(5):t(7)},function(e,n,t){var r=t(0),o=t(6);\\"string\\"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,\\"\\"]]);var i=(r(o,{insert:\\"head\\",singleton:!1}),o.locals?o.locals:{});e.exports=i},function(e,n,t){var r=t(1),o=t(2),i=t(3);n=r(!1);var a=o(i);n.push([e.i,\\"body {\\\\n  width: 10;\\\\n  background-image: url(\\"+a+\\"); }\\\\n\\",\\"\\"]),e.exports=n},function(e,n,t){var r=t(0),o=t(8);\\"string\\"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,\\"\\"]]);var i=(r(o,{insert:\\"head\\",singleton:!1}),o.locals?o.locals:{});e.exports=i},function(e,n,t){var r=t(1),o=t(2),i=t(3);n=r(!1);var a=o(i);n.push([e.i,\\"body {\\\\n  width: 10;\\\\n  background-image: url(\\"+a+\\"); }\\\\n\\",\\"\\"]),e.exports=n},function(e,n,t){\\"use strict\\";function r(){return\\"foo\\"}function o(){return\\"bar\\"}t.r(n),t(4),t.d(n,\\"barLibFn\\",(function(){return o})),t.d(n,\\"fooLibFn\\",(function(){return r})),t.p=window.__kbnPublicPath__.bar}]);"`;

exports[`prepares assets for distribution: foo bundle 1`] = `"var __kbnBundles__=\\"object\\"==typeof __kbnBundles__?__kbnBundles__:{};__kbnBundles__[\\"plugin/foo\\"]=function(n){function e(e){for(var t,o,u=e[0],i=e[1],c=0,f=[];c<u.length;c++)o=u[c],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t]);for(a&&a(e);f.length;)f.shift()()}var t={},r={0:0};function o(e){if(t[e])return t[e].exports;var r=t[e]={i:e,l:!1,exports:{}};return n[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(n){var e=[],t=r[n];if(0!==t)if(t)e.push(t[2]);else{var u=new Promise((function(e,o){t=r[n]=[e,o]}));e.push(t[2]=u);var i,c=document.createElement(\\"script\\");c.charset=\\"utf-8\\",c.timeout=120,o.nc&&c.setAttribute(\\"nonce\\",o.nc),c.src=function(n){return o.p+\\"\\"+({}[n]||n)+\\".plugin.js\\"}(n);var a=new Error;i=function(e){c.onerror=c.onload=null,clearTimeout(f);var t=r[n];if(0!==t){if(t){var o=e&&(\\"load\\"===e.type?\\"missing\\":e.type),u=e&&e.target&&e.target.src;a.message=\\"Loading chunk \\"+n+\\" failed.\\\\n(\\"+o+\\": \\"+u+\\")\\",a.name=\\"ChunkLoadError\\",a.type=o,a.request=u,t[1](a)}r[n]=void 0}};var f=setTimeout((function(){i({type:\\"timeout\\",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(e)},o.m=n,o.c=t,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){\\"undefined\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:\\"Module\\"}),Object.defineProperty(n,\\"__esModule\\",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&\\"object\\"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,\\"default\\",{enumerable:!0,value:n}),2&e&&\\"string\\"!=typeof n)for(var r in n)o.d(t,r,function(e){return n[e]}.bind(null,r));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,\\"a\\",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p=\\"\\",o.oe=function(n){throw console.error(n),n};var u=window.foo_bundle_jsonpfunction=window.foo_bundle_jsonpfunction||[],i=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var a=i;return o(o.s=0)}([function(n,e,t){\\"use strict\\";function r(){return\\"foo\\"}function o(n,e,t,r,o,u,i){try{var c=n[u](i),a=c.value}catch(n){return void t(n)}c.done?e(a):Promise.resolve(a).then(r,o)}function u(n){return function(){var e=this,t=arguments;return new Promise((function(r,u){var i=n.apply(e,t);function c(n){o(i,r,u,c,a,\\"next\\",n)}function a(n){o(i,r,u,c,a,\\"throw\\",n)}c(void 0)}))}}function i(){return c.apply(this,arguments)}function c(){return(c=u(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.e(1).then(t.bind(null,1));case 2:return n.abrupt(\\"return\\",n.sent);case 3:case\\"end\\":return n.stop()}}),n)})))).apply(this,arguments)}t.r(e),t.d(e,\\"getFoo\\",(function(){return i})),t.d(e,\\"fooLibFn\\",(function(){return r})),t.d(e,\\"ext\\",(function(){return\\"TRUE\\"})),t.p=window.__kbnPublicPath__.foo}]);"`;
