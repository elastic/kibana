# -----
# This file is for information purpose only. 'viewer' and 'editor' roles are defined in stateful Elasticsearch by default
# Source: https://github.com/elastic/elasticsearch/blob/4272164530807787d4d8b991e3095a6e79176dbf/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java#L861-L952
# Note: inconsistency between these roles definition and the same roles of serverless project may break FTR deployment-agnostic tests
# -----
viewer:
  cluster: []
  indices:
    - names:
        - '.alerts*'
        - '.preview.alerts*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '.items-*'
        - '.lists-*'
        - '.siem-signals*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '/~(([.]|ilm-history-).*)/'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '.profiling-*'
        - 'profiling-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
  applications:
    - application: 'kibana-.kibana'
      privileges:
        - 'read'
      resources:
        - '*'
  run_as: []

editor:
  cluster: []
  indices:
    - names:
        - 'observability-annotations'
      privileges:
        - 'read'
        - 'view_index_metadata'
        - 'write'
      allow_restricted_indices: false
    - names:
        - '.items-*'
        - '.lists-*'
        - '.siem-signals*'
      privileges:
        - 'maintenance'
        - 'read'
        - 'view_index_metadata'
        - 'write'
      allow_restricted_indices: false
    - names:
        - '/~(([.]|ilm-history-).*)/'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '.profiling-*'
        - 'profiling-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '.alerts*'
        - '.internal.alerts*'
        - '.internal.preview.alerts*'
        - '.preview.alerts*'
      privileges:
        - 'maintenance'
        - 'read'
        - 'view_index_metadata'
        - 'write'
      allow_restricted_indices: false
  applications:
    - application: 'kibana-.kibana'
      privileges:
        - 'all'
      resources:
        - '*'
  run_as: []

# Admin role without 'remote_indices' access definition
# There is no such built-in role in stateful, and it's a role "similar" to the built-in 'admin' role in serverless
admin:
  # TODO: 'all' should be replaced with explicit list both here and serverless for deployment-agnostic tests with 'admin' role to be compatible
  cluster: ['all']
  indices:
    - names: ['*']
      privileges: ['all']
      allow_restricted_indices: false
    - names: ['*']
      privileges:
        - 'monitor'
        - 'read'
        - 'read_cross_cluster'
        - 'view_index_metadata'
      allow_restricted_indices: true
  applications:
    - application: '*'
      privileges: ['*']
      resources: ['*']
  run_as: ['*']

# temporarily added for testing purpose
system_indices_superuser:
  cluster: ['all']
  indices:
    - names: ['*']
      privileges: ['all']
      allow_restricted_indices: true
  applications:
    - application: '*'
      privileges: ['*']
      resources: ['*']
  run_as: ['*']

machine_learning_admin:
  cluster: ['manage_ml']
  indices:
    - names: ['.ml-anomalies*','.ml-notifications*','.ml-state*','.ml-meta*','.ml-stats-*']
      privileges: ['view_index_metadata', 'read']
      allow_restricted_indices: true
    - names: ['.ml-annotations*']
      privileges: ['write', 'read', 'view_index_metadata']
      allow_restricted_indices: true
  applications:
    - application: 'kibana-*'
      privileges: ['reserved_ml_admin']
      resources: ['*']
  run_as: []

machine_learning_user:
  cluster: ['monitor_ml']
  indices:
    - names: ['.ml-anomalies*','.ml-notifications*',]
      privileges: ['view_index_metadata', 'read']
      allow_restricted_indices: false
    - names: ['.ml-annotations*']
      privileges: ['write', 'read', 'view_index_metadata']
      allow_restricted_indices: false
  applications:
    - application: 'kibana-*'
      privileges: ['reserved_ml_user']
      resources: ['*']
  run_as: []

apm_user:
  cluster: []
  indices:
    - names:
        - 'apm-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'logs-apm.*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'logs-apm-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'metrics-apm.*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'metrics-apm-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'traces-apm.*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'traces-apm-*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - '.ml-anomalies*'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
    - names:
        - 'observability-annotations'
      privileges:
        - 'read'
        - 'view_index_metadata'
      allow_restricted_indices: false
  applications:
    - application: 'kibana-*'
      privileges:
        - 'reserved_ml_apm_user'
      resources:
        - '*'
  run_as: []

monitoring_user:
  cluster:
    - "cluster:monitor/main"
    - "cluster:monitor/xpack/info"
    - "cluster:monitor/remote/info"
  indices:
    - names:
        - ".monitoring-*"
      privileges:
        - "read"
        - "read_cross_cluster"
      allow_restricted_indices: false
    - names:
        - "/metrics-(beats|elasticsearch|enterprisesearch|kibana|logstash).*/"
      privileges:
        - "read"
        - "read_cross_cluster"
      allow_restricted_indices: false
    - names:
        - "metricbeat-*"
      privileges:
        - "read"
        - "read_cross_cluster"
      allow_restricted_indices: false
  applications:
    - application: "kibana-*"
      privileges:
        - "reserved_monitoring"
      resources:
        - "*"
  run_as: []
