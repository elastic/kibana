{
  "testCases": [
    {
      "query": "from a_index | stats by stringField",
      "error": [],
      "warning": []
    },
    {
      "query": "FROM index\n            | EVAL numberField * 3.281\n            | STATS avg_numberField = AVG(`numberField * 3.281`)",
      "error": [],
      "warning": []
    },
    {
      "query": "FROM index | STATS AVG(numberField) by round(numberField) + 1 | EVAL `round(numberField) + 1` / 2",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats ",
      "error": [
        "At least one aggregation or grouping expression required in [STATS]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by 1",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(`numberField`)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(*)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count()",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = count(*)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = count()",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = avg(numberField), count(*)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(case(false, 0, 1))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = sum( case(false, 0, 1))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(stringField == \"a\" or null)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(`numberField`) | keep `count(``numberField``)` ",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(`numberField`) | drop `count(``numberField``)` ",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats count(`numberField`) | eval `count(``numberField``)` ",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | STATS sum( numberField ) + abs( numberField ) ",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [sum(numberField)+abs(numberField)]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | STATS abs( numberField + sum( numberField )) ",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [abs(numberField+sum(numberField))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField + 1",
      "error": [
        "At least one aggregation function required in [STATS], found [numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField + 1, stringField",
      "error": [
        "At least one aggregation function required in [STATS], found [numberField+1]",
        "Expected an aggregate function or group but got [stringField] of type [FieldAttribute]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField + 1, numberField + 2, count()",
      "error": [
        "At least one aggregation function required in [STATS], found [numberField+1]",
        "At least one aggregation function required in [STATS], found [numberField+2]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField + 1, numberField + count(), count()",
      "error": [
        "At least one aggregation function required in [STATS], found [numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField + 1",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField + 1 by ipField",
      "error": [
        "At least one aggregation function required in [STATS], found [numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField ",
      "error": [
        "Expected an aggregate function or group but got [numberField] of type [FieldAttribute]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField=",
      "error": [
        "SyntaxError: mismatched input '<EOF>' expecting {QUOTED_STRING, INTEGER_LITERAL, DECIMAL_LITERAL, 'false', '(', 'not', 'null', '?', 'true', '+', '-', OPENING_BRACKET, UNQUOTED_IDENTIFIER, QUOTED_IDENTIFIER}"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats numberField=5 by ",
      "error": [
        "SyntaxError: mismatched input '<EOF>' expecting {QUOTED_STRING, INTEGER_LITERAL, DECIMAL_LITERAL, 'false', '(', 'not', 'null', '?', 'true', '+', '-', OPENING_BRACKET, UNQUOTED_IDENTIFIER, QUOTED_IDENTIFIER}"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by wrongField",
      "error": [
        "Unknown column [wrongField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by wrongField + 1",
      "error": [
        "Unknown column [wrongField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by var0 = wrongField + 1",
      "error": [
        "Unknown column [wrongField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = avg(fn(number)), count(*)",
      "error": [
        "Unknown function [fn]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(round(*))",
      "error": [
        "Using wildcards (*) in round is not allowed"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(count(*))",
      "error": [
        "Aggregate function's parameters must be an attribute, literal or a non-aggregation function; found [count(*)] of type [number]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField), percentile(numberField, 50) by ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField), percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField), percentile(numberField, 50) + 1 by ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) + percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) - percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) * percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) / percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) % percentile(numberField, 50) BY ipField",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats by ",
      "error": [
        "SyntaxError: mismatched input '<EOF>' expecting {QUOTED_STRING, INTEGER_LITERAL, DECIMAL_LITERAL, 'false', '(', 'not', 'null', '?', 'true', '+', '-', OPENING_BRACKET, UNQUOTED_IDENTIFIER, QUOTED_IDENTIFIER}"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(* + 1) BY ipField",
      "error": [
        "SyntaxError: no viable alternative at input 'count(* +'"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(* + round(numberField)) BY ipField",
      "error": [
        "SyntaxError: no viable alternative at input 'count(* +'"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(round(*)) BY ipField",
      "error": [
        "Using wildcards (*) in round is not allowed"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats count(count(*)) BY ipField",
      "error": [
        "Aggregate function's parameters must be an attribute, literal or a non-aggregation function; found [count(*)] of type [number]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by percentile(numberField)",
      "error": [
        "STATS BY does not support function percentile"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats avg(numberField) by stringField, percentile(numberField) by ipField",
      "error": [
        "STATS BY does not support function percentile",
        "SyntaxError: mismatched input 'by' expecting <EOF>"
      ],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, pi(), \"\", \"\")",
      "error": [],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, 1 + 30 / 10, \"\", \"\")",
      "error": [],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, 1 + 30 / 10, concat(\"\", \"\"), \"\")",
      "error": [],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, abs(numberField), \"\", \"\")",
      "error": [
        "Argument of [bucket] must be a constant, received [abs(numberField)]"
      ],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, abs(length(numberField)), \"\", \"\")",
      "error": [
        "Argument of [bucket] must be a constant, received [abs(length(numberField))]"
      ],
      "warning": []
    },
    {
      "query": "from index | stats by bucket(dateField, numberField, stringField, stringField)",
      "error": [
        "Argument of [bucket] must be a constant, received [numberField]",
        "Argument of [bucket] must be a constant, received [stringField]",
        "Argument of [bucket] must be a constant, received [stringField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + avg(numberField) +1",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1 + avg(numberField)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1 + numberField",
      "error": [
        "At least one aggregation function required in [STATS], found [5+1+numberField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1, var0 = sum(numberField)",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round( sum(numberField) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round( sum(numberField) ) + round( sum(numberField) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round( sum(numberField + numberField) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round( sum(numberField + round(numberField)) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round( sum(numberField + round(numberField)) ) + round( sum(numberField + round(numberField)) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round( numberField ) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round( numberField ) ) + sum(round( numberField ) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round( numberField + sum(numberField) )",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(numberField+sum(numberField))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round( numberField + sum(numberField) ), var0 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(numberField+sum(numberField))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = round( numberField + sum(numberField) ), var1 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(numberField+sum(numberField))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + avg(numberField) +1+1",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1 + avg(numberField)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1 + numberField",
      "error": [
        "At least one aggregation function required in [STATS], found [5+1+1+numberField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1, var0 = sum(numberField)",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( sum(numberField) ))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( sum(numberField) )) + round(round( sum(numberField) ))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( sum(numberField + numberField) ))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( sum(numberField + round(numberField)) ))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( sum(numberField + round(numberField)) )) + round(round( sum(numberField + round(numberField)) ))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round( numberField )) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round( numberField )) ) + sum(round(round( numberField )) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( numberField + sum(numberField) ))",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(numberField+sum(numberField)))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round( numberField + sum(numberField) )), var0 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(numberField+sum(numberField)))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = round(round( numberField + sum(numberField) )), var1 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(numberField+sum(numberField)))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + avg(numberField) +1+1+1",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1+1 + avg(numberField)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1+1 + numberField",
      "error": [
        "At least one aggregation function required in [STATS], found [5+1+1+1+numberField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1+1",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1+1, var0 = sum(numberField)",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( sum(numberField) )))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( sum(numberField) ))) + round(round(round( sum(numberField) )))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( sum(numberField + numberField) )))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( sum(numberField + round(numberField)) )))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( sum(numberField + round(numberField)) ))) + round(round(round( sum(numberField + round(numberField)) )))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round(round( numberField ))) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round(round( numberField ))) ) + sum(round(round(round( numberField ))) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( numberField + sum(numberField) )))",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(numberField+sum(numberField))))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round( numberField + sum(numberField) ))), var0 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(numberField+sum(numberField))))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = round(round(round( numberField + sum(numberField) ))), var1 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(numberField+sum(numberField))))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + avg(numberField) +1+1+1+1",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1+1+1 + avg(numberField)",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 +1+1+1+1 + numberField",
      "error": [
        "At least one aggregation function required in [STATS], found [5+1+1+1+1+numberField]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1+1+1",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats 5 + numberField +1+1+1+1, var0 = sum(numberField)",
      "error": [
        "At least one aggregation function required in [STATS], found [5+numberField+1+1+1+1]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( sum(numberField) ))))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( sum(numberField) )))) + round(round(round(round( sum(numberField) ))))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( sum(numberField + numberField) ))))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( sum(numberField + round(numberField)) ))))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( sum(numberField + round(numberField)) )))) + round(round(round(round( sum(numberField + round(numberField)) ))))",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round(round(round( numberField )))) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats sum(round(round(round(round( numberField )))) ) + sum(round(round(round(round( numberField )))) )",
      "error": [],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( numberField + sum(numberField) ))))",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(round(numberField+sum(numberField)))))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats round(round(round(round( numberField + sum(numberField) )))), var0 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(round(numberField+sum(numberField)))))]"
      ],
      "warning": []
    },
    {
      "query": "from a_index | stats var0 = round(round(round(round( numberField + sum(numberField) )))), var1 = sum(numberField)",
      "error": [
        "Cannot combine aggregation and non-aggregation values in [STATS], found [round(round(round(round(numberField+sum(numberField)))))]"
      ],
      "warning": []
    }
  ]
}