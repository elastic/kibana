// Removes EUI focus ring
@mixin removeEuiFocusRing {
  outline: none;

  &:focus-visible {
    outline-style: none;
  }
}

// Passes focus ring styles down to a child of a focused element
@mixin passDownFocusRing($target) {
  @include removeEuiFocusRing;

  #{$target} {
    outline: $euiFocusRingSize solid currentColor; // Safari & Firefox
  }

  &:focus-visible #{$target} {
    outline-style: auto; // Chrome
  }

  &:not(:focus-visible) #{$target} {
    outline: none;
  }
}

/**
 * 1. Only visually hide the action, so that it's still accessible to screen readers.
 * 2. When tabbed to, this element needs to be visible for keyboard accessibility.
 */
.unifiedFieldListItemButton__action {
  opacity: 0; /* 1 */

  &--always {
    opacity: 1;
  }

  &:focus {
    opacity: 1; /* 2 */
  }
}

.unifiedFieldListItemButton {
  width: 100%;

  &.kbnFieldButton {
    &:focus-within,
    &-isActive {
      @include removeEuiFocusRing;
    }
  }

  .kbnFieldButton__button:focus {
    @include passDownFocusRing('.kbnFieldButton__nameInner');
  }

  & button .kbnFieldButton__nameInner:hover {
    text-decoration: underline;
  }

  &:hover,
  &[class*='-isActive'] {
    .unifiedFieldListItemButton__action {
      opacity: 1;
    }
  }
}

.unifiedFieldListItemButton--missing {
  background: lightOrDarkTheme(transparentize($euiColorMediumShade, .9), $euiColorEmptyShade);
  color: $euiColorDarkShade;
}

// A drag handle will appear only on item hover/focus
.unifiedFieldListItemButton--withDragHandle {
  &.kbnFieldButton {
    padding: 0;
  }

  .kbnFieldButton__dragHandle {
    margin-right: 0;
    width: 0;
    overflow: hidden;
    transition: $euiAnimSpeedNormal ease-in-out;
    transition-property: width, margin-right;
  }

  &.domDragDrop-isDraggable {
    box-shadow: none;
  }
  &.domDragDrop-isDraggable:hover {
    transform: none;
  }

  &:hover,
  &[class*='-isActive'],
  .domDragDrop__keyboardHandler:focus + &,
  &:focus-within {
    .kbnFieldButton__dragHandle {
      margin-right: $euiSizeS;
      width: $euiSize;
    }
  }
}
