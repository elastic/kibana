steps:
  - group: ES|QL Evaluations
    key: esql-evaluations
    depends_on:
      - build
      - quick_checks
      - checks
      - linting
      - linting_with_types
      - check_types
      - check_oas_snapshot
    steps:
      - label: 'ES|QL Generation Evaluations'
        command: bash .buildkite/scripts/steps/evals/esql_evals.sh
        env:
          KBN_EVALS: '1'
        key: esql-evals
        timeout_in_minutes: 60
        agents:
          machineType: n2-standard-8
          preemptible: true
        retry:
          automatic:
            - exit_status: '-1'
              limit: 3
            - exit_status: '*'
              limit: 1
