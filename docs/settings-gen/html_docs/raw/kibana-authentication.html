<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Authentication in Kibana | Kibana Guide | Elastic</title>
<meta class="elastic" name="content" content="Authentication in Kibana | Kibana Guide">

<link rel="home" href="index.html" title="Kibana Guide"/>
<link rel="up" href="using-kibana-with-security.html" title="Configure security in Kibana"/>
<link rel="prev" href="using-kibana-with-security.html" title="Configure security in Kibana"/>
<link rel="next" href="elasticsearch-mutual-tls.html" title="Mutual TLS authentication between Kibana and Elasticsearch"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="using-kibana-with-security.html">« Configure security in Kibana</a>
</span>
<span class="next">
<a href="elasticsearch-mutual-tls.html">Mutual TLS authentication between Kibana and Elasticsearch »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="using-kibana-with-security.html">Configure security in Kibana</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Authentication in Kibana</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="kibana-authentication"></a>Authentication in Kibana</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>

<p>Kibana supports the following authentication mechanisms:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="kibana-authentication.html#multiple-authentication-providers" title="Multiple authentication providers">Multiple authentication providers</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#basic-authentication" title="Basic authentication">Basic authentication</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#token-authentication" title="Token authentication">Token authentication</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#pki-authentication" title="Public key infrastructure (PKI) authentication">Public key infrastructure (PKI) authentication</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#saml" title="SAML single sign-on">SAML single sign-on</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#oidc" title="OpenID Connect single sign-on">OpenID Connect single sign-on</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#kerberos" title="Kerberos single sign-on">Kerberos single sign-on</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#anonymous-authentication" title="Anonymous authentication">Anonymous authentication</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#http-authentication" title="HTTP authentication">HTTP authentication</a>
</li>
<li class="listitem">
<a class="xref" href="kibana-authentication.html#embedded-content-authentication" title="Embedded content authentication">Embedded content authentication</a>
</li>
</ul>
</div>
<p>For an introduction to Kibana&#8217;s security features, including the login process, refer to <a class="xref" href="tutorial-secure-access-to-kibana.html" title="Securing access to Kibana"><em>Securing access to Kibana</em></a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="multiple-authentication-providers"></a>Multiple authentication providers</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>Enable multiple authentication mechanisms at the same time by specifying a prioritized list of the authentication <em>providers</em> (typically of various types) in the configuration. Providers are consulted in ascending order. Make sure each configured provider has a unique name (e.g. <code class="literal">basic1</code> or <code class="literal">saml1</code> in the configuration example) and <code class="literal">order</code> setting. In the event that two or more providers have the same name or <code class="literal">order</code>, Kibana will fail to start.</p>
<p>When two or more providers are configured, you can choose the provider you want to use on the Login Selector UI. The order the providers appear is determined by the <code class="literal">order</code> setting. The appearance of the specific provider entry can be customized with the <code class="literal">description</code>, <code class="literal">hint</code>, and <code class="literal">icon</code> settings.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To provide login instructions to users, use the <code class="literal">xpack.security.loginHelp</code> setting, which supports Markdown format. When you specify the <code class="literal">xpack.security.loginHelp</code> setting, the Login Selector UI displays a <code class="literal">Need help?</code> link that lets users access login help information.</p>
</div>
</div>
<p>If you don&#8217;t want a specific provider to show up at the Login Selector UI (e.g. to only support third-party initiated login) you can hide it with <code class="literal">showInSelector</code> setting set to <code class="literal">false</code>. However, in this case, the provider is presented in the provider chain and may be consulted during authentication based on its <code class="literal">order</code>. To disable the provider, use the <code class="literal">enabled</code> setting.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>The Login Selector UI can also be disabled or enabled with <code class="literal">xpack.security.authc.selector.enabled</code> setting.</p>
</div>
</div>
<p>Here is how your <code class="literal">kibana.yml</code> and Login Selector UI can look like if you deal with multiple authentication providers:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.loginHelp: "**Help** info with a [link](...)"
xpack.security.authc.providers:
  basic.basic1:
    order: 0
    icon: "logoElasticsearch"
    hint: "Typically for administrators"
  saml.saml1:
    order: 1
    realm: saml1
    description: "Log in with SSO"
    icon: "https://my-company.xyz/saml-logo.svg"
  saml.saml2:
    order: 2
    realm: saml2
    showInSelector: false
  kerberos.kerberos1:
    order: 3
    enabled: false</pre>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="security/images/kibana-login.png" alt="Login Selector UI">
</div>
</div>
<p>For more information, refer to <a class="xref" href="security-settings-kb.html#authentication-security-settings" title="Authentication security settings">authentication security settings</a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you have multiple authentication providers configured, you can use the <code class="literal">auth_provider_hint</code> URL query parameter to create a deep
link to any provider and bypass the Login Selector UI. Using the <code class="literal">kibana.yml</code> above as an example, you can add <code class="literal">?auth_provider_hint=basic1</code>
to the login page URL, which will take you directly to the basic login page.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="basic-authentication"></a>Basic authentication</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>To successfully log in to Kibana, basic authentication requires a username and password. Basic authentication is enabled by default, and is based on the Native, LDAP, or Active Directory security realm that is provided by Elasticsearch. The basic authentication provider uses a Kibana provided login form, and supports authentication using the <code class="literal">Authorization</code> request header <code class="literal">Basic</code> scheme.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can configure only one Basic provider per Kibana instance.</p>
</div>
</div>
<p>For more information about basic authentication and built-in users, see
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/setting-up-authentication.html" class="ulink" target="_top">User authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="token-authentication"></a>Token authentication</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>Token authentication is a <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">subscription feature</a>. This allows users to log in using the same Kibana
provided login form as basic authentication, and is based on the Native security realm or LDAP security realm that is provided by Elasticsearch. The
token authentication provider is built on Elasticsearch token APIs.</p>
<p>Prior to configuring Kibana, ensure token support is enabled in Elasticsearch. See the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/security-api-get-token.html" class="ulink" target="_top">Elasticsearch token API</a> documentation for more information.</p>
<p>To enable the token authentication provider in Kibana, set the following value in your <code class="literal">kibana.yml</code>:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can configure only one Token provider per Kibana instance.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  token.token1:
    order: 0</pre>
</div>
<p>Switching to the token authentication provider from basic one will make Kibana to reject requests from applications like <code class="literal">curl</code> that usually use <code class="literal">Authorization</code> request header with the <code class="literal">Basic</code> scheme for authentication. If you still want to support such applications you&#8217;ll have to either switch to using <code class="literal">Bearer</code> scheme with the tokens <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/security-api-get-token.html" class="ulink" target="_top">created by Elasticsearch token API</a> or add <code class="literal">Basic</code> scheme to the list of supported schemes for the <a class="xref" href="kibana-authentication.html#http-authentication" title="HTTP authentication">HTTP authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="pki-authentication"></a>Public key infrastructure (PKI) authentication</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>PKI authentication will not work if Kibana is hosted behind a TLS termination reverse proxy. In this configuration, Kibana does not have direct access to the client certificates and cannot authenticate the user.</p>
</div>
</div>
<p>PKI authentication is a <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">subscription feature</a>. This allows users to log
into Kibana using X.509 client certificates that must be presented while connecting to Kibana. The certificates must first be accepted for
authentication on the Kibana TLS layer, and then they are further validated by an Elasticsearch PKI realm. The PKI authentication provider relies on
the Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/security-api-delegate-pki-authentication.html" class="ulink" target="_top">Delegate PKI authentication API</a> to exchange X.509 client certificates to
access tokens. All subsequent requests to Elasticsearch APIs on behalf of users will be authenticated using these access tokens.</p>
<p>Prior to configuring Kibana, ensure that the PKI realm is enabled in Elasticsearch and configured to permit delegation. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/configuring-pki-realm.html" class="ulink" target="_top">Configuring a PKI realm</a> for more information.</p>
<p>To enable the PKI authentication provider in Kibana, you must first <a class="xref" href="configuring-tls.html" title="Encrypt TLS communications in Kibana">configure Kibana to encrypt communications between the browser and Kibana server</a>. You must also enable TLS client authentication and include the certificate authority (CA) used to sign client certificates into a list of CAs trusted by Kibana in your <code class="literal">kibana.yml</code>:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can configure only one PKI provider per Kibana instance.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">server.ssl.certificateAuthorities: /path/to/your/cacert.pem
server.ssl.clientAuthentication: required
xpack.security.authc.providers:
  pki.pki1:
    order: 0</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Trusted CAs can also be specified in a PKCS #12 keystore bundled with your Kibana server certificate/key using
<code class="literal">server.ssl.keystore.path</code> or in a separate trust store using <code class="literal">server.ssl.truststore.path</code>.</p>
</div>
</div>
<p>You can also configure both PKI and basic authentication for the same Kibana instance:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">server.ssl.clientAuthentication: optional
xpack.security.authc.providers:
  pki.pki1:
    order: 0
  basic.basic1:
    order: 1</pre>
</div>
<p>Note that with <code class="literal">server.ssl.clientAuthentication</code> set to <code class="literal">required</code>, users are asked to provide a valid client certificate, even if they want to authenticate with username and password. Depending on the security policies, it may or may not be desired. If not, <code class="literal">server.ssl.clientAuthentication</code> can be set to <code class="literal">optional</code>. In this case, Kibana still requests a client certificate, but the client won&#8217;t be required to present one. The <code class="literal">optional</code> client authentication mode might also be needed in other cases, for example, when PKI authentication is used in conjunction with Reporting.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="saml"></a>SAML single sign-on</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>SAML authentication is part of single sign-on (SSO), a <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">subscription feature</a>. This allows users to log
in to Kibana with an external Identity Provider, such as Okta or Auth0. Make sure that SAML is enabled and configured in Elasticsearch before setting
it up in Kibana. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/saml-guide.html" class="ulink" target="_top">Configuring SAML single sign-on on the Elastic Stack</a>.</p>
<p>Enable SAML authentication by specifying which SAML realm in Elasticsearch should be used:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  saml.saml1:
    order: 0
    realm: saml1</pre>
</div>
<p>You can log in to Kibana via SAML SSO by navigating directly to the Kibana URL. If you aren&#8217;t authenticated, you are redirected to the Identity Provider for login. Most Identity Providers maintain a long-lived session. If you log in to a different application using the same Identity Provider in the same browser, you are automatically authenticated. An exception is if Elasticsearch or the Identity Provider is configured to force you to re-authenticate. This login scenario is called <em>Service Provider initiated login</em>.</p>
<p>It&#8217;s also possible to configure multiple SAML authentication providers at the same time. In this case, you will need to choose which provider to use for login at the Login Selector UI:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  saml.saml1:
    order: 0
    realm: saml1
    description: "Log in with Elastic"
  saml.saml2:
    order: 1
    realm: saml2
    description: "Log in with Auth0"</pre>
</div>
<div class="position-relative"><h5><a id="_saml_and_basic_authentication"></a>SAML and basic authentication</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>You can also configure both SAML and basic authentication for the same Kibana instance. This might be the case for Kibana or Elasticsearch admins whose accounts aren&#8217;t linked to the SSO users database:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  saml.saml1:
    order: 0
    realm: saml1
    description: "Log in with Elastic"
  basic.basic1:
    order: 1</pre>
</div>
<p>Basic authentication is supported <em>only</em> if the <code class="literal">basic</code> authentication provider is explicitly declared in <code class="literal">xpack.security.authc.providers</code> setting, in addition to <code class="literal">saml</code>.</p>
<p>To support basic authentication for the applications like <code class="literal">curl</code> or when the <code class="literal">Authorization: Basic base64(username:password)</code> HTTP header is included in the request (for example, by reverse proxy), add <code class="literal">Basic</code> scheme to the list of supported schemes for the <a class="xref" href="kibana-authentication.html#http-authentication" title="HTTP authentication">HTTP authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="oidc"></a>OpenID Connect single sign-on</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>OpenID Connect (OIDC) authentication is part of single sign-on (SSO), a <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">subscription feature</a>. Similar
to SAML, authentication with OIDC allows users to log in to Kibana using an OIDC Provider such as Google, or Okta. OIDC should also
be configured in Elasticsearch. For more details, see <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/oidc-guide.html" class="ulink" target="_top">Configuring single sign-on to the Elastic Stack using OpenID Connect</a>.</p>
<p>Enable OIDC authentication by specifying which OIDC realm in Elasticsearch to use:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  oidc.oidc1:
    order: 0
    realm: oidc1</pre>
</div>
<p>To use third party initiated SSO, configure your OpenID Provider to use <code class="literal">/api/security/oidc/initiate_login</code> as <code class="literal">Initiate Login URI</code>.</p>
<p>It&#8217;s also possible to configure multiple OpenID Connect authentication providers at the same time. In this case, you need to choose which provider to use for login at the Login Selector UI:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  oidc.oidc1:
    order: 0
    realm: oidc1
    description: "Log in with Elastic"
  oidc.oidc2:
    order: 1
    realm: oidc2
    description: "Log in with Auth0"</pre>
</div>
<div class="position-relative"><h5><a id="_openid_connect_and_basic_authentication"></a>OpenID Connect and basic authentication</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>You can also configure both OpenID Connect and basic authentication for the same Kibana instance. This might be the case for Kibana or Elasticsearch admins whose accounts aren&#8217;t linked to the SSO users database:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  oidc.oidc1:
    order: 0
    realm: oidc1
    description: "Log in with Elastic"
  basic.basic1:
    order: 1</pre>
</div>
<p>Basic authentication is supported <em>only</em> if the <code class="literal">basic</code> authentication provider is explicitly declared in <code class="literal">xpack.security.authc.providers</code> setting, in addition to <code class="literal">oidc</code>.</p>
<p>To support basic authentication for the applications like <code class="literal">curl</code> or when the <code class="literal">Authorization: Basic base64(username:password)</code> HTTP header is included in the request (for example, by reverse proxy), add <code class="literal">Basic</code> scheme to the list of supported schemes for the <a class="xref" href="kibana-authentication.html#http-authentication" title="HTTP authentication">HTTP authentication</a>.</p>
<div class="position-relative"><h4><a id="_single_sign_on_provider_details"></a>Single sign-on provider details</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>The following sections apply both to <a class="xref" href="kibana-authentication.html#saml" title="SAML single sign-on">SAML single sign-on</a> and <a class="xref" href="kibana-authentication.html#oidc" title="OpenID Connect single sign-on">OpenID Connect single sign-on</a></p>
<div class="position-relative"><h5><a id="_access_and_refresh_tokens"></a>Access and refresh tokens</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>Once the user logs in to Kibana with SSO, either using SAML or OpenID Connect, Elasticsearch issues access and refresh tokens
that Kibana encrypts and stores as a part of its own session. This way, the user isn&#8217;t redirected to the Identity Provider
for every request that requires authentication. It also means that the Kibana session depends on the <a class="xref" href="security-settings-kb.html#security-session-and-cookie-settings" title="Session and cookie security settings"><code class="literal">xpack.security.session.idleTimeout</code> and <code class="literal">xpack.security.session.lifespan</code></a> settings, and the user is automatically logged
out if the session expires. An access token that is stored in the session can expire, in which case Kibana will
automatically renew it with a one-time-use refresh token and store it in the same session.</p>
<p>Kibana can only determine if an access token has expired if it receives a request that requires authentication. If both access
and refresh tokens have already expired (for example, after 24 hours of inactivity), Kibana initiates a new "handshake" and
redirects the user to the external authentication provider (SAML Identity Provider or OpenID Connect Provider)
Depending on Elasticsearch and the external authentication provider configuration, the user might be asked to re-enter credentials.</p>
<p>If Kibana can&#8217;t redirect the user to the external authentication provider (for example, for AJAX/XHR requests), an error
indicates that both access and refresh tokens are expired. Reloading the current Kibana page fixes the error.</p>
<div class="position-relative"><h5><a id="_local_and_global_logout"></a>Local and global logout</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>During logout, both the Kibana session and Elasticsearch access/refresh token pair are invalidated. This is known as "local" logout.</p>
<p>Kibana can also initiate a "global" logout or <em>Single Logout</em> if it&#8217;s supported by the external authentication provider and not
explicitly disabled by Elasticsearch. In this case, the user is redirected to the external authentication provider for log out of
all applications associated with the active provider session.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="kerberos"></a>Kerberos single sign-on</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<p>Kerberos authentication is part of single sign-on (SSO), a <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">subscription feature</a>. Make sure that
Kerberos is enabled and configured in Elasticsearch before setting it up in Kibana. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/master/kerberos-realm.html" class="ulink" target="_top">Kerberos authentication</a>.</p>
<p>Next, to enable Kerberos in Kibana, you will need to enable the Kerberos authentication provider in the <code class="literal">kibana.yml</code> configuration file, as follows:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can configure only one Kerberos provider per Kibana instance.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  kerberos.kerberos1:
    order: 0</pre>
</div>
<p>You may want to be able to authenticate with the basic authentication provider as a secondary mechanism or while you are setting up Kerberos for the stack:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  kerberos.kerberos1:
    order: 0
    description: "Log in with Kerberos"
  basic.basic1:
    order: 1</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Kibana uses SPNEGO, which wraps the Kerberos protocol for use with HTTP, extending it to web applications.
At the end of the Kerberos handshake, Kibana forwards the service ticket to Elasticsearch, then Elasticsearch unpacks the service ticket and responds with an access and refresh token, which are used for subsequent authentication.
On every Elasticsearch node that Kibana connects to, the keytab file should always contain the HTTP service principal for the Kibana host.
The HTTP service principal name must have the <code class="literal">HTTP/kibana.domain.local@KIBANA.DOMAIN.LOCAL</code> format.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="anonymous-authentication"></a>Anonymous authentication</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Anyone with access to the network Kibana is exposed to will be able to access Kibana. Make sure that you&#8217;ve properly restricted the capabilities of the anonymous service account so that anonymous users can&#8217;t perform destructive actions or escalate their own privileges.</p>
</div>
</div>
<p>Anonymous authentication gives users access to Kibana without requiring them to provide credentials. This can be useful if you want your users to skip the login step when you embed dashboards in another application or set up a demo Kibana instance in your internal network, while still keeping other security features intact.</p>
<p>To enable anonymous authentication in Kibana, you must specify the credentials the anonymous service account Kibana should use internally to authenticate anonymous requests.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can configure only one anonymous authentication provider per Kibana instance.</p>
</div>
</div>
<p>You must have a user account that can authenticate to Elasticsearch using a username and password, for instance from the Native or LDAP security realms, so that you can use these credentials to impersonate the anonymous users. Here is how your <code class="literal">kibana.yml</code> might look:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  anonymous.anonymous1:
    order: 0
    credentials:
      username: "anonymous_service_account"
      password: "anonymous_service_account_password"</pre>
</div>
<div class="position-relative"><h5><a id="_anonymous_access_and_other_types_of_authentication"></a>Anonymous access and other types of authentication</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>You can configure more authentication providers in addition to anonymous access in Kibana. In this case, the Login Selector presents a configurable <span class="strong strong"><strong>Continue as Guest</strong></span> option for anonymous access:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.providers:
  basic.basic1:
    order: 0
  anonymous.anonymous1:
    order: 1
    credentials:
      username: "anonymous_service_account"
      password: "anonymous_service_account_password"</pre>
</div>
<div class="position-relative"><h5><a id="anonymous-access-and-embedding"></a>Anonymous access and embedding</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>One of the most popular use cases for anonymous access is when you embed Kibana into other applications and don&#8217;t want to force your users to log in to view it.
If you configured Kibana to use anonymous access as the sole authentication mechanism, you don&#8217;t need to do anything special while embedding Kibana.</p>
<p>For information on how to embed, refer to <a class="xref" href="embedding.html" title="Embed Kibana content in a web page">Embed Kibana content in a web page</a>.</p>
<div class="position-relative"><h5><a id="anonymous-access-session"></a>Anonymous access session</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>Kibana maintains a separate <a class="xref" href="xpack-security-session-management.html" title="Session management">session</a> for every anonymous user, as it does for all other authentication mechanisms.</p>
<p>You can configure <a class="xref" href="xpack-security-session-management.html#session-idle-timeout" title="Session idle timeout">session idle timeout</a> and <a class="xref" href="xpack-security-session-management.html#session-lifespan" title="Session lifespan">session lifespan</a> for anonymous sessions the same as you do for any other session with the exception that idle timeout is explicitly disabled for anonymous sessions by default. The global <a class="xref" href="security-settings-kb.html#security-session-and-cookie-settings" title="Session and cookie security settings"><code class="literal">xpack.security.session.idleTimeout</code></a> setting doesn&#8217;t affect anonymous sessions. To change the idle timeout for anonymous sessions, you must configure the provider-level <a class="xref" href="security-settings-kb.html#anonymous-authentication-provider-settings" title="Anonymous authentication provider settings"><code class="literal">xpack.security.authc.providers.anonymous.&lt;provider-name&gt;.session.idleTimeout</code></a> setting.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="http-authentication"></a>HTTP authentication</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Be very careful when you modify HTTP authentication settings as it may indirectly affect other important Kibana features that implicitly rely on HTTP authentication (e.g. Reporting).</p>
</div>
</div>
<p>HTTP protocol provides a simple authentication framework that can be used by a client to provide authentication information. It uses a case-insensitive token as a means to identify the authentication scheme, followed by additional information necessary for achieving authentication via that scheme.</p>
<p>This type of authentication is usually useful for machine-to-machine interaction that requires authentication and where human intervention is not desired or just infeasible. There are a number of use cases when HTTP authentication support comes in handy for Kibana users as well.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>API keys are intended for programmatic access to Kibana and Elasticsearch. Do not use API keys to authenticate access via a web browser.</p>
</div>
</div>
<p>By default Kibana supports <a class="xref" href="api-keys.html" title="API Keys"><code class="literal">ApiKey</code></a> authentication scheme <em>and</em> any scheme supported by the currently enabled authentication provider. For example, <code class="literal">Basic</code> authentication scheme is automatically supported when basic authentication provider is enabled, or <code class="literal">Bearer</code> scheme when any of the token based authentication providers is enabled (Token, SAML, OpenID Connect, PKI or Kerberos). But it&#8217;s also possible to add support for any other authentication scheme in the <code class="literal">kibana.yml</code> configuration file, as follows:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Don&#8217;t forget to explicitly specify the default <code class="literal">apikey</code> and <code class="literal">bearer</code> schemes when you just want to add a new one to the list.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.authc.http.schemes: [apikey, bearer, basic, something-custom]</pre>
</div>
<p>With this configuration, you can send requests to Kibana with the <code class="literal">Authorization</code> header using <code class="literal">ApiKey</code>, <code class="literal">Bearer</code>, <code class="literal">Basic</code> or <code class="literal">Something-Custom</code> HTTP schemes (case insensitive). Under the hood, Kibana relays this header to Elasticsearch, then Elasticsearch authenticates the request using the credentials in the header.</p>
<div class="position-relative"><h4><a id="embedded-content-authentication"></a>Embedded content authentication</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/security/authentication/index.asciidoc">edit</a></div>
<p>Once you create a dashboard or a visualization, you might want to share it with your colleagues or friends. The easiest way to do this is to share a direct link to your dashboard or visualization. However, some users might not have access to your Kibana. With the Kibana embedding functionality, you can display the content you created in Kibana to an internal company website or a personal web page.</p>
<p><a id="embedding-cookies"></a>To minimize security risk, embedding with iframes requires careful consideration. By default, modern web browsers enforce the
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" class="ulink" target="_top">same-origin policy</a> to restrict the behavior of framed pages. When
Elastic Stack security features are enabled on your cluster, make sure the browsers can transmit session cookies to a Kibana server. The setting you need to be aware of is <a class="xref" href="security-settings-kb.html#xpack-security-sameSiteCookies"><code class="literal">xpack.security.sameSiteCookies</code></a>. To support modern browsers, you must set it to <code class="literal">None</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.sameSiteCookies: "None"</pre>
</div>
<p>For more information about possible values and implications, refer to <a class="xref" href="security-settings-kb.html#xpack-security-sameSiteCookies">xpack.security.sameSiteCookies</a>.
For more information about iframe and cookies, refer to <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe" class="ulink" target="_top">iframe</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" class="ulink" target="_top">SameSite cookies</a>.</p>
<p>If you&#8217;re embedding Kibana in a website that supports single sign-on (SSO) with SAML, OpenID Connect, Kerberos, or PKI, it&#8217;s highly advisable to configure Kibana as a part of the SSO setup. Operating in a single and properly configured security domain provides you with the most secure and seamless user experience.</p>
<p>If you have multiple authentication providers enabled, and you want to automatically log in anonymous users when embedding anything other than dashboards and visualizations, then you will need to add the <code class="literal">auth_provider_hint=&lt;anonymous-provider-name&gt;</code> query string parameter to the Kibana URL that you&#8217;re embedding.</p>
<p>For example, if you craft the iframe code to embed Kibana, it might look like this:</p>
<div class="pre_wrapper lang-html">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-html">&lt;iframe src="https://localhost:5601/app/monitoring#/elasticsearch/nodes?embed=true&amp;_g=(....)" height="600" width="800"&gt;&lt;/iframe&gt;</pre>
</div>
<p>To make this iframe leverage anonymous access automatically, you will need to modify a link to Kibana in the <code class="literal">src</code> iframe attribute to look like this:</p>
<div class="pre_wrapper lang-html">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-html">&lt;iframe src="https://localhost:5601/app/monitoring?auth_provider_hint=anonymous1#/elasticsearch/nodes?embed=true&amp;_g=(....)" height="600" width="800"&gt;&lt;/iframe&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">auth_provider_hint</code> query string parameter goes <span class="strong strong"><strong>before</strong></span> the hash URL fragment.</p>
</div>
</div>
<p>For more information, refer to <a class="xref" href="reporting-getting-started.html#embed-code" title="Embed code">Embed code</a>.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="using-kibana-with-security.html">« Configure security in Kibana</a>
</span>
<span class="next">
<a href="elasticsearch-mutual-tls.html">Mutual TLS authentication between Kibana and Elasticsearch »</a>
</span>
</div>
</body>
</html>
