[[timelion-create]]
=== Create time series visualizations

To compare independent data sources within a single visualization, create a time series visualization.

[[timelion-create-before-you-begin]]
==== Before you begin

In this tutorial, you'll use the time series data from https://www.elastic.co/guide/en/beats/metricbeat/current/index.html[Metricbeat].

To ingest the data locally, link:https://www.elastic.co/downloads/beats/metricbeat[download Metricbeat].

[[timelion-create-comparison-visualization]]
==== Create the visualization

Compare the real-time percentage of CPU time spent in user space to the results offset by one hour.

. To define an `index`, `timefield`, and `metric`, enter the following in the *Timelion Expression* field:

[source,text]
----------------------------------
.es(index=metricbeat-*, timefield='@timestamp', metric='avg:system.cpu.user.pct')
----------------------------------

image::images/timelion-create01.png[]
{nbsp}

. For comparison, add another series with data from the previous hour, separated by a comma:  

[source,text]
----------------------------------
.es(index=metricbeat-*, timefield='@timestamp', metric='avg:system.cpu.user.pct'), .es(offset=-1h,index=metricbeat-*, timefield='@timestamp', metric='avg:system.cpu.user.pct')
----------------------------------

image::images/timelion-create02.png[]
{nbsp}

. To easily distinguish between the two series, customize the labels:

[source,text]
----------------------------------
.es(offset=-1h,index=metricbeat-*, timefield='@timestamp', metric='avg:system.cpu.user.pct').label('last hour'), .es(index=metricbeat-*, timefield='@timestamp', metric='avg:system.cpu.user.pct').label('current hour')
----------------------------------

image::images/timelion-create03.png[]
{nbsp}
