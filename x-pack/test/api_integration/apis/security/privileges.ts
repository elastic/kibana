/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */

import { KibanaFunctionalTestDefaultProviders } from '../../../types/providers';

// eslint-disable-next-line import/no-default-export
export default function({ getService }: KibanaFunctionalTestDefaultProviders) {
  const supertest = getService('supertest');

  let version: string;

  describe('Privileges', () => {
    before(async () => {
      const versionService = getService('kibanaServer').version;
      version = await versionService.get();
    });

    // This test also functions as a sanity check for assigned privilege actions, to ensure that feature privileges are being granted in the way that developers expect.
    // It could also be considered a huge maintenance burden, which will be largely alleviated once we can use jest's snapshotting abiliites
    // For any poor soul which would prefer to just regenerate the following expected payload and look at the diff to ensure the proper changes
    // were made, you can use the following bash command:
    //
    // curl -s -u elastic:changeme http://localhost:5620/api/security/privileges?includeActions=true 2>&1 | perl -pe 's/"(\w+:)(\d\.\d\.\d)([^"]*)"/`$1\${version}$3`/g'
    //
    describe('GET /api/security/privileges?includeActions=true', () => {
      it('should return a privilege map with all known privileges with actions', async () => {
        await supertest
          .get('/api/security/privileges?includeActions=true')
          .set('kbn-xsrf', 'xxx')
          .send()
          .expect(200, {
            features: {
              discover: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/discover`,
                  `ui:${version}:navLinks/kibana:discover`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `saved_object:${version}:search/create`,
                  `saved_object:${version}:search/bulk_create`,
                  `saved_object:${version}:search/update`,
                  `saved_object:${version}:search/delete`,
                  `saved_object:${version}:url/bulk_get`,
                  `saved_object:${version}:url/get`,
                  `saved_object:${version}:url/find`,
                  `saved_object:${version}:url/create`,
                  `saved_object:${version}:url/bulk_create`,
                  `saved_object:${version}:url/update`,
                  `saved_object:${version}:url/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/search/delete`,
                  `ui:${version}:savedObjectsManagement/search/edit`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:savedObjectsManagement/url/delete`,
                  `ui:${version}:savedObjectsManagement/url/edit`,
                  `ui:${version}:savedObjectsManagement/url/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:discover/show`,
                  `ui:${version}:discover/createShortUrl`,
                  `ui:${version}:discover/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/discover`,
                  `ui:${version}:navLinks/kibana:discover`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `saved_object:${version}:url/bulk_get`,
                  `saved_object:${version}:url/get`,
                  `saved_object:${version}:url/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:savedObjectsManagement/url/read`,
                  `ui:${version}:discover/show`,
                ],
              },
              visualize: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/visualize`,
                  `ui:${version}:navLinks/kibana:visualize`,
                  `saved_object:${version}:visualization/bulk_get`,
                  `saved_object:${version}:visualization/get`,
                  `saved_object:${version}:visualization/find`,
                  `saved_object:${version}:visualization/create`,
                  `saved_object:${version}:visualization/bulk_create`,
                  `saved_object:${version}:visualization/update`,
                  `saved_object:${version}:visualization/delete`,
                  `saved_object:${version}:url/bulk_get`,
                  `saved_object:${version}:url/get`,
                  `saved_object:${version}:url/find`,
                  `saved_object:${version}:url/create`,
                  `saved_object:${version}:url/bulk_create`,
                  `saved_object:${version}:url/update`,
                  `saved_object:${version}:url/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `ui:${version}:savedObjectsManagement/visualization/delete`,
                  `ui:${version}:savedObjectsManagement/visualization/edit`,
                  `ui:${version}:savedObjectsManagement/visualization/read`,
                  `ui:${version}:savedObjectsManagement/url/delete`,
                  `ui:${version}:savedObjectsManagement/url/edit`,
                  `ui:${version}:savedObjectsManagement/url/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:visualize/show`,
                  `ui:${version}:visualize/createShortUrl`,
                  `ui:${version}:visualize/delete`,
                  `ui:${version}:visualize/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/visualize`,
                  `ui:${version}:navLinks/kibana:visualize`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `saved_object:${version}:visualization/bulk_get`,
                  `saved_object:${version}:visualization/get`,
                  `saved_object:${version}:visualization/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:savedObjectsManagement/visualization/read`,
                  `ui:${version}:visualize/show`,
                ],
              },
              dashboard: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/dashboard`,
                  `ui:${version}:navLinks/kibana:dashboard`,
                  `saved_object:${version}:dashboard/bulk_get`,
                  `saved_object:${version}:dashboard/get`,
                  `saved_object:${version}:dashboard/find`,
                  `saved_object:${version}:dashboard/create`,
                  `saved_object:${version}:dashboard/bulk_create`,
                  `saved_object:${version}:dashboard/update`,
                  `saved_object:${version}:dashboard/delete`,
                  `saved_object:${version}:url/bulk_get`,
                  `saved_object:${version}:url/get`,
                  `saved_object:${version}:url/find`,
                  `saved_object:${version}:url/create`,
                  `saved_object:${version}:url/bulk_create`,
                  `saved_object:${version}:url/update`,
                  `saved_object:${version}:url/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `saved_object:${version}:visualization/bulk_get`,
                  `saved_object:${version}:visualization/get`,
                  `saved_object:${version}:visualization/find`,
                  `saved_object:${version}:timelion-sheet/bulk_get`,
                  `saved_object:${version}:timelion-sheet/get`,
                  `saved_object:${version}:timelion-sheet/find`,
                  `saved_object:${version}:canvas-workpad/bulk_get`,
                  `saved_object:${version}:canvas-workpad/get`,
                  `saved_object:${version}:canvas-workpad/find`,
                  `saved_object:${version}:map/bulk_get`,
                  `saved_object:${version}:map/get`,
                  `saved_object:${version}:map/find`,
                  `ui:${version}:savedObjectsManagement/dashboard/delete`,
                  `ui:${version}:savedObjectsManagement/dashboard/edit`,
                  `ui:${version}:savedObjectsManagement/dashboard/read`,
                  `ui:${version}:savedObjectsManagement/url/delete`,
                  `ui:${version}:savedObjectsManagement/url/edit`,
                  `ui:${version}:savedObjectsManagement/url/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:savedObjectsManagement/visualization/read`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                  `ui:${version}:savedObjectsManagement/map/read`,
                  `ui:${version}:dashboard/createNew`,
                  `ui:${version}:dashboard/show`,
                  `ui:${version}:dashboard/showWriteControls`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/dashboard`,
                  `ui:${version}:navLinks/kibana:dashboard`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:search/bulk_get`,
                  `saved_object:${version}:search/get`,
                  `saved_object:${version}:search/find`,
                  `saved_object:${version}:visualization/bulk_get`,
                  `saved_object:${version}:visualization/get`,
                  `saved_object:${version}:visualization/find`,
                  `saved_object:${version}:timelion-sheet/bulk_get`,
                  `saved_object:${version}:timelion-sheet/get`,
                  `saved_object:${version}:timelion-sheet/find`,
                  `saved_object:${version}:canvas-workpad/bulk_get`,
                  `saved_object:${version}:canvas-workpad/get`,
                  `saved_object:${version}:canvas-workpad/find`,
                  `saved_object:${version}:map/bulk_get`,
                  `saved_object:${version}:map/get`,
                  `saved_object:${version}:map/find`,
                  `saved_object:${version}:dashboard/bulk_get`,
                  `saved_object:${version}:dashboard/get`,
                  `saved_object:${version}:dashboard/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/search/read`,
                  `ui:${version}:savedObjectsManagement/visualization/read`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                  `ui:${version}:savedObjectsManagement/map/read`,
                  `ui:${version}:savedObjectsManagement/dashboard/read`,
                  `ui:${version}:dashboard/show`,
                ],
              },
              dev_tools: {
                all: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:console`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/console`,
                  `ui:${version}:catalogue/searchprofiler`,
                  `ui:${version}:catalogue/grokdebugger`,
                  `ui:${version}:navLinks/kibana:dev_tools`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:dev_tools/show`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:console`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/console`,
                  `ui:${version}:catalogue/searchprofiler`,
                  `ui:${version}:catalogue/grokdebugger`,
                  `ui:${version}:navLinks/kibana:dev_tools`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:dev_tools/show`,
                ],
              },
              advancedSettings: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/advanced_settings`,
                  `ui:${version}:management/kibana/settings`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:config/create`,
                  `saved_object:${version}:config/bulk_create`,
                  `saved_object:${version}:config/update`,
                  `saved_object:${version}:config/delete`,
                  `ui:${version}:savedObjectsManagement/config/delete`,
                  `ui:${version}:savedObjectsManagement/config/edit`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:advancedSettings/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/advanced_settings`,
                  `ui:${version}:management/kibana/settings`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                ],
              },
              indexPatterns: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/index_patterns`,
                  `ui:${version}:management/kibana/index_patterns`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:index-pattern/create`,
                  `saved_object:${version}:index-pattern/bulk_create`,
                  `saved_object:${version}:index-pattern/update`,
                  `saved_object:${version}:index-pattern/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/index-pattern/delete`,
                  `ui:${version}:savedObjectsManagement/index-pattern/edit`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:indexPatterns/createNew`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/index_patterns`,
                  `ui:${version}:management/kibana/index_patterns`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                ],
              },
              timelion: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:timelion`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/timelion`,
                  `ui:${version}:navLinks/timelion`,
                  `saved_object:${version}:timelion-sheet/bulk_get`,
                  `saved_object:${version}:timelion-sheet/get`,
                  `saved_object:${version}:timelion-sheet/find`,
                  `saved_object:${version}:timelion-sheet/create`,
                  `saved_object:${version}:timelion-sheet/bulk_create`,
                  `saved_object:${version}:timelion-sheet/update`,
                  `saved_object:${version}:timelion-sheet/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/delete`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/edit`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:timelion/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:timelion`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/timelion`,
                  `ui:${version}:navLinks/timelion`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:timelion-sheet/bulk_get`,
                  `saved_object:${version}:timelion-sheet/get`,
                  `saved_object:${version}:timelion-sheet/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                ],
              },
              graph: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:graph`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/graph`,
                  `ui:${version}:navLinks/graph`,
                  `saved_object:${version}:graph-workspace/bulk_get`,
                  `saved_object:${version}:graph-workspace/get`,
                  `saved_object:${version}:graph-workspace/find`,
                  `saved_object:${version}:graph-workspace/create`,
                  `saved_object:${version}:graph-workspace/bulk_create`,
                  `saved_object:${version}:graph-workspace/update`,
                  `saved_object:${version}:graph-workspace/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/graph-workspace/delete`,
                  `ui:${version}:savedObjectsManagement/graph-workspace/edit`,
                  `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:graph/save`,
                  `ui:${version}:graph/delete`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:graph`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/graph`,
                  `ui:${version}:navLinks/graph`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:graph-workspace/bulk_get`,
                  `saved_object:${version}:graph-workspace/get`,
                  `saved_object:${version}:graph-workspace/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                ],
              },
              apm: {
                all: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:apm`,
                  `app:${version}:apm`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/apm`,
                  `ui:${version}:navLinks/apm`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:apm/show`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:apm`,
                  `app:${version}:apm`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/apm`,
                  `ui:${version}:navLinks/apm`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:apm/show`,
                ],
              },
              maps: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:maps`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/maps`,
                  `ui:${version}:navLinks/maps`,
                  `saved_object:${version}:map/bulk_get`,
                  `saved_object:${version}:map/get`,
                  `saved_object:${version}:map/find`,
                  `saved_object:${version}:map/create`,
                  `saved_object:${version}:map/bulk_create`,
                  `saved_object:${version}:map/update`,
                  `saved_object:${version}:map/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/map/delete`,
                  `ui:${version}:savedObjectsManagement/map/edit`,
                  `ui:${version}:savedObjectsManagement/map/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:maps/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:maps`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/maps`,
                  `ui:${version}:navLinks/maps`,
                  `saved_object:${version}:map/bulk_get`,
                  `saved_object:${version}:map/get`,
                  `saved_object:${version}:map/find`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/map/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                ],
              },
              canvas: {
                all: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:canvas`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/canvas`,
                  `ui:${version}:navLinks/canvas`,
                  `saved_object:${version}:canvas-workpad/bulk_get`,
                  `saved_object:${version}:canvas-workpad/get`,
                  `saved_object:${version}:canvas-workpad/find`,
                  `saved_object:${version}:canvas-workpad/create`,
                  `saved_object:${version}:canvas-workpad/bulk_create`,
                  `saved_object:${version}:canvas-workpad/update`,
                  `saved_object:${version}:canvas-workpad/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/delete`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/edit`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:canvas/save`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `app:${version}:canvas`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/canvas`,
                  `ui:${version}:navLinks/canvas`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:index-pattern/bulk_get`,
                  `saved_object:${version}:index-pattern/get`,
                  `saved_object:${version}:index-pattern/find`,
                  `saved_object:${version}:canvas-workpad/bulk_get`,
                  `saved_object:${version}:canvas-workpad/get`,
                  `saved_object:${version}:canvas-workpad/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/index-pattern/read`,
                  `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                ],
              },
              infrastructure: {
                all: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:infra`,
                  `app:${version}:infra`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/infraops`,
                  `ui:${version}:navLinks/infra:home`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                  `saved_object:${version}:infrastructure-ui-source/get`,
                  `saved_object:${version}:infrastructure-ui-source/find`,
                  `saved_object:${version}:infrastructure-ui-source/create`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_create`,
                  `saved_object:${version}:infrastructure-ui-source/update`,
                  `saved_object:${version}:infrastructure-ui-source/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/delete`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/edit`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:infrastructure/show`,
                  `ui:${version}:infrastructure/configureSource`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:infra`,
                  `app:${version}:infra`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/infraops`,
                  `ui:${version}:navLinks/infra:home`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                  `saved_object:${version}:infrastructure-ui-source/get`,
                  `saved_object:${version}:infrastructure-ui-source/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                  `ui:${version}:infrastructure/show`,
                ],
              },
              logs: {
                all: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:infra`,
                  `app:${version}:infra`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/infralogging`,
                  `ui:${version}:navLinks/infra:logs`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                  `saved_object:${version}:infrastructure-ui-source/get`,
                  `saved_object:${version}:infrastructure-ui-source/find`,
                  `saved_object:${version}:infrastructure-ui-source/create`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_create`,
                  `saved_object:${version}:infrastructure-ui-source/update`,
                  `saved_object:${version}:infrastructure-ui-source/delete`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/delete`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/edit`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:logs/show`,
                  `ui:${version}:logs/configureSource`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:infra`,
                  `app:${version}:infra`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/infralogging`,
                  `ui:${version}:navLinks/infra:logs`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                  `saved_object:${version}:infrastructure-ui-source/get`,
                  `saved_object:${version}:infrastructure-ui-source/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                  `ui:${version}:logs/show`,
                ],
              },
              uptime: {
                all: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:uptime`,
                  `app:${version}:uptime`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/uptime`,
                  `ui:${version}:navLinks/uptime`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                  'allHack:',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  `api:${version}:uptime`,
                  `app:${version}:uptime`,
                  `app:${version}:kibana`,
                  `ui:${version}:catalogue/uptime`,
                  `ui:${version}:navLinks/uptime`,
                  `saved_object:${version}:config/bulk_get`,
                  `saved_object:${version}:config/get`,
                  `saved_object:${version}:config/find`,
                  `ui:${version}:savedObjectsManagement/config/read`,
                ],
              },
            },
            global: {
              all: [
                'login:',
                `version:${version}`,
                `space:${version}:manage`,
                `ui:${version}:spaces/manage`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/discover`,
                `ui:${version}:navLinks/kibana:discover`,
                `saved_object:${version}:search/bulk_get`,
                `saved_object:${version}:search/get`,
                `saved_object:${version}:search/find`,
                `saved_object:${version}:search/create`,
                `saved_object:${version}:search/bulk_create`,
                `saved_object:${version}:search/update`,
                `saved_object:${version}:search/delete`,
                `saved_object:${version}:url/bulk_get`,
                `saved_object:${version}:url/get`,
                `saved_object:${version}:url/find`,
                `saved_object:${version}:url/create`,
                `saved_object:${version}:url/bulk_create`,
                `saved_object:${version}:url/update`,
                `saved_object:${version}:url/delete`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `saved_object:${version}:index-pattern/bulk_get`,
                `saved_object:${version}:index-pattern/get`,
                `saved_object:${version}:index-pattern/find`,
                `ui:${version}:savedObjectsManagement/search/delete`,
                `ui:${version}:savedObjectsManagement/search/edit`,
                `ui:${version}:savedObjectsManagement/search/read`,
                `ui:${version}:savedObjectsManagement/url/delete`,
                `ui:${version}:savedObjectsManagement/url/edit`,
                `ui:${version}:savedObjectsManagement/url/read`,
                `ui:${version}:savedObjectsManagement/config/read`,
                `ui:${version}:savedObjectsManagement/index-pattern/read`,
                `ui:${version}:discover/show`,
                `ui:${version}:discover/createShortUrl`,
                `ui:${version}:discover/save`,
                `ui:${version}:catalogue/visualize`,
                `ui:${version}:navLinks/kibana:visualize`,
                `saved_object:${version}:visualization/bulk_get`,
                `saved_object:${version}:visualization/get`,
                `saved_object:${version}:visualization/find`,
                `saved_object:${version}:visualization/create`,
                `saved_object:${version}:visualization/bulk_create`,
                `saved_object:${version}:visualization/update`,
                `saved_object:${version}:visualization/delete`,
                `ui:${version}:savedObjectsManagement/visualization/delete`,
                `ui:${version}:savedObjectsManagement/visualization/edit`,
                `ui:${version}:savedObjectsManagement/visualization/read`,
                `ui:${version}:visualize/show`,
                `ui:${version}:visualize/createShortUrl`,
                `ui:${version}:visualize/delete`,
                `ui:${version}:visualize/save`,
                `ui:${version}:catalogue/dashboard`,
                `ui:${version}:navLinks/kibana:dashboard`,
                `saved_object:${version}:dashboard/bulk_get`,
                `saved_object:${version}:dashboard/get`,
                `saved_object:${version}:dashboard/find`,
                `saved_object:${version}:dashboard/create`,
                `saved_object:${version}:dashboard/bulk_create`,
                `saved_object:${version}:dashboard/update`,
                `saved_object:${version}:dashboard/delete`,
                `saved_object:${version}:timelion-sheet/bulk_get`,
                `saved_object:${version}:timelion-sheet/get`,
                `saved_object:${version}:timelion-sheet/find`,
                `saved_object:${version}:canvas-workpad/bulk_get`,
                `saved_object:${version}:canvas-workpad/get`,
                `saved_object:${version}:canvas-workpad/find`,
                `saved_object:${version}:map/bulk_get`,
                `saved_object:${version}:map/get`,
                `saved_object:${version}:map/find`,
                `ui:${version}:savedObjectsManagement/dashboard/delete`,
                `ui:${version}:savedObjectsManagement/dashboard/edit`,
                `ui:${version}:savedObjectsManagement/dashboard/read`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                `ui:${version}:savedObjectsManagement/map/read`,
                `ui:${version}:dashboard/createNew`,
                `ui:${version}:dashboard/show`,
                `ui:${version}:dashboard/showWriteControls`,
                `api:${version}:console`,
                `ui:${version}:catalogue/console`,
                `ui:${version}:catalogue/searchprofiler`,
                `ui:${version}:catalogue/grokdebugger`,
                `ui:${version}:navLinks/kibana:dev_tools`,
                `ui:${version}:dev_tools/show`,
                `ui:${version}:catalogue/advanced_settings`,
                `ui:${version}:management/kibana/settings`,
                `saved_object:${version}:config/create`,
                `saved_object:${version}:config/bulk_create`,
                `saved_object:${version}:config/update`,
                `saved_object:${version}:config/delete`,
                `ui:${version}:savedObjectsManagement/config/delete`,
                `ui:${version}:savedObjectsManagement/config/edit`,
                `ui:${version}:advancedSettings/save`,
                `ui:${version}:catalogue/index_patterns`,
                `ui:${version}:management/kibana/index_patterns`,
                `saved_object:${version}:index-pattern/create`,
                `saved_object:${version}:index-pattern/bulk_create`,
                `saved_object:${version}:index-pattern/update`,
                `saved_object:${version}:index-pattern/delete`,
                `ui:${version}:savedObjectsManagement/index-pattern/delete`,
                `ui:${version}:savedObjectsManagement/index-pattern/edit`,
                `ui:${version}:indexPatterns/createNew`,
                `app:${version}:timelion`,
                `ui:${version}:catalogue/timelion`,
                `ui:${version}:navLinks/timelion`,
                `saved_object:${version}:timelion-sheet/create`,
                `saved_object:${version}:timelion-sheet/bulk_create`,
                `saved_object:${version}:timelion-sheet/update`,
                `saved_object:${version}:timelion-sheet/delete`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/delete`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/edit`,
                `ui:${version}:timelion/save`,
                `app:${version}:graph`,
                `ui:${version}:catalogue/graph`,
                `ui:${version}:navLinks/graph`,
                `saved_object:${version}:graph-workspace/bulk_get`,
                `saved_object:${version}:graph-workspace/get`,
                `saved_object:${version}:graph-workspace/find`,
                `saved_object:${version}:graph-workspace/create`,
                `saved_object:${version}:graph-workspace/bulk_create`,
                `saved_object:${version}:graph-workspace/update`,
                `saved_object:${version}:graph-workspace/delete`,
                `ui:${version}:savedObjectsManagement/graph-workspace/delete`,
                `ui:${version}:savedObjectsManagement/graph-workspace/edit`,
                `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                `ui:${version}:graph/save`,
                `ui:${version}:graph/delete`,
                `api:${version}:apm`,
                `app:${version}:apm`,
                `ui:${version}:catalogue/apm`,
                `ui:${version}:navLinks/apm`,
                `ui:${version}:apm/show`,
                `app:${version}:maps`,
                `ui:${version}:catalogue/maps`,
                `ui:${version}:navLinks/maps`,
                `saved_object:${version}:map/create`,
                `saved_object:${version}:map/bulk_create`,
                `saved_object:${version}:map/update`,
                `saved_object:${version}:map/delete`,
                `ui:${version}:savedObjectsManagement/map/delete`,
                `ui:${version}:savedObjectsManagement/map/edit`,
                `ui:${version}:maps/save`,
                `app:${version}:canvas`,
                `ui:${version}:catalogue/canvas`,
                `ui:${version}:navLinks/canvas`,
                `saved_object:${version}:canvas-workpad/create`,
                `saved_object:${version}:canvas-workpad/bulk_create`,
                `saved_object:${version}:canvas-workpad/update`,
                `saved_object:${version}:canvas-workpad/delete`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/delete`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/edit`,
                `ui:${version}:canvas/save`,
                `api:${version}:infra`,
                `app:${version}:infra`,
                `ui:${version}:catalogue/infraops`,
                `ui:${version}:navLinks/infra:home`,
                `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                `saved_object:${version}:infrastructure-ui-source/get`,
                `saved_object:${version}:infrastructure-ui-source/find`,
                `saved_object:${version}:infrastructure-ui-source/create`,
                `saved_object:${version}:infrastructure-ui-source/bulk_create`,
                `saved_object:${version}:infrastructure-ui-source/update`,
                `saved_object:${version}:infrastructure-ui-source/delete`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/delete`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/edit`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                `ui:${version}:infrastructure/show`,
                `ui:${version}:infrastructure/configureSource`,
                `ui:${version}:catalogue/infralogging`,
                `ui:${version}:navLinks/infra:logs`,
                `ui:${version}:logs/show`,
                `ui:${version}:logs/configureSource`,
                `api:${version}:uptime`,
                `app:${version}:uptime`,
                `ui:${version}:catalogue/uptime`,
                `ui:${version}:navLinks/uptime`,
                'allHack:',
              ],
              read: [
                'login:',
                `version:${version}`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/discover`,
                `ui:${version}:navLinks/kibana:discover`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `saved_object:${version}:index-pattern/bulk_get`,
                `saved_object:${version}:index-pattern/get`,
                `saved_object:${version}:index-pattern/find`,
                `saved_object:${version}:search/bulk_get`,
                `saved_object:${version}:search/get`,
                `saved_object:${version}:search/find`,
                `saved_object:${version}:url/bulk_get`,
                `saved_object:${version}:url/get`,
                `saved_object:${version}:url/find`,
                `ui:${version}:savedObjectsManagement/config/read`,
                `ui:${version}:savedObjectsManagement/index-pattern/read`,
                `ui:${version}:savedObjectsManagement/search/read`,
                `ui:${version}:savedObjectsManagement/url/read`,
                `ui:${version}:discover/show`,
                `ui:${version}:catalogue/visualize`,
                `ui:${version}:navLinks/kibana:visualize`,
                `saved_object:${version}:visualization/bulk_get`,
                `saved_object:${version}:visualization/get`,
                `saved_object:${version}:visualization/find`,
                `ui:${version}:savedObjectsManagement/visualization/read`,
                `ui:${version}:visualize/show`,
                `ui:${version}:catalogue/dashboard`,
                `ui:${version}:navLinks/kibana:dashboard`,
                `saved_object:${version}:timelion-sheet/bulk_get`,
                `saved_object:${version}:timelion-sheet/get`,
                `saved_object:${version}:timelion-sheet/find`,
                `saved_object:${version}:canvas-workpad/bulk_get`,
                `saved_object:${version}:canvas-workpad/get`,
                `saved_object:${version}:canvas-workpad/find`,
                `saved_object:${version}:map/bulk_get`,
                `saved_object:${version}:map/get`,
                `saved_object:${version}:map/find`,
                `saved_object:${version}:dashboard/bulk_get`,
                `saved_object:${version}:dashboard/get`,
                `saved_object:${version}:dashboard/find`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                `ui:${version}:savedObjectsManagement/map/read`,
                `ui:${version}:savedObjectsManagement/dashboard/read`,
                `ui:${version}:dashboard/show`,
                `api:${version}:console`,
                `ui:${version}:catalogue/console`,
                `ui:${version}:catalogue/searchprofiler`,
                `ui:${version}:catalogue/grokdebugger`,
                `ui:${version}:navLinks/kibana:dev_tools`,
                `ui:${version}:dev_tools/show`,
                `ui:${version}:catalogue/advanced_settings`,
                `ui:${version}:management/kibana/settings`,
                `ui:${version}:catalogue/index_patterns`,
                `ui:${version}:management/kibana/index_patterns`,
                `app:${version}:timelion`,
                `ui:${version}:catalogue/timelion`,
                `ui:${version}:navLinks/timelion`,
                `app:${version}:graph`,
                `ui:${version}:catalogue/graph`,
                `ui:${version}:navLinks/graph`,
                `saved_object:${version}:graph-workspace/bulk_get`,
                `saved_object:${version}:graph-workspace/get`,
                `saved_object:${version}:graph-workspace/find`,
                `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                `api:${version}:apm`,
                `app:${version}:apm`,
                `ui:${version}:catalogue/apm`,
                `ui:${version}:navLinks/apm`,
                `ui:${version}:apm/show`,
                `app:${version}:maps`,
                `ui:${version}:catalogue/maps`,
                `ui:${version}:navLinks/maps`,
                `app:${version}:canvas`,
                `ui:${version}:catalogue/canvas`,
                `ui:${version}:navLinks/canvas`,
                `api:${version}:infra`,
                `app:${version}:infra`,
                `ui:${version}:catalogue/infraops`,
                `ui:${version}:navLinks/infra:home`,
                `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                `saved_object:${version}:infrastructure-ui-source/get`,
                `saved_object:${version}:infrastructure-ui-source/find`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                `ui:${version}:infrastructure/show`,
                `ui:${version}:catalogue/infralogging`,
                `ui:${version}:navLinks/infra:logs`,
                `ui:${version}:logs/show`,
                `api:${version}:uptime`,
                `app:${version}:uptime`,
                `ui:${version}:catalogue/uptime`,
                `ui:${version}:navLinks/uptime`,
              ],
            },
            space: {
              all: [
                'login:',
                `version:${version}`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/discover`,
                `ui:${version}:navLinks/kibana:discover`,
                `saved_object:${version}:search/bulk_get`,
                `saved_object:${version}:search/get`,
                `saved_object:${version}:search/find`,
                `saved_object:${version}:search/create`,
                `saved_object:${version}:search/bulk_create`,
                `saved_object:${version}:search/update`,
                `saved_object:${version}:search/delete`,
                `saved_object:${version}:url/bulk_get`,
                `saved_object:${version}:url/get`,
                `saved_object:${version}:url/find`,
                `saved_object:${version}:url/create`,
                `saved_object:${version}:url/bulk_create`,
                `saved_object:${version}:url/update`,
                `saved_object:${version}:url/delete`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `saved_object:${version}:index-pattern/bulk_get`,
                `saved_object:${version}:index-pattern/get`,
                `saved_object:${version}:index-pattern/find`,
                `ui:${version}:savedObjectsManagement/search/delete`,
                `ui:${version}:savedObjectsManagement/search/edit`,
                `ui:${version}:savedObjectsManagement/search/read`,
                `ui:${version}:savedObjectsManagement/url/delete`,
                `ui:${version}:savedObjectsManagement/url/edit`,
                `ui:${version}:savedObjectsManagement/url/read`,
                `ui:${version}:savedObjectsManagement/config/read`,
                `ui:${version}:savedObjectsManagement/index-pattern/read`,
                `ui:${version}:discover/show`,
                `ui:${version}:discover/createShortUrl`,
                `ui:${version}:discover/save`,
                `ui:${version}:catalogue/visualize`,
                `ui:${version}:navLinks/kibana:visualize`,
                `saved_object:${version}:visualization/bulk_get`,
                `saved_object:${version}:visualization/get`,
                `saved_object:${version}:visualization/find`,
                `saved_object:${version}:visualization/create`,
                `saved_object:${version}:visualization/bulk_create`,
                `saved_object:${version}:visualization/update`,
                `saved_object:${version}:visualization/delete`,
                `ui:${version}:savedObjectsManagement/visualization/delete`,
                `ui:${version}:savedObjectsManagement/visualization/edit`,
                `ui:${version}:savedObjectsManagement/visualization/read`,
                `ui:${version}:visualize/show`,
                `ui:${version}:visualize/createShortUrl`,
                `ui:${version}:visualize/delete`,
                `ui:${version}:visualize/save`,
                `ui:${version}:catalogue/dashboard`,
                `ui:${version}:navLinks/kibana:dashboard`,
                `saved_object:${version}:dashboard/bulk_get`,
                `saved_object:${version}:dashboard/get`,
                `saved_object:${version}:dashboard/find`,
                `saved_object:${version}:dashboard/create`,
                `saved_object:${version}:dashboard/bulk_create`,
                `saved_object:${version}:dashboard/update`,
                `saved_object:${version}:dashboard/delete`,
                `saved_object:${version}:timelion-sheet/bulk_get`,
                `saved_object:${version}:timelion-sheet/get`,
                `saved_object:${version}:timelion-sheet/find`,
                `saved_object:${version}:canvas-workpad/bulk_get`,
                `saved_object:${version}:canvas-workpad/get`,
                `saved_object:${version}:canvas-workpad/find`,
                `saved_object:${version}:map/bulk_get`,
                `saved_object:${version}:map/get`,
                `saved_object:${version}:map/find`,
                `ui:${version}:savedObjectsManagement/dashboard/delete`,
                `ui:${version}:savedObjectsManagement/dashboard/edit`,
                `ui:${version}:savedObjectsManagement/dashboard/read`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                `ui:${version}:savedObjectsManagement/map/read`,
                `ui:${version}:dashboard/createNew`,
                `ui:${version}:dashboard/show`,
                `ui:${version}:dashboard/showWriteControls`,
                `api:${version}:console`,
                `ui:${version}:catalogue/console`,
                `ui:${version}:catalogue/searchprofiler`,
                `ui:${version}:catalogue/grokdebugger`,
                `ui:${version}:navLinks/kibana:dev_tools`,
                `ui:${version}:dev_tools/show`,
                `ui:${version}:catalogue/advanced_settings`,
                `ui:${version}:management/kibana/settings`,
                `saved_object:${version}:config/create`,
                `saved_object:${version}:config/bulk_create`,
                `saved_object:${version}:config/update`,
                `saved_object:${version}:config/delete`,
                `ui:${version}:savedObjectsManagement/config/delete`,
                `ui:${version}:savedObjectsManagement/config/edit`,
                `ui:${version}:advancedSettings/save`,
                `ui:${version}:catalogue/index_patterns`,
                `ui:${version}:management/kibana/index_patterns`,
                `saved_object:${version}:index-pattern/create`,
                `saved_object:${version}:index-pattern/bulk_create`,
                `saved_object:${version}:index-pattern/update`,
                `saved_object:${version}:index-pattern/delete`,
                `ui:${version}:savedObjectsManagement/index-pattern/delete`,
                `ui:${version}:savedObjectsManagement/index-pattern/edit`,
                `ui:${version}:indexPatterns/createNew`,
                `app:${version}:timelion`,
                `ui:${version}:catalogue/timelion`,
                `ui:${version}:navLinks/timelion`,
                `saved_object:${version}:timelion-sheet/create`,
                `saved_object:${version}:timelion-sheet/bulk_create`,
                `saved_object:${version}:timelion-sheet/update`,
                `saved_object:${version}:timelion-sheet/delete`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/delete`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/edit`,
                `ui:${version}:timelion/save`,
                `app:${version}:graph`,
                `ui:${version}:catalogue/graph`,
                `ui:${version}:navLinks/graph`,
                `saved_object:${version}:graph-workspace/bulk_get`,
                `saved_object:${version}:graph-workspace/get`,
                `saved_object:${version}:graph-workspace/find`,
                `saved_object:${version}:graph-workspace/create`,
                `saved_object:${version}:graph-workspace/bulk_create`,
                `saved_object:${version}:graph-workspace/update`,
                `saved_object:${version}:graph-workspace/delete`,
                `ui:${version}:savedObjectsManagement/graph-workspace/delete`,
                `ui:${version}:savedObjectsManagement/graph-workspace/edit`,
                `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                `ui:${version}:graph/save`,
                `ui:${version}:graph/delete`,
                `api:${version}:apm`,
                `app:${version}:apm`,
                `ui:${version}:catalogue/apm`,
                `ui:${version}:navLinks/apm`,
                `ui:${version}:apm/show`,
                `app:${version}:maps`,
                `ui:${version}:catalogue/maps`,
                `ui:${version}:navLinks/maps`,
                `saved_object:${version}:map/create`,
                `saved_object:${version}:map/bulk_create`,
                `saved_object:${version}:map/update`,
                `saved_object:${version}:map/delete`,
                `ui:${version}:savedObjectsManagement/map/delete`,
                `ui:${version}:savedObjectsManagement/map/edit`,
                `ui:${version}:maps/save`,
                `app:${version}:canvas`,
                `ui:${version}:catalogue/canvas`,
                `ui:${version}:navLinks/canvas`,
                `saved_object:${version}:canvas-workpad/create`,
                `saved_object:${version}:canvas-workpad/bulk_create`,
                `saved_object:${version}:canvas-workpad/update`,
                `saved_object:${version}:canvas-workpad/delete`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/delete`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/edit`,
                `ui:${version}:canvas/save`,
                `api:${version}:infra`,
                `app:${version}:infra`,
                `ui:${version}:catalogue/infraops`,
                `ui:${version}:navLinks/infra:home`,
                `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                `saved_object:${version}:infrastructure-ui-source/get`,
                `saved_object:${version}:infrastructure-ui-source/find`,
                `saved_object:${version}:infrastructure-ui-source/create`,
                `saved_object:${version}:infrastructure-ui-source/bulk_create`,
                `saved_object:${version}:infrastructure-ui-source/update`,
                `saved_object:${version}:infrastructure-ui-source/delete`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/delete`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/edit`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                `ui:${version}:infrastructure/show`,
                `ui:${version}:infrastructure/configureSource`,
                `ui:${version}:catalogue/infralogging`,
                `ui:${version}:navLinks/infra:logs`,
                `ui:${version}:logs/show`,
                `ui:${version}:logs/configureSource`,
                `api:${version}:uptime`,
                `app:${version}:uptime`,
                `ui:${version}:catalogue/uptime`,
                `ui:${version}:navLinks/uptime`,
                'allHack:',
              ],
              read: [
                'login:',
                `version:${version}`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/discover`,
                `ui:${version}:navLinks/kibana:discover`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `saved_object:${version}:index-pattern/bulk_get`,
                `saved_object:${version}:index-pattern/get`,
                `saved_object:${version}:index-pattern/find`,
                `saved_object:${version}:search/bulk_get`,
                `saved_object:${version}:search/get`,
                `saved_object:${version}:search/find`,
                `saved_object:${version}:url/bulk_get`,
                `saved_object:${version}:url/get`,
                `saved_object:${version}:url/find`,
                `ui:${version}:savedObjectsManagement/config/read`,
                `ui:${version}:savedObjectsManagement/index-pattern/read`,
                `ui:${version}:savedObjectsManagement/search/read`,
                `ui:${version}:savedObjectsManagement/url/read`,
                `ui:${version}:discover/show`,
                `ui:${version}:catalogue/visualize`,
                `ui:${version}:navLinks/kibana:visualize`,
                `saved_object:${version}:visualization/bulk_get`,
                `saved_object:${version}:visualization/get`,
                `saved_object:${version}:visualization/find`,
                `ui:${version}:savedObjectsManagement/visualization/read`,
                `ui:${version}:visualize/show`,
                `ui:${version}:catalogue/dashboard`,
                `ui:${version}:navLinks/kibana:dashboard`,
                `saved_object:${version}:timelion-sheet/bulk_get`,
                `saved_object:${version}:timelion-sheet/get`,
                `saved_object:${version}:timelion-sheet/find`,
                `saved_object:${version}:canvas-workpad/bulk_get`,
                `saved_object:${version}:canvas-workpad/get`,
                `saved_object:${version}:canvas-workpad/find`,
                `saved_object:${version}:map/bulk_get`,
                `saved_object:${version}:map/get`,
                `saved_object:${version}:map/find`,
                `saved_object:${version}:dashboard/bulk_get`,
                `saved_object:${version}:dashboard/get`,
                `saved_object:${version}:dashboard/find`,
                `ui:${version}:savedObjectsManagement/timelion-sheet/read`,
                `ui:${version}:savedObjectsManagement/canvas-workpad/read`,
                `ui:${version}:savedObjectsManagement/map/read`,
                `ui:${version}:savedObjectsManagement/dashboard/read`,
                `ui:${version}:dashboard/show`,
                `api:${version}:console`,
                `ui:${version}:catalogue/console`,
                `ui:${version}:catalogue/searchprofiler`,
                `ui:${version}:catalogue/grokdebugger`,
                `ui:${version}:navLinks/kibana:dev_tools`,
                `ui:${version}:dev_tools/show`,
                `ui:${version}:catalogue/advanced_settings`,
                `ui:${version}:management/kibana/settings`,
                `ui:${version}:catalogue/index_patterns`,
                `ui:${version}:management/kibana/index_patterns`,
                `app:${version}:timelion`,
                `ui:${version}:catalogue/timelion`,
                `ui:${version}:navLinks/timelion`,
                `app:${version}:graph`,
                `ui:${version}:catalogue/graph`,
                `ui:${version}:navLinks/graph`,
                `saved_object:${version}:graph-workspace/bulk_get`,
                `saved_object:${version}:graph-workspace/get`,
                `saved_object:${version}:graph-workspace/find`,
                `ui:${version}:savedObjectsManagement/graph-workspace/read`,
                `api:${version}:apm`,
                `app:${version}:apm`,
                `ui:${version}:catalogue/apm`,
                `ui:${version}:navLinks/apm`,
                `ui:${version}:apm/show`,
                `app:${version}:maps`,
                `ui:${version}:catalogue/maps`,
                `ui:${version}:navLinks/maps`,
                `app:${version}:canvas`,
                `ui:${version}:catalogue/canvas`,
                `ui:${version}:navLinks/canvas`,
                `api:${version}:infra`,
                `app:${version}:infra`,
                `ui:${version}:catalogue/infraops`,
                `ui:${version}:navLinks/infra:home`,
                `saved_object:${version}:infrastructure-ui-source/bulk_get`,
                `saved_object:${version}:infrastructure-ui-source/get`,
                `saved_object:${version}:infrastructure-ui-source/find`,
                `ui:${version}:savedObjectsManagement/infrastructure-ui-source/read`,
                `ui:${version}:infrastructure/show`,
                `ui:${version}:catalogue/infralogging`,
                `ui:${version}:navLinks/infra:logs`,
                `ui:${version}:logs/show`,
                `api:${version}:uptime`,
                `app:${version}:uptime`,
                `ui:${version}:catalogue/uptime`,
                `ui:${version}:navLinks/uptime`,
              ],
            },
            reserved: {
              monitoring: [
                `version:${version}`,
                `app:${version}:monitoring`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/monitoring`,
                `ui:${version}:navLinks/monitoring`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `ui:${version}:savedObjectsManagement/config/read`,
              ],
              ml: [
                `version:${version}`,
                `app:${version}:ml`,
                `app:${version}:kibana`,
                `ui:${version}:catalogue/ml`,
                `ui:${version}:navLinks/ml`,
                `saved_object:${version}:config/bulk_get`,
                `saved_object:${version}:config/get`,
                `saved_object:${version}:config/find`,
                `ui:${version}:savedObjectsManagement/config/read`,
              ],
            },
          });
      });

      describe('GET /api/security/privileges', () => {
        it('should return a privilege map with all known privileges, without actions', async () => {
          await supertest
            .get('/api/security/privileges')
            .set('kbn-xsrf', 'xxx')
            .send()
            .expect(200, {
              features: {
                discover: ['all', 'read'],
                visualize: ['all', 'read'],
                dashboard: ['all', 'read'],
                dev_tools: ['all', 'read'],
                advancedSettings: ['all', 'read'],
                indexPatterns: ['all', 'read'],
                timelion: ['all', 'read'],
                graph: ['all', 'read'],
                maps: ['all', 'read'],
                canvas: ['all', 'read'],
                infrastructure: ['all', 'read'],
                logs: ['all', 'read'],
                uptime: ['all', 'read'],
                apm: ['all', 'read'],
              },
              global: ['all', 'read'],
              space: ['all', 'read'],
              reserved: ['monitoring', 'ml'],
            });
        });
      });
    });
  });
}
