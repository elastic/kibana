/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */

import { KibanaFunctionalTestDefaultProviders } from 'x-pack/test/types/providers';

// tslint:disable no-default-export
export default function({ getService }: KibanaFunctionalTestDefaultProviders) {
  const supertest = getService('supertest');

  let version: string;

  describe('Privileges', () => {
    before(async () => {
      const versionService = getService('kibanaServer').version;
      version = await versionService.get();
    });

    // This test also functions as a sanity check for assigned privilege actions, to ensure that feature privileges are being granted in the way that developers expect.

    describe('GET /api/security/privileges?includeActions=true', () => {
      it('should return a privilege map with all known privileges with actions', async () => {
        await supertest
          .get('/api/security/privileges?includeActions=true')
          .set('kbn-xsrf', 'xxx')
          .send()
          .expect(200, {
            features: {
              discover: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/discover',
                  'ui:navLinks/kibana:discover',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'saved_object:search/create',
                  'saved_object:search/bulk_create',
                  'saved_object:search/update',
                  'saved_object:search/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'ui:discover/show',
                  'ui:discover/save',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/discover',
                  'ui:navLinks/kibana:discover',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'ui:discover/show',
                ],
              },
              visualize: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/visualize',
                  'ui:navLinks/kibana:visualize',
                  'saved_object:visualization/bulk_get',
                  'saved_object:visualization/get',
                  'saved_object:visualization/find',
                  'saved_object:visualization/create',
                  'saved_object:visualization/bulk_create',
                  'saved_object:visualization/update',
                  'saved_object:visualization/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'ui:visualize/showWriteControls',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/visualize',
                  'ui:navLinks/kibana:visualize',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'saved_object:visualization/bulk_get',
                  'saved_object:visualization/get',
                  'saved_object:visualization/find',
                ],
              },
              dashboard: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/dashboard',
                  'ui:navLinks/kibana:dashboard',
                  'saved_object:dashboard/bulk_get',
                  'saved_object:dashboard/get',
                  'saved_object:dashboard/find',
                  'saved_object:dashboard/create',
                  'saved_object:dashboard/bulk_create',
                  'saved_object:dashboard/update',
                  'saved_object:dashboard/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'saved_object:visualization/bulk_get',
                  'saved_object:visualization/get',
                  'saved_object:visualization/find',
                  'saved_object:timelion-sheet/bulk_get',
                  'saved_object:timelion-sheet/get',
                  'saved_object:timelion-sheet/find',
                  'saved_object:canvas-workpad/bulk_get',
                  'saved_object:canvas-workpad/get',
                  'saved_object:canvas-workpad/find',
                  'ui:dashboard/createNew',
                  'ui:dashboard/show',
                  'ui:dashboard/showWriteControls',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/dashboard',
                  'ui:navLinks/kibana:dashboard',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:search/bulk_get',
                  'saved_object:search/get',
                  'saved_object:search/find',
                  'saved_object:visualization/bulk_get',
                  'saved_object:visualization/get',
                  'saved_object:visualization/find',
                  'saved_object:timelion-sheet/bulk_get',
                  'saved_object:timelion-sheet/get',
                  'saved_object:timelion-sheet/find',
                  'saved_object:canvas-workpad/bulk_get',
                  'saved_object:canvas-workpad/get',
                  'saved_object:canvas-workpad/find',
                  'saved_object:dashboard/bulk_get',
                  'saved_object:dashboard/get',
                  'saved_object:dashboard/find',
                  'ui:dashboard/show',
                ],
              },
              dev_tools: {
                all: [
                  'login:',
                  `version:${version}`,
                  'api:console/execute',
                  'app:kibana',
                  'ui:catalogue/console',
                  'ui:catalogue/searchprofiler',
                  'ui:catalogue/grokdebugger',
                  'ui:navLinks/kibana:dev_tools',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'api:console/execute',
                  'app:kibana',
                  'ui:catalogue/console',
                  'ui:catalogue/searchprofiler',
                  'ui:catalogue/grokdebugger',
                  'ui:navLinks/kibana:dev_tools',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              advancedSettings: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/advanced_settings',
                  'ui:management/kibana/settings',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:config/create',
                  'saved_object:config/bulk_create',
                  'saved_object:config/update',
                  'saved_object:config/delete',
                  'ui:advancedSettings/save',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/advanced_settings',
                  'ui:management/kibana/settings',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              indexPatterns: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/index_patterns',
                  'ui:management/kibana/indices',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:index-pattern/create',
                  'saved_object:index-pattern/bulk_create',
                  'saved_object:index-pattern/update',
                  'saved_object:index-pattern/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:kibana',
                  'ui:catalogue/index_patterns',
                  'ui:management/kibana/indices',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              timelion: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:timelion',
                  'app:kibana',
                  'ui:catalogue/timelion',
                  'ui:navLinks/timelion',
                  'saved_object:timelion-sheet/bulk_get',
                  'saved_object:timelion-sheet/get',
                  'saved_object:timelion-sheet/find',
                  'saved_object:timelion-sheet/create',
                  'saved_object:timelion-sheet/bulk_create',
                  'saved_object:timelion-sheet/update',
                  'saved_object:timelion-sheet/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'ui:timelion/save',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:timelion',
                  'app:kibana',
                  'ui:catalogue/timelion',
                  'ui:navLinks/timelion',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:timelion-sheet/bulk_get',
                  'saved_object:timelion-sheet/get',
                  'saved_object:timelion-sheet/find',
                ],
              },
              graph: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:graph',
                  'app:kibana',
                  'ui:catalogue/graph',
                  'ui:navLinks/graph',
                  'saved_object:graph-workspace/bulk_get',
                  'saved_object:graph-workspace/get',
                  'saved_object:graph-workspace/find',
                  'saved_object:graph-workspace/create',
                  'saved_object:graph-workspace/bulk_create',
                  'saved_object:graph-workspace/update',
                  'saved_object:graph-workspace/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:graph',
                  'app:kibana',
                  'ui:catalogue/graph',
                  'ui:navLinks/graph',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:graph-workspace/bulk_get',
                  'saved_object:graph-workspace/get',
                  'saved_object:graph-workspace/find',
                ],
              },
              monitoring: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:monitoring',
                  'app:kibana',
                  'ui:catalogue/monitoring',
                  'ui:navLinks/monitoring',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              ml: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:ml',
                  'app:kibana',
                  'ui:catalogue/ml',
                  'ui:navLinks/ml',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              apm: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:apm',
                  'app:kibana',
                  'ui:catalogue/apm',
                  'ui:navLinks/apm',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              maps: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:maps',
                  'app:kibana',
                  'ui:catalogue/maps',
                  'ui:navLinks/maps',
                  'saved_object:map/bulk_get',
                  'saved_object:map/get',
                  'saved_object:map/find',
                  'saved_object:map/create',
                  'saved_object:map/bulk_create',
                  'saved_object:map/update',
                  'saved_object:map/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'ui:maps/save',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:maps',
                  'app:kibana',
                  'ui:catalogue/maps',
                  'ui:navLinks/maps',
                  'saved_object:map/bulk_get',
                  'saved_object:map/get',
                  'saved_object:map/find',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                ],
              },
              canvas: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:canvas',
                  'app:kibana',
                  'ui:catalogue/canvas',
                  'ui:navLinks/canvas',
                  'saved_object:canvas-workpad/bulk_get',
                  'saved_object:canvas-workpad/get',
                  'saved_object:canvas-workpad/find',
                  'saved_object:canvas-workpad/create',
                  'saved_object:canvas-workpad/bulk_create',
                  'saved_object:canvas-workpad/update',
                  'saved_object:canvas-workpad/delete',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'ui:canvas/save',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:canvas',
                  'app:kibana',
                  'ui:catalogue/canvas',
                  'ui:navLinks/canvas',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                  'saved_object:index-pattern/bulk_get',
                  'saved_object:index-pattern/get',
                  'saved_object:index-pattern/find',
                  'saved_object:canvas-workpad/bulk_get',
                  'saved_object:canvas-workpad/get',
                  'saved_object:canvas-workpad/find',
                ],
              },
              infrastructure: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:infra',
                  'app:kibana',
                  'ui:catalogue/infraops',
                  'ui:navLinks/infra:home',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:infra',
                  'app:kibana',
                  'ui:catalogue/infraops',
                  'ui:navLinks/infra:home',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              logs: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:infra',
                  'app:kibana',
                  'ui:catalogue/infralogging',
                  'ui:navLinks/infra:logs',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:infra',
                  'app:kibana',
                  'ui:catalogue/infralogging',
                  'ui:navLinks/infra:logs',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
              uptime: {
                all: [
                  'login:',
                  `version:${version}`,
                  'app:uptime',
                  'app:kibana',
                  'ui:catalogue/uptime',
                  'ui:navLinks/uptime',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
                read: [
                  'login:',
                  `version:${version}`,
                  'app:uptime',
                  'app:kibana',
                  'ui:catalogue/uptime',
                  'ui:navLinks/uptime',
                  'saved_object:config/bulk_get',
                  'saved_object:config/get',
                  'saved_object:config/find',
                ],
              },
            },
            global: {
              all: [
                'login:',
                `version:${version}`,
                'space:manage',
                'ui:spaces/manage',
                'app:kibana',
                'ui:catalogue/discover',
                'ui:navLinks/kibana:discover',
                'saved_object:search/bulk_get',
                'saved_object:search/get',
                'saved_object:search/find',
                'saved_object:search/create',
                'saved_object:search/bulk_create',
                'saved_object:search/update',
                'saved_object:search/delete',
                'saved_object:config/bulk_get',
                'saved_object:config/get',
                'saved_object:config/find',
                'saved_object:index-pattern/bulk_get',
                'saved_object:index-pattern/get',
                'saved_object:index-pattern/find',
                'ui:discover/show',
                'ui:discover/save',
                'ui:catalogue/visualize',
                'ui:navLinks/kibana:visualize',
                'saved_object:visualization/bulk_get',
                'saved_object:visualization/get',
                'saved_object:visualization/find',
                'saved_object:visualization/create',
                'saved_object:visualization/bulk_create',
                'saved_object:visualization/update',
                'saved_object:visualization/delete',
                'ui:visualize/showWriteControls',
                'ui:catalogue/dashboard',
                'ui:navLinks/kibana:dashboard',
                'saved_object:dashboard/bulk_get',
                'saved_object:dashboard/get',
                'saved_object:dashboard/find',
                'saved_object:dashboard/create',
                'saved_object:dashboard/bulk_create',
                'saved_object:dashboard/update',
                'saved_object:dashboard/delete',
                'saved_object:timelion-sheet/bulk_get',
                'saved_object:timelion-sheet/get',
                'saved_object:timelion-sheet/find',
                'saved_object:canvas-workpad/bulk_get',
                'saved_object:canvas-workpad/get',
                'saved_object:canvas-workpad/find',
                'ui:dashboard/createNew',
                'ui:dashboard/show',
                'ui:dashboard/showWriteControls',
                'api:console/execute',
                'ui:catalogue/console',
                'ui:catalogue/searchprofiler',
                'ui:catalogue/grokdebugger',
                'ui:navLinks/kibana:dev_tools',
                'ui:catalogue/advanced_settings',
                'ui:management/kibana/settings',
                'saved_object:config/create',
                'saved_object:config/bulk_create',
                'saved_object:config/update',
                'saved_object:config/delete',
                'ui:advancedSettings/save',
                'ui:catalogue/index_patterns',
                'ui:management/kibana/indices',
                'saved_object:index-pattern/create',
                'saved_object:index-pattern/bulk_create',
                'saved_object:index-pattern/update',
                'saved_object:index-pattern/delete',
                'app:timelion',
                'ui:catalogue/timelion',
                'ui:navLinks/timelion',
                'saved_object:timelion-sheet/create',
                'saved_object:timelion-sheet/bulk_create',
                'saved_object:timelion-sheet/update',
                'saved_object:timelion-sheet/delete',
                'ui:timelion/save',
                'app:graph',
                'ui:catalogue/graph',
                'ui:navLinks/graph',
                'saved_object:graph-workspace/bulk_get',
                'saved_object:graph-workspace/get',
                'saved_object:graph-workspace/find',
                'saved_object:graph-workspace/create',
                'saved_object:graph-workspace/bulk_create',
                'saved_object:graph-workspace/update',
                'saved_object:graph-workspace/delete',
                'app:monitoring',
                'ui:catalogue/monitoring',
                'ui:navLinks/monitoring',
                'app:ml',
                'ui:catalogue/ml',
                'ui:navLinks/ml',
                'app:apm',
                'ui:catalogue/apm',
                'ui:navLinks/apm',
                'app:maps',
                'ui:catalogue/maps',
                'ui:navLinks/maps',
                'saved_object:map/bulk_get',
                'saved_object:map/get',
                'saved_object:map/find',
                'saved_object:map/create',
                'saved_object:map/bulk_create',
                'saved_object:map/update',
                'saved_object:map/delete',
                'ui:maps/save',
                'app:canvas',
                'ui:catalogue/canvas',
                'ui:navLinks/canvas',
                'saved_object:canvas-workpad/create',
                'saved_object:canvas-workpad/bulk_create',
                'saved_object:canvas-workpad/update',
                'saved_object:canvas-workpad/delete',
                'ui:canvas/save',
                'app:infra',
                'ui:catalogue/infraops',
                'ui:navLinks/infra:home',
                'ui:catalogue/infralogging',
                'ui:navLinks/infra:logs',
                'app:uptime',
                'ui:catalogue/uptime',
                'ui:navLinks/uptime',
              ],
              read: [
                'login:',
                `version:${version}`,
                'app:kibana',
                'ui:catalogue/discover',
                'ui:navLinks/kibana:discover',
                'saved_object:config/bulk_get',
                'saved_object:config/get',
                'saved_object:config/find',
                'saved_object:index-pattern/bulk_get',
                'saved_object:index-pattern/get',
                'saved_object:index-pattern/find',
                'saved_object:search/bulk_get',
                'saved_object:search/get',
                'saved_object:search/find',
                'ui:discover/show',
                'ui:catalogue/visualize',
                'ui:navLinks/kibana:visualize',
                'saved_object:visualization/bulk_get',
                'saved_object:visualization/get',
                'saved_object:visualization/find',
                'ui:catalogue/dashboard',
                'ui:navLinks/kibana:dashboard',
                'saved_object:timelion-sheet/bulk_get',
                'saved_object:timelion-sheet/get',
                'saved_object:timelion-sheet/find',
                'saved_object:canvas-workpad/bulk_get',
                'saved_object:canvas-workpad/get',
                'saved_object:canvas-workpad/find',
                'saved_object:dashboard/bulk_get',
                'saved_object:dashboard/get',
                'saved_object:dashboard/find',
                'ui:dashboard/show',
                'api:console/execute',
                'ui:catalogue/console',
                'ui:catalogue/searchprofiler',
                'ui:catalogue/grokdebugger',
                'ui:navLinks/kibana:dev_tools',
                'ui:catalogue/advanced_settings',
                'ui:management/kibana/settings',
                'ui:catalogue/index_patterns',
                'ui:management/kibana/indices',
                'app:timelion',
                'ui:catalogue/timelion',
                'ui:navLinks/timelion',
                'app:graph',
                'ui:catalogue/graph',
                'ui:navLinks/graph',
                'saved_object:graph-workspace/bulk_get',
                'saved_object:graph-workspace/get',
                'saved_object:graph-workspace/find',
                'app:monitoring',
                'ui:catalogue/monitoring',
                'ui:navLinks/monitoring',
                'app:ml',
                'ui:catalogue/ml',
                'ui:navLinks/ml',
                'app:apm',
                'ui:catalogue/apm',
                'ui:navLinks/apm',
                'app:maps',
                'ui:catalogue/maps',
                'ui:navLinks/maps',
                'saved_object:map/bulk_get',
                'saved_object:map/get',
                'saved_object:map/find',
                'app:canvas',
                'ui:catalogue/canvas',
                'ui:navLinks/canvas',
                'app:infra',
                'ui:catalogue/infraops',
                'ui:navLinks/infra:home',
                'ui:catalogue/infralogging',
                'ui:navLinks/infra:logs',
                'app:uptime',
                'ui:catalogue/uptime',
                'ui:navLinks/uptime',
              ],
            },
            space: {
              all: [
                'login:',
                `version:${version}`,
                'app:kibana',
                'ui:catalogue/discover',
                'ui:navLinks/kibana:discover',
                'saved_object:search/bulk_get',
                'saved_object:search/get',
                'saved_object:search/find',
                'saved_object:search/create',
                'saved_object:search/bulk_create',
                'saved_object:search/update',
                'saved_object:search/delete',
                'saved_object:config/bulk_get',
                'saved_object:config/get',
                'saved_object:config/find',
                'saved_object:index-pattern/bulk_get',
                'saved_object:index-pattern/get',
                'saved_object:index-pattern/find',
                'ui:discover/show',
                'ui:discover/save',
                'ui:catalogue/visualize',
                'ui:navLinks/kibana:visualize',
                'saved_object:visualization/bulk_get',
                'saved_object:visualization/get',
                'saved_object:visualization/find',
                'saved_object:visualization/create',
                'saved_object:visualization/bulk_create',
                'saved_object:visualization/update',
                'saved_object:visualization/delete',
                'ui:visualize/showWriteControls',
                'ui:catalogue/dashboard',
                'ui:navLinks/kibana:dashboard',
                'saved_object:dashboard/bulk_get',
                'saved_object:dashboard/get',
                'saved_object:dashboard/find',
                'saved_object:dashboard/create',
                'saved_object:dashboard/bulk_create',
                'saved_object:dashboard/update',
                'saved_object:dashboard/delete',
                'saved_object:timelion-sheet/bulk_get',
                'saved_object:timelion-sheet/get',
                'saved_object:timelion-sheet/find',
                'saved_object:canvas-workpad/bulk_get',
                'saved_object:canvas-workpad/get',
                'saved_object:canvas-workpad/find',
                'ui:dashboard/createNew',
                'ui:dashboard/show',
                'ui:dashboard/showWriteControls',
                'api:console/execute',
                'ui:catalogue/console',
                'ui:catalogue/searchprofiler',
                'ui:catalogue/grokdebugger',
                'ui:navLinks/kibana:dev_tools',
                'ui:catalogue/advanced_settings',
                'ui:management/kibana/settings',
                'saved_object:config/create',
                'saved_object:config/bulk_create',
                'saved_object:config/update',
                'saved_object:config/delete',
                'ui:advancedSettings/save',
                'ui:catalogue/index_patterns',
                'ui:management/kibana/indices',
                'saved_object:index-pattern/create',
                'saved_object:index-pattern/bulk_create',
                'saved_object:index-pattern/update',
                'saved_object:index-pattern/delete',
                'app:timelion',
                'ui:catalogue/timelion',
                'ui:navLinks/timelion',
                'saved_object:timelion-sheet/create',
                'saved_object:timelion-sheet/bulk_create',
                'saved_object:timelion-sheet/update',
                'saved_object:timelion-sheet/delete',
                'ui:timelion/save',
                'app:graph',
                'ui:catalogue/graph',
                'ui:navLinks/graph',
                'saved_object:graph-workspace/bulk_get',
                'saved_object:graph-workspace/get',
                'saved_object:graph-workspace/find',
                'saved_object:graph-workspace/create',
                'saved_object:graph-workspace/bulk_create',
                'saved_object:graph-workspace/update',
                'saved_object:graph-workspace/delete',
                'app:monitoring',
                'ui:catalogue/monitoring',
                'ui:navLinks/monitoring',
                'app:ml',
                'ui:catalogue/ml',
                'ui:navLinks/ml',
                'app:apm',
                'ui:catalogue/apm',
                'ui:navLinks/apm',
                'app:maps',
                'ui:catalogue/maps',
                'ui:navLinks/maps',
                'saved_object:map/bulk_get',
                'saved_object:map/get',
                'saved_object:map/find',
                'saved_object:map/create',
                'saved_object:map/bulk_create',
                'saved_object:map/update',
                'saved_object:map/delete',
                'ui:maps/save',
                'app:canvas',
                'ui:catalogue/canvas',
                'ui:navLinks/canvas',
                'saved_object:canvas-workpad/create',
                'saved_object:canvas-workpad/bulk_create',
                'saved_object:canvas-workpad/update',
                'saved_object:canvas-workpad/delete',
                'ui:canvas/save',
                'app:infra',
                'ui:catalogue/infraops',
                'ui:navLinks/infra:home',
                'ui:catalogue/infralogging',
                'ui:navLinks/infra:logs',
                'app:uptime',
                'ui:catalogue/uptime',
                'ui:navLinks/uptime',
              ],
              read: [
                'login:',
                `version:${version}`,
                'app:kibana',
                'ui:catalogue/discover',
                'ui:navLinks/kibana:discover',
                'saved_object:config/bulk_get',
                'saved_object:config/get',
                'saved_object:config/find',
                'saved_object:index-pattern/bulk_get',
                'saved_object:index-pattern/get',
                'saved_object:index-pattern/find',
                'saved_object:search/bulk_get',
                'saved_object:search/get',
                'saved_object:search/find',
                'ui:discover/show',
                'ui:catalogue/visualize',
                'ui:navLinks/kibana:visualize',
                'saved_object:visualization/bulk_get',
                'saved_object:visualization/get',
                'saved_object:visualization/find',
                'ui:catalogue/dashboard',
                'ui:navLinks/kibana:dashboard',
                'saved_object:timelion-sheet/bulk_get',
                'saved_object:timelion-sheet/get',
                'saved_object:timelion-sheet/find',
                'saved_object:canvas-workpad/bulk_get',
                'saved_object:canvas-workpad/get',
                'saved_object:canvas-workpad/find',
                'saved_object:dashboard/bulk_get',
                'saved_object:dashboard/get',
                'saved_object:dashboard/find',
                'ui:dashboard/show',
                'api:console/execute',
                'ui:catalogue/console',
                'ui:catalogue/searchprofiler',
                'ui:catalogue/grokdebugger',
                'ui:navLinks/kibana:dev_tools',
                'ui:catalogue/advanced_settings',
                'ui:management/kibana/settings',
                'ui:catalogue/index_patterns',
                'ui:management/kibana/indices',
                'app:timelion',
                'ui:catalogue/timelion',
                'ui:navLinks/timelion',
                'app:graph',
                'ui:catalogue/graph',
                'ui:navLinks/graph',
                'saved_object:graph-workspace/bulk_get',
                'saved_object:graph-workspace/get',
                'saved_object:graph-workspace/find',
                'app:monitoring',
                'ui:catalogue/monitoring',
                'ui:navLinks/monitoring',
                'app:ml',
                'ui:catalogue/ml',
                'ui:navLinks/ml',
                'app:apm',
                'ui:catalogue/apm',
                'ui:navLinks/apm',
                'app:maps',
                'ui:catalogue/maps',
                'ui:navLinks/maps',
                'saved_object:map/bulk_get',
                'saved_object:map/get',
                'saved_object:map/find',
                'app:canvas',
                'ui:catalogue/canvas',
                'ui:navLinks/canvas',
                'app:infra',
                'ui:catalogue/infraops',
                'ui:navLinks/infra:home',
                'ui:catalogue/infralogging',
                'ui:navLinks/infra:logs',
                'app:uptime',
                'ui:catalogue/uptime',
                'ui:navLinks/uptime',
              ],
            },
          });
      });

      describe('GET /api/security/privileges', () => {
        it('should return a privilege map with all known privileges, without actions', async () => {
          await supertest
            .get('/api/security/privileges')
            .set('kbn-xsrf', 'xxx')
            .send()
            .expect(200, {
              features: {
                discover: ['all', 'read'],
                visualize: ['all', 'read'],
                dashboard: ['all', 'read'],
                dev_tools: ['all', 'read'],
                advancedSettings: ['all', 'read'],
                indexPatterns: ['all', 'read'],
                timelion: ['all', 'read'],
                graph: ['all', 'read'],
                monitoring: ['all'],
                ml: ['all'],
                apm: ['all'],
                maps: ['all', 'read'],
                canvas: ['all', 'read'],
                infrastructure: ['all', 'read'],
                logs: ['all', 'read'],
                uptime: ['all', 'read'],
              },
              global: ['all', 'read'],
              space: ['all', 'read'],
            });
        });
      });
    });
  });
}
