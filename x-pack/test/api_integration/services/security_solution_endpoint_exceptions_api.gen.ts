/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: Endpoint Exceptions API client for tests
 *   version: Bundle (no version)
 */

import {
  ELASTIC_HTTP_VERSION_HEADER,
  X_ELASTIC_INTERNAL_ORIGIN_REQUEST,
} from '@kbn/core-http-common';
import { FtrProviderContext } from '../ftr_provider_context';

import { CreateEndpointListItemRequestBodyInput } from '../../../../packages/kbn-securitysolution-endpoint-exceptions-common/api/create_endpoint_list_item/create_endpoint_list_item.gen';
import { DeleteEndpointListItemRequestQueryInput } from '../../../../packages/kbn-securitysolution-endpoint-exceptions-common/api/delete_endpoint_list_item/delete_endpoint_list_item.gen';
import { FindEndpointListItemsRequestQueryInput } from '../../../../packages/kbn-securitysolution-endpoint-exceptions-common/api/find_endpoint_list_item/find_endpoint_list_item.gen';
import { GetEndpointListItemRequestQueryInput } from '../../../../packages/kbn-securitysolution-endpoint-exceptions-common/api/read_endpoint_list_item/read_endpoint_list_item.gen';
import { UpdateEndpointListItemRequestBodyInput } from '../../../../packages/kbn-securitysolution-endpoint-exceptions-common/api/update_endpoint_list_item/update_endpoint_list_item.gen';

export function SecuritySolutionApiProvider({ getService }: FtrProviderContext) {
  const supertest = getService('supertest');

  return {
    /**
     * Creates an endpoint list or does nothing if the list already exists
     */
    createEndpointList() {
      return supertest
        .post('/api/endpoint_list')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana');
    },
    createEndpointListItem(props: CreateEndpointListItemProps) {
      return supertest
        .post('/api/endpoint_list/items')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana')
        .send(props.body as object);
    },
    deleteEndpointListItem(props: DeleteEndpointListItemProps) {
      return supertest
        .delete('/api/endpoint_list/items')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana')
        .query(props.query);
    },
    findEndpointListItems(props: FindEndpointListItemsProps) {
      return supertest
        .get('/api/endpoint_list/items/_find')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana')
        .query(props.query);
    },
    getEndpointListItem(props: GetEndpointListItemProps) {
      return supertest
        .get('/api/endpoint_list/items')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana')
        .query(props.query);
    },
    updateEndpointListItem(props: UpdateEndpointListItemProps) {
      return supertest
        .put('/api/endpoint_list/items')
        .set('kbn-xsrf', 'true')
        .set(ELASTIC_HTTP_VERSION_HEADER, '2023-10-31')
        .set(X_ELASTIC_INTERNAL_ORIGIN_REQUEST, 'kibana')
        .send(props.body as object);
    },
  };
}

export interface CreateEndpointListItemProps {
  body: CreateEndpointListItemRequestBodyInput;
}
export interface DeleteEndpointListItemProps {
  query: DeleteEndpointListItemRequestQueryInput;
}
export interface FindEndpointListItemsProps {
  query: FindEndpointListItemsRequestQueryInput;
}
export interface GetEndpointListItemProps {
  query: GetEndpointListItemRequestQueryInput;
}
export interface UpdateEndpointListItemProps {
  body: UpdateEndpointListItemRequestBodyInput;
}
