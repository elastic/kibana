openapi: 3.0.0
info:
  title: Common Attack Discovery Attributes
  version: 'not applicable'
paths: {}
components:
  x-codegen-enabled: true
  schemas:

    AttackDiscoveries:
      type: array
      description: Array of attack discoveries
      items:
        $ref: './post_attack_discovery_route.schema.yaml#/components/schemas/AttackDiscovery'

    AttackDiscoveryStatus:
      type: string
      description: The status of the attack discovery.
      enum:
        - running
        - succeeded
        - failed

    GenerationInterval:
      type: object
      description: Run durations for the attack discovery
      required:
        - 'timestamp'
        - 'durationMs'
        - 'entitySummaryMarkdown'
        - 'summaryMarkdown'
        - 'timestamp'
        - 'title'
      properties:
        alertIds:
          description: The time the attack discovery was generated
          items:
            type: string
        durationMs:
          description: The duration of the attack discovery generation
          type: integer


    AttackDiscoveryResponse:
      type: object
      required:
        - apiConfig
        - id
        - createdAt
        - users
        - namespace
        - attackDiscoveries
        - status
        - backingIndex
        - generationIntervals
        - averageIntervalMs
      properties:
        id:
          $ref: '../common_attributes.schema.yaml#/components/schemas/NonEmptyString'
        'timestamp':
          $ref: '../common_attributes.schema.yaml#/components/schemas/NonEmptyString'
        updatedAt:
          description: The last time attack discovery was updated.
          type: string
        alertsContextCount:
            type: integer
            description: The number of alerts in the context.
        createdAt:
          description: The time attack discovery was created.
          type: string
        replacements:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/Replacements'
        users:
          type: array
          items:
            $ref: '../common_attributes.schema.yaml#/components/schemas/User'
        status:
          $ref: '#/components/schemas/AttackDiscoveryStatus'
          description: The status of the attack discovery.
        attackDiscoveries:
          $ref: '#/components/schemas/AttackDiscoveries'
          description: The attack discoveries.
        apiConfig:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/ApiConfig'
          description: LLM API configuration.
        namespace:
          type: string
          description: Kibana space
        backingIndex:
          type: string
          description: The backing index required for update requests.
        generationIntervals:
          type: array
          description: The most 5 recent generation intervals
          items:
            $ref: '#/components/schemas/AttackDiscoveryStatus'
        averageIntervalMs:
            type: integer
            description: The average generation interval in milliseconds

    AttackDiscoveryUpdateProps:
      type: object
      required:
        - id
        - status
        - backingIndex
      properties:
        id:
          $ref: '../common_attributes.schema.yaml#/components/schemas/NonEmptyString'
        apiConfig:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/ApiConfig'
          description: LLM API configuration.
        alertsContextCount:
          type: integer
          description: The number of alerts in the context.
        attackDiscoveries:
          $ref: '#/components/schemas/AttackDiscoveries'
          description: The attack discoveries.
        status:
          $ref: '#/components/schemas/AttackDiscoveryStatus'
          description: The status of the attack discovery.
        replacements:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/Replacements'
        backingIndex:
          type: string
          description: The backing index required for update requests.

    AttackDiscoveryCreateProps:
      type: object
      required:
        - attackDiscoveries
        - apiConfig
        - status
      properties:
        id:
          type: string
          description: The attack discovery id.
        status:
          $ref: '#/components/schemas/AttackDiscoveryStatus'
          description: The status of the attack discovery.
        alertsContextCount:
          type: integer
          description: The number of alerts in the context.
        attackDiscoveries:
          $ref: '#/components/schemas/AttackDiscoveries'
          description: The attack discoveries.
        apiConfig:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/ApiConfig'
          description: LLM API configuration.
        replacements:
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/Replacements'

