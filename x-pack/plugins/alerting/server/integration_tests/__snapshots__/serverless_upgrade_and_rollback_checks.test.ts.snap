// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Serverless upgrade and rollback checks detect param changes to review for: .es-query 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "aggField": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "aggType": Object {
      "flags": Object {
        "default": "count",
        "error": [Function],
        "presence": "optional",
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "esQuery": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "any",
      "whens": Array [
        Object {
          "is": Object {
            "allow": Array [
              "esQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
          "otherwise": Object {
            "flags": Object {
              "error": [Function],
              "presence": "forbidden",
            },
            "type": "any",
          },
          "ref": Object {
            "path": Array [
              "searchType",
            ],
          },
          "then": Object {
            "flags": Object {
              "error": [Function],
            },
            "metas": Array [
              Object {
                "x-oas-min-length": 1,
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
      ],
    },
    "esqlQuery": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "any",
      "whens": Array [
        Object {
          "is": Object {
            "allow": Array [
              "esqlQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
          "otherwise": Object {
            "flags": Object {
              "error": [Function],
              "presence": "forbidden",
            },
            "type": "any",
          },
          "ref": Object {
            "path": Array [
              "searchType",
            ],
          },
          "then": Object {
            "flags": Object {
              "default": Object {
                "special": "deep",
              },
              "error": [Function],
              "presence": "optional",
            },
            "keys": Object {
              "esql": Object {
                "flags": Object {
                  "error": [Function],
                },
                "metas": Array [
                  Object {
                    "x-oas-min-length": 1,
                  },
                ],
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            },
            "type": "object",
          },
        },
      ],
    },
    "excludeHitsFromPreviousRun": Object {
      "flags": Object {
        "default": true,
        "error": [Function],
        "presence": "optional",
      },
      "type": "boolean",
    },
    "groupBy": Object {
      "flags": Object {
        "default": "all",
        "error": [Function],
        "presence": "optional",
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "index": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "any",
      "whens": Array [
        Object {
          "is": Object {
            "allow": Array [
              "esQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
          "otherwise": Object {
            "flags": Object {
              "error": [Function],
              "presence": "forbidden",
            },
            "type": "any",
          },
          "ref": Object {
            "path": Array [
              "searchType",
            ],
          },
          "then": Object {
            "flags": Object {
              "error": [Function],
            },
            "items": Array [
              Object {
                "flags": Object {
                  "error": [Function],
                  "presence": "optional",
                },
                "metas": Array [
                  Object {
                    "x-oas-min-length": 1,
                  },
                ],
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "limit": 1,
                },
                "name": "min",
              },
            ],
            "type": "array",
          },
        },
      ],
    },
    "searchConfiguration": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "any",
      "whens": Array [
        Object {
          "is": Object {
            "allow": Array [
              "searchSource",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
          "otherwise": Object {
            "flags": Object {
              "error": [Function],
              "presence": "forbidden",
            },
            "type": "any",
          },
          "ref": Object {
            "path": Array [
              "searchType",
            ],
          },
          "then": Object {
            "flags": Object {
              "default": Object {
                "special": "deep",
              },
              "error": [Function],
              "presence": "optional",
              "unknown": true,
            },
            "keys": Object {},
            "preferences": Object {
              "stripUnknown": Object {
                "objects": false,
              },
            },
            "type": "object",
          },
        },
      ],
    },
    "searchType": Object {
      "flags": Object {
        "default": "esQuery",
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              "searchSource",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "esQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "esqlQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "size": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "limit": 0,
          },
          "name": "min",
        },
        Object {
          "args": Object {
            "limit": 10000,
          },
          "name": "max",
        },
      ],
      "type": "number",
    },
    "sourceFields": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "label": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "searchPath": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          },
          "type": "object",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 5,
          },
          "name": "max",
        },
      ],
      "type": "array",
    },
    "termField": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "metas": Array [
              Object {
                "x-oas-min-length": 1,
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "items": Array [
              Object {
                "flags": Object {
                  "error": [Function],
                  "presence": "optional",
                },
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "limit": 2,
                },
                "name": "min",
              },
              Object {
                "args": Object {
                  "limit": 4,
                },
                "name": "max",
              },
            ],
            "type": "array",
          },
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "alternatives",
    },
    "termSize": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
      ],
      "type": "number",
    },
    "threshold": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "type": "number",
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
        Object {
          "args": Object {
            "limit": 2,
          },
          "name": "max",
        },
      ],
      "type": "array",
    },
    "thresholdComparator": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              ">",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "<",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              ">=",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "<=",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "between",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "notBetween",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "alternatives",
    },
    "timeField": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "any",
      "whens": Array [
        Object {
          "is": Object {
            "allow": Array [
              "esQuery",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
          "otherwise": Object {
            "flags": Object {
              "default": [Function],
              "error": [Function],
              "presence": "optional",
            },
            "metas": Array [
              Object {
                "x-oas-min-length": 1,
              },
              Object {
                "x-oas-optional": true,
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
          "ref": Object {
            "path": Array [
              "searchType",
            ],
          },
          "then": Object {
            "flags": Object {
              "error": [Function],
            },
            "metas": Array [
              Object {
                "x-oas-min-length": 1,
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
      ],
    },
    "timeWindowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
      ],
      "type": "number",
    },
    "timeWindowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "rules": Array [
    Object {
      "args": Object {
        "method": [Function],
      },
      "name": "custom",
    },
  ],
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: .geo-containment 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "boundaryGeoField": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "boundaryIndexId": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "boundaryIndexQuery": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-any-type": true,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "any",
    },
    "boundaryIndexTitle": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "boundaryNameField": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "boundaryType": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "dateField": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "entity": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "geoField": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "index": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "indexId": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "indexQuery": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-any-type": true,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "any",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: .index-threshold 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "aggField": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "aggType": Object {
      "flags": Object {
        "default": "count",
        "error": [Function],
        "presence": "optional",
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "filterKuery": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "groupBy": Object {
      "flags": Object {
        "default": "all",
        "error": [Function],
        "presence": "optional",
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "index": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "metas": Array [
              Object {
                "x-oas-min-length": 1,
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "items": Array [
              Object {
                "flags": Object {
                  "error": [Function],
                  "presence": "optional",
                },
                "metas": Array [
                  Object {
                    "x-oas-min-length": 1,
                  },
                ],
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            ],
            "rules": Array [
              Object {
                "args": Object {
                  "limit": 1,
                },
                "name": "min",
              },
            ],
            "type": "array",
          },
        },
      ],
      "type": "alternatives",
    },
    "termField": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "termSize": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
      ],
      "type": "number",
    },
    "threshold": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "type": "number",
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
        Object {
          "args": Object {
            "limit": 2,
          },
          "name": "max",
        },
      ],
      "type": "array",
    },
    "thresholdComparator": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              ">",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "<",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              ">=",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "<=",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "between",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "notBetween",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "alternatives",
    },
    "timeField": Object {
      "flags": Object {
        "error": [Function],
      },
      "metas": Array [
        Object {
          "x-oas-min-length": 1,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "timeWindowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
      ],
      "type": "number",
    },
    "timeWindowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "rules": Array [
    Object {
      "args": Object {
        "method": [Function],
      },
      "name": "custom",
    },
  ],
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: apm.anomaly 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "anomalyDetectorTypes": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "matches": Array [
            Object {
              "schema": Object {
                "allow": Array [
                  "txLatency",
                ],
                "flags": Object {
                  "error": [Function],
                  "only": true,
                },
                "type": "any",
              },
            },
            Object {
              "schema": Object {
                "allow": Array [
                  "txThroughput",
                ],
                "flags": Object {
                  "error": [Function],
                  "only": true,
                },
                "type": "any",
              },
            },
            Object {
              "schema": Object {
                "allow": Array [
                  "txFailureRate",
                ],
                "flags": Object {
                  "error": [Function],
                  "only": true,
                },
                "type": "any",
              },
            },
          ],
          "type": "alternatives",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "limit": 1,
          },
          "name": "min",
        },
      ],
      "type": "array",
    },
    "anomalySeverityType": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              "critical",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "major",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "minor",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "warning",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "environment": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "serviceName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "transactionType": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "windowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "windowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: apm.error_rate 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "environment": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "errorGroupingKey": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "groupBy": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "rules": Array [
            Object {
              "args": Object {
                "method": [Function],
              },
              "name": "custom",
            },
          ],
          "type": "string",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "array",
    },
    "searchConfiguration": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "query": Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "language": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "query": Object {
              "flags": Object {
                "error": [Function],
              },
              "matches": Array [
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                },
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "metas": Array [
                              Object {
                                "x-oas-any-type": true,
                              },
                            ],
                            "type": "any",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                },
              ],
              "type": "alternatives",
            },
          },
          "type": "object",
        },
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "object",
    },
    "serviceName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "threshold": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "useKqlFilter": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "windowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "windowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: apm.transaction_duration 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "aggregationType": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              "avg",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "95th",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "99th",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "environment": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "groupBy": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "rules": Array [
            Object {
              "args": Object {
                "method": [Function],
              },
              "name": "custom",
            },
          ],
          "type": "string",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "array",
    },
    "searchConfiguration": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "query": Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "language": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "query": Object {
              "flags": Object {
                "error": [Function],
              },
              "matches": Array [
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                },
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "metas": Array [
                              Object {
                                "x-oas-any-type": true,
                              },
                            ],
                            "type": "any",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                },
              ],
              "type": "alternatives",
            },
          },
          "type": "object",
        },
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "object",
    },
    "serviceName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "threshold": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "transactionName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "transactionType": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "useKqlFilter": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "windowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "windowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: apm.transaction_error_rate 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "environment": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "groupBy": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "rules": Array [
            Object {
              "args": Object {
                "method": [Function],
              },
              "name": "custom",
            },
          ],
          "type": "string",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "array",
    },
    "searchConfiguration": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "query": Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "language": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "query": Object {
              "flags": Object {
                "error": [Function],
              },
              "matches": Array [
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                },
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "metas": Array [
                              Object {
                                "x-oas-any-type": true,
                              },
                            ],
                            "type": "any",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                },
              ],
              "type": "alternatives",
            },
          },
          "type": "object",
        },
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "object",
    },
    "serviceName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "threshold": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "transactionName": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "transactionType": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "useKqlFilter": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "windowSize": Object {
      "flags": Object {
        "error": [Function],
      },
      "type": "number",
    },
    "windowUnit": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: metrics.alert.inventory.threshold 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
    "unknown": true,
  },
  "keys": Object {
    "alertOnNoData": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "criteria": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "comparator": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "customMetric": Object {
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "presence": "optional",
              },
              "keys": Object {
                "aggregation": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "field": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "id": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "label": Object {
                  "flags": Object {
                    "default": [Function],
                    "error": [Function],
                    "presence": "optional",
                  },
                  "metas": Array [
                    Object {
                      "x-oas-optional": true,
                    },
                  ],
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "type": Object {
                  "allow": Array [
                    "custom",
                  ],
                  "flags": Object {
                    "error": [Function],
                    "only": true,
                  },
                  "type": "any",
                },
              },
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "type": "object",
            },
            "metric": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "threshold": Object {
              "flags": Object {
                "error": [Function],
              },
              "items": Array [
                Object {
                  "flags": Object {
                    "error": [Function],
                    "presence": "optional",
                  },
                  "type": "number",
                },
              ],
              "type": "array",
            },
            "timeSize": Object {
              "flags": Object {
                "error": [Function],
              },
              "type": "number",
            },
            "timeUnit": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "warningComparator": Object {
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "presence": "optional",
              },
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "warningThreshold": Object {
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "presence": "optional",
              },
              "items": Array [
                Object {
                  "flags": Object {
                    "error": [Function],
                    "presence": "optional",
                  },
                  "type": "number",
                },
              ],
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "type": "array",
            },
          },
          "type": "object",
        },
      ],
      "type": "array",
    },
    "filterQuery": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "nodeType": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "sourceId": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "preferences": Object {
    "stripUnknown": Object {
      "objects": false,
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: observability.rules.custom_threshold 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
    "unknown": true,
  },
  "keys": Object {
    "alertOnGroupDisappear": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "alertOnNoData": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "boolean",
    },
    "criteria": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "aggType": Object {
              "allow": Array [
                "custom",
              ],
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "only": true,
                "presence": "optional",
              },
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "type": "any",
            },
            "comparator": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "equation": Object {
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "presence": "optional",
              },
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "label": Object {
              "flags": Object {
                "default": [Function],
                "error": [Function],
                "presence": "optional",
              },
              "metas": Array [
                Object {
                  "x-oas-optional": true,
                },
              ],
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "metric": Object {
              "flags": Object {
                "error": [Function],
                "presence": "forbidden",
              },
              "type": "any",
            },
            "metrics": Object {
              "flags": Object {
                "error": [Function],
              },
              "items": Array [
                Object {
                  "flags": Object {
                    "error": [Function],
                    "presence": "optional",
                  },
                  "matches": Array [
                    Object {
                      "schema": Object {
                        "flags": Object {
                          "default": Object {
                            "special": "deep",
                          },
                          "error": [Function],
                          "presence": "optional",
                        },
                        "keys": Object {
                          "aggType": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "field": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "filter": Object {
                            "flags": Object {
                              "error": [Function],
                              "presence": "forbidden",
                            },
                            "type": "any",
                          },
                          "name": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                        },
                        "type": "object",
                      },
                    },
                    Object {
                      "schema": Object {
                        "flags": Object {
                          "default": Object {
                            "special": "deep",
                          },
                          "error": [Function],
                          "presence": "optional",
                        },
                        "keys": Object {
                          "aggType": Object {
                            "allow": Array [
                              "count",
                            ],
                            "flags": Object {
                              "error": [Function],
                              "only": true,
                            },
                            "type": "any",
                          },
                          "field": Object {
                            "flags": Object {
                              "error": [Function],
                              "presence": "forbidden",
                            },
                            "type": "any",
                          },
                          "filter": Object {
                            "flags": Object {
                              "default": [Function],
                              "error": [Function],
                              "presence": "optional",
                            },
                            "metas": Array [
                              Object {
                                "x-oas-optional": true,
                              },
                            ],
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "name": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                        },
                        "type": "object",
                      },
                    },
                  ],
                  "type": "alternatives",
                },
              ],
              "type": "array",
            },
            "threshold": Object {
              "flags": Object {
                "error": [Function],
              },
              "items": Array [
                Object {
                  "flags": Object {
                    "error": [Function],
                    "presence": "optional",
                  },
                  "type": "number",
                },
              ],
              "type": "array",
            },
            "timeSize": Object {
              "flags": Object {
                "error": [Function],
              },
              "type": "number",
            },
            "timeUnit": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          },
          "type": "object",
        },
      ],
      "type": "array",
    },
    "groupBy": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "items": Array [
              Object {
                "flags": Object {
                  "error": [Function],
                  "presence": "optional",
                },
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            ],
            "type": "array",
          },
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "alternatives",
    },
    "searchConfiguration": Object {
      "flags": Object {
        "default": Object {
          "special": "deep",
        },
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "filter": Object {
          "flags": Object {
            "default": [Function],
            "error": [Function],
            "presence": "optional",
          },
          "items": Array [
            Object {
              "flags": Object {
                "default": Object {
                  "special": "deep",
                },
                "error": [Function],
                "presence": "optional",
              },
              "keys": Object {
                "meta": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "metas": Array [
                    Object {
                      "x-oas-get-additional-properties": [Function],
                    },
                  ],
                  "rules": Array [
                    Object {
                      "args": Object {
                        "key": Object {
                          "flags": Object {
                            "error": [Function],
                          },
                          "rules": Array [
                            Object {
                              "args": Object {
                                "method": [Function],
                              },
                              "name": "custom",
                            },
                          ],
                          "type": "string",
                        },
                        "value": Object {
                          "flags": Object {
                            "error": [Function],
                          },
                          "metas": Array [
                            Object {
                              "x-oas-any-type": true,
                            },
                          ],
                          "type": "any",
                        },
                      },
                      "name": "entries",
                    },
                  ],
                  "type": "record",
                },
                "query": Object {
                  "flags": Object {
                    "default": [Function],
                    "error": [Function],
                    "presence": "optional",
                  },
                  "metas": Array [
                    Object {
                      "x-oas-get-additional-properties": [Function],
                    },
                    Object {
                      "x-oas-optional": true,
                    },
                  ],
                  "rules": Array [
                    Object {
                      "args": Object {
                        "key": Object {
                          "flags": Object {
                            "error": [Function],
                          },
                          "rules": Array [
                            Object {
                              "args": Object {
                                "method": [Function],
                              },
                              "name": "custom",
                            },
                          ],
                          "type": "string",
                        },
                        "value": Object {
                          "flags": Object {
                            "error": [Function],
                          },
                          "metas": Array [
                            Object {
                              "x-oas-any-type": true,
                            },
                          ],
                          "type": "any",
                        },
                      },
                      "name": "entries",
                    },
                  ],
                  "type": "record",
                },
              },
              "type": "object",
            },
          ],
          "metas": Array [
            Object {
              "x-oas-optional": true,
            },
          ],
          "type": "array",
        },
        "index": Object {
          "flags": Object {
            "error": [Function],
          },
          "matches": Array [
            Object {
              "schema": Object {
                "flags": Object {
                  "error": [Function],
                },
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            },
            Object {
              "schema": Object {
                "flags": Object {
                  "default": Object {
                    "special": "deep",
                  },
                  "error": [Function],
                  "presence": "optional",
                },
                "keys": Object {
                  "allowHidden": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "type": "boolean",
                  },
                  "allowNoIndex": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "type": "boolean",
                  },
                  "fieldAttrs": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "default": Object {
                                "special": "deep",
                              },
                              "error": [Function],
                              "presence": "optional",
                            },
                            "keys": Object {
                              "count": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "number",
                              },
                              "customDescription": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-max-length": 300,
                                  },
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "customLabel": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                            },
                            "type": "object",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                  "fieldFormats": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "default": Object {
                                "special": "deep",
                              },
                              "error": [Function],
                              "presence": "optional",
                            },
                            "keys": Object {
                              "id": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "params": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-any-type": true,
                                  },
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "any",
                              },
                            },
                            "type": "object",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                  "fields": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "default": Object {
                                "special": "deep",
                              },
                              "error": [Function],
                              "presence": "optional",
                            },
                            "keys": Object {
                              "aggregatable": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "boolean",
                              },
                              "count": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "limit": 0,
                                    },
                                    "name": "min",
                                  },
                                ],
                                "type": "number",
                              },
                              "customDescription": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-max-length": 300,
                                  },
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "customLabel": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "esTypes": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "items": Array [
                                  Object {
                                    "flags": Object {
                                      "error": [Function],
                                      "presence": "optional",
                                    },
                                    "rules": Array [
                                      Object {
                                        "args": Object {
                                          "method": [Function],
                                        },
                                        "name": "custom",
                                      },
                                    ],
                                    "type": "string",
                                  },
                                ],
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "array",
                              },
                              "format": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "keys": Object {
                                  "id": Object {
                                    "flags": Object {
                                      "default": [Function],
                                      "error": [Function],
                                      "presence": "optional",
                                    },
                                    "metas": Array [
                                      Object {
                                        "x-oas-optional": true,
                                      },
                                    ],
                                    "rules": Array [
                                      Object {
                                        "args": Object {
                                          "method": [Function],
                                        },
                                        "name": "custom",
                                      },
                                    ],
                                    "type": "string",
                                  },
                                  "params": Object {
                                    "flags": Object {
                                      "default": [Function],
                                      "error": [Function],
                                      "presence": "optional",
                                    },
                                    "metas": Array [
                                      Object {
                                        "x-oas-any-type": true,
                                      },
                                      Object {
                                        "x-oas-optional": true,
                                      },
                                    ],
                                    "type": "any",
                                  },
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "object",
                              },
                              "name": Object {
                                "flags": Object {
                                  "error": [Function],
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-max-length": 1000,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "readFromDocValues": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "boolean",
                              },
                              "runtimeField": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "matches": Array [
                                  Object {
                                    "schema": Object {
                                      "flags": Object {
                                        "default": Object {
                                          "special": "deep",
                                        },
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "keys": Object {
                                        "customDescription": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-max-length": 300,
                                            },
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                          ],
                                          "type": "string",
                                        },
                                        "customLabel": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                          ],
                                          "type": "string",
                                        },
                                        "format": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "keys": Object {
                                            "id": Object {
                                              "flags": Object {
                                                "default": [Function],
                                                "error": [Function],
                                                "presence": "optional",
                                              },
                                              "metas": Array [
                                                Object {
                                                  "x-oas-optional": true,
                                                },
                                              ],
                                              "rules": Array [
                                                Object {
                                                  "args": Object {
                                                    "method": [Function],
                                                  },
                                                  "name": "custom",
                                                },
                                              ],
                                              "type": "string",
                                            },
                                            "params": Object {
                                              "flags": Object {
                                                "default": [Function],
                                                "error": [Function],
                                                "presence": "optional",
                                              },
                                              "metas": Array [
                                                Object {
                                                  "x-oas-any-type": true,
                                                },
                                                Object {
                                                  "x-oas-optional": true,
                                                },
                                              ],
                                              "type": "any",
                                            },
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "type": "object",
                                        },
                                        "popularity": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "limit": 0,
                                              },
                                              "name": "min",
                                            },
                                          ],
                                          "type": "number",
                                        },
                                        "script": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "keys": Object {
                                            "source": Object {
                                              "flags": Object {
                                                "error": [Function],
                                              },
                                              "rules": Array [
                                                Object {
                                                  "args": Object {
                                                    "method": [Function],
                                                  },
                                                  "name": "custom",
                                                },
                                              ],
                                              "type": "string",
                                            },
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "type": "object",
                                        },
                                        "type": Object {
                                          "flags": Object {
                                            "error": [Function],
                                          },
                                          "matches": Array [
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "keyword",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "long",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "double",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "date",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "ip",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "boolean",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                            Object {
                                              "schema": Object {
                                                "allow": Array [
                                                  "geo_point",
                                                ],
                                                "flags": Object {
                                                  "error": [Function],
                                                  "only": true,
                                                },
                                                "type": "any",
                                              },
                                            },
                                          ],
                                          "type": "alternatives",
                                        },
                                      },
                                      "type": "object",
                                    },
                                  },
                                  Object {
                                    "schema": Object {
                                      "flags": Object {
                                        "default": Object {
                                          "special": "deep",
                                        },
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "keys": Object {
                                        "fields": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-get-additional-properties": [Function],
                                            },
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "key": Object {
                                                  "flags": Object {
                                                    "error": [Function],
                                                  },
                                                  "rules": Array [
                                                    Object {
                                                      "args": Object {
                                                        "method": [Function],
                                                      },
                                                      "name": "custom",
                                                    },
                                                  ],
                                                  "type": "string",
                                                },
                                                "value": Object {
                                                  "flags": Object {
                                                    "default": Object {
                                                      "special": "deep",
                                                    },
                                                    "error": [Function],
                                                    "presence": "optional",
                                                  },
                                                  "keys": Object {
                                                    "customDescription": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-max-length": 300,
                                                        },
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "rules": Array [
                                                        Object {
                                                          "args": Object {
                                                            "method": [Function],
                                                          },
                                                          "name": "custom",
                                                        },
                                                        Object {
                                                          "args": Object {
                                                            "method": [Function],
                                                          },
                                                          "name": "custom",
                                                        },
                                                      ],
                                                      "type": "string",
                                                    },
                                                    "customLabel": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "rules": Array [
                                                        Object {
                                                          "args": Object {
                                                            "method": [Function],
                                                          },
                                                          "name": "custom",
                                                        },
                                                      ],
                                                      "type": "string",
                                                    },
                                                    "format": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "keys": Object {
                                                        "id": Object {
                                                          "flags": Object {
                                                            "default": [Function],
                                                            "error": [Function],
                                                            "presence": "optional",
                                                          },
                                                          "metas": Array [
                                                            Object {
                                                              "x-oas-optional": true,
                                                            },
                                                          ],
                                                          "rules": Array [
                                                            Object {
                                                              "args": Object {
                                                                "method": [Function],
                                                              },
                                                              "name": "custom",
                                                            },
                                                          ],
                                                          "type": "string",
                                                        },
                                                        "params": Object {
                                                          "flags": Object {
                                                            "default": [Function],
                                                            "error": [Function],
                                                            "presence": "optional",
                                                          },
                                                          "metas": Array [
                                                            Object {
                                                              "x-oas-any-type": true,
                                                            },
                                                            Object {
                                                              "x-oas-optional": true,
                                                            },
                                                          ],
                                                          "type": "any",
                                                        },
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "type": "object",
                                                    },
                                                    "popularity": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "rules": Array [
                                                        Object {
                                                          "args": Object {
                                                            "limit": 0,
                                                          },
                                                          "name": "min",
                                                        },
                                                      ],
                                                      "type": "number",
                                                    },
                                                    "type": Object {
                                                      "flags": Object {
                                                        "error": [Function],
                                                      },
                                                      "matches": Array [
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "keyword",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "long",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "double",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "date",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "ip",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "boolean",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                        Object {
                                                          "schema": Object {
                                                            "allow": Array [
                                                              "geo_point",
                                                            ],
                                                            "flags": Object {
                                                              "error": [Function],
                                                              "only": true,
                                                            },
                                                            "type": "any",
                                                          },
                                                        },
                                                      ],
                                                      "type": "alternatives",
                                                    },
                                                  },
                                                  "type": "object",
                                                },
                                              },
                                              "name": "entries",
                                            },
                                          ],
                                          "type": "record",
                                        },
                                        "script": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "keys": Object {
                                            "source": Object {
                                              "flags": Object {
                                                "error": [Function],
                                              },
                                              "rules": Array [
                                                Object {
                                                  "args": Object {
                                                    "method": [Function],
                                                  },
                                                  "name": "custom",
                                                },
                                              ],
                                              "type": "string",
                                            },
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "type": "object",
                                        },
                                        "type": Object {
                                          "allow": Array [
                                            "composite",
                                          ],
                                          "flags": Object {
                                            "error": [Function],
                                            "only": true,
                                          },
                                          "type": "any",
                                        },
                                      },
                                      "type": "object",
                                    },
                                  },
                                ],
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "alternatives",
                              },
                              "script": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-max-length": 1000000,
                                  },
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                              "scripted": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "boolean",
                              },
                              "searchable": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "boolean",
                              },
                              "shortDotsEnable": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "boolean",
                              },
                              "subType": Object {
                                "flags": Object {
                                  "default": [Function],
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "keys": Object {
                                  "multi": Object {
                                    "flags": Object {
                                      "default": [Function],
                                      "error": [Function],
                                      "presence": "optional",
                                    },
                                    "keys": Object {
                                      "parent": Object {
                                        "flags": Object {
                                          "error": [Function],
                                        },
                                        "rules": Array [
                                          Object {
                                            "args": Object {
                                              "method": [Function],
                                            },
                                            "name": "custom",
                                          },
                                        ],
                                        "type": "string",
                                      },
                                    },
                                    "metas": Array [
                                      Object {
                                        "x-oas-optional": true,
                                      },
                                    ],
                                    "type": "object",
                                  },
                                  "nested": Object {
                                    "flags": Object {
                                      "default": [Function],
                                      "error": [Function],
                                      "presence": "optional",
                                    },
                                    "keys": Object {
                                      "path": Object {
                                        "flags": Object {
                                          "error": [Function],
                                        },
                                        "rules": Array [
                                          Object {
                                            "args": Object {
                                              "method": [Function],
                                            },
                                            "name": "custom",
                                          },
                                        ],
                                        "type": "string",
                                      },
                                    },
                                    "metas": Array [
                                      Object {
                                        "x-oas-optional": true,
                                      },
                                    ],
                                    "type": "object",
                                  },
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-optional": true,
                                  },
                                ],
                                "type": "object",
                              },
                              "type": Object {
                                "flags": Object {
                                  "default": "string",
                                  "error": [Function],
                                  "presence": "optional",
                                },
                                "metas": Array [
                                  Object {
                                    "x-oas-max-length": 1000,
                                  },
                                ],
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                            },
                            "preferences": Object {
                              "stripUnknown": Object {
                                "objects": true,
                              },
                            },
                            "type": "object",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                  "id": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                  "name": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                  "namespaces": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "items": Array [
                      Object {
                        "flags": Object {
                          "error": [Function],
                          "presence": "optional",
                        },
                        "rules": Array [
                          Object {
                            "args": Object {
                              "method": [Function],
                            },
                            "name": "custom",
                          },
                        ],
                        "type": "string",
                      },
                    ],
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "type": "array",
                  },
                  "runtimeFieldMap": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-get-additional-properties": [Function],
                      },
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "key": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                          "value": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "matches": Array [
                              Object {
                                "schema": Object {
                                  "flags": Object {
                                    "default": Object {
                                      "special": "deep",
                                    },
                                    "error": [Function],
                                    "presence": "optional",
                                  },
                                  "keys": Object {
                                    "customDescription": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-max-length": 300,
                                        },
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "rules": Array [
                                        Object {
                                          "args": Object {
                                            "method": [Function],
                                          },
                                          "name": "custom",
                                        },
                                        Object {
                                          "args": Object {
                                            "method": [Function],
                                          },
                                          "name": "custom",
                                        },
                                      ],
                                      "type": "string",
                                    },
                                    "customLabel": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "rules": Array [
                                        Object {
                                          "args": Object {
                                            "method": [Function],
                                          },
                                          "name": "custom",
                                        },
                                      ],
                                      "type": "string",
                                    },
                                    "format": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "keys": Object {
                                        "id": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                          ],
                                          "type": "string",
                                        },
                                        "params": Object {
                                          "flags": Object {
                                            "default": [Function],
                                            "error": [Function],
                                            "presence": "optional",
                                          },
                                          "metas": Array [
                                            Object {
                                              "x-oas-any-type": true,
                                            },
                                            Object {
                                              "x-oas-optional": true,
                                            },
                                          ],
                                          "type": "any",
                                        },
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "type": "object",
                                    },
                                    "popularity": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "rules": Array [
                                        Object {
                                          "args": Object {
                                            "limit": 0,
                                          },
                                          "name": "min",
                                        },
                                      ],
                                      "type": "number",
                                    },
                                    "script": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "keys": Object {
                                        "source": Object {
                                          "flags": Object {
                                            "error": [Function],
                                          },
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                          ],
                                          "type": "string",
                                        },
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "type": "object",
                                    },
                                    "type": Object {
                                      "flags": Object {
                                        "error": [Function],
                                      },
                                      "matches": Array [
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "keyword",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "long",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "double",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "date",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "ip",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "boolean",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                        Object {
                                          "schema": Object {
                                            "allow": Array [
                                              "geo_point",
                                            ],
                                            "flags": Object {
                                              "error": [Function],
                                              "only": true,
                                            },
                                            "type": "any",
                                          },
                                        },
                                      ],
                                      "type": "alternatives",
                                    },
                                  },
                                  "type": "object",
                                },
                              },
                              Object {
                                "schema": Object {
                                  "flags": Object {
                                    "default": Object {
                                      "special": "deep",
                                    },
                                    "error": [Function],
                                    "presence": "optional",
                                  },
                                  "keys": Object {
                                    "fields": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-get-additional-properties": [Function],
                                        },
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "rules": Array [
                                        Object {
                                          "args": Object {
                                            "key": Object {
                                              "flags": Object {
                                                "error": [Function],
                                              },
                                              "rules": Array [
                                                Object {
                                                  "args": Object {
                                                    "method": [Function],
                                                  },
                                                  "name": "custom",
                                                },
                                              ],
                                              "type": "string",
                                            },
                                            "value": Object {
                                              "flags": Object {
                                                "default": Object {
                                                  "special": "deep",
                                                },
                                                "error": [Function],
                                                "presence": "optional",
                                              },
                                              "keys": Object {
                                                "customDescription": Object {
                                                  "flags": Object {
                                                    "default": [Function],
                                                    "error": [Function],
                                                    "presence": "optional",
                                                  },
                                                  "metas": Array [
                                                    Object {
                                                      "x-oas-max-length": 300,
                                                    },
                                                    Object {
                                                      "x-oas-optional": true,
                                                    },
                                                  ],
                                                  "rules": Array [
                                                    Object {
                                                      "args": Object {
                                                        "method": [Function],
                                                      },
                                                      "name": "custom",
                                                    },
                                                    Object {
                                                      "args": Object {
                                                        "method": [Function],
                                                      },
                                                      "name": "custom",
                                                    },
                                                  ],
                                                  "type": "string",
                                                },
                                                "customLabel": Object {
                                                  "flags": Object {
                                                    "default": [Function],
                                                    "error": [Function],
                                                    "presence": "optional",
                                                  },
                                                  "metas": Array [
                                                    Object {
                                                      "x-oas-optional": true,
                                                    },
                                                  ],
                                                  "rules": Array [
                                                    Object {
                                                      "args": Object {
                                                        "method": [Function],
                                                      },
                                                      "name": "custom",
                                                    },
                                                  ],
                                                  "type": "string",
                                                },
                                                "format": Object {
                                                  "flags": Object {
                                                    "default": [Function],
                                                    "error": [Function],
                                                    "presence": "optional",
                                                  },
                                                  "keys": Object {
                                                    "id": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "rules": Array [
                                                        Object {
                                                          "args": Object {
                                                            "method": [Function],
                                                          },
                                                          "name": "custom",
                                                        },
                                                      ],
                                                      "type": "string",
                                                    },
                                                    "params": Object {
                                                      "flags": Object {
                                                        "default": [Function],
                                                        "error": [Function],
                                                        "presence": "optional",
                                                      },
                                                      "metas": Array [
                                                        Object {
                                                          "x-oas-any-type": true,
                                                        },
                                                        Object {
                                                          "x-oas-optional": true,
                                                        },
                                                      ],
                                                      "type": "any",
                                                    },
                                                  },
                                                  "metas": Array [
                                                    Object {
                                                      "x-oas-optional": true,
                                                    },
                                                  ],
                                                  "type": "object",
                                                },
                                                "popularity": Object {
                                                  "flags": Object {
                                                    "default": [Function],
                                                    "error": [Function],
                                                    "presence": "optional",
                                                  },
                                                  "metas": Array [
                                                    Object {
                                                      "x-oas-optional": true,
                                                    },
                                                  ],
                                                  "rules": Array [
                                                    Object {
                                                      "args": Object {
                                                        "limit": 0,
                                                      },
                                                      "name": "min",
                                                    },
                                                  ],
                                                  "type": "number",
                                                },
                                                "type": Object {
                                                  "flags": Object {
                                                    "error": [Function],
                                                  },
                                                  "matches": Array [
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "keyword",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "long",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "double",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "date",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "ip",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "boolean",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                    Object {
                                                      "schema": Object {
                                                        "allow": Array [
                                                          "geo_point",
                                                        ],
                                                        "flags": Object {
                                                          "error": [Function],
                                                          "only": true,
                                                        },
                                                        "type": "any",
                                                      },
                                                    },
                                                  ],
                                                  "type": "alternatives",
                                                },
                                              },
                                              "type": "object",
                                            },
                                          },
                                          "name": "entries",
                                        },
                                      ],
                                      "type": "record",
                                    },
                                    "script": Object {
                                      "flags": Object {
                                        "default": [Function],
                                        "error": [Function],
                                        "presence": "optional",
                                      },
                                      "keys": Object {
                                        "source": Object {
                                          "flags": Object {
                                            "error": [Function],
                                          },
                                          "rules": Array [
                                            Object {
                                              "args": Object {
                                                "method": [Function],
                                              },
                                              "name": "custom",
                                            },
                                          ],
                                          "type": "string",
                                        },
                                      },
                                      "metas": Array [
                                        Object {
                                          "x-oas-optional": true,
                                        },
                                      ],
                                      "type": "object",
                                    },
                                    "type": Object {
                                      "allow": Array [
                                        "composite",
                                      ],
                                      "flags": Object {
                                        "error": [Function],
                                        "only": true,
                                      },
                                      "type": "any",
                                    },
                                  },
                                  "type": "object",
                                },
                              },
                            ],
                            "type": "alternatives",
                          },
                        },
                        "name": "entries",
                      },
                    ],
                    "type": "record",
                  },
                  "sourceFilters": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "items": Array [
                      Object {
                        "flags": Object {
                          "default": Object {
                            "special": "deep",
                          },
                          "error": [Function],
                          "presence": "optional",
                        },
                        "keys": Object {
                          "clientId": Object {
                            "flags": Object {
                              "default": [Function],
                              "error": [Function],
                              "presence": "optional",
                            },
                            "matches": Array [
                              Object {
                                "schema": Object {
                                  "flags": Object {
                                    "error": [Function],
                                  },
                                  "rules": Array [
                                    Object {
                                      "args": Object {
                                        "method": [Function],
                                      },
                                      "name": "custom",
                                    },
                                  ],
                                  "type": "string",
                                },
                              },
                              Object {
                                "schema": Object {
                                  "flags": Object {
                                    "error": [Function],
                                  },
                                  "type": "number",
                                },
                              },
                            ],
                            "metas": Array [
                              Object {
                                "x-oas-optional": true,
                              },
                            ],
                            "type": "alternatives",
                          },
                          "value": Object {
                            "flags": Object {
                              "error": [Function],
                            },
                            "rules": Array [
                              Object {
                                "args": Object {
                                  "method": [Function],
                                },
                                "name": "custom",
                              },
                            ],
                            "type": "string",
                          },
                        },
                        "type": "object",
                      },
                    ],
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "type": "array",
                  },
                  "timeFieldName": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                  "title": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                  "type": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                  "typeMeta": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                      "unknown": true,
                    },
                    "keys": Object {},
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "preferences": Object {
                      "stripUnknown": Object {
                        "objects": false,
                      },
                    },
                    "type": "object",
                  },
                  "version": Object {
                    "flags": Object {
                      "default": [Function],
                      "error": [Function],
                      "presence": "optional",
                    },
                    "metas": Array [
                      Object {
                        "x-oas-optional": true,
                      },
                    ],
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                },
                "type": "object",
              },
            },
          ],
          "type": "alternatives",
        },
        "query": Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "language": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "query": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          },
          "type": "object",
        },
      },
      "type": "object",
    },
  },
  "preferences": Object {
    "stripUnknown": Object {
      "objects": false,
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.eqlRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "properties": Object {
        "alertSuppression": Object {
          "additionalProperties": false,
          "properties": Object {
            "duration": Object {
              "additionalProperties": false,
              "properties": Object {
                "unit": Object {
                  "enum": Array [
                    "s",
                    "m",
                    "h",
                  ],
                  "type": "string",
                },
                "value": Object {
                  "minimum": 1,
                  "type": "integer",
                },
              },
              "required": Array [
                "value",
                "unit",
              ],
              "type": "object",
            },
            "groupBy": Object {
              "items": Object {
                "type": "string",
              },
              "maxItems": 3,
              "minItems": 1,
              "type": "array",
            },
            "missingFieldsStrategy": Object {
              "enum": Array [
                "doNotSuppress",
                "suppress",
              ],
              "type": "string",
            },
          },
          "required": Array [
            "groupBy",
          ],
          "type": "object",
        },
        "dataViewId": Object {
          "type": "string",
        },
        "eventCategoryOverride": Object {
          "type": "string",
        },
        "filters": Object {
          "items": Object {},
          "type": "array",
        },
        "index": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "language": Object {
          "const": "eql",
          "type": "string",
        },
        "query": Object {
          "type": "string",
        },
        "responseActions": Object {
          "items": Object {
            "anyOf": Array [
              Object {
                "additionalProperties": false,
                "properties": Object {
                  "actionTypeId": Object {
                    "const": ".osquery",
                    "type": "string",
                  },
                  "params": Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "ecsMapping": Object {
                        "additionalProperties": Object {
                          "additionalProperties": false,
                          "properties": Object {
                            "field": Object {
                              "type": "string",
                            },
                            "value": Object {
                              "anyOf": Array [
                                Object {
                                  "type": "string",
                                },
                                Object {
                                  "items": Object {
                                    "type": "string",
                                  },
                                  "type": "array",
                                },
                              ],
                            },
                          },
                          "type": "object",
                        },
                        "properties": Object {},
                        "type": "object",
                      },
                      "packId": Object {
                        "type": "string",
                      },
                      "queries": Object {
                        "items": Object {
                          "additionalProperties": false,
                          "properties": Object {
                            "ecs_mapping": Object {
                              "$ref": "#/allOf/1/properties/responseActions/items/anyOf/0/properties/params/properties/ecsMapping",
                            },
                            "id": Object {
                              "type": "string",
                            },
                            "platform": Object {
                              "type": "string",
                            },
                            "query": Object {
                              "type": "string",
                            },
                            "removed": Object {
                              "type": "boolean",
                            },
                            "snapshot": Object {
                              "type": "boolean",
                            },
                            "version": Object {
                              "type": "string",
                            },
                          },
                          "required": Array [
                            "id",
                            "query",
                          ],
                          "type": "object",
                        },
                        "type": "array",
                      },
                      "query": Object {
                        "type": "string",
                      },
                      "savedQueryId": Object {
                        "type": "string",
                      },
                      "timeout": Object {
                        "type": "number",
                      },
                    },
                    "type": "object",
                  },
                },
                "required": Array [
                  "actionTypeId",
                  "params",
                ],
                "type": "object",
              },
              Object {
                "additionalProperties": false,
                "properties": Object {
                  "actionTypeId": Object {
                    "const": ".endpoint",
                    "type": "string",
                  },
                  "params": Object {
                    "anyOf": Array [
                      Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "command": Object {
                            "const": "isolate",
                            "type": "string",
                          },
                          "comment": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "command",
                        ],
                        "type": "object",
                      },
                      Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "command": Object {
                            "enum": Array [
                              "kill-process",
                              "suspend-process",
                            ],
                            "type": "string",
                          },
                          "comment": Object {
                            "type": "string",
                          },
                          "config": Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "field": Object {
                                "type": "string",
                              },
                              "overwrite": Object {
                                "default": true,
                                "type": "boolean",
                              },
                            },
                            "required": Array [
                              "field",
                            ],
                            "type": "object",
                          },
                        },
                        "required": Array [
                          "command",
                          "config",
                        ],
                        "type": "object",
                      },
                    ],
                  },
                },
                "required": Array [
                  "actionTypeId",
                  "params",
                ],
                "type": "object",
              },
            ],
          },
          "type": "array",
        },
        "tiebreakerField": Object {
          "type": "string",
        },
        "timestampField": Object {
          "type": "string",
        },
        "type": Object {
          "const": "eql",
          "type": "string",
        },
      },
      "required": Array [
        "type",
        "language",
        "query",
      ],
      "type": "object",
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.indicatorRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "properties": Object {
        "alertSuppression": Object {
          "additionalProperties": false,
          "properties": Object {
            "duration": Object {
              "additionalProperties": false,
              "properties": Object {
                "unit": Object {
                  "enum": Array [
                    "s",
                    "m",
                    "h",
                  ],
                  "type": "string",
                },
                "value": Object {
                  "minimum": 1,
                  "type": "integer",
                },
              },
              "required": Array [
                "value",
                "unit",
              ],
              "type": "object",
            },
            "groupBy": Object {
              "items": Object {
                "type": "string",
              },
              "maxItems": 3,
              "minItems": 1,
              "type": "array",
            },
            "missingFieldsStrategy": Object {
              "enum": Array [
                "doNotSuppress",
                "suppress",
              ],
              "type": "string",
            },
          },
          "required": Array [
            "groupBy",
          ],
          "type": "object",
        },
        "concurrentSearches": Object {
          "minimum": 1,
          "type": "integer",
        },
        "dataViewId": Object {
          "type": "string",
        },
        "filters": Object {
          "items": Object {},
          "type": "array",
        },
        "index": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "itemsPerSearch": Object {
          "minimum": 1,
          "type": "integer",
        },
        "language": Object {
          "enum": Array [
            "kuery",
            "lucene",
          ],
          "type": "string",
        },
        "query": Object {
          "type": "string",
        },
        "savedId": Object {
          "type": "string",
        },
        "threatFilters": Object {
          "$ref": "#/allOf/1/properties/filters",
        },
        "threatIndex": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "threatIndicatorPath": Object {
          "type": "string",
        },
        "threatLanguage": Object {
          "$ref": "#/allOf/1/properties/language",
        },
        "threatMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "entries": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "field": Object {
                      "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
                    },
                    "type": Object {
                      "const": "mapping",
                      "type": "string",
                    },
                    "value": Object {
                      "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
                    },
                  },
                  "required": Array [
                    "field",
                    "type",
                    "value",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "entries",
            ],
            "type": "object",
          },
          "minItems": 1,
          "type": "array",
        },
        "threatQuery": Object {
          "type": "string",
        },
        "type": Object {
          "const": "threat_match",
          "type": "string",
        },
      },
      "required": Array [
        "type",
        "language",
        "query",
        "threatQuery",
        "threatMapping",
        "threatIndex",
      ],
      "type": "object",
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.mlRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "properties": Object {
        "alertSuppression": Object {
          "additionalProperties": false,
          "properties": Object {
            "duration": Object {
              "additionalProperties": false,
              "properties": Object {
                "unit": Object {
                  "enum": Array [
                    "s",
                    "m",
                    "h",
                  ],
                  "type": "string",
                },
                "value": Object {
                  "minimum": 1,
                  "type": "integer",
                },
              },
              "required": Array [
                "value",
                "unit",
              ],
              "type": "object",
            },
            "groupBy": Object {
              "items": Object {
                "type": "string",
              },
              "maxItems": 3,
              "minItems": 1,
              "type": "array",
            },
            "missingFieldsStrategy": Object {
              "enum": Array [
                "doNotSuppress",
                "suppress",
              ],
              "type": "string",
            },
          },
          "required": Array [
            "groupBy",
          ],
          "type": "object",
        },
        "anomalyThreshold": Object {
          "minimum": 0,
          "type": "integer",
        },
        "machineLearningJobId": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "type": Object {
          "const": "machine_learning",
          "type": "string",
        },
      },
      "required": Array [
        "type",
        "anomalyThreshold",
        "machineLearningJobId",
      ],
      "type": "object",
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.newTermsRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "properties": Object {
        "alertSuppression": Object {
          "additionalProperties": false,
          "properties": Object {
            "duration": Object {
              "additionalProperties": false,
              "properties": Object {
                "unit": Object {
                  "enum": Array [
                    "s",
                    "m",
                    "h",
                  ],
                  "type": "string",
                },
                "value": Object {
                  "minimum": 1,
                  "type": "integer",
                },
              },
              "required": Array [
                "value",
                "unit",
              ],
              "type": "object",
            },
            "groupBy": Object {
              "items": Object {
                "type": "string",
              },
              "maxItems": 3,
              "minItems": 1,
              "type": "array",
            },
            "missingFieldsStrategy": Object {
              "enum": Array [
                "doNotSuppress",
                "suppress",
              ],
              "type": "string",
            },
          },
          "required": Array [
            "groupBy",
          ],
          "type": "object",
        },
        "dataViewId": Object {
          "type": "string",
        },
        "filters": Object {
          "items": Object {},
          "type": "array",
        },
        "historyWindowStart": Object {
          "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
        },
        "index": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "language": Object {
          "enum": Array [
            "kuery",
            "lucene",
          ],
          "type": "string",
        },
        "newTermsFields": Object {
          "items": Object {
            "type": "string",
          },
          "maxItems": 3,
          "minItems": 1,
          "type": "array",
        },
        "query": Object {
          "type": "string",
        },
        "responseActions": Object {
          "items": Object {
            "anyOf": Array [
              Object {
                "additionalProperties": false,
                "properties": Object {
                  "actionTypeId": Object {
                    "const": ".osquery",
                    "type": "string",
                  },
                  "params": Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "ecsMapping": Object {
                        "additionalProperties": Object {
                          "additionalProperties": false,
                          "properties": Object {
                            "field": Object {
                              "type": "string",
                            },
                            "value": Object {
                              "anyOf": Array [
                                Object {
                                  "type": "string",
                                },
                                Object {
                                  "items": Object {
                                    "type": "string",
                                  },
                                  "type": "array",
                                },
                              ],
                            },
                          },
                          "type": "object",
                        },
                        "properties": Object {},
                        "type": "object",
                      },
                      "packId": Object {
                        "type": "string",
                      },
                      "queries": Object {
                        "items": Object {
                          "additionalProperties": false,
                          "properties": Object {
                            "ecs_mapping": Object {
                              "$ref": "#/allOf/1/properties/responseActions/items/anyOf/0/properties/params/properties/ecsMapping",
                            },
                            "id": Object {
                              "type": "string",
                            },
                            "platform": Object {
                              "type": "string",
                            },
                            "query": Object {
                              "type": "string",
                            },
                            "removed": Object {
                              "type": "boolean",
                            },
                            "snapshot": Object {
                              "type": "boolean",
                            },
                            "version": Object {
                              "type": "string",
                            },
                          },
                          "required": Array [
                            "id",
                            "query",
                          ],
                          "type": "object",
                        },
                        "type": "array",
                      },
                      "query": Object {
                        "type": "string",
                      },
                      "savedQueryId": Object {
                        "type": "string",
                      },
                      "timeout": Object {
                        "type": "number",
                      },
                    },
                    "type": "object",
                  },
                },
                "required": Array [
                  "actionTypeId",
                  "params",
                ],
                "type": "object",
              },
              Object {
                "additionalProperties": false,
                "properties": Object {
                  "actionTypeId": Object {
                    "const": ".endpoint",
                    "type": "string",
                  },
                  "params": Object {
                    "anyOf": Array [
                      Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "command": Object {
                            "const": "isolate",
                            "type": "string",
                          },
                          "comment": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "command",
                        ],
                        "type": "object",
                      },
                      Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "command": Object {
                            "enum": Array [
                              "kill-process",
                              "suspend-process",
                            ],
                            "type": "string",
                          },
                          "comment": Object {
                            "type": "string",
                          },
                          "config": Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "field": Object {
                                "type": "string",
                              },
                              "overwrite": Object {
                                "default": true,
                                "type": "boolean",
                              },
                            },
                            "required": Array [
                              "field",
                            ],
                            "type": "object",
                          },
                        },
                        "required": Array [
                          "command",
                          "config",
                        ],
                        "type": "object",
                      },
                    ],
                  },
                },
                "required": Array [
                  "actionTypeId",
                  "params",
                ],
                "type": "object",
              },
            ],
          },
          "type": "array",
        },
        "type": Object {
          "const": "new_terms",
          "type": "string",
        },
      },
      "required": Array [
        "type",
        "query",
        "newTermsFields",
        "historyWindowStart",
        "language",
      ],
      "type": "object",
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.notifications 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "ruleAlertId": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.queryRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "anyOf": Array [
        Object {
          "additionalProperties": false,
          "properties": Object {
            "alertSuppression": Object {
              "additionalProperties": false,
              "properties": Object {
                "duration": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "unit": Object {
                      "enum": Array [
                        "s",
                        "m",
                        "h",
                      ],
                      "type": "string",
                    },
                    "value": Object {
                      "minimum": 1,
                      "type": "integer",
                    },
                  },
                  "required": Array [
                    "value",
                    "unit",
                  ],
                  "type": "object",
                },
                "groupBy": Object {
                  "items": Object {
                    "type": "string",
                  },
                  "maxItems": 3,
                  "minItems": 1,
                  "type": "array",
                },
                "missingFieldsStrategy": Object {
                  "enum": Array [
                    "doNotSuppress",
                    "suppress",
                  ],
                  "type": "string",
                },
              },
              "required": Array [
                "groupBy",
              ],
              "type": "object",
            },
            "dataViewId": Object {
              "type": "string",
            },
            "filters": Object {
              "items": Object {},
              "type": "array",
            },
            "index": Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
            "language": Object {
              "enum": Array [
                "kuery",
                "lucene",
              ],
              "type": "string",
            },
            "query": Object {
              "type": "string",
            },
            "responseActions": Object {
              "items": Object {
                "anyOf": Array [
                  Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "actionTypeId": Object {
                        "const": ".osquery",
                        "type": "string",
                      },
                      "params": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "ecsMapping": Object {
                            "additionalProperties": Object {
                              "additionalProperties": false,
                              "properties": Object {
                                "field": Object {
                                  "type": "string",
                                },
                                "value": Object {
                                  "anyOf": Array [
                                    Object {
                                      "type": "string",
                                    },
                                    Object {
                                      "items": Object {
                                        "type": "string",
                                      },
                                      "type": "array",
                                    },
                                  ],
                                },
                              },
                              "type": "object",
                            },
                            "properties": Object {},
                            "type": "object",
                          },
                          "packId": Object {
                            "type": "string",
                          },
                          "queries": Object {
                            "items": Object {
                              "additionalProperties": false,
                              "properties": Object {
                                "ecs_mapping": Object {
                                  "$ref": "#/allOf/1/anyOf/0/properties/responseActions/items/anyOf/0/properties/params/properties/ecsMapping",
                                },
                                "id": Object {
                                  "type": "string",
                                },
                                "platform": Object {
                                  "type": "string",
                                },
                                "query": Object {
                                  "type": "string",
                                },
                                "removed": Object {
                                  "type": "boolean",
                                },
                                "snapshot": Object {
                                  "type": "boolean",
                                },
                                "version": Object {
                                  "type": "string",
                                },
                              },
                              "required": Array [
                                "id",
                                "query",
                              ],
                              "type": "object",
                            },
                            "type": "array",
                          },
                          "query": Object {
                            "type": "string",
                          },
                          "savedQueryId": Object {
                            "type": "string",
                          },
                          "timeout": Object {
                            "type": "number",
                          },
                        },
                        "type": "object",
                      },
                    },
                    "required": Array [
                      "actionTypeId",
                      "params",
                    ],
                    "type": "object",
                  },
                  Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "actionTypeId": Object {
                        "const": ".endpoint",
                        "type": "string",
                      },
                      "params": Object {
                        "anyOf": Array [
                          Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "command": Object {
                                "const": "isolate",
                                "type": "string",
                              },
                              "comment": Object {
                                "type": "string",
                              },
                            },
                            "required": Array [
                              "command",
                            ],
                            "type": "object",
                          },
                          Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "command": Object {
                                "enum": Array [
                                  "kill-process",
                                  "suspend-process",
                                ],
                                "type": "string",
                              },
                              "comment": Object {
                                "type": "string",
                              },
                              "config": Object {
                                "additionalProperties": false,
                                "properties": Object {
                                  "field": Object {
                                    "type": "string",
                                  },
                                  "overwrite": Object {
                                    "default": true,
                                    "type": "boolean",
                                  },
                                },
                                "required": Array [
                                  "field",
                                ],
                                "type": "object",
                              },
                            },
                            "required": Array [
                              "command",
                              "config",
                            ],
                            "type": "object",
                          },
                        ],
                      },
                    },
                    "required": Array [
                      "actionTypeId",
                      "params",
                    ],
                    "type": "object",
                  },
                ],
              },
              "type": "array",
            },
            "savedId": Object {
              "type": "string",
            },
            "type": Object {
              "const": "query",
              "type": "string",
            },
          },
          "required": Array [
            "type",
            "language",
            "query",
          ],
          "type": "object",
        },
        Object {
          "additionalProperties": false,
          "properties": Object {
            "alertSuppression": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/alertSuppression",
            },
            "dataViewId": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/dataViewId",
            },
            "filters": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/filters",
            },
            "index": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/index",
            },
            "language": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/language",
            },
            "query": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/query",
            },
            "responseActions": Object {
              "items": Object {
                "$ref": "#/allOf/1/anyOf/0/properties/responseActions/items",
              },
              "type": "array",
            },
            "savedId": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/savedId",
            },
            "type": Object {
              "const": "saved_query",
              "type": "string",
            },
          },
          "required": Array [
            "type",
            "language",
            "savedId",
          ],
          "type": "object",
        },
      ],
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.savedQueryRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "anyOf": Array [
        Object {
          "additionalProperties": false,
          "properties": Object {
            "alertSuppression": Object {
              "additionalProperties": false,
              "properties": Object {
                "duration": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "unit": Object {
                      "enum": Array [
                        "s",
                        "m",
                        "h",
                      ],
                      "type": "string",
                    },
                    "value": Object {
                      "minimum": 1,
                      "type": "integer",
                    },
                  },
                  "required": Array [
                    "value",
                    "unit",
                  ],
                  "type": "object",
                },
                "groupBy": Object {
                  "items": Object {
                    "type": "string",
                  },
                  "maxItems": 3,
                  "minItems": 1,
                  "type": "array",
                },
                "missingFieldsStrategy": Object {
                  "enum": Array [
                    "doNotSuppress",
                    "suppress",
                  ],
                  "type": "string",
                },
              },
              "required": Array [
                "groupBy",
              ],
              "type": "object",
            },
            "dataViewId": Object {
              "type": "string",
            },
            "filters": Object {
              "items": Object {},
              "type": "array",
            },
            "index": Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
            "language": Object {
              "enum": Array [
                "kuery",
                "lucene",
              ],
              "type": "string",
            },
            "query": Object {
              "type": "string",
            },
            "responseActions": Object {
              "items": Object {
                "anyOf": Array [
                  Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "actionTypeId": Object {
                        "const": ".osquery",
                        "type": "string",
                      },
                      "params": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "ecsMapping": Object {
                            "additionalProperties": Object {
                              "additionalProperties": false,
                              "properties": Object {
                                "field": Object {
                                  "type": "string",
                                },
                                "value": Object {
                                  "anyOf": Array [
                                    Object {
                                      "type": "string",
                                    },
                                    Object {
                                      "items": Object {
                                        "type": "string",
                                      },
                                      "type": "array",
                                    },
                                  ],
                                },
                              },
                              "type": "object",
                            },
                            "properties": Object {},
                            "type": "object",
                          },
                          "packId": Object {
                            "type": "string",
                          },
                          "queries": Object {
                            "items": Object {
                              "additionalProperties": false,
                              "properties": Object {
                                "ecs_mapping": Object {
                                  "$ref": "#/allOf/1/anyOf/0/properties/responseActions/items/anyOf/0/properties/params/properties/ecsMapping",
                                },
                                "id": Object {
                                  "type": "string",
                                },
                                "platform": Object {
                                  "type": "string",
                                },
                                "query": Object {
                                  "type": "string",
                                },
                                "removed": Object {
                                  "type": "boolean",
                                },
                                "snapshot": Object {
                                  "type": "boolean",
                                },
                                "version": Object {
                                  "type": "string",
                                },
                              },
                              "required": Array [
                                "id",
                                "query",
                              ],
                              "type": "object",
                            },
                            "type": "array",
                          },
                          "query": Object {
                            "type": "string",
                          },
                          "savedQueryId": Object {
                            "type": "string",
                          },
                          "timeout": Object {
                            "type": "number",
                          },
                        },
                        "type": "object",
                      },
                    },
                    "required": Array [
                      "actionTypeId",
                      "params",
                    ],
                    "type": "object",
                  },
                  Object {
                    "additionalProperties": false,
                    "properties": Object {
                      "actionTypeId": Object {
                        "const": ".endpoint",
                        "type": "string",
                      },
                      "params": Object {
                        "anyOf": Array [
                          Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "command": Object {
                                "const": "isolate",
                                "type": "string",
                              },
                              "comment": Object {
                                "type": "string",
                              },
                            },
                            "required": Array [
                              "command",
                            ],
                            "type": "object",
                          },
                          Object {
                            "additionalProperties": false,
                            "properties": Object {
                              "command": Object {
                                "enum": Array [
                                  "kill-process",
                                  "suspend-process",
                                ],
                                "type": "string",
                              },
                              "comment": Object {
                                "type": "string",
                              },
                              "config": Object {
                                "additionalProperties": false,
                                "properties": Object {
                                  "field": Object {
                                    "type": "string",
                                  },
                                  "overwrite": Object {
                                    "default": true,
                                    "type": "boolean",
                                  },
                                },
                                "required": Array [
                                  "field",
                                ],
                                "type": "object",
                              },
                            },
                            "required": Array [
                              "command",
                              "config",
                            ],
                            "type": "object",
                          },
                        ],
                      },
                    },
                    "required": Array [
                      "actionTypeId",
                      "params",
                    ],
                    "type": "object",
                  },
                ],
              },
              "type": "array",
            },
            "savedId": Object {
              "type": "string",
            },
            "type": Object {
              "const": "query",
              "type": "string",
            },
          },
          "required": Array [
            "type",
            "language",
            "query",
          ],
          "type": "object",
        },
        Object {
          "additionalProperties": false,
          "properties": Object {
            "alertSuppression": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/alertSuppression",
            },
            "dataViewId": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/dataViewId",
            },
            "filters": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/filters",
            },
            "index": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/index",
            },
            "language": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/language",
            },
            "query": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/query",
            },
            "responseActions": Object {
              "items": Object {
                "$ref": "#/allOf/1/anyOf/0/properties/responseActions/items",
              },
              "type": "array",
            },
            "savedId": Object {
              "$ref": "#/allOf/1/anyOf/0/properties/savedId",
            },
            "type": Object {
              "const": "saved_query",
              "type": "string",
            },
          },
          "required": Array [
            "type",
            "language",
            "savedId",
          ],
          "type": "object",
        },
      ],
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: siem.thresholdRule 1`] = `
Object {
  "$schema": "http://json-schema.org/draft-07/schema#",
  "allOf": Array [
    Object {
      "properties": Object {
        "author": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "buildingBlockType": Object {
          "type": "string",
        },
        "description": Object {
          "minLength": 1,
          "type": "string",
        },
        "exceptionsList": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "list_id": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "namespace_type": Object {
                "enum": Array [
                  "agnostic",
                  "single",
                ],
                "type": "string",
              },
              "type": Object {
                "enum": Array [
                  "detection",
                  "rule_default",
                  "endpoint",
                  "endpoint_trusted_apps",
                  "endpoint_events",
                  "endpoint_host_isolation_exceptions",
                  "endpoint_blocklists",
                ],
                "type": "string",
              },
            },
            "required": Array [
              "id",
              "list_id",
              "type",
              "namespace_type",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "falsePositives": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "from": Object {
          "type": "string",
        },
        "immutable": Object {
          "type": "boolean",
        },
        "investigationFields": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "field_names": Object {
                  "items": Object {
                    "minLength": 1,
                    "pattern": "^(?! *$).+$",
                    "type": "string",
                  },
                  "minItems": 1,
                  "type": "array",
                },
              },
              "required": Array [
                "field_names",
              ],
              "type": "object",
            },
            Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
          ],
        },
        "license": Object {
          "type": "string",
        },
        "maxSignals": Object {
          "minimum": 1,
          "type": "integer",
        },
        "meta": Object {
          "additionalProperties": Object {},
          "properties": Object {},
          "type": "object",
        },
        "namespace": Object {
          "type": "string",
        },
        "note": Object {
          "type": "string",
        },
        "outputIndex": Object {
          "type": "string",
        },
        "references": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "relatedIntegrations": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "integration": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "package": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "version": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "package",
              "version",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "requiredFields": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "ecs": Object {
                "type": "boolean",
              },
              "name": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
              "type": Object {
                "$ref": "#/allOf/0/properties/investigationFields/anyOf/0/properties/field_names/items",
              },
            },
            "required": Array [
              "name",
              "type",
              "ecs",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "riskScore": Object {
          "maximum": 100,
          "minimum": 0,
          "type": "integer",
        },
        "riskScoreMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "risk_score": Object {
                "$ref": "#/allOf/0/properties/riskScore",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "ruleId": Object {
          "type": "string",
        },
        "ruleNameOverride": Object {
          "type": "string",
        },
        "ruleSource": Object {
          "anyOf": Array [
            Object {
              "additionalProperties": false,
              "properties": Object {
                "isCustomized": Object {
                  "type": "boolean",
                },
                "type": Object {
                  "const": "external",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
                "isCustomized",
              ],
              "type": "object",
            },
            Object {
              "additionalProperties": false,
              "properties": Object {
                "type": Object {
                  "const": "internal",
                  "type": "string",
                },
              },
              "required": Array [
                "type",
              ],
              "type": "object",
            },
          ],
        },
        "setup": Object {
          "type": "string",
        },
        "severity": Object {
          "enum": Array [
            "low",
            "medium",
            "high",
            "critical",
          ],
          "type": "string",
        },
        "severityMapping": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "field": Object {
                "type": "string",
              },
              "operator": Object {
                "const": "equals",
                "type": "string",
              },
              "severity": Object {
                "$ref": "#/allOf/0/properties/severity",
              },
              "value": Object {
                "type": "string",
              },
            },
            "required": Array [
              "field",
              "operator",
              "severity",
              "value",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "threat": Object {
          "items": Object {
            "additionalProperties": false,
            "properties": Object {
              "framework": Object {
                "type": "string",
              },
              "tactic": Object {
                "additionalProperties": false,
                "properties": Object {
                  "id": Object {
                    "type": "string",
                  },
                  "name": Object {
                    "type": "string",
                  },
                  "reference": Object {
                    "type": "string",
                  },
                },
                "required": Array [
                  "id",
                  "name",
                  "reference",
                ],
                "type": "object",
              },
              "technique": Object {
                "items": Object {
                  "additionalProperties": false,
                  "properties": Object {
                    "id": Object {
                      "type": "string",
                    },
                    "name": Object {
                      "type": "string",
                    },
                    "reference": Object {
                      "type": "string",
                    },
                    "subtechnique": Object {
                      "items": Object {
                        "additionalProperties": false,
                        "properties": Object {
                          "id": Object {
                            "type": "string",
                          },
                          "name": Object {
                            "type": "string",
                          },
                          "reference": Object {
                            "type": "string",
                          },
                        },
                        "required": Array [
                          "id",
                          "name",
                          "reference",
                        ],
                        "type": "object",
                      },
                      "type": "array",
                    },
                  },
                  "required": Array [
                    "id",
                    "name",
                    "reference",
                  ],
                  "type": "object",
                },
                "type": "array",
              },
            },
            "required": Array [
              "framework",
              "tactic",
            ],
            "type": "object",
          },
          "type": "array",
        },
        "timelineId": Object {
          "type": "string",
        },
        "timelineTitle": Object {
          "type": "string",
        },
        "timestampOverride": Object {
          "type": "string",
        },
        "timestampOverrideFallbackDisabled": Object {
          "type": "boolean",
        },
        "to": Object {
          "type": "string",
        },
        "version": Object {
          "minimum": 1,
          "type": "integer",
        },
      },
      "required": Array [
        "author",
        "description",
        "falsePositives",
        "from",
        "ruleId",
        "immutable",
        "outputIndex",
        "maxSignals",
        "riskScore",
        "riskScoreMapping",
        "severity",
        "severityMapping",
        "threat",
        "to",
        "references",
        "version",
        "exceptionsList",
      ],
      "type": "object",
    },
    Object {
      "properties": Object {
        "alertSuppression": Object {
          "additionalProperties": false,
          "properties": Object {
            "duration": Object {
              "additionalProperties": false,
              "properties": Object {
                "unit": Object {
                  "enum": Array [
                    "s",
                    "m",
                    "h",
                  ],
                  "type": "string",
                },
                "value": Object {
                  "minimum": 1,
                  "type": "integer",
                },
              },
              "required": Array [
                "value",
                "unit",
              ],
              "type": "object",
            },
          },
          "required": Array [
            "duration",
          ],
          "type": "object",
        },
        "dataViewId": Object {
          "type": "string",
        },
        "filters": Object {
          "items": Object {},
          "type": "array",
        },
        "index": Object {
          "items": Object {
            "type": "string",
          },
          "type": "array",
        },
        "language": Object {
          "enum": Array [
            "kuery",
            "lucene",
          ],
          "type": "string",
        },
        "query": Object {
          "type": "string",
        },
        "savedId": Object {
          "type": "string",
        },
        "threshold": Object {
          "additionalProperties": false,
          "properties": Object {
            "cardinality": Object {
              "items": Object {
                "additionalProperties": false,
                "properties": Object {
                  "field": Object {
                    "type": "string",
                  },
                  "value": Object {
                    "minimum": 0,
                    "type": "integer",
                  },
                },
                "required": Array [
                  "field",
                  "value",
                ],
                "type": "object",
              },
              "type": "array",
            },
            "field": Object {
              "items": Object {
                "type": "string",
              },
              "type": "array",
            },
            "value": Object {
              "minimum": 1,
              "type": "integer",
            },
          },
          "required": Array [
            "field",
            "value",
          ],
          "type": "object",
        },
        "type": Object {
          "const": "threshold",
          "type": "string",
        },
      },
      "required": Array [
        "type",
        "language",
        "query",
        "threshold",
      ],
      "type": "object",
    },
  ],
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: slo.rules.burnRate 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "dependencies": Object {
      "flags": Object {
        "default": [Function],
        "error": [Function],
        "presence": "optional",
      },
      "items": Array [
        Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "actionGroupsToSuppressOn": Object {
              "flags": Object {
                "error": [Function],
              },
              "items": Array [
                Object {
                  "flags": Object {
                    "error": [Function],
                    "presence": "optional",
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
              ],
              "type": "array",
            },
            "ruleId": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          },
          "type": "object",
        },
      ],
      "metas": Array [
        Object {
          "x-oas-optional": true,
        },
      ],
      "type": "array",
    },
    "sloId": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "string",
    },
    "windows": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "default": Object {
              "special": "deep",
            },
            "error": [Function],
            "presence": "optional",
          },
          "keys": Object {
            "actionGroup": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "burnRateThreshold": Object {
              "flags": Object {
                "error": [Function],
              },
              "type": "number",
            },
            "id": Object {
              "flags": Object {
                "error": [Function],
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
            "longWindow": Object {
              "flags": Object {
                "default": Object {
                  "special": "deep",
                },
                "error": [Function],
                "presence": "optional",
              },
              "keys": Object {
                "unit": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "value": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "type": "number",
                },
              },
              "type": "object",
            },
            "maxBurnRateThreshold": Object {
              "flags": Object {
                "default": null,
                "error": [Function],
                "presence": "optional",
              },
              "matches": Array [
                Object {
                  "schema": Object {
                    "flags": Object {
                      "error": [Function],
                    },
                    "type": "number",
                  },
                },
                Object {
                  "schema": Object {
                    "allow": Array [
                      null,
                    ],
                    "flags": Object {
                      "error": [Function],
                      "only": true,
                    },
                    "type": "any",
                  },
                },
              ],
              "type": "alternatives",
            },
            "shortWindow": Object {
              "flags": Object {
                "default": Object {
                  "special": "deep",
                },
                "error": [Function],
                "presence": "optional",
              },
              "keys": Object {
                "unit": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "rules": Array [
                    Object {
                      "args": Object {
                        "method": [Function],
                      },
                      "name": "custom",
                    },
                  ],
                  "type": "string",
                },
                "value": Object {
                  "flags": Object {
                    "error": [Function],
                  },
                  "type": "number",
                },
              },
              "type": "object",
            },
          },
          "type": "object",
        },
      ],
      "type": "array",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: transform_health 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "excludeTransforms": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "default": Array [],
              "error": [Function],
              "presence": "optional",
            },
            "items": Array [
              Object {
                "flags": Object {
                  "error": [Function],
                  "presence": "optional",
                },
                "rules": Array [
                  Object {
                    "args": Object {
                      "method": [Function],
                    },
                    "name": "custom",
                  },
                ],
                "type": "string",
              },
            ],
            "type": "array",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "includeTransforms": Object {
      "flags": Object {
        "error": [Function],
      },
      "items": Array [
        Object {
          "flags": Object {
            "error": [Function],
            "presence": "optional",
          },
          "rules": Array [
            Object {
              "args": Object {
                "method": [Function],
              },
              "name": "custom",
            },
          ],
          "type": "string",
        },
      ],
      "type": "array",
    },
    "testsConfig": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "default": Object {
                "special": "deep",
              },
              "error": [Function],
              "presence": "optional",
            },
            "keys": Object {
              "errorMessages": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": false,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "healthCheck": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "notStarted": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
            },
            "type": "object",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: xpack.ml.anomaly_detection_alert 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "includeInterim": Object {
      "flags": Object {
        "default": true,
        "error": [Function],
        "presence": "optional",
      },
      "type": "boolean",
    },
    "jobSelection": Object {
      "flags": Object {
        "default": Object {
          "special": "deep",
        },
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "groupIds": Object {
          "flags": Object {
            "default": Array [],
            "error": [Function],
            "presence": "optional",
          },
          "items": Array [
            Object {
              "flags": Object {
                "error": [Function],
                "presence": "optional",
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          ],
          "type": "array",
        },
        "jobIds": Object {
          "flags": Object {
            "default": Array [],
            "error": [Function],
            "presence": "optional",
          },
          "items": Array [
            Object {
              "flags": Object {
                "error": [Function],
                "presence": "optional",
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          ],
          "type": "array",
        },
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "object",
    },
    "lookbackInterval": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "string",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "resultType": Object {
      "flags": Object {
        "error": [Function],
      },
      "matches": Array [
        Object {
          "schema": Object {
            "allow": Array [
              "record",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "bucket",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              "influencer",
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "severity": Object {
      "flags": Object {
        "error": [Function],
      },
      "rules": Array [
        Object {
          "args": Object {
            "limit": 0,
          },
          "name": "min",
        },
        Object {
          "args": Object {
            "limit": 100,
          },
          "name": "max",
        },
      ],
      "type": "number",
    },
    "topNBuckets": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "error": [Function],
            },
            "rules": Array [
              Object {
                "args": Object {
                  "limit": 1,
                },
                "name": "min",
              },
            ],
            "type": "number",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
  },
  "type": "object",
}
`;

exports[`Serverless upgrade and rollback checks detect param changes to review for: xpack.ml.anomaly_detection_jobs_health 1`] = `
Object {
  "flags": Object {
    "default": Object {
      "special": "deep",
    },
    "error": [Function],
    "presence": "optional",
  },
  "keys": Object {
    "excludeJobs": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "default": Object {
                "special": "deep",
              },
              "error": [Function],
              "presence": "optional",
            },
            "keys": Object {
              "groupIds": Object {
                "flags": Object {
                  "default": Array [],
                  "error": [Function],
                  "presence": "optional",
                },
                "items": Array [
                  Object {
                    "flags": Object {
                      "error": [Function],
                      "presence": "optional",
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                ],
                "type": "array",
              },
              "jobIds": Object {
                "flags": Object {
                  "default": Array [],
                  "error": [Function],
                  "presence": "optional",
                },
                "items": Array [
                  Object {
                    "flags": Object {
                      "error": [Function],
                      "presence": "optional",
                    },
                    "rules": Array [
                      Object {
                        "args": Object {
                          "method": [Function],
                        },
                        "name": "custom",
                      },
                    ],
                    "type": "string",
                  },
                ],
                "type": "array",
              },
            },
            "rules": Array [
              Object {
                "args": Object {
                  "method": [Function],
                },
                "name": "custom",
              },
            ],
            "type": "object",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
    "includeJobs": Object {
      "flags": Object {
        "default": Object {
          "special": "deep",
        },
        "error": [Function],
        "presence": "optional",
      },
      "keys": Object {
        "groupIds": Object {
          "flags": Object {
            "default": Array [],
            "error": [Function],
            "presence": "optional",
          },
          "items": Array [
            Object {
              "flags": Object {
                "error": [Function],
                "presence": "optional",
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          ],
          "type": "array",
        },
        "jobIds": Object {
          "flags": Object {
            "default": Array [],
            "error": [Function],
            "presence": "optional",
          },
          "items": Array [
            Object {
              "flags": Object {
                "error": [Function],
                "presence": "optional",
              },
              "rules": Array [
                Object {
                  "args": Object {
                    "method": [Function],
                  },
                  "name": "custom",
                },
              ],
              "type": "string",
            },
          ],
          "type": "array",
        },
      },
      "rules": Array [
        Object {
          "args": Object {
            "method": [Function],
          },
          "name": "custom",
        },
      ],
      "type": "object",
    },
    "testsConfig": Object {
      "flags": Object {
        "default": null,
        "error": [Function],
        "presence": "optional",
      },
      "matches": Array [
        Object {
          "schema": Object {
            "flags": Object {
              "default": Object {
                "special": "deep",
              },
              "error": [Function],
              "presence": "optional",
            },
            "keys": Object {
              "behindRealtime": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                        "timeInterval": Object {
                          "flags": Object {
                            "default": null,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "matches": Array [
                            Object {
                              "schema": Object {
                                "flags": Object {
                                  "error": [Function],
                                },
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                            },
                            Object {
                              "schema": Object {
                                "allow": Array [
                                  null,
                                ],
                                "flags": Object {
                                  "error": [Function],
                                  "only": true,
                                },
                                "type": "any",
                              },
                            },
                          ],
                          "type": "alternatives",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "datafeed": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "delayedData": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "docsCount": Object {
                          "flags": Object {
                            "default": null,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "matches": Array [
                            Object {
                              "schema": Object {
                                "flags": Object {
                                  "error": [Function],
                                },
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "limit": 1,
                                    },
                                    "name": "min",
                                  },
                                ],
                                "type": "number",
                              },
                            },
                            Object {
                              "schema": Object {
                                "allow": Array [
                                  null,
                                ],
                                "flags": Object {
                                  "error": [Function],
                                  "only": true,
                                },
                                "type": "any",
                              },
                            },
                          ],
                          "type": "alternatives",
                        },
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                        "timeInterval": Object {
                          "flags": Object {
                            "default": null,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "matches": Array [
                            Object {
                              "schema": Object {
                                "flags": Object {
                                  "error": [Function],
                                },
                                "rules": Array [
                                  Object {
                                    "args": Object {
                                      "method": [Function],
                                    },
                                    "name": "custom",
                                  },
                                ],
                                "type": "string",
                              },
                            },
                            Object {
                              "schema": Object {
                                "allow": Array [
                                  null,
                                ],
                                "flags": Object {
                                  "error": [Function],
                                  "only": true,
                                },
                                "type": "any",
                              },
                            },
                          ],
                          "type": "alternatives",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "errorMessages": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
              "mml": Object {
                "flags": Object {
                  "default": null,
                  "error": [Function],
                  "presence": "optional",
                },
                "matches": Array [
                  Object {
                    "schema": Object {
                      "flags": Object {
                        "default": Object {
                          "special": "deep",
                        },
                        "error": [Function],
                        "presence": "optional",
                      },
                      "keys": Object {
                        "enabled": Object {
                          "flags": Object {
                            "default": true,
                            "error": [Function],
                            "presence": "optional",
                          },
                          "type": "boolean",
                        },
                      },
                      "type": "object",
                    },
                  },
                  Object {
                    "schema": Object {
                      "allow": Array [
                        null,
                      ],
                      "flags": Object {
                        "error": [Function],
                        "only": true,
                      },
                      "type": "any",
                    },
                  },
                ],
                "type": "alternatives",
              },
            },
            "type": "object",
          },
        },
        Object {
          "schema": Object {
            "allow": Array [
              null,
            ],
            "flags": Object {
              "error": [Function],
              "only": true,
            },
            "type": "any",
          },
        },
      ],
      "type": "alternatives",
    },
  },
  "type": "object",
}
`;
