openapi: 3.0.0
info:
  title: Common Osquery Attributes
  version: 8.9.0
paths: {}
components:
  schemas:
    Id:
      type: string
    IdOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Id'
        - type: null
    AgentSelection:
      type: object
      properties:
        agents:
          type: array
          items:
            type: string
        allAgentsSelected:
          type: boolean
        platformsSelected:
          type: array
          items:
            type: string
        policiesSelected:
          type: array
          items:
            type: string

    AgentSelectionOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/AgentSelection'
        - type: null

    Description:
      type: string

    DescriptionOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Description'
        - type: null

    Platform:
      type: string

    PlatformOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Platform'
        - type: null

    Query:
      type: string

    QueryOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Query'
        - type: null

    Version:
      type: string

    VersionOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Version'
        - type: null

    Interval:
      type: string

    IntervalOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Interval'
        - type: null

    Snapshot:
      type: boolean

    SnapshotOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Snapshot'
        - type: null

    Removed:
      type: boolean

    RemovedOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Removed'
        - type: null

    SavedQueryId:
      type: string

    SavedQueryIdOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/SavedQueryId'
        - type: null

    PackId:
      type: string

    PackIdOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/PackId'
        - type: null

    ExecutionContext:
      type: object
      properties:
        name:
          oneOf:
            - type: string
            - type: null
        url:
          oneOf:
            - type: string
            - type: null

    ExecutionContextOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/ExecutionContext'
        - type: null

    ECSMappingItem:
      type: object
      properties:
        field:
          type: string
        value:
          oneOf:
            - type: string
            - type: array
              items:
                type: string

    ECSMapping:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/ECSMappingItem'

    ECSMappingOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/ECSMapping'
        - type: null

    StringArrayOrUndefined:
      oneOf:
        - type: array
          items:
            type: string
        - type: null

    ArrayQueriesItem:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/Id'
        query:
          $ref: '#/components/schemas/Query'
        ecs_mapping:
          $ref: '#/components/schemas/ECSMappingOrUndefined'
        version:
          $ref: '#/components/schemas/VersionOrUndefined'
        platform:
          $ref: '#/components/schemas/PlatformOrUndefined'
        removed:
          $ref: '#/components/schemas/RemovedOrUndefined'
        snapshot:
          $ref: '#/components/schemas/SnapshotOrUndefined'

    ArrayQueries:
      type: array
      items:
        $ref: '#/components/schemas/ArrayQueriesItem'

    ObjectQueriesItem:
      type: object
      properties:
        query:
          $ref: '#/components/schemas/Query'
        id:
          $ref: '#/components/schemas/Id'
        ecs_mapping:
          $ref: '#/components/schemas/ECSMappingOrUndefined'
        version:
          $ref: '#/components/schemas/VersionOrUndefined'
        platform:
          $ref: '#/components/schemas/PlatformOrUndefined'
        saved_query_id:
          $ref: '#/components/schemas/SavedQueryIdOrUndefined'
        removed:
          $ref: '#/components/schemas/RemovedOrUndefined'
        snapshot:
          $ref: '#/components/schemas/SnapshotOrUndefined'

    ObjectQueries:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/ObjectQueriesItem'

    Queries:
      oneOf:
        - $ref: '#/components/schemas/ArrayQueries'
        - $ref: '#/components/schemas/ObjectQueries'

    QueriesOrUndefined:
      oneOf:
        - $ref: '#/components/schemas/Queries'
        - type: null

    FilterQueryOrUndefined:
      oneOf:
        - type: string
        - type: null
    PageOrUndefined:
      oneOf:
        - type: integer
        - type: null
    PageSizeOrUndefined:
      oneOf:
        - type: integer
        - type: null
    SortOrUndefined:
      oneOf:
        - type: string
        - type: null
    SortOrderOrUndefined:
      oneOf:
        - type: string
        - type: null
        - enum: [ asc, desc ]

