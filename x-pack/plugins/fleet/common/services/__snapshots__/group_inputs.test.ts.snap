// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`groupInputs() should group inputs for a package with multiple policy templates and input groups correctly 1`] = `
Array [
  Object {
    "description": "Collect logs for AWS services",
    "name": "logs",
    "streams": Array [
      Object {
        "data_stream": Object {
          "dataset": "aws.cloudtrail",
          "type": "logs",
        },
        "description": "Collect AWS CloudTrail logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS CloudTrail logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.cloudwatch_logs",
          "type": "logs",
        },
        "description": "Collect AWS CloudWatch logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS CloudWatch logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.ec2_logs",
          "type": "logs",
        },
        "description": "Collect AWS EC2 logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS EC2 logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.elb_logs",
          "type": "logs",
        },
        "description": "Collect AWS ELB logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS ELB logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.s3access",
          "type": "logs",
        },
        "description": "Collect AWS s3access logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS s3access logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.vpcflow",
          "type": "logs",
        },
        "description": "Collect AWS vpcflow logs using s3 input",
        "enabled": true,
        "input": "s3",
        "template_path": "s3.yml.hbs",
        "title": "AWS vpcflow logs",
        "vars": Array [
          Object {
            "description": "The duration that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.  The maximum is 12 hours.",
            "multi": false,
            "name": "visibility_timeout",
            "required": false,
            "show_user": false,
            "title": "Visibility Timeout",
            "type": "text",
          },
          Object {
            "description": "The maximum duration of AWS API can take. The maximum is half of the visibility timeout value.",
            "multi": false,
            "name": "api_timeout",
            "required": false,
            "show_user": false,
            "title": "API Timeout",
            "type": "text",
          },
          Object {
            "description": "URL of the AWS SQS queue that messages will be received from.",
            "multi": false,
            "name": "queue_url",
            "required": true,
            "show_user": true,
            "title": "Queue URL",
            "type": "text",
          },
          Object {
            "default": false,
            "description": "Enabling this option changes the service name from \`s3\` to \`s3-fips\` for connecting to the correct service endpoint.",
            "multi": false,
            "name": "fips_enabled",
            "required": false,
            "show_user": false,
            "title": "Enable S3 FIPS",
            "type": "bool",
          },
        ],
      },
    ],
    "title": "Logs",
  },
  Object {
    "description": "Collect metrics for AWS services",
    "name": "metrics",
    "streams": Array [
      Object {
        "data_stream": Object {
          "dataset": "aws.billing",
          "type": "metrics",
        },
        "description": "Collect AWS billing metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS Billing metrics",
        "vars": Array [
          Object {
            "default": "12h",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": Array [
              "AZ",
              "INSTANCE_TYPE",
              "SERVICE",
            ],
            "multi": true,
            "name": "cost_explorer_config.group_by_dimension_keys",
            "required": false,
            "show_user": true,
            "title": "Cost Explorer Group By Dimension Keys",
            "type": "text",
          },
          Object {
            "default": Array [
              "aws:createdBy",
            ],
            "multi": true,
            "name": "cost_explorer_config.group_by_tag_keys",
            "required": false,
            "show_user": true,
            "title": "Cost Explorer Group By Tag Keys",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.cloudwatch_metrics",
          "type": "metrics",
        },
        "description": "Collect AWS CloudWatch metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS CloudWatch metrics",
        "vars": Array [
          Object {
            "default": "300s",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "- namespace: AWS/EC2
  resource_type: ec2:instance
  name:
    - CPUUtilization
    - DiskWriteOps
  statistic:
    - Average
    - Maximum
  # dimensions:
   # - name: InstanceId
      # value: i-123456
  # tags:
    # - key: created-by
      # value: foo
",
            "multi": false,
            "name": "metrics",
            "required": true,
            "show_user": true,
            "title": "Metrics",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.dynamodb",
          "type": "metrics",
        },
        "description": "Collect AWS DynamoDB metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS DynamoDB metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.ebs",
          "type": "metrics",
        },
        "description": "Collect AWS EBS metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS EBS metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.ec2_metrics",
          "type": "metrics",
        },
        "description": "Collect AWS EC2 metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS EC2 metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.elb_metrics",
          "type": "metrics",
        },
        "description": "Collect AWS ELB metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS ELB metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.lambda",
          "type": "metrics",
        },
        "description": "Collect AWS Lambda metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS Lambda metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.natgateway",
          "type": "metrics",
        },
        "description": "Collect AWS NAT gateway metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS NAT gateway metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.rds",
          "type": "metrics",
        },
        "description": "Collect AWS RDS metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS RDS metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.s3_daily_storage",
          "type": "metrics",
        },
        "description": "Collect AWS S3 daily storage metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS S3 daily storage metrics",
        "vars": Array [
          Object {
            "default": "24h",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.s3_request",
          "type": "metrics",
        },
        "description": "Collect AWS S3 request metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS S3 request metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.sns",
          "type": "metrics",
        },
        "description": "Collect AWS SNS metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS SNS metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.sqs",
          "type": "metrics",
        },
        "description": "Collect AWS SQS metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS SQS metrics",
        "vars": Array [
          Object {
            "default": "5m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.transitgateway",
          "type": "metrics",
        },
        "description": "Collect AWS Transit Gateway metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS Transit Gateway metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.usage",
          "type": "metrics",
        },
        "description": "Collect AWS usage metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS usage metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
        ],
      },
      Object {
        "data_stream": Object {
          "dataset": "aws.vpn",
          "type": "metrics",
        },
        "description": "Collect AWS VPN metrics",
        "enabled": true,
        "input": "aws/metrics",
        "template_path": "stream.yml.hbs",
        "title": "AWS VPN metrics",
        "vars": Array [
          Object {
            "default": "1m",
            "multi": false,
            "name": "period",
            "required": true,
            "show_user": true,
            "title": "Period",
            "type": "text",
          },
          Object {
            "multi": true,
            "name": "regions",
            "required": false,
            "show_user": true,
            "title": "Regions",
            "type": "text",
          },
          Object {
            "multi": false,
            "name": "latency",
            "required": false,
            "show_user": false,
            "title": "Latency",
            "type": "text",
          },
          Object {
            "default": "# - key: \\"created-by\\"
  # value: \\"foo\\"
",
            "multi": false,
            "name": "tags_filter",
            "required": false,
            "show_user": false,
            "title": "Tags Filter",
            "type": "yaml",
          },
        ],
      },
    ],
    "title": "Metrics",
  },
]
`;
