/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import React from 'react';
import {
  EuiTitle,
  EuiButtonEmpty,
  EuiPanel,
  EuiBasicTable,
  EuiSpacer,
  EuiToolTip,
  EuiBasicTableColumn,
  useEuiTheme,
} from '@elastic/eui';
import { i18n } from '@kbn/i18n';
import { css } from '@emotion/react';
import {
  DASHBOARD_TABLE_TYPES,
  vulnerabilityDashboardTableContent,
} from './vulnerability_table_panel.config';

export interface VulnerabilityDashboardTableProps<T> {
  tableType: DASHBOARD_TABLE_TYPES;
  columns: Array<EuiBasicTableColumn<T>>;
  items: T[];
  onViewVulnerabilitiesClick: () => void;
}

export const VulnerabilityTablePanel = <T extends {}>({
  items,
  columns,
  tableType,
  onViewVulnerabilitiesClick,
}: VulnerabilityDashboardTableProps<T>) => {
  const { euiTheme } = useEuiTheme();
  const { title } = vulnerabilityDashboardTableContent[tableType];
  const tooltipText = i18n.translate('xpack.csp.vulnerabilityTable.panel.tooltipText', {
    defaultMessage: 'Explore in Findings',
  });

  return (
    <EuiPanel hasBorder paddingSize="m">
      <EuiTitle size="s">
        <h2>{title}</h2>
      </EuiTitle>
      <EuiSpacer size="m" />
      <EuiBasicTable
        className="vulnerabilityTable"
        css={css`
          & .euiTableHeaderCell {
            border-bottom: ${euiTheme.border.width.thick} solid ${euiTheme.colors.darkestShade};
          }
        `}
        items={items}
        columns={columns}
      />
      <EuiSpacer size="s" />
      <EuiToolTip position="top" content={tooltipText}>
        <EuiButtonEmpty iconType="search" onClick={onViewVulnerabilitiesClick} size="s">
          {i18n.translate('xpack.csp.vulnerabilityTable.panel..buttonText', {
            defaultMessage: 'View all vulnerabilities',
          })}
        </EuiButtonEmpty>
      </EuiToolTip>
    </EuiPanel>
  );
};
