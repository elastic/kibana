/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

export const getVulnerabilityFilter = () => [
  {
    bool: {
      minimum_should_match: 1,
      should: [
        { match_phrase: { 'vulnerability.severity': 'CRITICAL' } },
        { match_phrase: { 'vulnerability.severity': 'HIGH' } },
        { match_phrase: { 'vulnerability.severity': 'MEDIUM' } },
        { match_phrase: { 'vulnerability.severity': 'LOW' } },
      ],
    },
  },
  { exists: { field: 'vulnerability.score.base' } },
  { exists: { field: 'vulnerability.score.version' } },
  { exists: { field: 'vulnerability.severity' } },
  { exists: { field: 'resource.id' } },
  { exists: { field: 'resource.name' } },
  { match_phrase: { 'vulnerability.enumeration': 'CVE' } },
];
