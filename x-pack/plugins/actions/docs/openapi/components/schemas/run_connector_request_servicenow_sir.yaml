title: Run ServiceNow SecOps connector parameters
description: Test ServiceNow security incidents.
oneOf:
  - type: object
    required:
      - subAction
      - subActionParams
    description: ServiceNow SecOps connector properties when `subAction` is `getChoices`.
    properties:
      subAction:
        type: string
        description: The action to test.
        enum:
          - getChoices
      subActionParams:
        type: object
        description: The set of configuration properties for the action.
        required:
          - fields
        properties:
          fields:
            type: array
            description: An array of fields.
            items:
              type: string
  - type: object
    required:
      - subAction
    description: ServiceNow SecOps connector properties when `subAction` is `getFields`.
    properties:
      subAction:
        type: string
        description: The action to test.
        enum:
          - getFields
  - type: object
    required:
      - subAction
      - subActionParams
    description: ServiceNow SecOps connector properties when `subAction` is `getIncident`.
    properties:
      subAction:
        type: string
        description: The action to test.
        enum:
          - getIncident
      subActionParams:
        type: object
        description: The set of configuration properties for the action.
        required:
          - externalId
        properties:
          externalId:
            type: string
            description: The ServiceNow SecOps issue identifier.
  - type: object
    required:
      - subAction
      - subActionParams
    description: ServiceNow SecOps connector properties when `subAction` is `pushToService`.
    properties:
      subAction:
        type: string
        description: The action to test.
        enum:
          - pushToService
      subActionParams:
        type: object
        description: The set of configuration properties for the action.
        required:
          - incident
        properties:
          comments:
            type: array
            description: Additional information that is sent to ServiceNow SecOps.
            items:
              type: object
              properties:
                comment:
                  type: string
                  description: A comment related to the incident. For example, describe how to troubleshoot the issue.
                commentId:
                  type: integer
                  description: A unique identifier for the comment.
          incident:
            type: object
            required:
             - short_description
            description: Information necessary to create or update a ServiceNow SecOps incident.
            properties:
              category:
                type: string
                description: The category of the incident.
              correlation_display:
                type: string
                description: A descriptive label of the alert for correlation purposes in ServiceNow.
              correlation_id:
                type: string
                description: >
                  The correlation identifier for the security incident. Connectors using the same correlation ID are associated with the same ServiceNow incident. This value determines whether a new ServiceNow incident is created or an existing one is updated. Modifying this value is optional; if not modified, the rule ID and alert ID are combined as `{{ruleID}}:{{alert ID}}` to form the correlation ID value in ServiceNow. The maximum character length for this value is 100 characters.
                  NOTE: Using the default configuration of `{{ruleID}}:{{alert ID}}` ensures that ServiceNow creates a separate incident record for every generated alert that uses a unique alert ID. If the rule generates multiple alerts that use the same alert IDs, ServiceNow creates and continually updates a single incident record for the alert.
              description:
                type: string
                description: The details about the incident.
              dest_ip:
                description: A list of destination IP addresses related to the security incident. The IPs are added as observables to the security incident.
                oneOf:
                  - type: string
                  - type: array
                    items:
                      type: string
              externalId:
                type: string
                description: The ServiceNow SecOps issue identifier. If present, the incident is updated. Otherwise, a new incident is created.
              malware_hash:
                description: A list of malware hashes related to the security incident. The hashes are added as observables to the security incident.
                oneOf:
                  - type: string
                  - type: array
                    items:
                      type: string
              malware_url:
                type: string
                description: A list of malware URLs related to the security incident. The URLs are added as observables to the security incident.
                oneOf:
                  - type: string
                  - type: array
                    items:
                      type: string
              priority:
                type: string
                description: The priority in ServiceNow.
              short_description:
                type: string
                description: A short description for the incident, used for searching the contents of the knowledge base.
              source_ip:
                description: A list of source IP addresses related to the security incident. The IPs are added as observables to the security incident.
                oneOf:
                  - type: string
                  - type: array
                    items:
                      type: string
              subcategory:
                type: string
                description: The subcategory of the incident.
discriminator:
  propertyName: subAction
