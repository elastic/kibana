{
  "id": "apache_ecs",
  "title": "Filebeat apache",
  "description": "Find unusual activity in Apache web access logs (ECS)",
  "type": "Web Access Logs",
  "logoFile": "logo.json",
  "defaultIndexPattern": "filebeat-*",
  "query": {
    "bool": {
      "filter": [
        { "term": { "event.module": "apache" } },
        { "term": { "event.dataset": "access" } },
        { "exists": { "field": "source.address" } },
        { "exists": { "field": "url.original" } },
        { "exists": { "field": "http.response.status_code" } }
      ]
    }
  },
  "jobs": [
    {
      "id": "visitor_rate_ecs",
      "file": "visitor_rate_ecs.json"
    },
    {
      "id": "response_code_ecs",
      "file": "response_code_ecs.json"
    },
    {
      "id": "source_ip_url_count_ecs",
      "file": "source_ip_url_count_ecs.json"
    },
    {
      "id": "source_ip_request_rate_ecs",
      "file": "source_ip_request_rate_ecs.json"
    },
    {
      "id": "low_request_rate_ecs",
      "file": "low_request_rate_ecs.json"
    }
  ],
  "datafeeds": [
    {
      "id": "datafeed-visitor_rate_ecs",
      "file": "datafeed_visitor_rate_ecs.json",
      "job_id": "visitor_rate_ecs"
    },
    {
      "id": "datafeed-response_code_ecs",
      "file": "datafeed_response_code_ecs.json",
      "job_id": "response_code_ecs"
    },
    {
      "id": "datafeed-source_ip_url_count_ecs",
      "file": "datafeed_source_ip_url_count_ecs.json",
      "job_id": "source_ip_url_count_ecs"
    },
    {
      "id": "datafeed-source_ip_request_rate_ecs",
      "file": "datafeed_source_ip_request_rate_ecs.json",
      "job_id": "source_ip_request_rate_ecs"
    },
    {
      "id": "datafeed-low_request_rate_ecs",
      "file": "datafeed_low_request_rate_ecs.json",
      "job_id": "low_request_rate_ecs"
    }
  ],
  "kibana": {
    "dashboard": [
      {
        "id": "ML-Apache-Access-Source-IP-Count-Explorer-ECS",
        "file": "ML-Apache-Access-Source-IP-Count-Explorer-ECS.json"
      },
      {
        "id": "ML-Apache-Source-IP-URL-Explorer-ECS",
        "file": "ML-Apache-Source-IP-URL-Explorer-ECS.json"
      }
    ],
    "search": [
      {
        "id": "ML-Filebeat-Apache-Access-ECS",
        "file": "ML-Filebeat-Apache-Access-ECS.json"
      }
    ],
    "visualization": [
      {
        "id": "ML-Apache-Access-Map-ECS",
        "file": "ML-Apache-Access-Map-ECS.json"
      },
      {
        "id": "ML-Apache-Access-Source-IP-Timechart-ECS",
        "file": "ML-Apache-Access-Source-IP-Timechart-ECS.json"
      },
      {
        "id": "ML-Apache-Access-Response-Code-Timechart-ECS",
        "file": "ML-Apache-Access-Response-Code-Timechart-ECS.json"
      },
      {
        "id": "ML-Apache-Access-Top-Source-IPs-Table-ECS",
        "file": "ML-Apache-Access-Top-Source-IPs-Table-ECS.json"
      },
      {
        "id": "ML-Apache-Access-Top-URLs-Table-ECS",
        "file": "ML-Apache-Access-Top-URLs-Table-ECS.json"
      },
      {
        "id": "ML-Apache-Access-Unique-Count-URL-Timechart-ECS",
        "file": "ML-Apache-Access-Unique-Count-URL-Timechart-ECS.json"
      }
    ]
  }
}
