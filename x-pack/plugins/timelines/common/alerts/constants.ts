/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import {
  ALERT_NAMESPACE,
  ALERT_RULE_NAMESPACE,
  TechnicalRuleDataFieldName,
} from '@kbn/rule-data-utils';
import { ValuesType } from 'utility-types';

// TODO: Replace the below located in: x-pack/plugins/security_solution/server/lib/detection_engine/rule_types/field_maps/field_names.ts

// export const ALERT_ANCESTORS = `${ALERT_NAMESPACE}.ancestors`;
// export const ALERT_DEPTH = `${ALERT_NAMESPACE}.depth`;
// export const ALERT_ORIGINAL_EVENT = `${ALERT_NAMESPACE}.original_event`;
// export const ALERT_ORIGINAL_TIME = `${ALERT_NAMESPACE}.original_time`;

/**
 * This file contains the security solution specific Alert fields not contained in the @kbn/rule-data-utils package
 */

// Cast to `as const` to preserve the exact string value when using as a type rather than a value
export const ALERT_ANCESTORS = `${ALERT_NAMESPACE}.ancestors` as const;
export const ALERT_ANCESTORS_DEPTH = `${ALERT_ANCESTORS}.depth` as const;
export const ALERT_ANCESTORS_ID = `${ALERT_ANCESTORS}.id` as const;
export const ALERT_ANCESTORS_INDEX = `${ALERT_ANCESTORS}.index` as const;
export const ALERT_ANCESTORS_RULE = `${ALERT_ANCESTORS}.rule` as const;
export const ALERT_ANCESTORS_TYPE = `${ALERT_ANCESTORS}.type` as const;
export const ALERT_DEPTH = `${ALERT_NAMESPACE}.depth` as const;
export const ALERT_GROUP = `${ALERT_NAMESPACE}.group` as const;
export const ALERT_GROUP_ID = `${ALERT_GROUP}.id` as const;
export const ALERT_GROUP_INDEX = `${ALERT_GROUP}.index` as const;
export const ALERT_ORIGINAL_EVENT = `${ALERT_NAMESPACE}.original_event` as const;
export const ALERT_ORIGINAL_EVENT_ACTION = `${ALERT_ORIGINAL_EVENT}.action` as const;
export const ALERT_ORIGINAL_EVENT_AGENT_ID_STATUS = `${ALERT_ORIGINAL_EVENT}.agent_id_status` as const;
export const ALERT_ORIGINAL_EVENT_CATEGORY = `${ALERT_ORIGINAL_EVENT}.category` as const;
export const ALERT_ORIGINAL_EVENT_CODE = `${ALERT_ORIGINAL_EVENT}.code` as const;
export const ALERT_ORIGINAL_EVENT_CREATED = `${ALERT_ORIGINAL_EVENT}.created` as const;
export const ALERT_ORIGINAL_EVENT_DATASET = `${ALERT_ORIGINAL_EVENT}.dataset` as const;
export const ALERT_ORIGINAL_EVENT_DURATION = `${ALERT_ORIGINAL_EVENT}.duration` as const;
export const ALERT_ORIGINAL_EVENT_END = `${ALERT_ORIGINAL_EVENT}.end` as const;
export const ALERT_ORIGINAL_EVENT_HASH = `${ALERT_ORIGINAL_EVENT}.hash` as const;
export const ALERT_ORIGINAL_EVENT_ID = `${ALERT_ORIGINAL_EVENT}.id` as const;
export const ALERT_ORIGINAL_EVENT_INGESTED = `${ALERT_ORIGINAL_EVENT}.ingested` as const;
export const ALERT_ORIGINAL_EVENT_KIND = `${ALERT_ORIGINAL_EVENT}.kind` as const;
export const ALERT_ORIGINAL_EVENT_MODULE = `${ALERT_ORIGINAL_EVENT}.module` as const;
export const ALERT_ORIGINAL_EVENT_ORIGINAL = `${ALERT_ORIGINAL_EVENT}.original` as const;
export const ALERT_ORIGINAL_EVENT_OUTCOME = `${ALERT_ORIGINAL_EVENT}.outcome` as const;
export const ALERT_ORIGINAL_EVENT_PROVIDER = `${ALERT_ORIGINAL_EVENT}.provider` as const;
export const ALERT_ORIGINAL_EVENT_REASON = `${ALERT_ORIGINAL_EVENT}.reason` as const;
export const ALERT_ORIGINAL_EVENT_REFERENCE = `${ALERT_ORIGINAL_EVENT}.reference` as const;
export const ALERT_ORIGINAL_EVENT_RISK_SCORE = `${ALERT_ORIGINAL_EVENT}.risk_score` as const;
export const ALERT_ORIGINAL_EVENT_RISK_SCORE_NORM = `${ALERT_ORIGINAL_EVENT}.risk_score_norm` as const;
export const ALERT_ORIGINAL_EVENT_SEQUENCE = `${ALERT_ORIGINAL_EVENT}.sequence` as const;
export const ALERT_ORIGINAL_EVENT_SEVERITY = `${ALERT_ORIGINAL_EVENT}.severity` as const;
export const ALERT_ORIGINAL_EVENT_START = `${ALERT_ORIGINAL_EVENT}.start` as const;
export const ALERT_ORIGINAL_EVENT_TIMEZONE = `${ALERT_ORIGINAL_EVENT}.timezone` as const;
export const ALERT_ORIGINAL_EVENT_TYPE = `${ALERT_ORIGINAL_EVENT}.type` as const;
export const ALERT_ORIGINAL_EVENT_URL = `${ALERT_ORIGINAL_EVENT}.url` as const;
export const ALERT_ORIGINAL_TIME = `${ALERT_NAMESPACE}.original_time` as const;
export const ALERT_THREAT = `${ALERT_NAMESPACE}.threat` as const;
export const ALERT_THREAT_FRAMEWORK = `${ALERT_THREAT}.framework` as const;
export const ALERT_THREAT_TACTIC = `${ALERT_THREAT}.tactic` as const;
export const ALERT_THREAT_TACTIC_ID = `${ALERT_THREAT_TACTIC}.id` as const;
export const ALERT_THREAT_TACTIC_NAME = `${ALERT_THREAT_TACTIC}.name` as const;
export const ALERT_THREAT_TACTIC_REFERENCE = `${ALERT_THREAT_TACTIC}.reference` as const;
export const ALERT_THREAT_TECHNIQUE = `${ALERT_THREAT}.technique` as const;
export const ALERT_THREAT_TECHNIQUE_ID = `${ALERT_THREAT_TECHNIQUE}.id` as const;
export const ALERT_THREAT_TECHNIQUE_NAME = `${ALERT_THREAT_TECHNIQUE}.name` as const;
export const ALERT_THREAT_TECHNIQUE_REFERENCE = `${ALERT_THREAT_TECHNIQUE}.reference` as const;
export const ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE = `${ALERT_THREAT_TECHNIQUE}.subtechnique` as const;
export const ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_ID = `${ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE}.id` as const;
export const ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_NAME = `${ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE}.name` as const;
export const ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_REFERENCE = `${ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE}.reference` as const;
export const ALERT_THRESHOLD_RESULT = `${ALERT_NAMESPACE}.threshold_result` as const;
export const ALERT_THRESHOLD_RESULT_CARDINALITY = `${ALERT_THRESHOLD_RESULT}.cardinality` as const;
export const ALERT_THRESHOLD_RESULT_CARDINALITY_FIELD = `${ALERT_THRESHOLD_RESULT_CARDINALITY}.field` as const;
export const ALERT_THRESHOLD_RESULT_CARDINALITY_VALUE = `${ALERT_THRESHOLD_RESULT_CARDINALITY}.value` as const;
export const ALERT_THRESHOLD_RESULT_COUNT = `${ALERT_THRESHOLD_RESULT}.count` as const;
export const ALERT_THRESHOLD_RESULT_FROM = `${ALERT_THRESHOLD_RESULT}.from` as const;
export const ALERT_THRESHOLD_RESULT_TERMS = `${ALERT_THRESHOLD_RESULT}.terms` as const;
export const ALERT_THRESHOLD_RESULT_TERMS_FIELD = `${ALERT_THRESHOLD_RESULT_TERMS}.field` as const;
export const ALERT_THRESHOLD_RESULT_TERMS_VALUE = `${ALERT_THRESHOLD_RESULT_TERMS}.value` as const;
export const ALERT_RULE_BUILDING_BLOCK_TYPE = `${ALERT_RULE_NAMESPACE}.building_block_type` as const;
export const ALERT_RULE_EXCEPTIONS_LIST = `${ALERT_RULE_NAMESPACE}.exceptions_list` as const;
export const ALERT_RULE_FALSE_POSITIVES = `${ALERT_RULE_NAMESPACE}.false_positives` as const;
export const ALERT_RULE_FILTERS = `${ALERT_RULE_NAMESPACE}.filters` as const;
export const ALERT_RULE_IMMUTABLE = `${ALERT_RULE_NAMESPACE}.immutable` as const;
export const ALERT_RULE_INDEX = `${ALERT_RULE_NAMESPACE}.index` as const;
export const ALERT_RULE_LANGUAGE = `${ALERT_RULE_NAMESPACE}.language` as const;
export const ALERT_RULE_MAX_SIGNALS = `${ALERT_RULE_NAMESPACE}.max_signals` as const;
export const ALERT_RULE_QUERY = `${ALERT_RULE_NAMESPACE}.query` as const;
// TODO: Could be deprecated
export const ALERT_RULE_SAVED_ID = `${ALERT_RULE_NAMESPACE}.saved_id` as const;
// TODO: not accounted for in the excel doc
export const ALERT_RULE_SIZE = `${ALERT_RULE_NAMESPACE}.size` as const;
export const ALERT_RULE_THREAT_MAPPING_ENTRIES_FIELD = `${ALERT_RULE_NAMESPACE}.threat_mapping.entries.field` as const;
export const ALERT_RULE_THREAT_MAPPING_ENTRIES_VALUE = `${ALERT_RULE_NAMESPACE}.threat_mapping.entries.value` as const;
export const ALERT_RULE_THREAT_MAPPING_ENTRIES_TYPE = `${ALERT_RULE_NAMESPACE}.threat_mapping.entries.type` as const;
export const ALERT_RULE_THRESHOLD = `${ALERT_RULE_NAMESPACE}.threshold` as const;
export const ALERT_RULE_TIMELINE_ID = `${ALERT_RULE_NAMESPACE}.timeline_id` as const;
export const ALERT_RULE_TIMELINE_TITLE = `${ALERT_RULE_NAMESPACE}.timeline_title` as const;
export const ALERT_RULE_THREAT = `${ALERT_RULE_NAMESPACE}.threat` as const;
export const ALERT_RULE_THREAT_FRAMEWORK = `${ALERT_RULE_THREAT}.framework` as const;
export const ALERT_RULE_THREAT_TACTIC = `${ALERT_RULE_THREAT}.tactic` as const;
export const ALERT_RULE_THREAT_TACTIC_ID = `${ALERT_RULE_THREAT_TACTIC}.id` as const;
export const ALERT_RULE_THREAT_TACTIC_NAME = `${ALERT_RULE_THREAT_TACTIC}.name` as const;
export const ALERT_RULE_THREAT_TACTIC_REFERENCE = `${ALERT_RULE_THREAT_TACTIC}.reference` as const;
export const ALERT_RULE_THREAT_TECHNIQUE = `${ALERT_RULE_THREAT}.technique` as const;
export const ALERT_RULE_THREAT_TECHNIQUE_ID = `${ALERT_RULE_THREAT_TECHNIQUE}.id` as const;
export const ALERT_RULE_THREAT_TECHNIQUE_NAME = `${ALERT_RULE_THREAT_TECHNIQUE}.name` as const;
export const ALERT_RULE_THREAT_TECHNIQUE_REFERENCE = `${ALERT_RULE_THREAT_TECHNIQUE}.reference` as const;

const securityFields = {
  ALERT_ANCESTORS,
  ALERT_ANCESTORS_DEPTH,
  ALERT_ANCESTORS_ID,
  ALERT_ANCESTORS_INDEX,
  ALERT_ANCESTORS_RULE,
  ALERT_ANCESTORS_TYPE,
  ALERT_DEPTH,
  ALERT_GROUP,
  ALERT_GROUP_ID,
  ALERT_GROUP_INDEX,
  ALERT_ORIGINAL_EVENT,
  ALERT_ORIGINAL_EVENT_ACTION,
  ALERT_ORIGINAL_EVENT_AGENT_ID_STATUS,
  ALERT_ORIGINAL_EVENT_CATEGORY,
  ALERT_ORIGINAL_EVENT_CODE,
  ALERT_ORIGINAL_EVENT_CREATED,
  ALERT_ORIGINAL_EVENT_DATASET,
  ALERT_ORIGINAL_EVENT_DURATION,
  ALERT_ORIGINAL_EVENT_END,
  ALERT_ORIGINAL_EVENT_HASH,
  ALERT_ORIGINAL_EVENT_ID,
  ALERT_ORIGINAL_EVENT_INGESTED,
  ALERT_ORIGINAL_EVENT_KIND,
  ALERT_ORIGINAL_EVENT_MODULE,
  ALERT_ORIGINAL_EVENT_ORIGINAL,
  ALERT_ORIGINAL_EVENT_OUTCOME,
  ALERT_ORIGINAL_EVENT_PROVIDER,
  ALERT_ORIGINAL_EVENT_REASON,
  ALERT_ORIGINAL_EVENT_REFERENCE,
  ALERT_ORIGINAL_EVENT_RISK_SCORE,
  ALERT_ORIGINAL_EVENT_RISK_SCORE_NORM,
  ALERT_ORIGINAL_EVENT_SEQUENCE,
  ALERT_ORIGINAL_EVENT_SEVERITY,
  ALERT_ORIGINAL_EVENT_START,
  ALERT_ORIGINAL_EVENT_TIMEZONE,
  ALERT_ORIGINAL_EVENT_TYPE,
  ALERT_ORIGINAL_EVENT_URL,
  ALERT_ORIGINAL_TIME,
  ALERT_THREAT,
  ALERT_THREAT_FRAMEWORK,
  ALERT_THREAT_TACTIC,
  ALERT_THREAT_TACTIC_ID,
  ALERT_THREAT_TACTIC_NAME,
  ALERT_THREAT_TACTIC_REFERENCE,
  ALERT_THREAT_TECHNIQUE,
  ALERT_THREAT_TECHNIQUE_ID,
  ALERT_THREAT_TECHNIQUE_NAME,
  ALERT_THREAT_TECHNIQUE_REFERENCE,
  ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE,
  ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_ID,
  ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_NAME,
  ALERT_THREAT_TECHNIQUE_SUBTECHNIQUE_REFERENCE,
  ALERT_THRESHOLD_RESULT,
  ALERT_THRESHOLD_RESULT_CARDINALITY,
  ALERT_THRESHOLD_RESULT_CARDINALITY_FIELD,
  ALERT_THRESHOLD_RESULT_CARDINALITY_VALUE,
  ALERT_THRESHOLD_RESULT_COUNT,
  ALERT_THRESHOLD_RESULT_FROM,
  ALERT_THRESHOLD_RESULT_TERMS,
  ALERT_THRESHOLD_RESULT_TERMS_FIELD,
  ALERT_THRESHOLD_RESULT_TERMS_VALUE,
  ALERT_RULE_BUILDING_BLOCK_TYPE,
  ALERT_RULE_EXCEPTIONS_LIST,
  ALERT_RULE_FALSE_POSITIVES,
  ALERT_RULE_FILTERS,
  ALERT_RULE_IMMUTABLE,
  ALERT_RULE_INDEX,
  ALERT_RULE_LANGUAGE,
  ALERT_RULE_MAX_SIGNALS,
  ALERT_RULE_QUERY,
  ALERT_RULE_SAVED_ID,
  ALERT_RULE_SIZE,
  ALERT_RULE_THRESHOLD,
  ALERT_RULE_TIMELINE_ID,
  ALERT_RULE_TIMELINE_TITLE,
  ALERT_RULE_THREAT,
  ALERT_RULE_THREAT_FRAMEWORK,
  ALERT_RULE_THREAT_TACTIC,
  ALERT_RULE_THREAT_TACTIC_ID,
  ALERT_RULE_THREAT_TACTIC_NAME,
  ALERT_RULE_THREAT_TACTIC_REFERENCE,
  ALERT_RULE_THREAT_TECHNIQUE,
  ALERT_RULE_THREAT_TECHNIQUE_ID,
  ALERT_RULE_THREAT_TECHNIQUE_NAME,
  ALERT_RULE_THREAT_TECHNIQUE_REFERENCE,
};

export type SecurityAlertRuleDataFieldName =
  | ValuesType<typeof securityFields>
  | TechnicalRuleDataFieldName;
