openapi: 3.0.1
info:
  title: Cases
  description: OpenAPI schema for Cases endpoints
  version: '0.2'
  contact:
    name: Cases Team
  license:
    name: Elastic License 2.0
    url: https://www.elastic.co/licensing/elastic-license
tags:
  - name: cases
    description: Case APIs enable you to open and track issues.
servers:
  - url: http://localhost:5601
    description: local
paths:
  /s/{spaceId}/api/cases:
    post:
      summary: Creates a case.
      operationId: createCase
      description: |
        You must have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana  feature privileges, depending on the owner of the case you're creating.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_case_request'
            examples:
              createCaseRequest:
                $ref: '#/components/examples/create_case_request'
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/case_response_properties'
              examples:
                createCaseResponse:
                  $ref: '#/components/examples/create_case_response'
      servers:
        - url: https://localhost:5601
    delete:
      summary: Deletes one or more cases.
      operationId: deleteCase
      description: |
        You must have `read` or `all` privileges and the `delete` sub-feature privilege for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the cases you're deleting.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/space_id'
        - name: ids
          description: The cases that you want to removed. All non-ASCII characters must be URL encoded.
          in: query
          required: true
          schema:
            type: string
          example: d4e7abb0-b462-11ec-9a8d-698504725a43
      responses:
        '204':
          description: Indicates a successful call.
      servers:
        - url: https://localhost:5601
    patch:
      summary: Updates one or more cases.
      operationId: updateCase
      description: |
        You must have `all` privileges for the **Cases** feature in the  **Management**, **Observability**, or **Security** section of the Kibana  feature privileges, depending on the owner of the case you're updating.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/update_case_request'
            examples:
              updateCaseRequest:
                $ref: '#/components/examples/update_case_request'
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/case_response_properties'
              examples:
                updateCaseResponse:
                  $ref: '#/components/examples/update_case_response'
      servers:
        - url: https://localhost:5601
    servers:
      - url: https://localhost:5601
  /s/{spaceId}/api/cases/configure/{configurationId}:
    patch:
      summary: Updates external connection details, such as the closure type and default connector for cases.
      operationId: updateCaseConfiguration
      description: |
        You must have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the case configuration. Connectors are used to interface with external systems. You must create a connector before you can use it in your cases. Refer to the add connectors API.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/configuration_id'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                closure_type:
                  $ref: '#/components/schemas/closure_types'
                connector:
                  description: An object that contains the connector configuration.
                  type: object
                  properties:
                    fields:
                      description: The fields specified in the case configuration are not used and are not propagated to individual cases, therefore it is recommended to set this object to `null`.
                      nullable: true
                      type: object
                    id:
                      description: The identifier for the connector. To create a case without a connector, use `none`.
                      type: string
                    name:
                      description: The name of the connector. To create a case without a connector, use `none`.
                      type: string
                    type:
                      $ref: '#/components/schemas/connector_types'
                  required:
                    - fields
                    - id
                    - name
                    - type
                version:
                  description: |
                    The version of the connector. To retrieve the version value, use the get configuration API.
                  type: string
                  example: WzIwMiwxXQ==
              required:
                - version
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json; charset=utf-8:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    closure_type:
                      $ref: '#/components/schemas/closure_types'
                    connector:
                      type: object
                      properties:
                        fields:
                          description: An object containing the connector fields. To create a case without a connector, specify null. If you want to omit any individual field, specify null as its value.
                          nullable: true
                          type: object
                          properties:
                            caseId:
                              description: The case identifier for Swimlane connectors.
                              type: string
                            category:
                              description: The category of the incident for ServiceNow ITSM and ServiceNow SecOps connectors.
                              type: string
                            destIp:
                              description: Indicates whether cases will send a comma-separated list of destination IPs for ServiceNow SecOps connectors.
                              type: boolean
                              nullable: true
                            impact:
                              description: The effect an incident had on business for ServiceNow ITSM connectors.
                              type: string
                            issueType:
                              description: The type of issue for Jira connectors.
                              type: string
                            issueTypes:
                              description: The type of incident for IBM Resilient connectors.
                              type: array
                              items:
                                type: string
                            malwareHash:
                              description: Indicates whether cases will send a comma-separated list of malware hashes for ServiceNow SecOps connectors.
                              type: boolean
                              nullable: true
                            malwareUrl:
                              description: Indicates whether cases will send a comma-separated list of malware URLs for ServiceNow SecOps connectors.
                              type: boolean
                              nullable: true
                            parent:
                              description: The key of the parent issue, when the issue type is sub-task for Jira connectors.
                              type: string
                            priority:
                              description: The priority of the issue for Jira and ServiceNow SecOps connectors.
                              type: string
                            severity:
                              description: The severity of the incident for ServiceNow ITSM connectors.
                              type: string
                            severityCode:
                              description: The severity code of the incident for IBM Resilient connectors.
                              type: string
                            sourceIp:
                              description: Indicates whether cases will send a comma-separated list of source IPs for ServiceNow SecOps connectors.
                              type: boolean
                              nullable: true
                            subcategory:
                              description: The subcategory of the incident for ServiceNow ITSM connectors.
                              type: string
                            urgency:
                              description: The extent to which the incident resolution can be delayed for ServiceNow ITSM connectors.
                              type: string
                          example: null
                        id:
                          description: The identifier for the connector. To create a case without a connector, use `none`.
                          type: string
                          example: none
                        name:
                          description: The name of the connector. To create a case without a connector, use `none`.
                          type: string
                          example: none
                        type:
                          $ref: '#/components/schemas/connector_types'
                    created_at:
                      type: string
                      format: date-time
                      example: '2022-06-01T17:07:17.767Z'
                    created_by:
                      type: object
                      properties:
                        email:
                          type: string
                          example: null
                        full_name:
                          type: string
                          example: null
                        username:
                          type: string
                          example: elastic
                    error:
                      type: string
                      example: null
                    id:
                      type: string
                      example: 4a97a440-e1cd-11ec-be9b-9b1838238ee6
                    mappings:
                      type: array
                      items:
                        type: object
                        properties:
                          action_type:
                            type: string
                            example: overwrite
                          source:
                            type: string
                            example: title
                          target:
                            type: string
                            example: summary
                    owner:
                      $ref: '#/components/schemas/owners'
                    updated_at:
                      type: string
                      format: date-time
                      nullable: true
                      example: '2022-06-01T19:58:48.169Z'
                    updated_by:
                      type: object
                      properties:
                        email:
                          type: string
                          example: null
                        full_name:
                          type: string
                          example: null
                        username:
                          type: string
                          example: elastic
                      nullable: true
                    version:
                      type: string
                      example: WzIwNzMsMV0=
      servers:
        - url: https://localhost:5601
    servers:
      - url: https://localhost:5601
  /s/{spaceId}/api/cases/{caseId}/comments:
    post:
      summary: Adds a comment or alert to a case.
      operationId: addCaseComment
      description: |
        You must have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the case you're creating.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/case_id'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/add_case_comment_request'
            examples:
              createCaseCommentRequest:
                $ref: '#/components/examples/add_comment_request'
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/case_response_properties'
              examples:
                createCaseCommentResponse:
                  $ref: '#/components/examples/add_comment_response'
      servers:
        - url: https://localhost:5601
    delete:
      summary: Deletes all comments and alerts from a case.
      operationId: deleteCaseComments
      description: |
        You must have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the cases you're deleting.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/case_id'
        - $ref: '#/components/parameters/space_id'
      responses:
        '204':
          description: Indicates a successful call.
      servers:
        - url: https://localhost:5601
    patch:
      summary: Updates a comment or alert in a case.
      operationId: updateCaseComment
      description: |
        You must have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the case you're updating. NOTE: You cannot change the comment type or the owner of a comment.
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/case_id'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/update_case_comment_request'
            examples:
              updateCaseCommentRequest:
                $ref: '#/components/examples/update_comment_request'
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/case_response_properties'
              examples:
                updateCaseCommentResponse:
                  $ref: '#/components/examples/update_comment_response'
      servers:
        - url: https://localhost:5601
    get:
      summary: Retrieves all the comments from a case.
      operationId: getAllCaseComments
      description: |
        You must have `read` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the cases with the comments you're seeking.
      deprecated: true
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/case_id'
        - $ref: '#/components/parameters/space_id'
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/case_response_properties'
      servers:
        - url: https://localhost:5601
    servers:
      - url: https://localhost:5601
  /s/{spaceId}/api/cases/{caseId}/connector/{connectorId}/_push:
    post:
      summary: Pushes a case to an external service.
      description: |
        You must have `all` privileges for the **Actions and Connectors** feature in the **Management** section of the Kibana feature privileges. You must also have `all` privileges for the **Cases** feature in the **Management**, **Observability**, or **Security** section of the Kibana feature privileges, depending on the owner of the case you're pushing.
      operationId: pushCase
      tags:
        - cases
      parameters:
        - $ref: '#/components/parameters/case_id'
        - $ref: '#/components/parameters/connector_id'
        - $ref: '#/components/parameters/kbn_xsrf'
        - $ref: '#/components/parameters/space_id'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              nullable: true
      responses:
        '200':
          description: Indicates a successful call.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/case_response_properties'
              examples:
                pushCaseResponse:
                  $ref: '#/components/examples/push_case_response'
      servers:
        - url: https://localhost:5601
    servers:
      - url: https://localhost:5601
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
    apiKeyAuth:
      type: apiKey
      in: header
      name: ApiKey
  parameters:
    kbn_xsrf:
      schema:
        type: string
      in: header
      name: kbn-xsrf
      required: true
    space_id:
      in: path
      name: spaceId
      description: An identifier for the space. If `/s/` and the identifier are omitted from the path, the default space is used.
      required: true
      schema:
        type: string
        example: default
    configuration_id:
      in: path
      name: configurationId
      description: An identifier for the configuration.
      required: true
      schema:
        type: string
        example: 3297a0f0-b5ec-11ec-b141-0fdb20a7f9a9
    case_id:
      in: path
      name: caseId
      description: The identifier for the case. To retrieve case IDs, use the find cases API. All non-ASCII characters must be URL encoded.
      required: true
      schema:
        type: string
        example: 9c235210-6834-11ea-a78c-6ffb38a34414
    connector_id:
      in: path
      name: connectorId
      description: An identifier for the connector. To retrieve connector IDs, use the find connectors API.
      required: true
      schema:
        type: string
        example: abed3a70-71bd-11ea-a0b2-c51ea50a58e2
  schemas:
    connector_properties_none:
      title: Create or update case request properties for no connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.none`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. To create a case without a connector, specify null. To update a case to remove the connector, specify null.
          nullable: true
          type: string
          example: null
        id:
          description: The identifier for the connector. To create a case without a connector, use `none`. To update a case to remove the connector, specify `none`.
          type: string
          example: none
        name:
          description: The name of the connector. To create a case without a connector, use `none`. To update a case to remove the connector, specify `none`.
          type: string
          example: none
        type:
          description: The type of connector. To create a case without a connector, use `.none`. To update a case to remove the connector, specify `.none`.
          type: string
          example: .none
          enum:
            - .none
    connector_properties_cases_webhook:
      title: Create or upate case request properties for Cases Webhook connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.cases-webhook`.
      type: object
      properties:
        fields:
          type: string
          nullable: true
          example: null
        id:
          description: The identifier for the connector. To retrieve connector IDs, use the find connectors API.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .cases-webhook
          enum:
            - .cases-webhook
    connector_properties_jira:
      title: Create or update case request properties for a Jira connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.jira`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. If you want to omit any individual field, specify null as its value.
          type: object
          required:
            - issueType
            - parent
            - priority
          properties:
            issueType:
              description: The type of issue.
              type: string
              nullable: true
            parent:
              description: The key of the parent issue, when the issue type is sub-task.
              type: string
              nullable: true
            priority:
              description: The priority of the issue.
              type: string
              nullable: true
        id:
          description: The identifier for the connector. To retrieve connector IDs, use the find connectors API.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .jira
          enum:
            - .jira
    connector_properties_resilient:
      title: Create case request properties for a IBM Resilient connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.resilient`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. If you want to omit any individual field, specify null as its value.
          type: object
          nullable: true
          required:
            - issueTypes
            - severityCode
          properties:
            issueTypes:
              description: The type of incident.
              type: array
              items:
                type: string
            severityCode:
              description: The severity code of the incident.
              type: string
        id:
          description: The identifier for the connector.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .resilient
          enum:
            - .resilient
    connector_properties_servicenow:
      title: Create case request properties for a ServiceNow ITSM connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.servicenow`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. If you want to omit any individual field, specify null as its value.
          type: object
          required:
            - category
            - impact
            - severity
            - subcategory
            - urgency
          properties:
            category:
              description: The category of the incident.
              type: string
              nullable: true
            impact:
              description: The effect an incident had on business.
              type: string
              nullable: true
            severity:
              description: The severity of the incident.
              type: string
              nullable: true
            subcategory:
              description: The subcategory of the incident.
              type: string
              nullable: true
            urgency:
              description: The extent to which the incident resolution can be delayed.
              type: string
              nullable: true
        id:
          description: The identifier for the connector. To retrieve connector IDs, use the find connectors API.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .servicenow
          enum:
            - .servicenow
    connector_properties_servicenow_sir:
      title: Create case request properties for a ServiceNow SecOps connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.servicenow-sir`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. If you want to omit any individual field, specify null as its value.
          type: object
          required:
            - category
            - destIp
            - malwareHash
            - malwareUrl
            - priority
            - sourceIp
            - subcategory
          properties:
            category:
              description: The category of the incident.
              type: string
              nullable: true
            destIp:
              description: Indicates whether cases will send a comma-separated list of destination IPs.
              type: boolean
              nullable: true
            malwareHash:
              description: Indicates whether cases will send a comma-separated list of malware hashes.
              type: boolean
              nullable: true
            malwareUrl:
              description: Indicates whether cases will send a comma-separated list of malware URLs.
              type: boolean
              nullable: true
            priority:
              description: The priority of the issue.
              type: string
              nullable: true
            sourceIp:
              description: Indicates whether cases will send a comma-separated list of source IPs.
              type: boolean
              nullable: true
            subcategory:
              description: The subcategory of the incident.
              type: string
              nullable: true
        id:
          description: The identifier for the connector. To retrieve connector IDs, use the find connectors API.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .servicenow-sir
          enum:
            - .servicenow-sir
    connector_properties_swimlane:
      title: Create case request properties for a Swimlane connector
      required:
        - fields
        - id
        - name
        - type
      description: Defines properties for connectors when type is `.swimlane`.
      type: object
      properties:
        fields:
          description: An object containing the connector fields. If you want to omit any individual field, specify null as its value.
          type: object
          required:
            - caseId
          properties:
            caseId:
              description: The case identifier for Swimlane connectors.
              type: string
              nullable: true
        id:
          description: The identifier for the connector. To retrieve connector IDs, use the find connectors API.
          type: string
        name:
          description: The name of the connector.
          type: string
        type:
          description: The type of connector.
          type: string
          example: .swimlane
          enum:
            - .swimlane
    owners:
      type: string
      description: |
        The application that owns the cases: Stack Management, Observability, or Elastic Security.
      enum:
        - cases
        - observability
        - securitySolution
      example: cases
    settings:
      type: object
      description: An object that contains the case settings.
      required:
        - syncAlerts
      properties:
        syncAlerts:
          description: Turns alert syncing on or off.
          type: boolean
          example: true
    severity_property:
      type: string
      description: The severity of the case.
      enum:
        - critical
        - high
        - low
        - medium
      default: low
    create_case_request:
      title: Create case request
      description: The create case API request body varies depending on the type of connector.
      type: object
      required:
        - connector
        - description
        - owner
        - settings
        - tags
        - title
      properties:
        assignees:
          type: array
          description: An array containing users that are assigned to the case.
          nullable: true
          items:
            type: object
            required:
              - uid
            properties:
              uid:
                type: string
                description: A unique identifier for the user profile. These identifiers can be found by using the suggest user profile API.
                example: u_0wpfV1MqYDaXzLtRVY-gLMrddKDEmfz51Fszhj7hWC8_0
        connector:
          oneOf:
            - $ref: '#/components/schemas/connector_properties_none'
            - $ref: '#/components/schemas/connector_properties_cases_webhook'
            - $ref: '#/components/schemas/connector_properties_jira'
            - $ref: '#/components/schemas/connector_properties_resilient'
            - $ref: '#/components/schemas/connector_properties_servicenow'
            - $ref: '#/components/schemas/connector_properties_servicenow_sir'
            - $ref: '#/components/schemas/connector_properties_swimlane'
        description:
          description: The description for the case.
          type: string
        owner:
          $ref: '#/components/schemas/owners'
        settings:
          $ref: '#/components/schemas/settings'
        severity:
          $ref: '#/components/schemas/severity_property'
        tags:
          description: The words and phrases that help categorize cases. It can be an empty array.
          type: array
          items:
            type: string
        title:
          description: A title for the case.
          type: string
    case_response_closed_by_properties:
      title: Case response properties for closed_by
      type: object
      nullable: true
      properties:
        email:
          type: string
          example: null
          nullable: true
        full_name:
          type: string
          example: null
          nullable: true
        username:
          type: string
          example: elastic
          nullable: true
        profile_uid:
          type: string
          example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
      required:
        - email
        - full_name
        - username
    alert_comment_response_properties:
      title: Add case comment response properties for alerts
      type: object
      required:
        - type
      properties:
        alertId:
          type: string
          example: 6b24c4dc44bc720cfc92797f3d61fff952f2b2627db1fb4f8cc49f4530c4ff42
        created_at:
          type: string
          format: date-time
          example: '2022-03-24T02:31:03.210Z'
        created_by:
          type: object
          properties:
            email:
              type: string
              example: null
              nullable: true
            full_name:
              type: string
              example: null
              nullable: true
            username:
              type: string
              example: elastic
              nullable: true
            profile_uid:
              type: string
              example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
        id:
          type: string
          example: 73362370-ab1a-11ec-985f-97e55adae8b9
        index:
          type: string
          example: .internal.alerts-security.alerts-default-000001
        owner:
          $ref: '#/components/schemas/owners'
        pushed_at:
          type: string
          format: date-time
          example: null
          nullable: true
        pushed_by:
          type: object
          properties:
            email:
              type: string
              example: null
              nullable: true
            full_name:
              type: string
              example: null
              nullable: true
            username:
              type: string
              example: elastic
              nullable: true
            profile_uid:
              type: string
              example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
          nullable: true
        rule:
          type: object
          properties:
            id:
              description: The rule identifier.
              type: string
              example: 94d80550-aaf4-11ec-985f-97e55adae8b9
            name:
              description: The rule name.
              type: string
              example: security_rule
        type:
          type: string
          example: alert
          enum:
            - alert
        updated_at:
          type: string
          format: date-time
          example: null
        updated_by:
          type: object
          properties:
            email:
              type: string
              example: null
              nullable: true
            full_name:
              type: string
              example: null
              nullable: true
            username:
              type: string
              example: elastic
              nullable: true
            profile_uid:
              type: string
              example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
        version:
          type: string
          example: WzMwNDgsMV0=
    case_response_created_by_properties:
      title: Case response properties for created_by
      type: object
      properties:
        email:
          type: string
          example: null
          nullable: true
        full_name:
          type: string
          example: null
          nullable: true
        username:
          type: string
          example: elastic
          nullable: true
        profile_uid:
          type: string
          example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
      required:
        - email
        - full_name
        - username
    case_response_pushed_by_properties:
      title: Case response properties for pushed_by
      type: object
      nullable: true
      properties:
        email:
          type: string
          example: null
          nullable: true
        full_name:
          type: string
          example: null
          nullable: true
        username:
          type: string
          example: elastic
          nullable: true
        profile_uid:
          type: string
          example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
      required:
        - email
        - full_name
        - username
    case_response_updated_by_properties:
      title: Case response properties for updated_by
      type: object
      nullable: true
      properties:
        email:
          type: string
          example: null
          nullable: true
        full_name:
          type: string
          example: null
          nullable: true
        username:
          type: string
          example: elastic
          nullable: true
        profile_uid:
          type: string
          example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
      required:
        - email
        - full_name
        - username
    user_comment_response_properties:
      title: Case response properties for user comments
      type: object
      required:
        - type
      properties:
        comment:
          type: string
          example: A new comment.
        created_at:
          type: string
          format: date-time
          example: '2022-05-13T09:16:17.416Z'
        created_by:
          $ref: '#/components/schemas/case_response_created_by_properties'
        id:
          type: string
          example: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
        owner:
          $ref: '#/components/schemas/owners'
        pushed_at:
          type: string
          format: date-time
          nullable: true
          example: null
        pushed_by:
          $ref: '#/components/schemas/case_response_pushed_by_properties'
        type:
          type: string
          example: user
          enum:
            - user
        updated_at:
          type: string
          format: date-time
          nullable: true
          example: null
        updated_by:
          $ref: '#/components/schemas/case_response_updated_by_properties'
        version:
          type: string
          example: WzIwNDMxLDFd
    external_service:
      type: object
      nullable: true
      properties:
        connector_id:
          type: string
        connector_name:
          type: string
        external_id:
          type: string
        external_title:
          type: string
        external_url:
          type: string
        pushed_at:
          type: string
          format: date-time
        pushed_by:
          type: object
          properties:
            email:
              type: string
              example: null
              nullable: true
            full_name:
              type: string
              example: null
              nullable: true
            username:
              type: string
              example: elastic
              nullable: true
            profile_uid:
              type: string
              example: u_J41Oh6L9ki-Vo2tOogS8WRTENzhHurGtRc87NgEAlkc_0
          nullable: true
    status:
      type: string
      description: The status of the case.
      enum:
        - closed
        - in-progress
        - open
    case_response_properties:
      title: Case response properties
      type: object
      required:
        - closed_at
        - closed_by
        - comments
        - connector
        - created_at
        - created_by
        - description
        - duration
        - external_service
        - id
        - owner
        - settings
        - severity
        - status
        - tags
        - title
        - totalAlerts
        - totalComment
        - updated_at
        - updated_by
        - version
      properties:
        assignees:
          type: array
          description: An array containing users that are assigned to the case.
          nullable: true
          items:
            type: object
            required:
              - uid
            properties:
              uid:
                type: string
                description: A unique identifier for the user profile. You can use the get user profile API to retrieve more details.
                example: u_0wpfV1MqYDaXzLtRVY-gLMrddKDEmfz51Fszhj7hWC8_0
        closed_at:
          type: string
          format: date-time
          nullable: true
        closed_by:
          $ref: '#/components/schemas/case_response_closed_by_properties'
        comments:
          title: Case response properties for comments
          description: An array of comment objects for the case.
          type: array
          items:
            discriminator:
              propertyName: type
            oneOf:
              - $ref: '#/components/schemas/alert_comment_response_properties'
              - $ref: '#/components/schemas/user_comment_response_properties'
        connector:
          title: Case response properties for connectors
          discriminator:
            propertyName: type
          oneOf:
            - $ref: '#/components/schemas/connector_properties_none'
            - $ref: '#/components/schemas/connector_properties_cases_webhook'
            - $ref: '#/components/schemas/connector_properties_jira'
            - $ref: '#/components/schemas/connector_properties_resilient'
            - $ref: '#/components/schemas/connector_properties_servicenow'
            - $ref: '#/components/schemas/connector_properties_servicenow_sir'
            - $ref: '#/components/schemas/connector_properties_swimlane'
        created_at:
          type: string
          format: date-time
          example: '2022-05-13T09:16:17.416Z'
        created_by:
          $ref: '#/components/schemas/case_response_created_by_properties'
        description:
          type: string
          example: A case description.
        duration:
          type: integer
          description: |
            The elapsed time from the creation of the case to its closure (in seconds). If the case has not been closed, the duration is set to null. If the case was closed after less than half a second, the duration is rounded down to zero.
          nullable: true
          example: 120
        external_service:
          $ref: '#/components/schemas/external_service'
        id:
          type: string
          example: 66b9aa00-94fa-11ea-9f74-e7e108796192
        owner:
          $ref: '#/components/schemas/owners'
        settings:
          $ref: '#/components/schemas/settings'
        severity:
          $ref: '#/components/schemas/severity_property'
        status:
          $ref: '#/components/schemas/status'
        tags:
          type: array
          items:
            type: string
          example:
            - tag-1
        title:
          type: string
          example: Case title 1
        totalAlerts:
          type: integer
          example: 0
        totalComment:
          type: integer
          example: 0
        updated_at:
          type: string
          format: date-time
          nullable: true
        updated_by:
          $ref: '#/components/schemas/case_response_updated_by_properties'
        version:
          type: string
          example: WzUzMiwxXQ==
    update_case_request:
      title: Update case request
      description: The update case API request body varies depending on the type of connector.
      type: object
      required:
        - cases
      properties:
        cases:
          type: array
          description: An array containing one or more case objects.
          items:
            type: object
            required:
              - id
              - version
            properties:
              assignees:
                type: array
                description: An array containing users that are assigned to the case.
                nullable: true
                items:
                  type: object
                  required:
                    - uid
                  properties:
                    uid:
                      type: string
                      description: A unique identifier for the user profile. These identifiers can be found by using the suggest user profile API.
                      example: u_0wpfV1MqYDaXzLtRVY-gLMrddKDEmfz51Fszhj7hWC8_0
              connector:
                oneOf:
                  - $ref: '#/components/schemas/connector_properties_none'
                  - $ref: '#/components/schemas/connector_properties_cases_webhook'
                  - $ref: '#/components/schemas/connector_properties_jira'
                  - $ref: '#/components/schemas/connector_properties_resilient'
                  - $ref: '#/components/schemas/connector_properties_servicenow'
                  - $ref: '#/components/schemas/connector_properties_servicenow_sir'
                  - $ref: '#/components/schemas/connector_properties_swimlane'
              description:
                description: An updated description for the case.
                type: string
              id:
                description: The identifier for the case.
                type: string
              settings:
                $ref: '#/components/schemas/settings'
              severity:
                $ref: '#/components/schemas/severity_property'
              status:
                $ref: '#/components/schemas/status'
              tags:
                description: The words and phrases that help categorize cases.
                type: array
                items:
                  type: string
              title:
                description: A title for the case.
                type: string
              version:
                description: The current version of the case. To determine this value, use the get case or find cases APIs.
                type: string
    closure_types:
      type: string
      description: Indicates whether a case is automatically closed when it is pushed to external systems (`close-by-pushing`) or not automatically closed (`close-by-user`).
      enum:
        - close-by-pushing
        - close-by-user
      example: close-by-user
    connector_types:
      type: string
      description: The type of connector.
      enum:
        - .cases-webhook
        - .jira
        - .none
        - .resilient
        - .servicenow
        - .servicenow-sir
        - .swimlane
      example: .none
    alert_identifiers:
      title: Alert identifiers
      description: |
        The alert identifier. It is required only when `type` is `alert`. If it is an array, `index` must also be an array with the same length or number of elements. This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
      oneOf:
        - type: string
        - type: array
          items:
            type: string
      x-technical-preview: true
      example: 6b24c4dc44bc720cfc92797f3d61fff952f2b2627db1fb4f8cc49f4530c4ff42
    alert_indices:
      title: Alert indices
      description: |
        The alert index. It is required only when `type` is `alert`. If it is an array, `alertId` must also be an array with the same length or number of elements. This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
      oneOf:
        - type: string
        - type: array
          items:
            type: string
      x-technical-preview: true
    rule:
      title: Alerting rule
      description: |
        The rule that is associated with the alert. It is required only when `type` is `alert`. This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
      type: object
      x-technical-preview: true
      properties:
        id:
          description: The rule identifier.
          type: string
          example: 94d80550-aaf4-11ec-985f-97e55adae8b9
        name:
          description: The rule name.
          type: string
          example: security_rule
    add_alert_comment_request_properties:
      title: Add case comment request properties for alerts
      required:
        - alertId
        - index
        - owner
        - rule
        - type
      description: Defines properties for case comment requests when type is alert.
      type: object
      properties:
        alertId:
          $ref: '#/components/schemas/alert_identifiers'
        index:
          $ref: '#/components/schemas/alert_indices'
        owner:
          $ref: '#/components/schemas/owners'
        rule:
          $ref: '#/components/schemas/rule'
        type:
          description: The type of comment.
          type: string
          example: alert
          enum:
            - alert
    add_user_comment_request_properties:
      title: Add case comment request properties for user comments
      description: Defines properties for case comment requests when type is user.
      type: object
      properties:
        comment:
          description: The new comment. It is required only when `type` is `user`.
          type: string
          example: A new comment.
        owner:
          $ref: '#/components/schemas/owners'
        type:
          type: string
          description: The type of comment.
          example: user
          enum:
            - user
      required:
        - comment
        - owner
        - type
    add_case_comment_request:
      title: Add case comment request
      description: The add comment to case API request body varies depending on whether you are adding an alert or a comment.
      discriminator:
        propertyName: type
      oneOf:
        - $ref: '#/components/schemas/add_alert_comment_request_properties'
        - $ref: '#/components/schemas/add_user_comment_request_properties'
    update_alert_comment_request_properties:
      title: Update case comment request properties for alerts
      description: Defines properties for case comment requests when type is alert.
      required:
        - alertId
        - id
        - index
        - owner
        - rule
        - type
        - version
      type: object
      properties:
        alertId:
          $ref: '#/components/schemas/alert_identifiers'
        id:
          type: string
          description: |
            The identifier for the comment. To retrieve comment IDs, use the get comments API.
          example: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
        index:
          $ref: '#/components/schemas/alert_indices'
        owner:
          $ref: '#/components/schemas/owners'
        rule:
          $ref: '#/components/schemas/rule'
        type:
          description: The type of comment.
          type: string
          enum:
            - alert
          example: alert
        version:
          description: |
            The current comment version. To retrieve version values, use the get comments API.
          type: string
          example: Wzk1LDFd
    update_user_comment_request_properties:
      title: Update case comment request properties for user comments
      description: Defines properties for case comment requests when type is user.
      type: object
      properties:
        comment:
          description: The new comment. It is required only when `type` is `user`.
          type: string
          example: A new comment.
        id:
          type: string
          description: |
            The identifier for the comment. To retrieve comment IDs, use the get comments API.
          example: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
        owner:
          $ref: '#/components/schemas/owners'
        type:
          type: string
          description: The type of comment.
          enum:
            - user
          example: user
        version:
          description: |
            The current comment version. To retrieve version values, use the get comments API.
          type: string
          example: Wzk1LDFd
      required:
        - comment
        - id
        - owner
        - type
        - version
    update_case_comment_request:
      title: Update case comment request
      description: The update case comment API request body varies depending on whether you are updating an alert or a comment.
      discriminator:
        propertyName: type
      oneOf:
        - $ref: '#/components/schemas/update_alert_comment_request_properties'
        - $ref: '#/components/schemas/update_user_comment_request_properties'
  examples:
    create_case_request:
      summary: Create a security case that uses a Jira connector.
      value:
        description: A case description.
        title: Case title 1
        tags:
          - tag-1
        connector:
          id: 131d4448-abe0-4789-939d-8ef60680b498
          name: My connector
          type: .jira
          fields:
            issueType: '10006'
            priority: High
            parent: null
        settings:
          syncAlerts: true
        owner: cases
    create_case_response:
      summary: The create case API returns a JSON object that contains details about the case.
      value:
        comments: []
        totalAlerts: 0
        id: 66b9aa00-94fa-11ea-9f74-e7e108796192
        version: WzUzMiwxXQ==
        totalComment: 1
        title: Case title 1
        tags:
          - tag 1
        assignees: []
        description: A case description.
        settings:
          syncAlerts: false
        owner: cases
        duration: null
        severity: low
        closed_at: null
        closed_by: null
        created_at: '2022-03-24T00:37:03.906Z'
        created_by:
          username: elastic
          full_name: null
          email: null
        status: open
        updated_at: null
        updated_by: null
        connector:
          id: 131d4448-abe0-4789-939d-8ef60680b498
          name: My connector
          type: .jira
          fields:
            issueType: '10006'
            parent: null
            priority: High
        external_service: null
    update_case_request:
      summary: Update the case description, tags, and connector.
      value:
        cases:
          - id: a18b38a0-71b0-11ea-a0b2-c51ea50a58e2
            version: WzIzLDFd
            connector:
              id: 131d4448-abe0-4789-939d-8ef60680b498
              name: My connector
              type: .jira
              fields:
                issueType: '10006'
                priority: null
                parent: null
            description: A case description.
            tags:
              - tag-1
            settings:
              syncAlerts: true
    update_case_response:
      summary: This is an example response when the case description, tags, and connector were updated.
      value:
        - id: 66b9aa00-94fa-11ea-9f74-e7e108796192
          version: WzU0OCwxXQ==
          comments: []
          totalComment: 0
          totalAlerts: 0
          title: Case title 1
          tags:
            - tag-1
          settings:
            syncAlerts: true
          owner: cases
          description: A case description.
          duration: null
          severity: low
          closed_at: null
          closed_by: null
          created_at: '2022-05-13T09:16:17.416Z'
          created_by:
            email: null
            full_name: null
            username: elastic
          status: open
          updated_at: '2022-05-13T09:48:33.043Z'
          updated_by:
            email: null
            full_name: null
            username: elastic
          assignees: []
          connector:
            id: 131d4448-abe0-4789-939d-8ef60680b498
            name: My connector
            type: .jira
            fields:
              issueType: '10006'
              parent: null
              priority: null
          external_service:
            external_title: IS-4
            pushed_by:
              full_name: null
              email: null
              username: elastic
            external_url: https://hms.atlassian.net/browse/IS-4
            pushed_at: '2022-05-13T09:20:40.672Z'
            connector_id: 05da469f-1fde-4058-99a3-91e4807e2de8
            external_id: '10003'
            connector_name: Jira
    add_comment_request:
      summary: Adds a comment to a case.
      value:
        type: user
        comment: A new comment.
        owner: cases
    add_comment_response:
      summary: The add comment to case API returns a JSON object that contains details about the case and its comments.
      value:
        comments:
          - id: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
            version: WzIwNDMxLDFd
            type: user
            owner: cases
            comment: A new comment.
            created_at: '2022-06-02T00:49:47.716Z'
            created_by:
              username: elastic
              email: null
              full_name: null
        totalAlerts: 0
        id: 293f1bc0-74f6-11ea-b83a-553aecdb28b6
        version: WzIzMzgsMV0=
        totalComment: 1
        title: Case title 1
        tags:
          - tag 1
        description: A case description.
        settings:
          syncAlerts: false
        owner: cases
        duration: null
        severity: low
        closed_at: null
        closed_by: null
        created_at: '2022-03-24T00:37:03.906Z'
        created_by:
          username: elastic
          full_name: null
          email: null
        status: open
        updated_at: '2022-06-03T00:49:47.716Z'
        updated_by:
          username: elastic
          email: null
          full_name: null
        connector:
          id: none
          name: none
          type: .none
          fields: null
        external_service: null
    update_comment_request:
      summary: Updates a comment of a case.
      value:
        id: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
        version: Wzk1LDFd
        type: user
        comment: An updated comment.
        owner: cases
    update_comment_response:
      summary: The add comment to case API returns a JSON object that contains details about the case and its comments.
      value:
        comments:
          - id: 8af6ac20-74f6-11ea-b83a-553aecdb28b6
            version: WzIwNjM3LDFd
            comment: An updated comment.
            type: user
            owner: cases
            created_at: '2022-03-24T00:37:10.832Z'
            created_by:
              username: elastic
              full_name: null
              email: null
            pushed_at: null
            pushed_by: null
            updated_at: '2022-03-24T01:27:06.210Z'
            updated_by:
              username: elastic
              full_name: null
              email: null
        totalAlerts: 0
        id: 293f1bc0-74f6-11ea-b83a-553aecdb28b6
        version: WzIwNjM2LDFd
        totalComment: 1
        title: Case title 1
        tags:
          - tag 1
        description: A case description.
        settings:
          syncAlerts: false
        owner: cases
        duration: null
        severity: low
        closed_at: null
        closed_by: null
        created_at: '2022-03-24T00:37:03.906Z'
        created_by:
          username: elastic
          full_name: null
          email: null
        status: open
        updated_at: '2022-03-24T01:27:06.210Z'
        updated_by:
          username: elastic
          full_name: null
          email: null
        connector:
          id: none
          name: none
          type: .none
          fields: null
        external_service: null
    push_case_response:
      summary: The push case API returns a JSON object with details about the case and the external service.
      value:
        id: b917f300-0ed9-11ed-bd18-65557fe66949
        version: WzE3NjgsM10=
        comments: []
        totalComment: 0
        totalAlerts: 0
        description: A case description.
        title: Case title 1
        tags:
          - tag 1
        settings:
          syncAlerts: true
        owner: cases
        duration: null
        severity: low
        closed_at: null
        closed_by: null
        created_at: '2022-07-29T00:59:39.444Z'
        created_by:
          username: elastic
          email: null
          full_name: null
        status: open
        updated_at: '2022-07-29T01:20:58.436Z'
        updated_by:
          username: elastic
          full_name: null
          email: null
        connector:
          id: 09f8c0b0-0eda-11ed-bd18-65557fe66949
          name: My connector
          type: .jira
          fields:
            issueType: '10006'
            parent: null
            priority: Low
        external_service:
          pushed_at: '2022-07-29T01:20:58.436Z'
          pushed_by:
            username: elastic
            full_name: null
            email: null
          connector_name: My connector
          external_id: '71926'
          external_title: ES-554
          external_url: https://cases.jira.com
          connector_id: 09f8c0b0-0eda-11ed-bd18-65557fe66949
security:
  - basicAuth: []
  - apiKeyAuth: []
