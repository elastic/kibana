parameters:
  - schema:
      type: string
    name: agentPolicyId
    in: path
    required: true
get:
  summary: Agent policy - Info
  tags: []
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            type: object
            properties:
              item:
                $ref: ../components/schemas/AgentPolicy.yaml
            required:
              - item
          examples:
            success:
              value:
                item:
                  id: 82da1fc0-8fbf-11ea-b2ce-01c4a6127154
                  name: Default policy
                  namespace: default
                  description: Default agent policy created by Kibana
                  status: active
                  packagePolicies:
                    - id: 8a5679b0-8fbf-11ea-b2ce-01c4a6127154
                      name: system-1
                      namespace: default
                      package:
                        name: system
                        title: System
                        version: 0.0.3
                      enabled: true
                      policy_id: 82da1fc0-8fbf-11ea-b2ce-01c4a6127154
                      output_id: 08adc51c-69f3-4294-80e2-24527c6ff73d
                      inputs:
                        - type: logs
                          enabled: true
                          streams:
                            - id: logs-system.auth
                              enabled: true
                              dataset: system.auth
                              vars:
                                paths:
                                  value:
                                    - /var/log/auth.log*
                                    - /var/log/secure*
                                  type: text
                              agent_stream:
                                paths:
                                  - /var/log/auth.log*
                                  - /var/log/secure*
                                exclude_files:
                                  - .gz$
                                multiline:
                                  pattern: ^\s
                                  match: after
                                processors:
                                  - add_locale: null
                                  - add_fields:
                                      target: ''
                                      fields:
                                        ecs.version: 1.5.0
                            - id: logs-system.syslog
                              enabled: true
                              dataset: system.syslog
                              vars:
                                paths:
                                  value:
                                    - /var/log/messages*
                                    - /var/log/syslog*
                                  type: text
                              agent_stream:
                                paths:
                                  - /var/log/messages*
                                  - /var/log/syslog*
                                exclude_files:
                                  - .gz$
                                multiline:
                                  pattern: ^\s
                                  match: after
                                processors:
                                  - add_locale: null
                                  - add_fields:
                                      target: ''
                                      fields:
                                        ecs.version: 1.5.0
                        - type: system/metrics
                          enabled: true
                          streams:
                            - id: system/metrics-system.core
                              enabled: true
                              dataset: system.core
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                              agent_stream:
                                metricsets:
                                  - core
                                core.metrics: percentages
                            - id: system/metrics-system.cpu
                              enabled: true
                              dataset: system.cpu
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - cpu
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.diskio
                              enabled: true
                              dataset: system.diskio
                              agent_stream:
                                metricsets:
                                  - diskio
                            - id: system/metrics-system.entropy
                              enabled: true
                              dataset: system.entropy
                              agent_stream:
                                metricsets:
                                  - entropy
                            - id: system/metrics-system.filesystem
                              enabled: true
                              dataset: system.filesystem
                              vars:
                                period:
                                  value: 1m
                                  type: text
                                processors:
                                  value: |
                                    - drop_event.when.regexp:
                                        system.filesystem.mount_point: ^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)
                                  type: yaml
                              agent_stream:
                                metricsets:
                                  - filesystem
                                period: 1m
                                processors:
                                  - drop_event.when.regexp:
                                      system.filesystem.mount_point: >-
                                        ^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)
                            - id: system/metrics-system.fsstat
                              enabled: true
                              dataset: system.fsstat
                              vars:
                                period:
                                  value: 1m
                                  type: text
                                processors:
                                  value: |
                                    - drop_event.when.regexp:
                                        system.filesystem.mount_point: ^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)
                                  type: yaml
                              agent_stream:
                                metricsets:
                                  - fsstat
                                period: 1m
                                processors:
                                  - drop_event.when.regexp:
                                      system.filesystem.mount_point: >-
                                        ^/(sys|cgroup|proc|dev|etc|host|lib|snap)($|/)
                            - id: system/metrics-system.load
                              enabled: true
                              dataset: system.load
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - load
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.memory
                              enabled: true
                              dataset: system.memory
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - memory
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.network
                              enabled: true
                              dataset: system.network
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - network
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.network_summary
                              enabled: true
                              dataset: system.network_summary
                              agent_stream:
                                metricsets:
                                  - network_summary
                            - id: system/metrics-system.process
                              enabled: true
                              dataset: system.process
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - process
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.process_summary
                              enabled: true
                              dataset: system.process_summary
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - process_summary
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.raid
                              enabled: true
                              dataset: system.raid
                              agent_stream:
                                metricsets:
                                  - raid
                            - id: system/metrics-system.service
                              enabled: true
                              dataset: system.service
                              agent_stream:
                                metricsets:
                                  - service
                            - id: system/metrics-system.socket
                              enabled: true
                              dataset: system.socket
                              agent_stream:
                                metricsets:
                                  - socket
                            - id: system/metrics-system.socket_summary
                              enabled: true
                              dataset: system.socket_summary
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                process.include_top_n.by_cpu:
                                  value: 5
                                  type: integer
                                process.include_top_n.by_memory:
                                  value: 5
                                  type: integer
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - socket_summary
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                process.include_top_n.by_cpu: 5
                                process.include_top_n.by_memory: 5
                                processes: .*
                            - id: system/metrics-system.uptime
                              enabled: true
                              dataset: system.uptime
                              vars:
                                core.metrics:
                                  value:
                                    - percentages
                                  type: text
                                cpu.metrics:
                                  value:
                                    - percentages
                                    - normalized_percentages
                                  type: text
                                period:
                                  value: 10s
                                  type: text
                                processes:
                                  value:
                                    - .*
                                  type: text
                              agent_stream:
                                metricsets:
                                  - uptime
                                core.metrics: percentages
                                cpu.metrics: 'percentages,normalized_percentages'
                                period: 10s
                                processes: .*
                            - id: system/metrics-system.users
                              enabled: true
                              dataset: system.users
                              agent_stream:
                                metricsets:
                                  - users
                      revision: 1
                  is_default: true
                  monitoring_enabled:
                    - logs
                    - metrics
                  revision: 2
                  updated_on: '2020-05-06T17:32:21.905Z'
                  updated_by: system
  operationId: agent-policy-info
  description: Get one agent policy
  parameters: []
put:
  summary: Agent policy - Update
  tags: []
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            type: object
            properties:
              item:
                $ref: ../components/schemas/AgentPolicy.yaml
            required:
              - item
          examples:
            example-1:
              value:
                item:
                  id: 0b7130d0-5a37-11ea-ac2c-25e9ab4ecb2a
                  name: UPDATED name
                  description: UPDATED description
                  namespace: UPDATED namespace
                  updated_on: 'Fri Feb 28 2020 16:22:31 GMT-0500 (Eastern Standard Time)'
                  updated_by: elastic
                  packagePolicies: []
  operationId: put-agent-policy-agentPolicyId
  requestBody:
    content:
      application/json:
        schema:
          $ref: ../components/schemas/NewAgentPolicy.yaml
        examples:
          example-1:
            value:
              name: UPDATED name
              description: UPDATED description
              namespace: UPDATED namespace
  parameters:
    - $ref: ../components/parameters/xsrfHeader.yaml
