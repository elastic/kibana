set_alert_assignees_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Assign alerts API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/signals/assignees:
      summary: Assigns users to alerts
      post:
        operationId: SetAlertAssignees
        description: Assigns users to alerts.
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                  - assignees
                  - ids
                properties:
                  assignees:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/AlertAssignees
                    description: Details about the assignees to assign and unassign.
                  ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/AlertIds
                    description: >-
                      List of alerts ids to assign and unassign passed
                      assignees.
        responses:
          '200':
            description: Indicates a successful call.
          '400':
            description: Invalid request.
actions.schema.yaml:
  openapi: 3.0.0
  info:
    title: Endpoint Actions Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action/state:
      get:
        summary: Get Action State schema
        operationId: EndpointGetActionsState
        x-codegen-enabled: false
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/action/running_procs:
      post:
        summary: Get Running Processes Action
        operationId: EndpointGetRunningProcessesAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  endpoint_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/EndpointIds
                  alert_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/AlertIds
                  case_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/CaseIds
                  comment:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Comment
                  parameters:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Parameters
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/action/isolate:
      post:
        summary: Isolate host Action
        operationId: EndpointIsolateHostAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  endpoint_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/EndpointIds
                  alert_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/AlertIds
                  case_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/CaseIds
                  comment:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Comment
                  parameters:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Parameters
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/action/unisolate:
      post:
        summary: Unisolate host Action
        operationId: EndpointUnisolateHostAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  endpoint_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/EndpointIds
                  alert_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/AlertIds
                  case_ids:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/CaseIds
                  comment:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Comment
                  parameters:
                    $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/Parameters
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/action/kill_process:
      post:
        summary: Kill process Action
        operationId: EndpointKillProcessAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/ProcessActionSchemas
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/action/suspend_process:
      post:
        summary: Suspend process Action
        operationId: EndpointSuspendProcessAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/ProcessActionSchemas
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
actions_status.schema.yaml:
  openapi: 3.0.0
  info:
    title: Get Action status schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action_status:
      get:
        summary: Get Actions status schema
        operationId: EndpointGetActionsStatus
        x-codegen-enabled: false
        parameters:
          - name: query
            in: query
            required: true
            schema:
              type: object
              properties:
                agent_ids:
                  $ref: ./shared_components.schema.yaml#/components/schemas/AgentIds
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
audit_log.schema.yaml:
  openapi: 3.0.0
  info:
    title: Audit Log Schema
    version: '2023-10-31'
  paths:
    '/api/endpoint/action_log/{agent_id}':
      get:
        summary: Get action audit log schema
        operationId: EndpointGetActionAuditLog
        x-codegen-enabled: false
        parameters:
          - name: query
            in: query
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/AuditLogRequestQuery
          - name: query
            in: path
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/AuditLogRequestParams
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
details.schema.yaml:
  openapi: 3.0.0
  info:
    title: Details Schema
    version: '2023-10-31'
  paths:
    '/api/endpoint/action/{action_id}':
      get:
        summary: Get Action details schema
        operationId: EndpointGetActionsDetails
        x-codegen-enabled: false
        parameters:
          - name: query
            in: path
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/DetailsRequestParams
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
execute.schema.yaml:
  openapi: 3.0.0
  info:
    title: Execute Action Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action/execute:
      post:
        summary: Execute Action
        operationId: EndpointExecuteAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/ExecuteActionRequestBody
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
file_download.schema.yaml:
  openapi: 3.0.0
  info:
    title: File Download Schema
    version: '2023-10-31'
  paths:
    '/api/endpoint/action/{action_id}/file/{file_id}/download`':
      get:
        summary: File Download schema
        operationId: EndpointFileDownload
        x-codegen-enabled: false
        parameters:
          - name: query
            in: path
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/FileDownloadRequestParams
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
file_info.schema.yaml:
  openapi: 3.0.0
  info:
    title: File Info Schema
    version: '2023-10-31'
  paths:
    '/api/endpoint/action/{action_id}/file/{file_id}`':
      get:
        summary: File Info schema
        operationId: EndpointFileInfo
        x-codegen-enabled: false
        parameters:
          - name: query
            in: path
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/FileInfoRequestParams
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
file_upload.schema.yaml:
  openapi: 3.0.0
  info:
    title: File Upload Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action/upload:
      post:
        summary: Upload Action
        operationId: EndpointUploadAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/FileUploadActionRequestBody
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
get_file.schema.yaml:
  openapi: 3.0.0
  info:
    title: Get File Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action/get_file:
      post:
        summary: Get File Action
        operationId: EndpointGetFileAction
        x-codegen-enabled: false
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/GetFileActionRequestBody
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
list.schema.yaml:
  openapi: 3.0.0
  info:
    title: Actions List Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/action:
      get:
        summary: Get Actions List schema
        operationId: EndpointGetActionsList
        x-codegen-enabled: false
        parameters:
          - name: query
            in: query
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/EndpointActionListRequestQuery
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
metadata.schema.yaml:
  openapi: 3.0.0
  info:
    title: Endpoint Metadata Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/metadata:
      get:
        summary: Get Metadata List schema
        operationId: GetEndpointMetadataList
        x-codegen-enabled: false
        parameters:
          - name: query
            in: query
            required: true
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/ListRequestQuery
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/metadata/transforms:
      get:
        summary: Get Metadata Transform schema
        operationId: GetEndpointMetadataTransform
        x-codegen-enabled: false
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    '/api/endpoint/metadata/{id}':
      get:
        summary: Get Metadata schema
        operationId: GetEndpointMetadata
        x-codegen-enabled: false
        parameters:
          - name: query
            in: path
            required: true
            schema:
              type: object
              properties:
                id:
                  type: string
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
policy.schema.yaml:
  openapi: 3.0.0
  info:
    title: Endpoint Policy Schema
    version: '2023-10-31'
  paths:
    /api/endpoint/policy/summaries:
      get:
        summary: Get Agent Policy Summary schema
        operationId: GetAgentPolicySummary
        parameters:
          - name: query
            in: query
            required: true
            schema:
              type: object
              properties:
                package_name:
                  type: string
                policy_id:
                  type: string
                  nullable: true
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
    /api/endpoint/policy_response:
      get:
        summary: Get Policy Response schema
        operationId: GetPolicyResponse
        parameters:
          - name: query
            in: query
            required: true
            schema:
              type: object
              properties:
                agentId:
                  $ref: ./shared_components.schema.yaml#/components/schemas/AgentId
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
get_suggestions.schema.yaml:
  openapi: 3.0.0
  info:
    title: Get Suggestions Schema
    version: '2023-10-31'
  paths:
    '/api/endpoint/suggestions/{suggestion_type}':
      post:
        summary: Get suggestions
        operationId: GetEndpointSuggestions
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                  - parameters
                properties:
                  field:
                    type: string
                  query:
                    type: string
                  filters: {}
                  fieldMeta: {}
        parameters:
          - name: query
            in: path
            required: true
            schema:
              type: object
              properties:
                suggestion_type:
                  type: string
                  enum:
                    - eventFilters
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/SuccessResponse
engine_settings_route.schema.yaml:
  openapi: 3.0.0
  info:
    version: 1.0.0
    title: Risk Scoring API
    description: >-
      These APIs allow the consumer to manage Entity Risk Scores within Entity
      Analytics.
  servers:
    - url: 'http://{kibana_host}:{port}'
      variables:
        kibana_host:
          default: localhost
        port:
          default: '5601'
  paths:
    /engine/settings:
      get:
        operationId: RiskEngineSettingsGet
        summary: Get the settings of the Risk Engine
        responses:
          '200':
            description: Successful response
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RiskEngineSettingsResponse
get_prebuilt_rules_and_timelines_status_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Prebuilt Rules Status API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/prepackaged/_status:
      get:
        operationId: GetPrebuiltRulesAndTimelinesStatus
        summary: Get the status of Elastic prebuilt rules
        tags:
          - Prebuilt Rules API
        responses:
          '200':
            description: Indicates a successful call
            content:
              application/json:
                schema:
                  type: object
                  additionalProperties: false
                  properties:
                    rules_custom_installed:
                      type: integer
                      description: The total number of custom rules
                      minimum: 0
                    rules_installed:
                      type: integer
                      description: The total number of installed prebuilt rules
                      minimum: 0
                    rules_not_installed:
                      type: integer
                      description: >-
                        The total number of available prebuilt rules that are
                        not installed
                      minimum: 0
                    rules_not_updated:
                      type: integer
                      description: The total number of outdated prebuilt rules
                      minimum: 0
                    timelines_installed:
                      type: integer
                      description: The total number of installed prebuilt timelines
                      minimum: 0
                    timelines_not_installed:
                      type: integer
                      description: >-
                        The total number of available prebuilt timelines that
                        are not installed
                      minimum: 0
                    timelines_not_updated:
                      type: integer
                      description: The total number of outdated prebuilt timelines
                      minimum: 0
                  required:
                    - rules_custom_installed
                    - rules_installed
                    - rules_not_installed
                    - rules_not_updated
                    - timelines_installed
                    - timelines_not_installed
                    - timelines_not_updated
install_prebuilt_rules_and_timelines_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Install Prebuilt Rules API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/prepackaged:
      put:
        operationId: InstallPrebuiltRulesAndTimelines
        summary: Installs all Elastic prebuilt rules and timelines
        tags:
          - Prebuilt Rules API
        responses:
          '200':
            description: Indicates a successful call
            content:
              application/json:
                schema:
                  type: object
                  additionalProperties: false
                  properties:
                    rules_installed:
                      type: integer
                      description: The number of rules installed
                      minimum: 0
                    rules_updated:
                      type: integer
                      description: The number of rules updated
                      minimum: 0
                    timelines_installed:
                      type: integer
                      description: The number of timelines installed
                      minimum: 0
                    timelines_updated:
                      type: integer
                      description: The number of timelines updated
                      minimum: 0
                  required:
                    - rules_installed
                    - rules_updated
                    - timelines_installed
                    - timelines_updated
bulk_actions_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Bulk Actions API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_bulk_action:
      post:
        operationId: PerformBulkAction
        summary: Applies a bulk action to multiple rules
        description: >-
          The bulk action is applied to all rules that match the filter or to
          the list of rules by their IDs.
        tags:
          - Bulk API
        parameters:
          - name: dry_run
            in: query
            description: Enables dry run mode for the request call.
            required: false
            schema:
              type: boolean
        requestBody:
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkDeleteRules
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkDisableRules
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkEnableRules
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkExportRules
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkDuplicateRules
                  - $ref: >-
                      ./shared_components.schema.yaml#/components/schemas/BulkEditRules
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  oneOf:
                    - $ref: >-
                        ./shared_components.schema.yaml#/components/schemas/BulkEditActionResponse
                    - $ref: >-
                        ./shared_components.schema.yaml#/components/schemas/BulkExportActionResponse
export_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Export Rules API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_export:
      summary: Exports rules to an `.ndjson` file
      post:
        operationId: ExportRules
        summary: Export rules
        description: >-
          Exports rules to an `.ndjson` file. The following configuration items
          are also included in the `.ndjson` file - Actions, Exception lists.
          Prebuilt rules cannot be exported.
        tags:
          - Import/Export API
        parameters:
          - name: exclude_export_details
            in: query
            required: false
            description: Determines whether a summary of the exported rules is returned.
            schema:
              type: boolean
              default: false
          - name: file_name
            in: query
            required: false
            description: File name for saving the exported rules.
            schema:
              type: string
              default: export.ndjson
        requestBody:
          required: false
          content:
            application/json:
              schema:
                type: object
                required:
                  - objects
                nullable: true
                properties:
                  objects:
                    type: array
                    items:
                      type: object
                      required:
                        - rule_id
                      properties:
                        rule_id:
                          $ref: >-
                            ./shared_components.schema.yaml#/components/schemas/RuleSignatureId
                    description: >-
                      Array of `rule_id` fields. Exports all rules when
                      unspecified.
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/ndjson:
                schema:
                  type: string
                  format: binary
                  description: An `.ndjson` file containing the returned rules.
find_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Find Rules API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_find:
      get:
        operationId: FindRules
        description: Finds rules that match the given query.
        tags:
          - Rules API
        parameters:
          - name: fields
            in: query
            required: false
            schema:
              type: array
              items:
                type: string
          - name: filter
            in: query
            description: Search query
            required: false
            schema:
              type: string
          - name: sort_field
            in: query
            description: Field to sort by
            required: false
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/FindRulesSortField
          - name: sort_order
            in: query
            description: Sort order
            required: false
            schema:
              $ref: ./shared_components.schema.yaml#/components/schemas/SortOrder
          - name: page
            in: query
            description: Page number
            required: false
            schema:
              type: integer
              minimum: 1
              default: 1
          - name: per_page
            in: query
            description: Rules per page
            required: false
            schema:
              type: integer
              minimum: 0
              default: 20
        responses:
          '200':
            description: Successful response
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    page:
                      type: integer
                    perPage:
                      type: integer
                    total:
                      type: integer
                    data:
                      type: array
                      items:
                        $ref: >-
                          ./shared_components.schema.yaml#/components/schemas/RuleResponse
                  required:
                    - page
                    - perPage
                    - total
                    - data
import_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Import Rules API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_import:
      summary: Imports rules from an `.ndjson` file
      post:
        operationId: ImportRules
        summary: Import rules
        description: >-
          Imports rules from an `.ndjson` file, including actions and exception
          lists.
        tags:
          - Import/Export API
        requestBody:
          required: true
          content:
            multipart/form-data:
              schema:
                type: object
                properties:
                  file:
                    type: string
                    format: binary
                    description: The `.ndjson` file containing the rules.
        parameters:
          - name: overwrite
            in: query
            required: false
            description: >-
              Determines whether existing rules with the same `rule_id` are
              overwritten.
            schema:
              type: boolean
              default: false
          - name: overwrite_exceptions
            in: query
            required: false
            description: >-
              Determines whether existing exception lists with the same
              `list_id` are overwritten.
            schema:
              type: boolean
              default: false
          - name: overwrite_action_connectors
            in: query
            required: false
            description: >-
              Determines whether existing actions with the same
              `kibana.alert.rule.actions.id` are overwritten.
            schema:
              type: boolean
              default: false
          - name: as_new_list
            in: query
            required: false
            description: Generates a new list ID for each imported exception list.
            schema:
              type: boolean
              default: false
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  type: object
                  additionalProperties: false
                  required:
                    - exceptions_success
                    - exceptions_success_count
                    - exceptions_errors
                    - rules_count
                    - success
                    - success_count
                    - errors
                    - action_connectors_errors
                    - action_connectors_warnings
                    - action_connectors_success
                    - action_connectors_success_count
                  properties:
                    exceptions_success:
                      type: boolean
                    exceptions_success_count:
                      type: integer
                      minimum: 0
                    exceptions_errors:
                      type: array
                      items:
                        $ref: >-
                          ./shared_components.schema.yaml#/components/schemas/ErrorSchema
                    rules_count:
                      type: integer
                      minimum: 0
                    success:
                      type: boolean
                    success_count:
                      type: integer
                      minimum: 0
                    errors:
                      type: array
                      items:
                        $ref: >-
                          ./shared_components.schema.yaml#/components/schemas/ErrorSchema
                    action_connectors_errors:
                      type: array
                      items:
                        $ref: >-
                          ./shared_components.schema.yaml#/components/schemas/ErrorSchema
                    action_connectors_warnings:
                      type: array
                      items:
                        $ref: >-
                          ./shared_components.schema.yaml#/components/schemas/WarningSchema
                    action_connectors_success:
                      type: boolean
                    action_connectors_success_count:
                      type: integer
                      minimum: 0
read_tags_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Tags API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/tags:
      summary: Aggregates and returns rule tags
      get:
        operationId: ReadTags
        summary: Aggregates and returns all unique tags from all rules
        tags:
          - Tags API
        responses:
          '200':
            description: Indicates a successful call
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleTagArray
bulk_create_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Bulk Create API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_bulk_create:
      post:
        operationId: BulkCreateRules
        deprecated: true
        description: Creates new detection rules in bulk.
        tags:
          - Bulk API
        requestBody:
          description: 'A JSON array of rules, where each rule contains the required fields.'
          required: true
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleCreateProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/BulkCrudRulesResponse
bulk_delete_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Bulk Delete API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_bulk_delete:
      delete:
        operationId: BulkDeleteRules
        deprecated: true
        description: Deletes multiple rules.
        tags:
          - Bulk API
        requestBody:
          description: >-
            A JSON array of `id` or `rule_id` fields of the rules you want to
            delete.
          required: true
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      $ref: >-
                        ./shared_components.schema.yaml#/components/schemas/RuleObjectId
                    rule_id:
                      $ref: >-
                        ./shared_components.schema.yaml#/components/schemas/RuleSignatureId
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/BulkCrudRulesResponse
bulk_patch_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Bulk Patch API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_bulk_update:
      patch:
        operationId: BulkPatchRules
        deprecated: true
        description: Updates multiple rules using the `PATCH` method.
        tags:
          - Bulk API
        requestBody:
          description: 'A JSON array of rules, where each rule contains the required fields.'
          required: true
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RulePatchProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/BulkCrudRulesResponse
bulk_update_rules_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Bulk Update API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules/_bulk_update:
      put:
        operationId: BulkUpdateRules
        deprecated: true
        description: Updates multiple rules using the `PUT` method.
        tags:
          - Bulk API
        requestBody:
          description: >-
            A JSON array where each element includes the `id` or `rule_id` field
            of the rule you want to update and the fields you want to modify.
          required: true
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleUpdateProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/BulkCrudRulesResponse
create_rule_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Create Rule API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules:
      post:
        operationId: CreateRule
        description: Create a single detection rule
        tags:
          - Rules API
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/RuleCreateProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleResponse
delete_rule_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Delete Rule API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules:
      delete:
        operationId: DeleteRule
        description: Deletes a single rule using the `rule_id` or `id` field.
        tags:
          - Rules API
        parameters:
          - name: id
            in: query
            required: false
            description: The rule's `id` value.
            schema:
              $ref: ./shared_components.schema.yaml#/components/schemas/RuleObjectId
          - name: rule_id
            in: query
            required: false
            description: The rule's `rule_id` value.
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/RuleSignatureId
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleResponse
patch_rule_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Patch Rule API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules:
      patch:
        operationId: PatchRule
        description: Patch a single rule
        tags:
          - Rules API
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/RulePatchProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleResponse
read_rule_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Read Rule API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules:
      get:
        operationId: ReadRule
        description: Read a single rule
        tags:
          - Rules API
        parameters:
          - name: id
            in: query
            required: false
            description: The rule's `id` value.
            schema:
              $ref: ./shared_components.schema.yaml#/components/schemas/RuleObjectId
          - name: rule_id
            in: query
            required: false
            description: The rule's `rule_id` value.
            schema:
              $ref: >-
                ./shared_components.schema.yaml#/components/schemas/RuleSignatureId
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleResponse
update_rule_route.schema.yaml:
  openapi: 3.0.0
  info:
    title: Update Rule API endpoint
    version: '2023-10-31'
  paths:
    /api/detection_engine/rules:
      put:
        operationId: UpdateRule
        description: Update a single rule
        tags:
          - Rules API
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: >-
                  ./shared_components.schema.yaml#/components/schemas/RuleUpdateProps
        responses:
          '200':
            description: Indicates a successful call.
            content:
              application/json:
                schema:
                  $ref: >-
                    ./shared_components.schema.yaml#/components/schemas/RuleResponse
shared_components.schema.yaml:
  components:
    schemas:
      NonEmptyString:
        type: string
        pattern: ^(?! *$).+$
        minLength: 1
        description: A string that is not empty and does not contain only whitespace
      AlertAssignees:
        type: object
        required:
          - add
          - remove
        properties:
          add:
            type: array
            items:
              $ref: '#/components/schemas/NonEmptyString'
            description: A list of users ids to assign.
          remove:
            type: array
            items:
              $ref: '#/components/schemas/NonEmptyString'
            description: A list of users ids to unassign.
      AlertIds:
        type: array
        items:
          $ref: '#/components/schemas/NonEmptyString'
        minItems: 1
        description: A list of alerts ids.
      SuccessResponse:
        type: object
        properties: {}
      EndpointIds:
        type: array
        items:
          type: string
          minLength: 1
        minItems: 1
        description: List of endpoint IDs (cannot contain empty strings)
      CaseIds:
        type: array
        items:
          type: string
          minLength: 1
        minItems: 1
        description: Case IDs to be updated (cannot contain empty strings)
      Comment:
        type: string
        description: Optional comment
      Parameters:
        type: object
        description: Optional parameters object
      ProcessActionSchemas:
        allOf:
          - type: object
            properties:
              endpoint_ids:
                $ref: '#/components/schemas/EndpointIds'
              alert_ids:
                $ref: '#/components/schemas/AlertIds'
              case_ids:
                $ref: '#/components/schemas/CaseIds'
              comment:
                $ref: '#/components/schemas/Comment'
              parameters:
                $ref: '#/components/schemas/Parameters'
          - type: object
            required:
              - parameters
            properties:
              parameters:
                oneOf:
                  - type: object
                    properties:
                      pid:
                        type: integer
                        minimum: 1
                  - type: object
                    properties:
                      entity_id:
                        type: string
                        minLength: 1
      AgentIds:
        oneOf:
          - type: array
            items:
              type: string
              minLength: 1
            minItems: 1
            maxItems: 50
          - type: string
            minLength: 1
        minLength: 1
      Page:
        type: integer
        default: 1
        minimum: 1
        description: Page number
      PageSize:
        type: integer
        default: 10
        minimum: 1
        maximum: 100
        description: Number of items per page
      StartDate:
        type: string
        description: Start date
      EndDate:
        type: string
        description: End date
      AuditLogRequestQuery:
        type: object
        properties:
          page:
            $ref: '#/components/schemas/Page'
          page_size:
            $ref: '#/components/schemas/PageSize'
          start_date:
            $ref: '#/components/schemas/StartDate'
          end_date:
            $ref: '#/components/schemas/EndDate'
      AgentId:
        type: string
        description: Agent ID
      AuditLogRequestParams:
        type: object
        properties:
          agent_id:
            $ref: '#/components/schemas/AgentId'
      DetailsRequestParams:
        type: object
        properties:
          action_id:
            type: string
      Command:
        type: string
        enum:
          - isolate
          - unisolate
          - kill-process
          - suspend-process
          - running-processes
          - get-file
          - execute
          - upload
        minLength: 1
        description: The command to be executed (cannot be an empty string)
      Timeout:
        type: integer
        minimum: 1
        description: The maximum timeout value in milliseconds (optional)
      ExecuteActionRequestBody:
        allOf:
          - type: object
            properties:
              endpoint_ids:
                $ref: '#/components/schemas/EndpointIds'
              alert_ids:
                $ref: '#/components/schemas/AlertIds'
              case_ids:
                $ref: '#/components/schemas/CaseIds'
              comment:
                $ref: '#/components/schemas/Comment'
              parameters:
                $ref: '#/components/schemas/Parameters'
          - type: object
            required:
              - parameters
            properties:
              parameters:
                required:
                  - command
                type: object
                properties:
                  command:
                    $ref: '#/components/schemas/Command'
                  timeout:
                    $ref: '#/components/schemas/Timeout'
      FileDownloadRequestParams:
        type: object
        required:
          - action_id
          - file_id
        properties:
          action_id:
            type: string
          file_id:
            type: string
      FileInfoRequestParams:
        type: object
        required:
          - action_id
          - file_id
        properties:
          action_id:
            type: string
          file_id:
            type: string
      FileUploadActionRequestBody:
        allOf:
          - type: object
            properties:
              endpoint_ids:
                $ref: '#/components/schemas/EndpointIds'
              alert_ids:
                $ref: '#/components/schemas/AlertIds'
              case_ids:
                $ref: '#/components/schemas/CaseIds'
              comment:
                $ref: '#/components/schemas/Comment'
              parameters:
                $ref: '#/components/schemas/Parameters'
          - type: object
            required:
              - parameters
              - file
            properties:
              parameters:
                type: object
                properties:
                  overwrite:
                    type: boolean
                    default: false
              file:
                type: string
                format: binary
      GetFileActionRequestBody:
        allOf:
          - type: object
            properties:
              endpoint_ids:
                $ref: '#/components/schemas/EndpointIds'
              alert_ids:
                $ref: '#/components/schemas/AlertIds'
              case_ids:
                $ref: '#/components/schemas/CaseIds'
              comment:
                $ref: '#/components/schemas/Comment'
              parameters:
                $ref: '#/components/schemas/Parameters'
          - type: object
            required:
              - parameters
              - file
            properties:
              parameters:
                required:
                  - path
                type: object
                properties:
                  path:
                    type: string
      Commands:
        type: array
        items:
          $ref: '#/components/schemas/Command'
      UserIds:
        oneOf:
          - type: array
            items:
              type: string
              minLength: 1
            minItems: 1
          - type: string
            minLength: 1
        description: User IDs
      Type:
        type: string
        enum:
          - automated
          - manual
      Types:
        type: array
        items:
          $ref: '#/components/schemas/Type'
        minLength: 1
        maxLength: 2
      WithOutputs:
        oneOf:
          - type: array
            items:
              type: string
              minLength: 1
            minItems: 1
          - type: string
            minLength: 1
        description: With Outputs
      EndpointActionListRequestQuery:
        type: object
        properties:
          agentIds:
            $ref: '#/components/schemas/AgentIds'
          commands:
            $ref: '#/components/schemas/Commands'
          page:
            $ref: '#/components/schemas/Page'
          pageSize:
            type: integer
            default: 10
            minimum: 1
            maximum: 10000
            description: Number of items per page
          startDate:
            $ref: '#/components/schemas/StartDate'
          endDate:
            $ref: '#/components/schemas/EndDate'
          userIds:
            $ref: '#/components/schemas/UserIds'
          types:
            $ref: '#/components/schemas/Types'
          withOutputs:
            $ref: '#/components/schemas/WithOutputs'
      ListRequestQuery:
        type: object
        required:
          - hostStatuses
        properties:
          page:
            type: integer
            default: 0
            minimum: 0
            description: Page number
          pageSize:
            type: integer
            default: 10
            minimum: 1
            maximum: 10000
            description: Number of items per page
          kuery:
            type: string
            nullable: true
          sortField:
            type: string
            enum:
              - enrolled_at
              - metadata.host.hostname
              - host_status
              - metadata.Endpoint.policy.applied.name
              - metadata.Endpoint.policy.applied.status
              - metadata.host.os.name
              - metadata.host.ip
              - metadata.agent.version
              - last_checkin
          sortDirection:
            type: string
            enum:
              - asc
              - desc
            nullable: true
          hostStatuses:
            type: array
            items:
              type: string
              enum:
                - healthy
                - offline
                - updating
                - inactive
                - unenrolled
      KibanaDate:
        type: string
        example: '2017-07-21T17:32:28Z'
      DateRange:
        description: Defines the time period on which risk inputs will be filtered.
        type: object
        required:
          - start
          - end
        properties:
          start:
            $ref: '#/components/schemas/KibanaDate'
          end:
            $ref: '#/components/schemas/KibanaDate'
      RiskEngineSettingsResponse:
        type: object
        properties:
          range:
            $ref: '#/components/schemas/DateRange'
      BulkDeleteRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - delete
            required:
              - action
      BulkDisableRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - disable
            required:
              - action
      BulkEnableRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - enable
            required:
              - action
      BulkExportRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - export
            required:
              - action
      BulkDuplicateRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - duplicate
              duplicate:
                type: object
                properties:
                  include_exceptions:
                    type: boolean
                    description: Whether to copy exceptions from the original rule
                  include_expired_exceptions:
                    type: boolean
                    description: Whether to copy expired exceptions from the original rule
                required:
                  - include_exceptions
                  - include_expired_exceptions
            required:
              - action
      RuleTagArray:
        type: array
        items:
          type: string
        description: >-
          String array containing words and phrases to help categorize, filter,
          and search rules. Defaults to an empty array.
      BulkActionEditPayloadTags:
        type: object
        properties:
          type:
            type: string
            enum:
              - add_tags
              - delete_tags
              - set_tags
          value:
            $ref: '#/components/schemas/RuleTagArray'
        required:
          - type
          - value
      IndexPatternArray:
        type: array
        items:
          type: string
      BulkActionEditPayloadIndexPatterns:
        type: object
        properties:
          type:
            type: string
            enum:
              - add_index_patterns
              - delete_index_patterns
              - set_index_patterns
          value:
            $ref: '#/components/schemas/IndexPatternArray'
          overwrite_data_views:
            type: boolean
        required:
          - type
          - value
      TimelineTemplateId:
        type: string
        description: Timeline template ID
      TimelineTemplateTitle:
        type: string
        description: Timeline template title
      BulkActionEditPayloadTimeline:
        type: object
        properties:
          type:
            type: string
            enum:
              - set_timeline
          value:
            type: object
            properties:
              timeline_id:
                $ref: '#/components/schemas/TimelineTemplateId'
              timeline_title:
                $ref: '#/components/schemas/TimelineTemplateTitle'
            required:
              - timeline_id
              - timeline_title
        required:
          - type
          - value
      ThrottleForBulkActions:
        type: string
        description: >-
          The condition for throttling the notification: 'rule', 'no_actions',
          or time duration
        enum:
          - rule
          - 1h
          - 1d
          - 7d
      RuleActionGroup:
        type: string
        description: >-
          Optionally groups actions by use cases. Use `default` for alert
          notifications.
      RuleActionId:
        type: string
        description: The connector ID.
      RuleActionParams:
        type: object
        description: >-
          Object containing the allowed connector fields, which varies according
          to the connector type.
        additionalProperties: true
      RuleActionNotifyWhen:
        type: string
        enum:
          - onActiveAlert
          - onThrottleInterval
          - onActionGroupChange
        description: >-
          The condition for throttling the notification: `onActionGroupChange`,
          `onActiveAlert`,  or `onThrottleInterval`
      RuleActionThrottle:
        description: Defines the interval on which a rule's actions are executed.
        oneOf:
          - type: string
            enum:
              - no_actions
              - rule
          - type: string
            pattern: '^[1-9]\d*[smhd]$'
            description: 'Time interval in seconds, minutes, hours, or days.'
            example: 1h
      RuleActionFrequency:
        type: object
        description: >-
          The action frequency defines when the action runs (for example, only
          on rule execution or at specific time intervals).
        properties:
          summary:
            type: boolean
            description: >-
              Action summary indicates whether we will send a summary
              notification about all the generate alerts or notification per
              individual alert
          notifyWhen:
            $ref: '#/components/schemas/RuleActionNotifyWhen'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
            nullable: true
        required:
          - summary
          - notifyWhen
          - throttle
      RuleActionAlertsFilter:
        type: object
        additionalProperties: true
      NormalizedRuleAction:
        type: object
        properties:
          group:
            $ref: '#/components/schemas/RuleActionGroup'
          id:
            $ref: '#/components/schemas/RuleActionId'
          params:
            $ref: '#/components/schemas/RuleActionParams'
          frequency:
            $ref: '#/components/schemas/RuleActionFrequency'
          alerts_filter:
            $ref: '#/components/schemas/RuleActionAlertsFilter'
        required:
          - group
          - id
          - params
        additionalProperties: false
      BulkActionEditPayloadRuleActions:
        type: object
        properties:
          type:
            type: string
            enum:
              - add_rule_actions
              - set_rule_actions
          value:
            type: object
            properties:
              throttle:
                $ref: '#/components/schemas/ThrottleForBulkActions'
              actions:
                type: array
                items:
                  $ref: '#/components/schemas/NormalizedRuleAction'
            required:
              - actions
        required:
          - type
          - value
      BulkActionEditPayloadSchedule:
        type: object
        properties:
          type:
            type: string
            enum:
              - set_schedule
          value:
            type: object
            properties:
              interval:
                type: string
                description: Interval in which the rule is executed
                pattern: '^[1-9]\d*[smh]$'
                example: 1h
              lookback:
                type: string
                description: Lookback time for the rule
                pattern: '^[1-9]\d*[smh]$'
                example: 1h
            required:
              - interval
              - lookback
        required:
          - type
          - value
      BulkActionEditPayload:
        anyOf:
          - $ref: '#/components/schemas/BulkActionEditPayloadTags'
          - $ref: '#/components/schemas/BulkActionEditPayloadIndexPatterns'
          - $ref: '#/components/schemas/BulkActionEditPayloadTimeline'
          - $ref: '#/components/schemas/BulkActionEditPayloadRuleActions'
          - $ref: '#/components/schemas/BulkActionEditPayloadSchedule'
      BulkEditRules:
        allOf:
          - type: object
            properties:
              query:
                type: string
                description: Query to filter rules
              ids:
                type: array
                description: Array of rule IDs
                minItems: 1
                items:
                  type: string
          - type: object
            properties:
              action:
                type: string
                enum:
                  - edit
              edit:
                type: array
                description: Array of objects containing the edit operations
                items:
                  $ref: '#/components/schemas/BulkActionEditPayload'
                minItems: 1
            required:
              - action
              - edit
      RuleName:
        type: string
        minLength: 1
      RuleDescription:
        type: string
        minLength: 1
      RiskScore:
        type: integer
        description: Risk score (0 to 100)
        minimum: 0
        maximum: 100
      Severity:
        type: string
        enum:
          - low
          - medium
          - high
          - critical
        description: Severity of the rule
      RuleNameOverride:
        type: string
        description: Sets the source field for the alert's signal.rule.name value
      TimestampOverride:
        type: string
        description: Sets the time field used to query indices
      TimestampOverrideFallbackDisabled:
        type: boolean
        description: Disables the fallback to the event's @timestamp field
      SavedObjectResolveOutcome:
        type: string
        enum:
          - exactMatch
          - aliasMatch
          - conflict
      SavedObjectResolveAliasTargetId:
        type: string
      SavedObjectResolveAliasPurpose:
        type: string
        enum:
          - savedObjectConversion
          - savedObjectImport
      RuleLicense:
        type: string
        description: The rule's license.
      InvestigationGuide:
        type: string
        description: Notes to help investigate alerts produced by the rule.
      BuildingBlockType:
        type: string
        description: >-
          Determines if the rule acts as a building block. By default,
          building-block alerts are not displayed in the UI. These rules are
          used as a foundation for other rules that do generate alerts. Its
          value must be default.
      AlertsIndex:
        type: string
        description: (deprecated) Has no effect.
        deprecated: true
      AlertsIndexNamespace:
        type: string
        description: Has no effect.
      RuleMetadata:
        type: object
        additionalProperties: true
      InvestigationFields:
        type: object
        properties:
          field_names:
            type: array
            items:
              $ref: '#/components/schemas/NonEmptyString'
            minItems: 1
        required:
          - field_names
      RuleVersion:
        type: integer
        minimum: 1
        description: The rule's version number.
      IsRuleEnabled:
        type: boolean
        description: Determines whether the rule is enabled.
      RiskScoreMapping:
        type: array
        items:
          type: object
          properties:
            field:
              type: string
            operator:
              type: string
              enum:
                - equals
            value:
              type: string
            risk_score:
              $ref: '#/components/schemas/RiskScore'
          required:
            - field
            - operator
            - value
        description: >-
          Overrides generated alerts' risk_score with a value from the source
          event
      SeverityMapping:
        type: array
        items:
          type: object
          properties:
            field:
              type: string
            operator:
              type: string
              enum:
                - equals
            severity:
              $ref: '#/components/schemas/Severity'
            value:
              type: string
          required:
            - field
            - operator
            - severity
            - value
        description: Overrides generated alerts' severity with values from the source event
      RuleInterval:
        type: string
        description: >-
          Frequency of rule execution, using a date math range. For example,
          "1h" means the rule runs every hour. Defaults to 5m (5 minutes).
      RuleIntervalFrom:
        type: string
        description: >-
          Time from which data is analyzed each time the rule executes, using a
          date math range. For example, now-4200s means the rule analyzes data
          from 70 minutes before its start time. Defaults to now-6m (analyzes
          data from 6 minutes before the start time).
        format: date-math
      RuleIntervalTo:
        type: string
      RuleAction:
        type: object
        properties:
          action_type_id:
            type: string
            description: The action type used for sending notifications.
          group:
            $ref: '#/components/schemas/RuleActionGroup'
          id:
            $ref: '#/components/schemas/RuleActionId'
          params:
            $ref: '#/components/schemas/RuleActionParams'
          uuid:
            $ref: '#/components/schemas/NonEmptyString'
          alerts_filter:
            $ref: '#/components/schemas/RuleActionAlertsFilter'
          frequency:
            $ref: '#/components/schemas/RuleActionFrequency'
        required:
          - action_type_id
          - group
          - id
          - params
      ExceptionListType:
        type: string
        description: The exception type
        enum:
          - detection
          - rule_default
          - endpoint
          - endpoint_trusted_apps
          - endpoint_events
          - endpoint_host_isolation_exceptions
          - endpoint_blocklists
      RuleExceptionList:
        type: object
        properties:
          id:
            $ref: '#/components/schemas/NonEmptyString'
            description: ID of the exception container
          list_id:
            $ref: '#/components/schemas/NonEmptyString'
            description: List ID of the exception container
          type:
            $ref: '#/components/schemas/ExceptionListType'
          namespace_type:
            type: string
            description: Determines the exceptions validity in rule's Kibana space
            enum:
              - agnostic
              - single
        required:
          - id
          - list_id
          - type
          - namespace_type
      RuleAuthorArray:
        type: array
        items:
          type: string
      RuleFalsePositiveArray:
        type: array
        items:
          type: string
      RuleReferenceArray:
        type: array
        items:
          type: string
      MaxSignals:
        type: integer
        minimum: 1
      ThreatTactic:
        type: object
        properties:
          id:
            type: string
            description: Tactic ID
          name:
            type: string
            description: Tactic name
          reference:
            type: string
            description: Tactic reference
        required:
          - id
          - name
          - reference
      ThreatSubtechnique:
        type: object
        properties:
          id:
            type: string
            description: Subtechnique ID
          name:
            type: string
            description: Subtechnique name
          reference:
            type: string
            description: Subtechnique reference
        required:
          - id
          - name
          - reference
      ThreatTechnique:
        type: object
        properties:
          id:
            type: string
            description: Technique ID
          name:
            type: string
            description: Technique name
          reference:
            type: string
            description: Technique reference
          subtechnique:
            type: array
            items:
              $ref: '#/components/schemas/ThreatSubtechnique'
            description: Array containing more specific information on the attack technique
        required:
          - id
          - name
          - reference
      Threat:
        type: object
        properties:
          framework:
            type: string
            description: Relevant attack framework
          tactic:
            $ref: '#/components/schemas/ThreatTactic'
          technique:
            type: array
            items:
              $ref: '#/components/schemas/ThreatTechnique'
            description: Array containing information on the attack techniques (optional)
        required:
          - framework
          - tactic
      ThreatArray:
        type: array
        items:
          $ref: '#/components/schemas/Threat'
      UUID:
        type: string
        format: uuid
        description: A universally unique identifier
      RuleObjectId:
        $ref: '#/components/schemas/UUID'
      RuleSignatureId:
        type: string
        description: 'Could be any string, not necessarily a UUID'
      IsRuleImmutable:
        type: boolean
      RelatedIntegration:
        type: object
        properties:
          package:
            $ref: '#/components/schemas/NonEmptyString'
          version:
            $ref: '#/components/schemas/NonEmptyString'
          integration:
            $ref: '#/components/schemas/NonEmptyString'
        required:
          - package
          - version
      RelatedIntegrationArray:
        type: array
        items:
          $ref: '#/components/schemas/RelatedIntegration'
      RequiredField:
        type: object
        properties:
          name:
            $ref: '#/components/schemas/NonEmptyString'
          type:
            $ref: '#/components/schemas/NonEmptyString'
          ecs:
            type: boolean
        required:
          - name
          - type
          - ecs
      RequiredFieldArray:
        type: array
        items:
          $ref: '#/components/schemas/RequiredField'
      SetupGuide:
        type: string
      RuleExecutionStatus:
        type: string
        description: >-
          Custom execution status of Security rules that is different from the
          status used in the Alerting Framework. We merge our custom status with
          the Framework's status to determine the resulting status of a rule.

          - going to run - @deprecated Replaced by the 'running' status but left
          for backwards compatibility with rule execution events already written
          to Event Log in the prior versions of Kibana. Don't use when writing
          rule status changes.

          - running - Rule execution started but not reached any intermediate or
          final status.

          - partial failure - Rule can partially fail for various reasons either
          in the middle of an execution (in this case we update its status right
          away) or in the end of it. So currently this status can be both
          intermediate and final at the same time. A typical reason for a
          partial failure: not all the indices that the rule searches over
          actually exist.

          - failed - Rule failed to execute due to unhandled exception or a
          reason defined in the business logic of its executor function.

          - succeeded - Rule executed successfully without any issues. Note:
          this status is just an indication of a rule's "health". The rule might
          or might not generate any alerts despite of it.
        enum:
          - going to run
          - running
          - partial failure
          - failed
          - succeeded
      RuleExecutionStatusOrder:
        type: integer
      RuleExecutionMetrics:
        type: object
        properties:
          total_search_duration_ms:
            description: >-
              Total time spent performing ES searches as measured by Kibana;
              includes network latency and time spent serializing/deserializing
              request/response
            type: integer
            minimum: 0
          total_indexing_duration_ms:
            description: >-
              Total time spent indexing documents during current rule execution
              cycle
            type: integer
            minimum: 0
          total_enrichment_duration_ms:
            description: >-
              Total time spent enriching documents during current rule execution
              cycle
            type: integer
            minimum: 0
          execution_gap_duration_s:
            description: Duration in seconds of execution gap
            type: integer
            minimum: 0
      RuleExecutionSummary:
        type: object
        properties:
          last_execution:
            type: object
            properties:
              date:
                description: Date of the last execution
                type: string
                format: date-time
              status:
                description: Status of the last execution
                $ref: '#/components/schemas/RuleExecutionStatus'
              status_order:
                $ref: '#/components/schemas/RuleExecutionStatusOrder'
              message:
                type: string
              metrics:
                $ref: '#/components/schemas/RuleExecutionMetrics'
            required:
              - date
              - status
              - status_order
              - message
              - metrics
        required:
          - last_execution
      ResponseFields:
        type: object
        properties:
          id:
            $ref: '#/components/schemas/RuleObjectId'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          immutable:
            $ref: '#/components/schemas/IsRuleImmutable'
          updated_at:
            type: string
            format: date-time
          updated_by:
            type: string
          created_at:
            type: string
            format: date-time
          created_by:
            type: string
          revision:
            type: integer
            minimum: 0
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            $ref: '#/components/schemas/RequiredFieldArray'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          execution_summary:
            $ref: '#/components/schemas/RuleExecutionSummary'
        required:
          - id
          - rule_id
          - immutable
          - updated_at
          - updated_by
          - created_at
          - created_by
          - revision
          - related_integrations
          - required_fields
          - setup
      RuleQuery:
        type: string
      EqlQueryLanguage:
        type: string
        enum:
          - eql
      EqlRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - eql
            description: Rule type
          query:
            $ref: '#/components/schemas/RuleQuery'
            description: EQL query to execute
          language:
            $ref: '#/components/schemas/EqlQueryLanguage'
            description: Query language to use
        required:
          - type
          - query
          - language
      DataViewId:
        type: string
      RuleFilterArray:
        type: array
        items: {}
      EventCategoryOverride:
        type: string
      TiebreakerField:
        type: string
        description: Sets a secondary field for sorting events
      TimestampField:
        type: string
        description: Contains the event timestamp used for sorting a sequence of events
      EqlOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
          event_category_override:
            $ref: '#/components/schemas/EventCategoryOverride'
          tiebreaker_field:
            $ref: '#/components/schemas/TiebreakerField'
          timestamp_field:
            $ref: '#/components/schemas/TimestampField'
      EqlRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/EqlRequiredFields'
          - $ref: '#/components/schemas/EqlOptionalFields'
      EqlRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/EqlRuleResponseFields'
      QueryRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - query
            description: Rule type
        required:
          - type
      SavedQueryId:
        type: string
      EcsMapping:
        type: object
        additionalProperties:
          type: object
          properties:
            field:
              type: string
            value:
              oneOf:
                - type: string
                - type: array
                  items:
                    type: string
      OsqueryQuery:
        type: object
        properties:
          id:
            type: string
            description: Query ID
          query:
            type: string
            description: Query to execute
          ecs_mapping:
            $ref: '#/components/schemas/EcsMapping'
          version:
            type: string
            description: Query version
          platform:
            type: string
          removed:
            type: boolean
          snapshot:
            type: boolean
        required:
          - id
          - query
      OsqueryParams:
        type: object
        properties:
          query:
            type: string
          ecs_mapping:
            $ref: '#/components/schemas/EcsMapping'
          queries:
            type: array
            items:
              $ref: '#/components/schemas/OsqueryQuery'
          pack_id:
            type: string
          saved_query_id:
            type: string
          timeout:
            type: number
      OsqueryResponseAction:
        type: object
        properties:
          action_type_id:
            type: string
            enum:
              - .osquery
          params:
            $ref: '#/components/schemas/OsqueryParams'
        required:
          - action_type_id
          - params
      DefaultParams:
        type: object
        properties:
          command:
            type: string
            enum:
              - isolate
          comment:
            type: string
        required:
          - command
      ProcessesParams:
        type: object
        properties:
          command:
            type: string
            enum:
              - kill-process
              - suspend-process
          comment:
            type: string
          config:
            required:
              - field
            type: object
            properties:
              field:
                type: string
                description: Field to use instead of process.pid
              overwrite:
                type: boolean
                description: Whether to overwrite field with process.pid
                default: true
        required:
          - command
          - config
      EndpointResponseAction:
        type: object
        properties:
          action_type_id:
            type: string
            enum:
              - .endpoint
          params:
            oneOf:
              - $ref: '#/components/schemas/DefaultParams'
              - $ref: '#/components/schemas/ProcessesParams'
        required:
          - action_type_id
          - params
      ResponseAction:
        oneOf:
          - $ref: '#/components/schemas/OsqueryResponseAction'
          - $ref: '#/components/schemas/EndpointResponseAction'
      AlertSuppressionGroupBy:
        type: array
        items:
          type: string
        minItems: 1
        maxItems: 3
      AlertSuppressionDuration:
        type: object
        properties:
          value:
            type: integer
            minimum: 1
          unit:
            type: string
            enum:
              - s
              - m
              - h
        required:
          - value
          - unit
      AlertSuppressionMissingFieldsStrategy:
        type: string
        enum:
          - doNotSuppress
          - suppress
        description: >-
          Describes how alerts will be generated for documents with missing
          suppress by fields:

          doNotSuppress - per each document a separate alert will be created

          suppress - only alert will be created per suppress by bucket
      AlertSuppression:
        type: object
        properties:
          group_by:
            $ref: '#/components/schemas/AlertSuppressionGroupBy'
          duration:
            $ref: '#/components/schemas/AlertSuppressionDuration'
          missing_fields_strategy:
            $ref: '#/components/schemas/AlertSuppressionMissingFieldsStrategy'
        required:
          - group_by
      QueryRuleOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
          saved_id:
            $ref: '#/components/schemas/SavedQueryId'
          response_actions:
            type: array
            items:
              $ref: '#/components/schemas/ResponseAction'
          alert_suppression:
            $ref: '#/components/schemas/AlertSuppression'
      KqlQueryLanguage:
        type: string
        enum:
          - kuery
          - lucene
      QueryRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/QueryRuleRequiredFields'
          - $ref: '#/components/schemas/QueryRuleOptionalFields'
          - type: object
            properties:
              query:
                $ref: '#/components/schemas/RuleQuery'
              language:
                $ref: '#/components/schemas/KqlQueryLanguage'
            required:
              - query
              - language
      QueryRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/QueryRuleResponseFields'
      SavedQueryRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - saved_query
            description: Rule type
          saved_id:
            $ref: '#/components/schemas/SavedQueryId'
        required:
          - type
          - saved_id
      SavedQueryRuleOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
          response_actions:
            type: array
            items:
              $ref: '#/components/schemas/ResponseAction'
          alert_suppression:
            $ref: '#/components/schemas/AlertSuppression'
          query:
            $ref: '#/components/schemas/RuleQuery'
      SavedQueryRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/SavedQueryRuleRequiredFields'
          - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
          - type: object
            properties:
              language:
                $ref: '#/components/schemas/KqlQueryLanguage'
            required:
              - language
      SavedQueryRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/SavedQueryRuleResponseFields'
      ThresholdField:
        oneOf:
          - type: string
          - type: array
            items:
              type: string
        description: Field to aggregate on
      ThresholdValue:
        type: integer
        minimum: 1
        description: Threshold value
      ThresholdCardinality:
        type: array
        items:
          type: object
          properties:
            field:
              type: string
            value:
              type: integer
              minimum: 0
          required:
            - field
            - value
      Threshold:
        type: object
        properties:
          field:
            $ref: '#/components/schemas/ThresholdField'
          value:
            $ref: '#/components/schemas/ThresholdValue'
          cardinality:
            $ref: '#/components/schemas/ThresholdCardinality'
        required:
          - field
          - value
      ThresholdRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - threshold
            description: Rule type
          query:
            $ref: '#/components/schemas/RuleQuery'
          threshold:
            $ref: '#/components/schemas/Threshold'
        required:
          - type
          - query
          - threshold
      ThresholdAlertSuppression:
        type: object
        properties:
          duration:
            $ref: '#/components/schemas/AlertSuppressionDuration'
        required:
          - duration
      ThresholdRuleOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
          saved_id:
            $ref: '#/components/schemas/SavedQueryId'
          alert_suppression:
            $ref: '#/components/schemas/ThresholdAlertSuppression'
      ThresholdRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/ThresholdRuleRequiredFields'
          - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
          - type: object
            properties:
              language:
                $ref: '#/components/schemas/KqlQueryLanguage'
            required:
              - language
      ThresholdRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/ThresholdRuleResponseFields'
      ThreatQuery:
        type: string
        description: Query to execute
      ThreatMapping:
        type: array
        minItems: 1
        items:
          type: object
          properties:
            entries:
              type: array
              items:
                type: object
                properties:
                  field:
                    $ref: '#/components/schemas/NonEmptyString'
                  type:
                    type: string
                    enum:
                      - mapping
                  value:
                    $ref: '#/components/schemas/NonEmptyString'
                required:
                  - field
                  - type
                  - value
          required:
            - entries
      ThreatIndex:
        type: array
        items:
          type: string
      ThreatMatchRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - threat_match
            description: Rule type
          query:
            $ref: '#/components/schemas/RuleQuery'
          threat_query:
            $ref: '#/components/schemas/ThreatQuery'
          threat_mapping:
            $ref: '#/components/schemas/ThreatMapping'
          threat_index:
            $ref: '#/components/schemas/ThreatIndex'
        required:
          - type
          - query
          - threat_query
          - threat_mapping
          - threat_index
      ThreatFilters:
        type: array
        items:
          description: >-
            Query and filter context array used to filter documents from the
            Elasticsearch index containing the threat values
      ThreatIndicatorPath:
        type: string
        description: >-
          Defines the path to the threat indicator in the indicator documents
          (optional)
      ConcurrentSearches:
        type: integer
        minimum: 1
      ItemsPerSearch:
        type: integer
        minimum: 1
      ThreatMatchRuleOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
          saved_id:
            $ref: '#/components/schemas/SavedQueryId'
          threat_filters:
            $ref: '#/components/schemas/ThreatFilters'
          threat_indicator_path:
            $ref: '#/components/schemas/ThreatIndicatorPath'
          threat_language:
            $ref: '#/components/schemas/KqlQueryLanguage'
          concurrent_searches:
            $ref: '#/components/schemas/ConcurrentSearches'
          items_per_search:
            $ref: '#/components/schemas/ItemsPerSearch'
          alert_suppression:
            $ref: '#/components/schemas/AlertSuppression'
      ThreatMatchRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/ThreatMatchRuleRequiredFields'
          - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
          - type: object
            properties:
              language:
                $ref: '#/components/schemas/KqlQueryLanguage'
            required:
              - language
      ThreatMatchRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/ThreatMatchRuleResponseFields'
      AnomalyThreshold:
        type: integer
        minimum: 0
        description: Anomaly threshold
      MachineLearningJobId:
        oneOf:
          - type: string
          - type: array
            items:
              type: string
            minItems: 1
        description: Machine learning job ID
      MachineLearningRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - machine_learning
            description: Rule type
          anomaly_threshold:
            $ref: '#/components/schemas/AnomalyThreshold'
          machine_learning_job_id:
            $ref: '#/components/schemas/MachineLearningJobId'
        required:
          - type
          - machine_learning_job_id
          - anomaly_threshold
      MachineLearningRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/MachineLearningRuleRequiredFields'
      MachineLearningRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/MachineLearningRuleResponseFields'
      NewTermsFields:
        type: array
        items:
          type: string
        minItems: 1
        maxItems: 3
      HistoryWindowStart:
        $ref: '#/components/schemas/NonEmptyString'
      NewTermsRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - new_terms
            description: Rule type
          query:
            $ref: '#/components/schemas/RuleQuery'
          new_terms_fields:
            $ref: '#/components/schemas/NewTermsFields'
          history_window_start:
            $ref: '#/components/schemas/HistoryWindowStart'
        required:
          - type
          - query
          - new_terms_fields
          - history_window_start
      NewTermsRuleOptionalFields:
        type: object
        properties:
          index:
            $ref: '#/components/schemas/IndexPatternArray'
          data_view_id:
            $ref: '#/components/schemas/DataViewId'
          filters:
            $ref: '#/components/schemas/RuleFilterArray'
      NewTermsRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/NewTermsRuleRequiredFields'
          - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
          - type: object
            properties:
              language:
                $ref: '#/components/schemas/KqlQueryLanguage'
            required:
              - language
      NewTermsRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/NewTermsRuleResponseFields'
      EsqlQueryLanguage:
        type: string
        enum:
          - esql
      EsqlRuleRequiredFields:
        type: object
        properties:
          type:
            type: string
            enum:
              - esql
            description: Rule type
          language:
            $ref: '#/components/schemas/EsqlQueryLanguage'
          query:
            $ref: '#/components/schemas/RuleQuery'
            description: ESQL query to execute
        required:
          - type
          - language
          - query
      EsqlRuleResponseFields:
        allOf:
          - $ref: '#/components/schemas/EsqlRuleRequiredFields'
      EsqlRule:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - x-inline: true
                    type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
                    required:
                      - version
                      - tags
                      - enabled
                      - risk_score_mapping
                      - severity_mapping
                      - interval
                      - from
                      - to
                      - actions
                      - exceptions_list
                      - author
                      - false_positives
                      - references
                      - max_signals
                      - threat
              - $ref: '#/components/schemas/ResponseFields'
          - $ref: '#/components/schemas/EsqlRuleResponseFields'
      RuleResponse:
        discriminator:
          propertyName: type
        anyOf:
          - $ref: '#/components/schemas/EqlRule'
          - $ref: '#/components/schemas/QueryRule'
          - $ref: '#/components/schemas/SavedQueryRule'
          - $ref: '#/components/schemas/ThresholdRule'
          - $ref: '#/components/schemas/ThreatMatchRule'
          - $ref: '#/components/schemas/MachineLearningRule'
          - $ref: '#/components/schemas/NewTermsRule'
          - $ref: '#/components/schemas/EsqlRule'
      BulkEditSkipReason:
        type: string
        enum:
          - RULE_NOT_MODIFIED
      BulkActionSkipResult:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
          skip_reason:
            $ref: '#/components/schemas/BulkEditSkipReason'
        required:
          - id
          - skip_reason
      BulkEditActionResults:
        type: object
        properties:
          updated:
            type: array
            items:
              $ref: '#/components/schemas/RuleResponse'
          created:
            type: array
            items:
              $ref: '#/components/schemas/RuleResponse'
          deleted:
            type: array
            items:
              $ref: '#/components/schemas/RuleResponse'
          skipped:
            type: array
            items:
              $ref: '#/components/schemas/BulkActionSkipResult'
        required:
          - updated
          - created
          - deleted
          - skipped
      BulkEditActionSummary:
        type: object
        properties:
          failed:
            type: integer
          skipped:
            type: integer
          succeeded:
            type: integer
          total:
            type: integer
        required:
          - failed
          - skipped
          - succeeded
          - total
      BulkActionsDryRunErrCode:
        type: string
        enum:
          - IMMUTABLE
          - MACHINE_LEARNING_AUTH
          - MACHINE_LEARNING_INDEX_PATTERN
          - ESQL_INDEX_PATTERN
      RuleDetailsInError:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
        required:
          - id
      NormalizedRuleError:
        type: object
        properties:
          message:
            type: string
          status_code:
            type: integer
          err_code:
            $ref: '#/components/schemas/BulkActionsDryRunErrCode'
          rules:
            type: array
            items:
              $ref: '#/components/schemas/RuleDetailsInError'
        required:
          - message
          - status_code
          - rules
      BulkEditActionResponse:
        type: object
        properties:
          success:
            type: boolean
          status_code:
            type: integer
          message:
            type: string
          rules_count:
            type: integer
          attributes:
            type: object
            properties:
              results:
                $ref: '#/components/schemas/BulkEditActionResults'
              summary:
                $ref: '#/components/schemas/BulkEditActionSummary'
              errors:
                type: array
                items:
                  $ref: '#/components/schemas/NormalizedRuleError'
            required:
              - results
              - summary
        required:
          - attributes
      BulkExportActionResponse:
        type: string
      FindRulesSortField:
        type: string
        enum:
          - created_at
          - createdAt
          - enabled
          - execution_summary.last_execution.date
          - execution_summary.last_execution.metrics.execution_gap_duration_s
          - execution_summary.last_execution.metrics.total_indexing_duration_ms
          - execution_summary.last_execution.metrics.total_search_duration_ms
          - execution_summary.last_execution.status
          - name
          - risk_score
          - riskScore
          - severity
          - updated_at
          - updatedAt
      SortOrder:
        type: string
        enum:
          - asc
          - desc
      ErrorSchema:
        type: object
        required:
          - error
        additionalProperties: false
        properties:
          id:
            type: string
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          list_id:
            type: string
            minLength: 1
          item_id:
            type: string
            minLength: 1
          error:
            type: object
            required:
              - status_code
              - message
            properties:
              status_code:
                type: integer
                minimum: 400
              message:
                type: string
      WarningSchema:
        type: object
        properties:
          type:
            type: string
          message:
            type: string
          actionPath:
            type: string
          buttonLabel:
            type: string
        required:
          - type
          - message
          - actionPath
      EqlRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/EqlRequiredFields'
          - $ref: '#/components/schemas/EqlOptionalFields'
      EqlRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/EqlRuleCreateFields'
      QueryRuleDefaultableFields:
        type: object
        properties:
          query:
            $ref: '#/components/schemas/RuleQuery'
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
      QueryRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/QueryRuleRequiredFields'
          - $ref: '#/components/schemas/QueryRuleOptionalFields'
          - $ref: '#/components/schemas/QueryRuleDefaultableFields'
      QueryRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/QueryRuleCreateFields'
      SavedQueryRuleDefaultableFields:
        type: object
        properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
      SavedQueryRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/SavedQueryRuleRequiredFields'
          - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
          - $ref: '#/components/schemas/SavedQueryRuleDefaultableFields'
      SavedQueryRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/SavedQueryRuleCreateFields'
      ThresholdRuleDefaultableFields:
        type: object
        properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
      ThresholdRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/ThresholdRuleRequiredFields'
          - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
          - $ref: '#/components/schemas/ThresholdRuleDefaultableFields'
      ThresholdRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThresholdRuleCreateFields'
      ThreatMatchRuleDefaultableFields:
        type: object
        properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
      ThreatMatchRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/ThreatMatchRuleRequiredFields'
          - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
          - $ref: '#/components/schemas/ThreatMatchRuleDefaultableFields'
      ThreatMatchRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThreatMatchRuleCreateFields'
      MachineLearningRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/MachineLearningRuleRequiredFields'
      MachineLearningRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/MachineLearningRuleCreateFields'
      NewTermsRuleDefaultableFields:
        type: object
        properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
      NewTermsRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/NewTermsRuleRequiredFields'
          - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
          - $ref: '#/components/schemas/NewTermsRuleDefaultableFields'
      NewTermsRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/NewTermsRuleCreateFields'
      EsqlRuleCreateFields:
        allOf:
          - $ref: '#/components/schemas/EsqlRuleRequiredFields'
      EsqlRuleCreateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/EsqlRuleCreateFields'
      RuleCreateProps:
        discriminator:
          propertyName: type
        anyOf:
          - $ref: '#/components/schemas/EqlRuleCreateProps'
          - $ref: '#/components/schemas/QueryRuleCreateProps'
          - $ref: '#/components/schemas/SavedQueryRuleCreateProps'
          - $ref: '#/components/schemas/ThresholdRuleCreateProps'
          - $ref: '#/components/schemas/ThreatMatchRuleCreateProps'
          - $ref: '#/components/schemas/MachineLearningRuleCreateProps'
          - $ref: '#/components/schemas/NewTermsRuleCreateProps'
          - $ref: '#/components/schemas/EsqlRuleCreateProps'
      BulkCrudRulesResponse:
        type: array
        items:
          oneOf:
            - $ref: '#/components/schemas/RuleResponse'
            - $ref: '#/components/schemas/ErrorSchema'
      EqlRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - eql
                description: Rule type
              query:
                $ref: '#/components/schemas/RuleQuery'
                description: EQL query to execute
              language:
                $ref: '#/components/schemas/EqlQueryLanguage'
                description: Query language to use
          - $ref: '#/components/schemas/EqlOptionalFields'
      EqlRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/EqlRulePatchFields'
      QueryRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - query
                description: Rule type
          - $ref: '#/components/schemas/QueryRuleOptionalFields'
          - $ref: '#/components/schemas/QueryRuleDefaultableFields'
      QueryRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/QueryRulePatchFields'
      SavedQueryRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - saved_query
                description: Rule type
              saved_id:
                $ref: '#/components/schemas/SavedQueryId'
          - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
          - $ref: '#/components/schemas/SavedQueryRuleDefaultableFields'
      SavedQueryRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/SavedQueryRulePatchFields'
      ThresholdRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - threshold
                description: Rule type
              query:
                $ref: '#/components/schemas/RuleQuery'
              threshold:
                $ref: '#/components/schemas/Threshold'
          - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
          - $ref: '#/components/schemas/ThresholdRuleDefaultableFields'
      ThresholdRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThresholdRulePatchFields'
      ThreatMatchRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - threat_match
                description: Rule type
              query:
                $ref: '#/components/schemas/RuleQuery'
              threat_query:
                $ref: '#/components/schemas/ThreatQuery'
              threat_mapping:
                $ref: '#/components/schemas/ThreatMapping'
              threat_index:
                $ref: '#/components/schemas/ThreatIndex'
          - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
          - $ref: '#/components/schemas/ThreatMatchRuleDefaultableFields'
      ThreatMatchRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThreatMatchRulePatchFields'
      MachineLearningRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - machine_learning
                description: Rule type
              anomaly_threshold:
                $ref: '#/components/schemas/AnomalyThreshold'
              machine_learning_job_id:
                $ref: '#/components/schemas/MachineLearningJobId'
      MachineLearningRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/MachineLearningRulePatchFields'
      NewTermsRulePatchFields:
        allOf:
          - type: object
            properties:
              type:
                type: string
                enum:
                  - new_terms
                description: Rule type
              query:
                $ref: '#/components/schemas/RuleQuery'
              new_terms_fields:
                $ref: '#/components/schemas/NewTermsFields'
              history_window_start:
                $ref: '#/components/schemas/HistoryWindowStart'
          - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
          - $ref: '#/components/schemas/NewTermsRuleDefaultableFields'
      NewTermsRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/NewTermsRulePatchFields'
      EsqlRulePatchProps:
        allOf:
          - allOf:
              - allOf:
                  - x-inline: true
                    type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - allOf:
              - type: object
                properties:
                  type:
                    type: string
                    enum:
                      - esql
                    description: Rule type
                  language:
                    $ref: '#/components/schemas/EsqlQueryLanguage'
                  query:
                    $ref: '#/components/schemas/RuleQuery'
                    description: ESQL query to execute
      RulePatchProps:
        anyOf:
          - $ref: '#/components/schemas/EqlRulePatchProps'
          - $ref: '#/components/schemas/QueryRulePatchProps'
          - $ref: '#/components/schemas/SavedQueryRulePatchProps'
          - $ref: '#/components/schemas/ThresholdRulePatchProps'
          - $ref: '#/components/schemas/ThreatMatchRulePatchProps'
          - $ref: '#/components/schemas/MachineLearningRulePatchProps'
          - $ref: '#/components/schemas/NewTermsRulePatchProps'
          - $ref: '#/components/schemas/EsqlRulePatchProps'
      EqlRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/EqlRuleCreateFields'
      QueryRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/QueryRuleCreateFields'
      SavedQueryRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/SavedQueryRuleCreateFields'
      ThresholdRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThresholdRuleCreateFields'
      ThreatMatchRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/ThreatMatchRuleCreateFields'
      MachineLearningRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/MachineLearningRuleCreateFields'
      NewTermsRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/NewTermsRuleCreateFields'
      EsqlRuleUpdateProps:
        allOf:
          - allOf:
              - allOf:
                  - type: object
                    properties:
                      name:
                        $ref: '#/components/schemas/RuleName'
                      description:
                        $ref: '#/components/schemas/RuleDescription'
                      risk_score:
                        $ref: '#/components/schemas/RiskScore'
                      severity:
                        $ref: '#/components/schemas/Severity'
                    required:
                      - name
                      - description
                      - risk_score
                      - severity
                  - type: object
                    properties:
                      rule_name_override:
                        $ref: '#/components/schemas/RuleNameOverride'
                      timestamp_override:
                        $ref: '#/components/schemas/TimestampOverride'
                      timestamp_override_fallback_disabled:
                        $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
                      timeline_id:
                        $ref: '#/components/schemas/TimelineTemplateId'
                      timeline_title:
                        $ref: '#/components/schemas/TimelineTemplateTitle'
                      outcome:
                        $ref: '#/components/schemas/SavedObjectResolveOutcome'
                      alias_target_id:
                        $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
                      alias_purpose:
                        $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
                      license:
                        $ref: '#/components/schemas/RuleLicense'
                      note:
                        $ref: '#/components/schemas/InvestigationGuide'
                      building_block_type:
                        $ref: '#/components/schemas/BuildingBlockType'
                      output_index:
                        $ref: '#/components/schemas/AlertsIndex'
                      namespace:
                        $ref: '#/components/schemas/AlertsIndexNamespace'
                      meta:
                        $ref: '#/components/schemas/RuleMetadata'
                      investigation_fields:
                        $ref: '#/components/schemas/InvestigationFields'
                      throttle:
                        $ref: '#/components/schemas/RuleActionThrottle'
                  - type: object
                    properties:
                      version:
                        $ref: '#/components/schemas/RuleVersion'
                      tags:
                        $ref: '#/components/schemas/RuleTagArray'
                      enabled:
                        $ref: '#/components/schemas/IsRuleEnabled'
                      risk_score_mapping:
                        $ref: '#/components/schemas/RiskScoreMapping'
                      severity_mapping:
                        $ref: '#/components/schemas/SeverityMapping'
                      interval:
                        $ref: '#/components/schemas/RuleInterval'
                      from:
                        $ref: '#/components/schemas/RuleIntervalFrom'
                      to:
                        $ref: '#/components/schemas/RuleIntervalTo'
                      actions:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleAction'
                      exceptions_list:
                        type: array
                        items:
                          $ref: '#/components/schemas/RuleExceptionList'
                      author:
                        $ref: '#/components/schemas/RuleAuthorArray'
                      false_positives:
                        $ref: '#/components/schemas/RuleFalsePositiveArray'
                      references:
                        $ref: '#/components/schemas/RuleReferenceArray'
                      max_signals:
                        $ref: '#/components/schemas/MaxSignals'
                      threat:
                        $ref: '#/components/schemas/ThreatArray'
              - type: object
                properties:
                  id:
                    $ref: '#/components/schemas/RuleObjectId'
                  rule_id:
                    $ref: '#/components/schemas/RuleSignatureId'
          - $ref: '#/components/schemas/EsqlRuleCreateFields'
      RuleUpdateProps:
        discriminator:
          propertyName: type
        anyOf:
          - $ref: '#/components/schemas/EqlRuleUpdateProps'
          - $ref: '#/components/schemas/QueryRuleUpdateProps'
          - $ref: '#/components/schemas/SavedQueryRuleUpdateProps'
          - $ref: '#/components/schemas/ThresholdRuleUpdateProps'
          - $ref: '#/components/schemas/ThreatMatchRuleUpdateProps'
          - $ref: '#/components/schemas/MachineLearningRuleUpdateProps'
          - $ref: '#/components/schemas/NewTermsRuleUpdateProps'
          - $ref: '#/components/schemas/EsqlRuleUpdateProps'
