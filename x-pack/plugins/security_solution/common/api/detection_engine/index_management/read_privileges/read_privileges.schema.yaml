openapi: 3.0.0
info:
  title: Read privileges API endpoint
  version: '2023-10-31'
paths:
  /api/detection_engine/privileges:
    get:
      x-labels: [serverless, ess]
      operationId: GetPrivileges
      x-codegen-enabled: true
      summary: Returns user privileges for the Kibana space
      description: |
        Retrieves whether or not the user is authenticated, and the user's Kibana
        space and index privileges, which determine if the user can create an
        index for the Elastic Security alerts generated by
        detection engine rules.
      tags:
        - Privileges API
      responses:
        200:
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  is_authenticated:
                    type: boolean
                  has_encryption_key:
                    type: boolean
                required: [is_authenticated, has_encryption_key]
        401:
          description: Unsuccessful authentication response
          content:
            application/json:
              schema:
                $ref: '../../../model/error_responses.schema.yaml#/components/schemas/PlatformErrorResponse'
        500:
          description: Internal server error response
          content:
            application/json:
              schema:
                $ref: '../../../model/error_responses.schema.yaml#/components/schemas/SiemErrorResponse'
