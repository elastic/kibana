/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import { z } from 'zod';

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 */

/**
 * Rule execution result is an aggregate that groups plain rule execution events by execution UUID. It contains such information as execution UUID, date, status and metrics.
 */
export interface RuleExecutionResult {
  execution_uuid: string;
  timestamp: string;
  duration_ms: number;
  status: string;
  message: string;
  num_active_alerts: number;
  num_new_alerts: number;
  num_recovered_alerts: number;
  num_triggered_actions: number;
  num_succeeded_actions: number;
  num_errored_actions: number;
  total_search_duration_ms: number;
  es_search_duration_ms: number;
  schedule_delay_ms: number;
  timed_out: boolean;
  indexing_duration_ms: number;
  search_duration_ms: number;
  gap_duration_s: number;
  security_status: string;
  security_message: string;
}

export const RuleExecutionResult = z.object({
  execution_uuid: z.string(),
  timestamp: z.string().datetime(),
  duration_ms: z.number().int(),
  status: z.string(),
  message: z.string(),
  num_active_alerts: z.number().int(),
  num_new_alerts: z.number().int(),
  num_recovered_alerts: z.number().int(),
  num_triggered_actions: z.number().int(),
  num_succeeded_actions: z.number().int(),
  num_errored_actions: z.number().int(),
  total_search_duration_ms: z.number().int(),
  es_search_duration_ms: z.number().int(),
  schedule_delay_ms: z.number().int(),
  timed_out: z.boolean(),
  indexing_duration_ms: z.number().int(),
  search_duration_ms: z.number().int(),
  gap_duration_s: z.number().int(),
  security_status: z.string(),
  security_message: z.string(),
});

/**
 * We support sorting rule execution results by these fields.
 */
export type SortFieldOfRuleExecutionResult =
  | 'timestamp'
  | 'duration_ms'
  | 'gap_duration_s'
  | 'indexing_duration_ms'
  | 'search_duration_ms'
  | 'schedule_delay_ms';

export const SortFieldOfRuleExecutionResult = z.enum([
  'timestamp',
  'duration_ms',
  'gap_duration_s',
  'indexing_duration_ms',
  'search_duration_ms',
  'schedule_delay_ms',
]);
export const SortFieldOfRuleExecutionResultEnum = SortFieldOfRuleExecutionResult.enum;
export type SortFieldOfRuleExecutionResultEnum = typeof SortFieldOfRuleExecutionResult.enum;
