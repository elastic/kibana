/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import { z } from 'zod';
import { requireOptional, isValidDateMath } from '@kbn/zod-helpers';

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 */

import {
  RuleName,
  RuleDescription,
  RuleLicense,
  RuleMetadata,
  InvestigationFields,
  RuleActionThrottle,
  RuleVersion,
  RuleTagArray,
  IsRuleEnabled,
  RuleAction,
  ThreatArray,
  RuleObjectId,
  RuleSignatureId,
  RelatedIntegrationArray,
  RequiredFieldArray,
  SetupGuide,
} from './common_attributes.gen';
import { RuleExecutionSummary } from '../../rule_monitoring/model/execution_summary.gen';
import {
  EventCategoryOverride,
  TiebreakerField,
  TimestampField,
} from './specific_attributes/eql_attributes.gen';
import { ResponseAction } from '../rule_response_actions/response_actions.gen';
import { AlertSuppression } from './specific_attributes/query_attributes.gen';
import { Threshold } from './specific_attributes/threshold_attributes.gen';
import { NewTermsFields, HistoryWindowStart } from './specific_attributes/new_terms_attributes.gen';

export type BaseRequiredFields = z.infer<typeof BaseRequiredFields>;
export const BaseRequiredFields = z.object({
  name: RuleName,
  description: RuleDescription,
  /**
   * Risk score (0 to 100)
   */
  risk_score: z.number().int().min(0).max(100),
  /**
   * Severity of the rule
   */
  severity: z.enum(['low', 'medium', 'high', 'critical']),
});

export type BaseOptionalFields = z.infer<typeof BaseOptionalFields>;
export const BaseOptionalFields = z.object({
  /**
   * Sets the source field for the alert's signal.rule.name value
   */
  rule_name_override: z.string().optional(),
  /**
   * Sets the time field used to query indices
   */
  timestamp_override: z.string().optional(),
  /**
   * Disables the fallback to the event's @timestamp field
   */
  timestamp_override_fallback_disabled: z.boolean().optional(),
  /**
   * Timeline template ID
   */
  timeline_id: z.string().optional(),
  /**
   * Timeline template title
   */
  timeline_title: z.string().optional(),
  /**
   * Outcome is a property of the saved object resolve API. It will provide information about the rule following the 8.0 migrations
   */
  outcome: z.enum(['exactMatch', 'aliasMatch', 'conflict']).optional(),
  alias_target_id: z.string().optional(),
  alias_purpose: z.enum(['savedObjectConversion', 'savedObjectImport']).optional(),
  license: RuleLicense.optional(),
  /**
   * Notes to help investigate alerts produced by the rule.
   */
  note: z.string().optional(),
  /**
   * Determines if the rule acts as a building block. By default, building-block alerts are not displayed in the UI. These rules are used as a foundation for other rules that do generate alerts. Its value must be default.
   */
  building_block_type: z.string().optional(),
  /**
   * (deprecated) Has no effect.
   */
  output_index: z.string().optional(),
  /**
   * Has no effect.
   */
  namespace: z.string().optional(),
  meta: RuleMetadata.optional(),
  investigation_fields: InvestigationFields.optional(),
  throttle: RuleActionThrottle.optional(),
});

export type BaseDefaultableFields = z.infer<typeof BaseDefaultableFields>;
export const BaseDefaultableFields = z.object({
  version: RuleVersion.optional(),
  tags: RuleTagArray.optional(),
  enabled: IsRuleEnabled.optional(),
  /**
   * Overrides generated alerts' risk_score with a value from the source event
   */
  risk_score_mapping: z
    .array(
      z
        .object({
          field: z.string(),
          operator: z.literal('equals'),
          value: z.string(),
          risk_score: z.number().int().min(0).max(100).optional(),
        })
        .transform(requireOptional)
    )
    .optional(),
  /**
   * Overrides generated alerts' severity with values from the source event
   */
  severity_mapping: z
    .array(
      z.object({
        field: z.string(),
        operator: z.literal('equals'),
        severity: z.enum(['low', 'medium', 'high', 'critical']),
        value: z.string(),
      })
    )
    .optional(),
  /**
   * Frequency of rule execution, using a date math range. For example, "1h" means the rule runs every hour. Defaults to 5m (5 minutes).
   */
  interval: z.string().optional(),
  /**
   * Time from which data is analyzed each time the rule executes, using a date math range. For example, now-4200s means the rule analyzes data from 70 minutes before its start time. Defaults to now-6m (analyzes data from 6 minutes before the start time).
   */
  from: z.string().superRefine(isValidDateMath).optional(),
  to: z.string().optional(),
  actions: z.array(RuleAction).optional(),
  exceptions_list: z
    .array(
      z.object({
        /**
         * ID of the exception container
         */
        id: z.string().min(1),
        /**
         * List ID of the exception container
         */
        list_id: z.string().min(1),
        /**
         * The exception type
         */
        type: z.enum([
          'detection',
          'rule_default',
          'endpoint',
          'endpoint_trusted_apps',
          'endpoint_events',
          'endpoint_host_isolation_exceptions',
          'endpoint_blocklists',
        ]),
        /**
         * Determines the exceptions validity in rule's Kibana space
         */
        namespace_type: z.enum(['agnostic', 'single']),
      })
    )
    .optional(),
  author: z.array(z.string()).optional(),
  false_positives: z.array(z.string()).optional(),
  references: z.array(z.string()).optional(),
  max_signals: z.number().int().min(1).optional(),
  threat: ThreatArray.optional(),
});

export type BaseCreateProps = z.infer<typeof BaseCreateProps>;
export const BaseCreateProps =
  BaseRequiredFields.and(BaseOptionalFields).and(BaseDefaultableFields);

export type BasePatchProps = z.infer<typeof BasePatchProps>;
export const BasePatchProps = BaseRequiredFields.partial()
  .and(BaseOptionalFields)
  .and(BaseDefaultableFields);

export type BaseResponseProps = z.infer<typeof BaseResponseProps>;
export const BaseResponseProps = BaseRequiredFields.and(
  BaseOptionalFields.transform(requireOptional)
).and(BaseDefaultableFields.required());

export type ResponseRequiredFields = z.infer<typeof ResponseRequiredFields>;
export const ResponseRequiredFields = z.object({
  id: RuleObjectId,
  rule_id: RuleSignatureId,
  immutable: z.boolean(),
  updated_at: z.string().datetime(),
  updated_by: z.string(),
  created_at: z.string().datetime(),
  created_by: z.string(),
  revision: z.number().int().min(0),
  related_integrations: RelatedIntegrationArray,
  required_fields: RequiredFieldArray,
  setup: SetupGuide,
});

export type ResponseOptionalFields = z.infer<typeof ResponseOptionalFields>;
export const ResponseOptionalFields = z.object({
  execution_summary: RuleExecutionSummary.optional(),
});

export type SharedCreateProps = z.infer<typeof SharedCreateProps>;
export const SharedCreateProps = BaseCreateProps.and(
  z.object({
    rule_id: RuleSignatureId.optional(),
  })
);

export type SharedUpdateProps = z.infer<typeof SharedUpdateProps>;
export const SharedUpdateProps = BaseCreateProps.and(
  z.object({
    id: RuleObjectId.optional(),
    rule_id: RuleSignatureId.optional(),
  })
);

export type SharedPatchProps = z.infer<typeof SharedPatchProps>;
export const SharedPatchProps = BasePatchProps.and(
  z.object({
    id: RuleObjectId.optional(),
    rule_id: RuleSignatureId.optional(),
  })
);

export type SharedResponseProps = z.infer<typeof SharedResponseProps>;
export const SharedResponseProps =
  BaseResponseProps.and(ResponseRequiredFields).and(ResponseOptionalFields);

export type QueryLanguage = z.infer<typeof QueryLanguage>;
export const QueryLanguage = z.enum(['kuery', 'lucene', 'eql', 'esql']);
export const QueryLanguageEnum = QueryLanguage.enum;
export type QueryLanguageEnum = typeof QueryLanguage.enum;

export type KqlQueryLanguage = z.infer<typeof KqlQueryLanguage>;
export const KqlQueryLanguage = z.enum(['kuery', 'lucene']);
export const KqlQueryLanguageEnum = KqlQueryLanguage.enum;
export type KqlQueryLanguageEnum = typeof KqlQueryLanguage.enum;

export type EqlQueryLanguage = z.infer<typeof EqlQueryLanguage>;
export const EqlQueryLanguage = z.literal('eql');

export type EqlRequiredFields = z.infer<typeof EqlRequiredFields>;
export const EqlRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('eql'),
  /**
   * EQL query to execute
   */
  query: z.string(),
  /**
   * Query language to use
   */
  language: EqlQueryLanguage,
});

export type EqlOptionalFields = z.infer<typeof EqlOptionalFields>;
export const EqlOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
  event_category_override: EventCategoryOverride.optional(),
  tiebreaker_field: TiebreakerField.optional(),
  timestamp_field: TimestampField.optional(),
});

export type EqlRuleCreateFields = z.infer<typeof EqlRuleCreateFields>;
export const EqlRuleCreateFields = EqlRequiredFields.and(EqlOptionalFields);

export type EqlRuleResponseFields = z.infer<typeof EqlRuleResponseFields>;
export const EqlRuleResponseFields = EqlRequiredFields.and(
  EqlOptionalFields.transform(requireOptional)
);

export type EqlRulePatchFields = z.infer<typeof EqlRulePatchFields>;
export const EqlRulePatchFields = EqlRequiredFields.partial().and(EqlOptionalFields);

export type EqlRule = z.infer<typeof EqlRule>;
export const EqlRule = SharedResponseProps.and(EqlRuleResponseFields);

export type EqlRuleCreateProps = z.infer<typeof EqlRuleCreateProps>;
export const EqlRuleCreateProps = SharedCreateProps.and(EqlRuleCreateFields);

export type EqlRuleUpdateProps = z.infer<typeof EqlRuleUpdateProps>;
export const EqlRuleUpdateProps = SharedUpdateProps.and(EqlRuleCreateFields);

export type EqlRulePatchProps = z.infer<typeof EqlRulePatchProps>;
export const EqlRulePatchProps = SharedPatchProps.and(EqlRulePatchFields);

export type QueryRuleRequiredFields = z.infer<typeof QueryRuleRequiredFields>;
export const QueryRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('query'),
});

export type QueryRuleOptionalFields = z.infer<typeof QueryRuleOptionalFields>;
export const QueryRuleOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
  saved_id: z.string().optional(),
  response_actions: z.array(ResponseAction).optional(),
  alert_suppression: AlertSuppression.optional(),
});

export type QueryRuleDefaultableFields = z.infer<typeof QueryRuleDefaultableFields>;
export const QueryRuleDefaultableFields = z.object({
  /**
   * Query to execute
   */
  query: z.string().optional(),
  language: KqlQueryLanguage.optional(),
});

export type QueryRuleCreateFields = z.infer<typeof QueryRuleCreateFields>;
export const QueryRuleCreateFields = QueryRuleRequiredFields.and(QueryRuleOptionalFields).and(
  QueryRuleDefaultableFields
);

export type QueryRulePatchFields = z.infer<typeof QueryRulePatchFields>;
export const QueryRulePatchFields = QueryRuleRequiredFields.partial()
  .and(QueryRuleOptionalFields)
  .and(QueryRuleDefaultableFields);

export type QueryRuleResponseFields = z.infer<typeof QueryRuleResponseFields>;
export const QueryRuleResponseFields = QueryRuleRequiredFields.and(
  QueryRuleOptionalFields.transform(requireOptional)
).and(QueryRuleDefaultableFields.required());

export type QueryRule = z.infer<typeof QueryRule>;
export const QueryRule = SharedResponseProps.and(QueryRuleResponseFields);

export type QueryRuleCreateProps = z.infer<typeof QueryRuleCreateProps>;
export const QueryRuleCreateProps = SharedCreateProps.and(QueryRuleCreateFields);

export type QueryRuleUpdateProps = z.infer<typeof QueryRuleUpdateProps>;
export const QueryRuleUpdateProps = SharedUpdateProps.and(QueryRuleCreateFields);

export type QueryRulePatchProps = z.infer<typeof QueryRulePatchProps>;
export const QueryRulePatchProps = SharedPatchProps.and(QueryRulePatchFields);

export type SavedQueryRuleRequiredFields = z.infer<typeof SavedQueryRuleRequiredFields>;
export const SavedQueryRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('saved_query'),
  saved_id: z.string(),
});

export type SavedQueryRuleOptionalFields = z.infer<typeof SavedQueryRuleOptionalFields>;
export const SavedQueryRuleOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
  response_actions: z.array(ResponseAction).optional(),
  alert_suppression: AlertSuppression.optional(),
  /**
   * Query to execute
   */
  query: z.string().optional(),
});

export type SavedQueryRuleDefaultableFields = z.infer<typeof SavedQueryRuleDefaultableFields>;
export const SavedQueryRuleDefaultableFields = z.object({
  language: KqlQueryLanguage.optional(),
});

export type SavedQueryRuleCreateFields = z.infer<typeof SavedQueryRuleCreateFields>;
export const SavedQueryRuleCreateFields = SavedQueryRuleRequiredFields.and(
  SavedQueryRuleOptionalFields
).and(SavedQueryRuleDefaultableFields);

export type SavedQueryRulePatchFields = z.infer<typeof SavedQueryRulePatchFields>;
export const SavedQueryRulePatchFields = SavedQueryRuleRequiredFields.partial()
  .and(SavedQueryRuleOptionalFields)
  .and(SavedQueryRuleDefaultableFields);

export type SavedQueryRuleResponseFields = z.infer<typeof SavedQueryRuleResponseFields>;
export const SavedQueryRuleResponseFields = SavedQueryRuleRequiredFields.and(
  SavedQueryRuleOptionalFields.transform(requireOptional)
).and(SavedQueryRuleDefaultableFields.required());

export type SavedQueryRule = z.infer<typeof SavedQueryRule>;
export const SavedQueryRule = SharedResponseProps.and(SavedQueryRuleResponseFields);

export type SavedQueryRuleCreateProps = z.infer<typeof SavedQueryRuleCreateProps>;
export const SavedQueryRuleCreateProps = SharedCreateProps.and(SavedQueryRuleCreateFields);

export type SavedQueryRuleUpdateProps = z.infer<typeof SavedQueryRuleUpdateProps>;
export const SavedQueryRuleUpdateProps = SharedUpdateProps.and(SavedQueryRuleCreateFields);

export type SavedQueryRulePatchProps = z.infer<typeof SavedQueryRulePatchProps>;
export const SavedQueryRulePatchProps = SharedPatchProps.and(SavedQueryRulePatchFields);

export type ThresholdRuleRequiredFields = z.infer<typeof ThresholdRuleRequiredFields>;
export const ThresholdRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('threshold'),
  query: z.string(),
  threshold: Threshold,
});

export type ThresholdRuleOptionalFields = z.infer<typeof ThresholdRuleOptionalFields>;
export const ThresholdRuleOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
  saved_id: z.string().optional(),
});

export type ThresholdRuleDefaultableFields = z.infer<typeof ThresholdRuleDefaultableFields>;
export const ThresholdRuleDefaultableFields = z.object({
  language: KqlQueryLanguage.optional(),
});

export type ThresholdRuleCreateFields = z.infer<typeof ThresholdRuleCreateFields>;
export const ThresholdRuleCreateFields = ThresholdRuleRequiredFields.and(
  ThresholdRuleOptionalFields
).and(ThresholdRuleDefaultableFields);

export type ThresholdRulePatchFields = z.infer<typeof ThresholdRulePatchFields>;
export const ThresholdRulePatchFields = ThresholdRuleRequiredFields.partial()
  .and(ThresholdRuleOptionalFields)
  .and(ThresholdRuleDefaultableFields);

export type ThresholdRuleResponseFields = z.infer<typeof ThresholdRuleResponseFields>;
export const ThresholdRuleResponseFields = ThresholdRuleRequiredFields.and(
  ThresholdRuleOptionalFields.transform(requireOptional)
).and(ThresholdRuleDefaultableFields.required());

export type ThresholdRule = z.infer<typeof ThresholdRule>;
export const ThresholdRule = SharedResponseProps.and(ThresholdRuleResponseFields);

export type ThresholdRuleCreateProps = z.infer<typeof ThresholdRuleCreateProps>;
export const ThresholdRuleCreateProps = SharedCreateProps.and(ThresholdRuleCreateFields);

export type ThresholdRuleUpdateProps = z.infer<typeof ThresholdRuleUpdateProps>;
export const ThresholdRuleUpdateProps = SharedUpdateProps.and(ThresholdRuleCreateFields);

export type ThresholdRulePatchProps = z.infer<typeof ThresholdRulePatchProps>;
export const ThresholdRulePatchProps = SharedPatchProps.and(ThresholdRulePatchFields);

export type ThreatMatchRuleRequiredFields = z.infer<typeof ThreatMatchRuleRequiredFields>;
export const ThreatMatchRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('threat_match'),
  query: z.string(),
  /**
   * Query to execute
   */
  threat_query: z.string(),
  threat_mapping: z
    .array(
      z.object({
        entries: z.array(
          z.object({
            field: z.string().min(1),
            type: z.literal('mapping'),
            value: z.string().min(1),
          })
        ),
      })
    )
    .min(1),
  threat_index: z.array(z.string()),
});

export type ThreatMatchRuleOptionalFields = z.infer<typeof ThreatMatchRuleOptionalFields>;
export const ThreatMatchRuleOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
  saved_id: z.string().optional(),
  threat_filters: z.array(z.unknown()).optional(),
  /**
   * Defines the path to the threat indicator in the indicator documents (optional)
   */
  threat_indicator_path: z.string().optional(),
  threat_language: KqlQueryLanguage.optional(),
  concurrent_searches: z.number().int().min(1).optional(),
  items_per_search: z.number().int().min(1).optional(),
});

export type ThreatMatchRuleDefaultableFields = z.infer<typeof ThreatMatchRuleDefaultableFields>;
export const ThreatMatchRuleDefaultableFields = z.object({
  language: KqlQueryLanguage.optional(),
});

export type ThreatMatchRuleCreateFields = z.infer<typeof ThreatMatchRuleCreateFields>;
export const ThreatMatchRuleCreateFields = ThreatMatchRuleRequiredFields.and(
  ThreatMatchRuleOptionalFields
).and(ThreatMatchRuleDefaultableFields);

export type ThreatMatchRulePatchFields = z.infer<typeof ThreatMatchRulePatchFields>;
export const ThreatMatchRulePatchFields = ThreatMatchRuleRequiredFields.partial()
  .and(ThreatMatchRuleOptionalFields)
  .and(ThreatMatchRuleDefaultableFields);

export type ThreatMatchRuleResponseFields = z.infer<typeof ThreatMatchRuleResponseFields>;
export const ThreatMatchRuleResponseFields = ThreatMatchRuleRequiredFields.and(
  ThreatMatchRuleOptionalFields.transform(requireOptional)
).and(ThreatMatchRuleDefaultableFields.required());

export type ThreatMatchRule = z.infer<typeof ThreatMatchRule>;
export const ThreatMatchRule = SharedResponseProps.and(ThreatMatchRuleResponseFields);

export type ThreatMatchRuleCreateProps = z.infer<typeof ThreatMatchRuleCreateProps>;
export const ThreatMatchRuleCreateProps = SharedCreateProps.and(ThreatMatchRuleCreateFields);

export type ThreatMatchRuleUpdateProps = z.infer<typeof ThreatMatchRuleUpdateProps>;
export const ThreatMatchRuleUpdateProps = SharedUpdateProps.and(ThreatMatchRuleCreateFields);

export type ThreatMatchRulePatchProps = z.infer<typeof ThreatMatchRulePatchProps>;
export const ThreatMatchRulePatchProps = SharedPatchProps.and(ThreatMatchRulePatchFields);

export type MachineLearningRuleRequiredFields = z.infer<typeof MachineLearningRuleRequiredFields>;
export const MachineLearningRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('machine_learning'),
  /**
   * Anomaly threshold
   */
  anomaly_threshold: z.number().int().min(0),
  /**
   * Machine learning job ID
   */
  machine_learning_job_id: z.union([z.string(), z.array(z.string()).min(1)]),
});

export type MachineLearningRulePatchFields = z.infer<typeof MachineLearningRulePatchFields>;
export const MachineLearningRulePatchFields = MachineLearningRuleRequiredFields.partial();

export type MachineLearningRuleResponseFields = z.infer<typeof MachineLearningRuleResponseFields>;
export const MachineLearningRuleResponseFields = MachineLearningRuleRequiredFields;

export type MachineLearningRuleCreateFields = z.infer<typeof MachineLearningRuleCreateFields>;
export const MachineLearningRuleCreateFields = MachineLearningRuleRequiredFields;

export type MachineLearningRule = z.infer<typeof MachineLearningRule>;
export const MachineLearningRule = SharedResponseProps.and(MachineLearningRuleResponseFields);

export type MachineLearningRuleCreateProps = z.infer<typeof MachineLearningRuleCreateProps>;
export const MachineLearningRuleCreateProps = SharedCreateProps.and(
  MachineLearningRuleCreateFields
);

export type MachineLearningRuleUpdateProps = z.infer<typeof MachineLearningRuleUpdateProps>;
export const MachineLearningRuleUpdateProps = SharedUpdateProps.and(
  MachineLearningRuleCreateFields
);

export type MachineLearningRulePatchProps = z.infer<typeof MachineLearningRulePatchProps>;
export const MachineLearningRulePatchProps = SharedPatchProps.and(MachineLearningRulePatchFields);

export type NewTermsRuleRequiredFields = z.infer<typeof NewTermsRuleRequiredFields>;
export const NewTermsRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('new_terms'),
  query: z.string(),
  new_terms_fields: NewTermsFields,
  history_window_start: HistoryWindowStart,
});

export type NewTermsRuleOptionalFields = z.infer<typeof NewTermsRuleOptionalFields>;
export const NewTermsRuleOptionalFields = z.object({
  index: z.array(z.string()).optional(),
  data_view_id: z.string().optional(),
  filters: z.array(z.unknown()).optional(),
});

export type NewTermsRuleDefaultableFields = z.infer<typeof NewTermsRuleDefaultableFields>;
export const NewTermsRuleDefaultableFields = z.object({
  language: KqlQueryLanguage.optional(),
});

export type NewTermsRulePatchFields = z.infer<typeof NewTermsRulePatchFields>;
export const NewTermsRulePatchFields = NewTermsRuleRequiredFields.partial()
  .and(NewTermsRuleOptionalFields)
  .and(NewTermsRuleDefaultableFields);

export type NewTermsRuleResponseFields = z.infer<typeof NewTermsRuleResponseFields>;
export const NewTermsRuleResponseFields = NewTermsRuleRequiredFields.and(
  NewTermsRuleOptionalFields.transform(requireOptional)
).and(NewTermsRuleDefaultableFields.required());

export type NewTermsRuleCreateFields = z.infer<typeof NewTermsRuleCreateFields>;
export const NewTermsRuleCreateFields = NewTermsRuleRequiredFields.and(
  NewTermsRuleOptionalFields
).and(NewTermsRuleDefaultableFields);

export type NewTermsRule = z.infer<typeof NewTermsRule>;
export const NewTermsRule = SharedResponseProps.and(NewTermsRuleResponseFields);

export type NewTermsRuleCreateProps = z.infer<typeof NewTermsRuleCreateProps>;
export const NewTermsRuleCreateProps = SharedCreateProps.and(NewTermsRuleCreateFields);

export type NewTermsRuleUpdateProps = z.infer<typeof NewTermsRuleUpdateProps>;
export const NewTermsRuleUpdateProps = SharedUpdateProps.and(NewTermsRuleCreateFields);

export type NewTermsRulePatchProps = z.infer<typeof NewTermsRulePatchProps>;
export const NewTermsRulePatchProps = SharedPatchProps.and(NewTermsRulePatchFields);

export type EsqlQueryLanguage = z.infer<typeof EsqlQueryLanguage>;
export const EsqlQueryLanguage = z.literal('esql');

export type EsqlRuleRequiredFields = z.infer<typeof EsqlRuleRequiredFields>;
export const EsqlRuleRequiredFields = z.object({
  /**
   * Rule type
   */
  type: z.literal('esql'),
  language: EsqlQueryLanguage,
  /**
   * ESQL query to execute
   */
  query: z.string(),
});

export type EsqlRulePatchFields = z.infer<typeof EsqlRulePatchFields>;
export const EsqlRulePatchFields = EsqlRuleRequiredFields.partial();

export type EsqlRuleResponseFields = z.infer<typeof EsqlRuleResponseFields>;
export const EsqlRuleResponseFields = EsqlRuleRequiredFields;

export type EsqlRuleCreateFields = z.infer<typeof EsqlRuleCreateFields>;
export const EsqlRuleCreateFields = EsqlRuleRequiredFields;

export type EsqlRule = z.infer<typeof EsqlRule>;
export const EsqlRule = SharedResponseProps.and(EsqlRuleResponseFields);

export type EsqlRuleCreateProps = z.infer<typeof EsqlRuleCreateProps>;
export const EsqlRuleCreateProps = SharedCreateProps.and(EsqlRuleCreateFields);

export type EsqlRuleUpdateProps = z.infer<typeof EsqlRuleUpdateProps>;
export const EsqlRuleUpdateProps = SharedUpdateProps.and(EsqlRuleCreateFields);

export type EsqlRulePatchProps = z.infer<typeof EsqlRulePatchProps>;
export const EsqlRulePatchProps = SharedPatchProps.and(EsqlRulePatchFields.partial());

export type TypeSpecificCreateProps = z.infer<typeof TypeSpecificCreateProps>;
export const TypeSpecificCreateProps = z.union([
  EqlRuleCreateFields,
  QueryRuleCreateFields,
  SavedQueryRuleCreateFields,
  ThresholdRuleCreateFields,
  ThreatMatchRuleCreateFields,
  MachineLearningRuleCreateFields,
  NewTermsRuleCreateFields,
  EsqlRuleCreateFields,
]);

export type TypeSpecificPatchProps = z.infer<typeof TypeSpecificPatchProps>;
export const TypeSpecificPatchProps = z.union([
  EqlRulePatchFields,
  QueryRulePatchFields,
  SavedQueryRulePatchFields,
  ThresholdRulePatchFields,
  ThreatMatchRulePatchFields,
  MachineLearningRulePatchFields,
  NewTermsRulePatchFields,
  EsqlRulePatchFields,
]);

export type TypeSpecificResponse = z.infer<typeof TypeSpecificResponse>;
export const TypeSpecificResponse = z.union([
  EqlRuleResponseFields,
  QueryRuleResponseFields,
  SavedQueryRuleResponseFields,
  ThresholdRuleResponseFields,
  ThreatMatchRuleResponseFields,
  MachineLearningRuleResponseFields,
  NewTermsRuleResponseFields,
  EsqlRuleResponseFields,
]);

export type RuleCreateProps = z.infer<typeof RuleCreateProps>;
export const RuleCreateProps = z.union([
  EqlRuleCreateProps,
  QueryRuleCreateProps,
  SavedQueryRuleCreateProps,
  ThresholdRuleCreateProps,
  ThreatMatchRuleCreateProps,
  MachineLearningRuleCreateProps,
  NewTermsRuleCreateProps,
  EsqlRuleCreateProps,
]);

export type RuleUpdateProps = z.infer<typeof RuleUpdateProps>;
export const RuleUpdateProps = z.union([
  EqlRuleUpdateProps,
  QueryRuleUpdateProps,
  SavedQueryRuleUpdateProps,
  ThresholdRuleUpdateProps,
  ThreatMatchRuleUpdateProps,
  MachineLearningRuleUpdateProps,
  NewTermsRuleUpdateProps,
  EsqlRuleUpdateProps,
]);

export type RulePatchProps = z.infer<typeof RulePatchProps>;
export const RulePatchProps = z.union([
  EqlRulePatchProps,
  QueryRulePatchProps,
  SavedQueryRulePatchProps,
  ThresholdRulePatchProps,
  ThreatMatchRulePatchProps,
  MachineLearningRulePatchProps,
  NewTermsRulePatchProps,
  EsqlRulePatchProps,
]);

export type RuleResponse = z.infer<typeof RuleResponse>;
export const RuleResponse = z.union([
  EqlRule,
  QueryRule,
  SavedQueryRule,
  ThresholdRule,
  ThreatMatchRule,
  MachineLearningRule,
  NewTermsRule,
  EsqlRule,
]);
