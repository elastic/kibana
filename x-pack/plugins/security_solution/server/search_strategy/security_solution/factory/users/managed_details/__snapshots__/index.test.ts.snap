// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`userDetails search strategy parse should parse data correctly 1`] = `
Object {
  "inspect": Object {
    "dsl": Array [
      "{
  \\"allow_no_indices\\": true,
  \\"index\\": [
    \\"logs-*\\"
  ],
  \\"ignore_unavailable\\": true,
  \\"track_total_hits\\": false,
  \\"body\\": {
    \\"query\\": {
      \\"bool\\": {
        \\"filter\\": [
          {
            \\"term\\": {
              \\"user.name\\": \\"test-user-name\\"
            }
          },
          {
            \\"terms\\": {
              \\"event.dataset\\": [
                \\"entityanalytics_okta.user\\",
                \\"entityanalytics_entra_id.user\\"
              ]
            }
          },
          {
            \\"term\\": {
              \\"event.kind\\": \\"asset\\"
            }
          }
        ]
      }
    },
    \\"size\\": 0,
    \\"aggs\\": {
      \\"datasets\\": {
        \\"terms\\": {
          \\"field\\": \\"event.dataset\\"
        },
        \\"aggs\\": {
          \\"latest_hit\\": {
            \\"top_hits\\": {
              \\"size\\": 1,
              \\"sort\\": [
                {
                  \\"@timestamp\\": {
                    \\"order\\": \\"desc\\"
                  }
                }
              ]
            }
          }
        }
      }
    }
  },
  \\"sort\\": [
    {
      \\"@timestamp\\": \\"desc\\"
    }
  ]
}",
    ],
  },
  "isPartial": false,
  "isRunning": false,
  "loaded": 21,
  "rawResponse": Object {
    "_shards": Object {
      "failed": 0,
      "skipped": 0,
      "successful": 2,
      "total": 2,
    },
    "aggregations": Object {
      "datasets": Object {
        "buckets": Array [
          Object {
            "doc_count": 122,
            "key": "entityanalytics_okta.user",
            "latest_hit": Object {
              "hits": Object {
                "hits": Array [
                  Object {
                    "_id": "Bnwi8osBcjOsowlA78aM",
                    "_index": ".ds-logs-entityanalytics_okta.user-default-2023.11.15-000001",
                    "_score": null,
                    "_source": Object {
                      "@timestamp": "2023-11-21T13:47:27.551Z",
                      "agent": Object {
                        "ephemeral_id": "8c548786-ae4d-4bd3-acda-8cdc4f68bb21",
                        "id": "ced095f0-df97-4bdc-86a9-25cc11238317",
                        "name": "docker-fleet-agent",
                        "type": "filebeat",
                        "version": "8.12.0",
                      },
                      "asset": Object {
                        "category": "entity",
                        "create_date": "2023-11-14T16:33:53.000Z",
                        "id": "00ud9ohoh9ww644Px5d7",
                        "last_seen": "2023-11-21T08:08:46.000Z",
                        "last_status_change_date": "2023-11-15T07:09:05.000Z",
                        "last_updated": "2023-11-21T08:14:56.000Z",
                        "status": "ACTIVE",
                        "type": "okta_user",
                      },
                      "data_stream": Object {
                        "dataset": "entityanalytics_okta.user",
                        "namespace": "default",
                        "type": "logs",
                      },
                      "ecs": Object {
                        "version": "8.11.0",
                      },
                      "elastic_agent": Object {
                        "id": "ced095f0-df97-4bdc-86a9-25cc11238317",
                        "snapshot": true,
                        "version": "8.12.0",
                      },
                      "entityanalytics_okta": Object {
                        "user": Object {
                          "_links": Object {
                            "self": Object {
                              "href": "https://dev-36006609.okta.com/api/v1/users/00ud9ohoh9ww644Px5d7",
                            },
                          },
                          "type": Object {
                            "id": "otyf1r6hlGf9AXhZ95d6",
                          },
                        },
                      },
                      "event": Object {
                        "action": "user-modified",
                        "agent_id_status": "verified",
                        "category": Array [
                          "iam",
                        ],
                        "dataset": "entityanalytics_okta.user",
                        "ingested": "2023-11-21T13:47:37Z",
                        "kind": "asset",
                        "type": Array [
                          "user",
                          "info",
                        ],
                      },
                      "input": Object {
                        "type": "entity-analytics",
                      },
                      "labels": Object {
                        "identity_source": "entity-analytics-entityanalytics_okta.user-be940503-bec8-4849-8ec7-2b526d6f2609",
                      },
                      "related": Object {
                        "user": Array [
                          "00ud9ohoh9ww644Px5d7",
                          "test.user@elastic.co",
                          "Test",
                          "User",
                        ],
                      },
                      "tags": Array [
                        "forwarded",
                        "entityanalytics_okta-user",
                      ],
                      "user": Object {
                        "account": Object {
                          "activated_date": "2023-11-14T16:33:54.000Z",
                          "change_date": "2023-11-15T07:09:05.000Z",
                          "create_date": "2023-11-14T16:33:53.000Z",
                          "password_change_date": "2023-11-15T07:09:05.000Z",
                          "status": Object {
                            "deprovisioned": false,
                            "locked_out": false,
                            "password_expired": false,
                            "recovery": false,
                            "suspended": false,
                          },
                        },
                        "email": "test@elastic.co",
                        "geo": Object {
                          "city_name": "Adam",
                          "country_iso_code": "NL",
                        },
                        "id": "00ud9ohoh9ww644Px5d7",
                        "name": "test@elastic.co",
                        "profile": Object {
                          "first_name": "Test",
                          "job_title": "Intern",
                          "last_name": "User",
                          "mobile_phone": "0645130499",
                          "primaryPhone": "0645130498",
                          "status": "ACTIVE",
                        },
                      },
                    },
                    "sort": Array [
                      1700574447551,
                    ],
                  },
                ],
                "max_score": null,
                "total": Object {
                  "relation": "eq",
                  "value": 122,
                },
              },
            },
          },
        ],
        "doc_count_error_upper_bound": 0,
        "sum_other_doc_count": 0,
      },
    },
    "hits": Object {
      "hits": Array [],
      "max_score": null,
    },
    "timed_out": false,
    "took": 5,
  },
  "total": 21,
  "users": Object {
    "entityanalytics_okta.user": Object {
      "@timestamp": "2023-11-21T13:47:27.551Z",
      "agent": Object {
        "ephemeral_id": "8c548786-ae4d-4bd3-acda-8cdc4f68bb21",
        "id": "ced095f0-df97-4bdc-86a9-25cc11238317",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.12.0",
      },
      "asset": Object {
        "category": "entity",
        "create_date": "2023-11-14T16:33:53.000Z",
        "id": "00ud9ohoh9ww644Px5d7",
        "last_seen": "2023-11-21T08:08:46.000Z",
        "last_status_change_date": "2023-11-15T07:09:05.000Z",
        "last_updated": "2023-11-21T08:14:56.000Z",
        "status": "ACTIVE",
        "type": "okta_user",
      },
      "data_stream": Object {
        "dataset": "entityanalytics_okta.user",
        "namespace": "default",
        "type": "logs",
      },
      "ecs": Object {
        "version": "8.11.0",
      },
      "elastic_agent": Object {
        "id": "ced095f0-df97-4bdc-86a9-25cc11238317",
        "snapshot": true,
        "version": "8.12.0",
      },
      "entityanalytics_okta": Object {
        "user": Object {
          "_links": Object {
            "self": Object {
              "href": "https://dev-36006609.okta.com/api/v1/users/00ud9ohoh9ww644Px5d7",
            },
          },
          "type": Object {
            "id": "otyf1r6hlGf9AXhZ95d6",
          },
        },
      },
      "event": Object {
        "action": "user-modified",
        "agent_id_status": "verified",
        "category": Array [
          "iam",
        ],
        "dataset": "entityanalytics_okta.user",
        "ingested": "2023-11-21T13:47:37Z",
        "kind": "asset",
        "type": Array [
          "user",
          "info",
        ],
      },
      "input": Object {
        "type": "entity-analytics",
      },
      "labels": Object {
        "identity_source": "entity-analytics-entityanalytics_okta.user-be940503-bec8-4849-8ec7-2b526d6f2609",
      },
      "related": Object {
        "user": Array [
          "00ud9ohoh9ww644Px5d7",
          "test.user@elastic.co",
          "Test",
          "User",
        ],
      },
      "tags": Array [
        "forwarded",
        "entityanalytics_okta-user",
      ],
      "user": Object {
        "account": Object {
          "activated_date": "2023-11-14T16:33:54.000Z",
          "change_date": "2023-11-15T07:09:05.000Z",
          "create_date": "2023-11-14T16:33:53.000Z",
          "password_change_date": "2023-11-15T07:09:05.000Z",
          "status": Object {
            "deprovisioned": false,
            "locked_out": false,
            "password_expired": false,
            "recovery": false,
            "suspended": false,
          },
        },
        "email": "test@elastic.co",
        "geo": Object {
          "city_name": "Adam",
          "country_iso_code": "NL",
        },
        "id": "00ud9ohoh9ww644Px5d7",
        "name": "test@elastic.co",
        "profile": Object {
          "first_name": "Test",
          "job_title": "Intern",
          "last_name": "User",
          "mobile_phone": "0645130499",
          "primaryPhone": "0645130498",
          "status": "ACTIVE",
        },
      },
    },
  },
}
`;
