{
  "author": [
    "Elastic"
  ],
  "description": "Generates a detection alert each time an Elastic Endpoint Security alert is received. Enabling this rule allows you to immediately begin investigating your Endpoint alerts.",
  "enabled": true,
  "exceptions_list": [
    {
      "id": "endpoint_list",
      "list_id": "endpoint_list",
      "namespace_type": "agnostic",
      "type": "endpoint"
    }
  ],
  "from": "now-10m",
  "index": [
    "logs-endpoint.alerts-*"
  ],
  "language": "kuery",
  "license": "Elastic License v2",
  "max_signals": 10000,
  "name": "Endpoint Security",
  "query": "event.kind:alert and event.module:(endpoint and not endgame)\n",
  "setup": "## Config\n\nThe 'Audit Detailed File Share' audit policy must be configured (Success Failure).\nSteps to implement the logging policy with with Advanced Audit Configuration:\n\n```\nComputer Configuration > \nPolicies > \nWindows Settings > \nSecurity Settings > \nAdvanced Audit Policies Configuration > \nAudit Policies > \nObject Access > \nAudit Detailed File Share (Success,Failure)\n```\n\nThe 'Audit Directory Service Changes' audit policy must be configured (Success Failure).\nSteps to implement the logging policy with with Advanced Audit Configuration:\n\n```\nComputer Configuration > \nPolicies > \nWindows Settings > \nSecurity Settings > \nAdvanced Audit Policies Configuration > \nAudit Policies > \nDS Access > \nAudit Directory Service Changes (Success,Failure)\n```\n",
  "required_fields": [
    {
      "name": "event.code",
      "type": "keyword",
      "ecs": true
    },
    {
      "name": "message",
      "type": "match_only_text",
      "ecs": true
    },
    {
      "name": "winlog.event_data.AttributeLDAPDisplayName",
      "type": "keyword",
      "ecs": false
    },
    {
      "name": "winlog.event_data.AttributeValue",
      "type": "keyword",
      "ecs": false
    },
    {
      "name": "winlog.event_data.ShareName",
      "type": "keyword",
      "ecs": false
    },
    {
      "name": "winlog.event_data.RelativeTargetName",
      "type": "keyword",
      "ecs": false
    },
    {
      "name": "winlog.event_data.AccessList",
      "type": "keyword",
      "ecs": false
    }
  ],
  "related_integrations": [
    {
      "package": "system",
      "version": "1.6.4"
    },
    {
      "package": "aws",
      "integration": "cloudtrail",
      "version": "1.11.0"
    }
  ],
  "risk_score": 47,
  "risk_score_mapping": [
    {
      "field": "event.risk_score",
      "operator": "equals",
      "value": ""
    }
  ],
  "rule_id": "9a1a2dae-0b5f-4c3d-8305-a268d404c306",
  "rule_name_override": "message",
  "severity": "medium",
  "severity_mapping": [
    {
      "field": "event.severity",
      "operator": "equals",
      "severity": "low",
      "value": "21"
    },
    {
      "field": "event.severity",
      "operator": "equals",
      "severity": "medium",
      "value": "47"
    },
    {
      "field": "event.severity",
      "operator": "equals",
      "severity": "high",
      "value": "73"
    },
    {
      "field": "event.severity",
      "operator": "equals",
      "severity": "critical",
      "value": "99"
    }
  ],
  "tags": [
    "Elastic",
    "Endpoint Security"
  ],
  "timestamp_override": "event.ingested",
  "type": "query",
  "version": 3
}
