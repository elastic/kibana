// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`createPrebuiltSavedObjects should create saved objects from given template - "hostRiskScoreDashboards" 1`] = `
Array [
  Object {
    "attributes": Object {
      "fieldAttrs": "{}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": "ml_host_risk_score_default",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-1",
    "migrationVersion": Object {
      "index-pattern": "7.11.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2021-08-18T18:37:41.486Z",
  },
  Object {
    "attributes": Object {
      "description": null,
      "state": Object {
        "datasourceStates": Object {
          "indexpattern": Object {
            "layers": Object {
              "b885eaad-3c68-49ad-9891-70158d912dbd": Object {
                "columnOrder": Array [
                  "8dcda7ec-1a1a-43b3-b0b8-e702943eed5c",
                  "e82aed80-ee04-4ad1-9b9d-fde4a25be58a",
                  "aa4ad9b2-8829-4517-aaa8-7ed7e5793e9b",
                ],
                "columns": Object {
                  "8dcda7ec-1a1a-43b3-b0b8-e702943eed5c": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "isBucketed": true,
                    "label": "Host Name",
                    "operationType": "terms",
                    "params": Object {
                      "missingBucket": false,
                      "orderBy": Object {
                        "columnId": "aa4ad9b2-8829-4517-aaa8-7ed7e5793e9b",
                        "type": "column",
                      },
                      "orderDirection": "desc",
                      "otherBucket": true,
                      "size": 20,
                    },
                    "scale": "ordinal",
                    "sourceField": "host.name",
                  },
                  "aa4ad9b2-8829-4517-aaa8-7ed7e5793e9b": Object {
                    "customLabel": true,
                    "dataType": "number",
                    "isBucketed": false,
                    "label": "Cumulative Risk Score",
                    "operationType": "max",
                    "scale": "ratio",
                    "sourceField": "host.risk.calculated_score_norm",
                  },
                  "e82aed80-ee04-4ad1-9b9d-fde4a25be58a": Object {
                    "dataType": "date",
                    "isBucketed": true,
                    "label": "@timestamp",
                    "operationType": "date_histogram",
                    "params": Object {
                      "interval": "1h",
                    },
                    "scale": "interval",
                    "sourceField": "@timestamp",
                  },
                },
                "incompleteColumns": Object {},
              },
            },
          },
        },
        "filters": Array [],
        "query": Object {
          "language": "kuery",
          "query": "",
        },
        "visualization": Object {
          "layers": Array [
            Object {
              "accessors": Array [
                "aa4ad9b2-8829-4517-aaa8-7ed7e5793e9b",
              ],
              "layerId": "b885eaad-3c68-49ad-9891-70158d912dbd",
              "palette": Object {
                "name": "default",
                "type": "palette",
              },
              "position": "top",
              "seriesType": "bar_stacked",
              "showGridlines": false,
              "splitAccessor": "8dcda7ec-1a1a-43b3-b0b8-e702943eed5c",
              "xAccessor": "e82aed80-ee04-4ad1-9b9d-fde4a25be58a",
            },
          ],
          "legend": Object {
            "isVisible": true,
            "position": "right",
          },
          "preferredSeriesType": "bar_stacked",
          "title": "Empty XY chart",
          "valueLabels": "hide",
        },
      },
      "title": "Host Risk Score (Max Risk Score Histogram)",
      "visualizationType": "lnsXY",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-2",
    "migrationVersion": Object {
      "lens": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-1",
        "name": "indexpattern-datasource-current-indexpattern",
        "type": "index-pattern",
      },
      Object {
        "id": "id-1",
        "name": "indexpattern-datasource-layer-b885eaad-3c68-49ad-9891-70158d912dbd",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "lens",
    "updated_at": "2021-08-18T18:48:30.689Z",
  },
  Object {
    "attributes": Object {
      "fieldAttrs": "{\\"signal.rule.type\\":{\\"count\\":1}}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": ".alerts-security.alerts-default",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-3",
    "migrationVersion": Object {
      "index-pattern": "7.11.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2021-08-18T16:27:39.980Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "Host Risk Score (Rule Breakdown)",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"Host Risk Score (Rule Breakdown)\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"2\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\"},\\"schema\\":\\"metric\\"},{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\"},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"host.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Host\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"4\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Name\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.type\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Type\\"},\\"schema\\":\\"bucket\\"}],\\"params\\":{\\"perPage\\":10,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true}}",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-4",
    "migrationVersion": Object {
      "visualization": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-3",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2021-08-18T16:27:39.980Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"not user.name: *$\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "Associated Users (Rule Breakdown)",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"Associated Users (Rule Breakdown)\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"2\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\"},\\"schema\\":\\"metric\\"},{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\"},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"user.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"User\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"4\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Name\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.type\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Type\\"},\\"schema\\":\\"bucket\\"}],\\"params\\":{\\"perPage\\":10,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true}}",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-5",
    "migrationVersion": Object {
      "visualization": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-3",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2021-08-18T16:27:39.980Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "Host Risk Score (Tactic Breakdown)- Verbose",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"Host Risk Score (Tactic Breakdown)- Verbose\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\"},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"host.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Host\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.threat.tactic.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":50,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":true,\\"missingBucketLabel\\":\\"Other\\",\\"customLabel\\":\\"Tactic\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"6\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.threat.technique.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":50,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":true,\\"missingBucketLabel\\":\\"Other\\",\\"customLabel\\":\\"Technique\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"7\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\"},\\"schema\\":\\"metric\\"}],\\"params\\":{\\"perPage\\":10,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true}}",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-6",
    "migrationVersion": Object {
      "visualization": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-3",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2021-08-18T16:27:39.980Z",
  },
  Object {
    "attributes": Object {
      "color": "#D36086",
      "description": "",
      "name": "experimental",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-7",
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "tag",
    "updated_at": "2021-08-18T16:27:39.980Z",
  },
  Object {
    "attributes": Object {
      "description": "This dashboard allows users to drill down further into the details of the risk components associated with a particular host.",
      "hits": 0,
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"language\\":\\"kuery\\",\\"query\\":\\"\\"},\\"filter\\":[]}",
      },
      "optionsJSON": "{\\"hidePanelTitles\\":false,\\"useMargins\\":true}",
      "panelsJSON": "[{\\"version\\":\\"7.13.4\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":0,\\"w\\":48,\\"h\\":3,\\"i\\":\\"eaa57cf4-7ca3-4919-ab76-dbac0eb6a195\\"},\\"panelIndex\\":\\"eaa57cf4-7ca3-4919-ab76-dbac0eb6a195\\",\\"embeddableConfig\\":{\\"savedVis\\":{\\"title\\":\\"\\",\\"description\\":\\"\\",\\"type\\":\\"markdown\\",\\"params\\":{\\"fontSize\\":12,\\"openLinksInNewTab\\":false,\\"markdown\\":\\"The Host Risk Score capability is an experimental feature released in 7.14. You can read further about it [here](https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/host-risk-score.md).\\"},\\"uiState\\":{},\\"data\\":{\\"aggs\\":[],\\"searchSource\\":{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}}},\\"hidePanelTitles\\":true,\\"enhancements\\":{}}},{\\"version\\":\\"7.13.4\\",\\"type\\":\\"lens\\",\\"gridData\\":{\\"x\\":0,\\"y\\":3,\\"w\\":48,\\"h\\":15,\\"i\\":\\"e11ed08e-70d0-4c69-991a-12e20dc89440\\"},\\"panelIndex\\":\\"e11ed08e-70d0-4c69-991a-12e20dc89440\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"339da811-5c23-4432-9649-53cb066e6aaf\\",\\"triggers\\":[\\"VALUE_CLICK_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"URL_DRILLDOWN\\",\\"name\\":\\"Go to Host View\\",\\"config\\":{\\"url\\":{\\"template\\":\\"{{kibanaUrl}}/app/security/hosts/{{context.panel.filters.[0].meta.params.query}}\\"},\\"openInNewTab\\":true,\\"encodeUrl\\":true}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Cumulative Host Risk Score (multiple hosts)\\",\\"panelRefName\\":\\"panel_e11ed08e-70d0-4c69-991a-12e20dc89440\\"},{\\"version\\":\\"7.13.4\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":18,\\"w\\":24,\\"h\\":28,\\"i\\":\\"cae82aa1-20c8-4354-94ab-3934ac53b8fe\\"},\\"panelIndex\\":\\"cae82aa1-20c8-4354-94ab-3934ac53b8fe\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"0fd43778-bd5d-4b2b-85c3-47ac3b756434\\",\\"triggers\\":[\\"VALUE_CLICK_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"URL_DRILLDOWN\\",\\"name\\":\\"Go to Host View\\",\\"config\\":{\\"url\\":{\\"template\\":\\"{{kibanaUrl}}/app/security/hosts/{{context.panel.filters.[0].meta.params.query}}\\"},\\"openInNewTab\\":true,\\"encodeUrl\\":true}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Associated Rules of Risky Hosts\\",\\"panelRefName\\":\\"panel_cae82aa1-20c8-4354-94ab-3934ac53b8fe\\"},{\\"version\\":\\"7.13.4\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":24,\\"y\\":18,\\"w\\":24,\\"h\\":28,\\"i\\":\\"8d09b97c-a023-4b7e-9e9d-1c46e726a487\\"},\\"panelIndex\\":\\"8d09b97c-a023-4b7e-9e9d-1c46e726a487\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"593ff0e6-25da-47ad-b81d-9a0106c0e9aa\\",\\"triggers\\":[\\"VALUE_CLICK_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"URL_DRILLDOWN\\",\\"name\\":\\"Go to Host View\\",\\"config\\":{\\"url\\":{\\"template\\":\\"{{kibanaUrl}}/app/security/hosts/{{context.panel.filters.[0].meta.params.query}}\\"},\\"openInNewTab\\":true,\\"encodeUrl\\":true}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Associated Users of Risky Hosts\\",\\"panelRefName\\":\\"panel_8d09b97c-a023-4b7e-9e9d-1c46e726a487\\"},{\\"version\\":\\"7.13.4\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":46,\\"w\\":48,\\"h\\":16,\\"i\\":\\"0c9c8318-ebb0-47fb-919a-1836ebf232ae\\"},\\"panelIndex\\":\\"0c9c8318-ebb0-47fb-919a-1836ebf232ae\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"a76ea63c-da92-4bad-b3d6-6df823e1c04b\\",\\"triggers\\":[\\"VALUE_CLICK_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"URL_DRILLDOWN\\",\\"name\\":\\"Go to Host View\\",\\"config\\":{\\"url\\":{\\"template\\":\\"{{kibanaUrl}}/app/security/hosts/{{context.panel.filters.[0].meta.params.query}}\\"},\\"openInNewTab\\":true,\\"encodeUrl\\":true}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Tactic Breakdown of Risky Hosts (Verbose)\\",\\"panelRefName\\":\\"panel_0c9c8318-ebb0-47fb-919a-1836ebf232ae\\"}]",
      "timeRestore": false,
      "title": "Drilldown of Host Risk Score",
      "version": 1,
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-8",
    "migrationVersion": Object {
      "dashboard": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-2",
        "name": "e11ed08e-70d0-4c69-991a-12e20dc89440:panel_e11ed08e-70d0-4c69-991a-12e20dc89440",
        "type": "lens",
      },
      Object {
        "id": "id-4",
        "name": "cae82aa1-20c8-4354-94ab-3934ac53b8fe:panel_cae82aa1-20c8-4354-94ab-3934ac53b8fe",
        "type": "visualization",
      },
      Object {
        "id": "id-5",
        "name": "8d09b97c-a023-4b7e-9e9d-1c46e726a487:panel_8d09b97c-a023-4b7e-9e9d-1c46e726a487",
        "type": "visualization",
      },
      Object {
        "id": "id-6",
        "name": "0c9c8318-ebb0-47fb-919a-1836ebf232ae:panel_0c9c8318-ebb0-47fb-919a-1836ebf232ae",
        "type": "visualization",
      },
      Object {
        "id": "id-7",
        "name": "tag-1d00ebe0-f3b2-11eb-beb2-b91666445a94",
        "type": "tag",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "dashboard",
    "updated_at": "2021-08-18T17:09:15.576Z",
  },
  Object {
    "attributes": Object {
      "fieldAttrs": "{}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": "ml_host_risk_score_latest_default",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-9",
    "migrationVersion": Object {
      "index-pattern": "7.11.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2021-08-18T18:47:22.500Z",
  },
  Object {
    "attributes": Object {
      "description": null,
      "state": Object {
        "datasourceStates": Object {
          "indexpattern": Object {
            "layers": Object {
              "2f34d626-d0ee-4ade-9e75-13c480699485": Object {
                "columnOrder": Array [
                  "9c8c581f-6cb8-4ecf-8eb3-4c6df33edc5d",
                  "c547501b-fe04-4073-8b4e-dbbdc3a4ff04",
                  "e2444d64-721a-4532-9633-5b206eee76d6",
                ],
                "columns": Object {
                  "9c8c581f-6cb8-4ecf-8eb3-4c6df33edc5d": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "isBucketed": true,
                    "label": "Host Name",
                    "operationType": "terms",
                    "params": Object {
                      "missingBucket": false,
                      "orderBy": Object {
                        "columnId": "c547501b-fe04-4073-8b4e-dbbdc3a4ff04",
                        "type": "column",
                      },
                      "orderDirection": "desc",
                      "otherBucket": true,
                      "size": 20,
                    },
                    "scale": "ordinal",
                    "sourceField": "host.name",
                  },
                  "c547501b-fe04-4073-8b4e-dbbdc3a4ff04": Object {
                    "customLabel": true,
                    "dataType": "number",
                    "isBucketed": false,
                    "label": "Risk Score",
                    "operationType": "sum",
                    "scale": "ratio",
                    "sourceField": "host.risk.calculated_score_norm",
                  },
                  "e2444d64-721a-4532-9633-5b206eee76d6": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "isBucketed": false,
                    "label": "Current Risk",
                    "operationType": "last_value",
                    "params": Object {
                      "sortField": "@timestamp",
                    },
                    "scale": "ordinal",
                    "sourceField": "host.risk.calculated_level",
                  },
                },
                "incompleteColumns": Object {},
              },
            },
          },
        },
        "filters": Array [],
        "query": Object {
          "language": "kuery",
          "query": "",
        },
        "visualization": Object {
          "columns": Array [
            Object {
              "columnId": "9c8c581f-6cb8-4ecf-8eb3-4c6df33edc5d",
              "isTransposed": false,
            },
            Object {
              "alignment": "left",
              "columnId": "c547501b-fe04-4073-8b4e-dbbdc3a4ff04",
              "hidden": true,
              "isTransposed": false,
            },
            Object {
              "columnId": "e2444d64-721a-4532-9633-5b206eee76d6",
              "isTransposed": false,
            },
          ],
          "layerId": "2f34d626-d0ee-4ade-9e75-13c480699485",
        },
      },
      "title": "Current Risk Score for Hosts",
      "visualizationType": "lnsDatatable",
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-10",
    "migrationVersion": Object {
      "lens": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-9",
        "name": "indexpattern-datasource-current-indexpattern",
        "type": "index-pattern",
      },
      Object {
        "id": "id-9",
        "name": "indexpattern-datasource-layer-2f34d626-d0ee-4ade-9e75-13c480699485",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "lens",
    "updated_at": "2021-08-18T17:07:41.806Z",
  },
  Object {
    "attributes": Object {
      "description": "This dashboard shows the most current list of risky hosts (Top 20) in an environment. ",
      "hits": 0,
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"language\\":\\"kuery\\",\\"query\\":\\"\\"},\\"filter\\":[]}",
      },
      "optionsJSON": "{\\"hidePanelTitles\\":false,\\"useMargins\\":true}",
      "panelsJSON": "[{\\"version\\":\\"7.13.4\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":0,\\"w\\":48,\\"h\\":3,\\"i\\":\\"287b65e9-0aaa-42ee-ab7b-d60b3937d37a\\"},\\"panelIndex\\":\\"287b65e9-0aaa-42ee-ab7b-d60b3937d37a\\",\\"embeddableConfig\\":{\\"savedVis\\":{\\"title\\":\\"\\",\\"description\\":\\"\\",\\"type\\":\\"markdown\\",\\"params\\":{\\"fontSize\\":12,\\"openLinksInNewTab\\":false,\\"markdown\\":\\"The Host Risk Score capability is an experimental feature released in 7.14. You can read further about it [here](https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/host-risk-score.md).\\"},\\"uiState\\":{},\\"data\\":{\\"aggs\\":[],\\"searchSource\\":{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}}},\\"hidePanelTitles\\":true,\\"enhancements\\":{}},\\"title\\":\\"Note:\\"},{\\"version\\":\\"7.13.4\\",\\"type\\":\\"lens\\",\\"gridData\\":{\\"x\\":16,\\"y\\":3,\\"w\\":16,\\"h\\":15,\\"i\\":\\"654d55f8-f873-4348-96cd-5dce0b56ac32\\"},\\"panelIndex\\":\\"654d55f8-f873-4348-96cd-5dce0b56ac32\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"b04e60d5-4e34-4589-af2e-8e9c3a15936f\\",\\"triggers\\":[\\"FILTER_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"DASHBOARD_TO_DASHBOARD_DRILLDOWN\\",\\"name\\":\\"Go to Dashboard\\",\\"config\\":{\\"useCurrentFilters\\":true,\\"useCurrentDateRange\\":true}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Current Risk Scores for Hosts\\",\\"panelRefName\\":\\"panel_654d55f8-f873-4348-96cd-5dce0b56ac32\\"}]",
      "timeRestore": false,
      "title": "Current Risk Score for Hosts",
      "version": 1,
    },
    "coreMigrationVersion": "7.13.4",
    "id": "id-11",
    "migrationVersion": Object {
      "dashboard": "7.13.1",
    },
    "references": Array [
      Object {
        "id": "id-10",
        "name": "654d55f8-f873-4348-96cd-5dce0b56ac32:panel_654d55f8-f873-4348-96cd-5dce0b56ac32",
        "type": "lens",
      },
      Object {
        "id": "id-8",
        "name": "654d55f8-f873-4348-96cd-5dce0b56ac32:drilldown:DASHBOARD_TO_DASHBOARD_DRILLDOWN:b04e60d5-4e34-4589-af2e-8e9c3a15936f:dashboardId",
        "type": "dashboard",
      },
      Object {
        "id": "id-7",
        "name": "tag-1d00ebe0-f3b2-11eb-beb2-b91666445a94",
        "type": "tag",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "dashboard",
    "updated_at": "2021-08-18T17:08:00.467Z",
  },
]
`;

exports[`createPrebuiltSavedObjects should create saved objects from given template - "userRiskScoreDashboards" 1`] = `
Array [
  Object {
    "attributes": Object {
      "fieldAttrs": "{}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": "ml_user_risk_score_latest_default",
      "typeMeta": "{}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID9>",
    "migrationVersion": Object {
      "index-pattern": "8.0.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "state": Object {
        "datasourceStates": Object {
          "indexpattern": Object {
            "layers": Object {
              "b4c8cd6f-2499-4791-a0f7-01b0d3f75efc": Object {
                "columnOrder": Array [
                  "ba672ee7-0990-4277-9bc7-6361077efe18",
                  "6b6df37f-ad45-462c-aa2f-2d19af98ed98",
                  "daefb732-9f48-4017-a49a-979cfdeef127",
                ],
                "columns": Object {
                  "6b6df37f-ad45-462c-aa2f-2d19af98ed98": Object {
                    "customLabel": true,
                    "dataType": "number",
                    "isBucketed": false,
                    "label": "Risk Score",
                    "operationType": "sum",
                    "params": Object {
                      "emptyAsNull": true,
                    },
                    "scale": "ratio",
                    "sourceField": "user.risk.calculated_score_norm",
                  },
                  "ba672ee7-0990-4277-9bc7-6361077efe18": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "isBucketed": true,
                    "label": "User Name",
                    "operationType": "terms",
                    "params": Object {
                      "missingBucket": false,
                      "orderBy": Object {
                        "columnId": "6b6df37f-ad45-462c-aa2f-2d19af98ed98",
                        "type": "column",
                      },
                      "orderDirection": "desc",
                      "otherBucket": true,
                      "parentFormat": Object {
                        "id": "terms",
                      },
                      "size": 30,
                    },
                    "scale": "ordinal",
                    "sourceField": "user.name",
                  },
                  "daefb732-9f48-4017-a49a-979cfdeef127": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "filter": Object {
                      "language": "kuery",
                      "query": "",
                    },
                    "isBucketed": false,
                    "label": "Current Risk",
                    "operationType": "last_value",
                    "params": Object {
                      "sortField": "@timestamp",
                    },
                    "scale": "ordinal",
                    "sourceField": "user.risk.calculated_level",
                  },
                },
                "incompleteColumns": Object {},
              },
            },
          },
        },
        "filters": Array [],
        "query": Object {
          "language": "kuery",
          "query": "",
        },
        "visualization": Object {
          "columns": Array [
            Object {
              "columnId": "ba672ee7-0990-4277-9bc7-6361077efe18",
              "isTransposed": false,
            },
            Object {
              "columnId": "6b6df37f-ad45-462c-aa2f-2d19af98ed98",
              "hidden": true,
              "isTransposed": false,
            },
            Object {
              "columnId": "daefb732-9f48-4017-a49a-979cfdeef127",
              "isTransposed": false,
            },
          ],
          "layerId": "b4c8cd6f-2499-4791-a0f7-01b0d3f75efc",
          "layerType": "data",
        },
      },
      "title": "Current Risk Score for Users",
      "visualizationType": "lnsDatatable",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID1>",
    "migrationVersion": Object {
      "lens": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID9>",
        "name": "indexpattern-datasource-layer-b4c8cd6f-2499-4791-a0f7-01b0d3f75efc",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "lens",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "fieldAttrs": "{}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": "ml_user_risk_score_default",
      "typeMeta": "{}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID10>",
    "migrationVersion": Object {
      "index-pattern": "8.0.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "state": Object {
        "datasourceStates": Object {
          "indexpattern": Object {
            "layers": Object {
              "b885eaad-3c68-49ad-9891-70158d912dbd": Object {
                "columnOrder": Array [
                  "1fced52d-7ba5-4254-8656-fe0d7ced586a",
                  "e82aed80-ee04-4ad1-9b9d-fde4a25be58a",
                  "3fadebce-2f31-4eed-9fc0-237249281a1a",
                ],
                "columns": Object {
                  "1fced52d-7ba5-4254-8656-fe0d7ced586a": Object {
                    "customLabel": true,
                    "dataType": "string",
                    "isBucketed": true,
                    "label": "User Name",
                    "operationType": "terms",
                    "params": Object {
                      "missingBucket": false,
                      "orderBy": Object {
                        "columnId": "3fadebce-2f31-4eed-9fc0-237249281a1a",
                        "type": "column",
                      },
                      "orderDirection": "desc",
                      "otherBucket": false,
                      "parentFormat": Object {
                        "id": "terms",
                      },
                      "size": 20,
                    },
                    "scale": "ordinal",
                    "sourceField": "user.name",
                  },
                  "3fadebce-2f31-4eed-9fc0-237249281a1a": Object {
                    "customLabel": true,
                    "dataType": "number",
                    "isBucketed": false,
                    "label": "Cumulative Risk Score",
                    "operationType": "max",
                    "params": Object {
                      "emptyAsNull": true,
                    },
                    "scale": "ratio",
                    "sourceField": "user.risk.calculated_score_norm",
                  },
                  "e82aed80-ee04-4ad1-9b9d-fde4a25be58a": Object {
                    "dataType": "date",
                    "isBucketed": true,
                    "label": "@timestamp",
                    "operationType": "date_histogram",
                    "params": Object {
                      "includeEmptyRows": true,
                      "interval": "1d",
                    },
                    "scale": "interval",
                    "sourceField": "@timestamp",
                  },
                },
                "incompleteColumns": Object {},
              },
            },
          },
        },
        "filters": Array [],
        "query": Object {
          "language": "kuery",
          "query": "not user.name: SYSTEM",
        },
        "visualization": Object {
          "layers": Array [
            Object {
              "accessors": Array [
                "3fadebce-2f31-4eed-9fc0-237249281a1a",
              ],
              "layerId": "b885eaad-3c68-49ad-9891-70158d912dbd",
              "layerType": "data",
              "position": "top",
              "seriesType": "bar_stacked",
              "showGridlines": false,
              "splitAccessor": "1fced52d-7ba5-4254-8656-fe0d7ced586a",
              "xAccessor": "e82aed80-ee04-4ad1-9b9d-fde4a25be58a",
            },
          ],
          "legend": Object {
            "isVisible": true,
            "legendSize": "auto",
            "position": "right",
          },
          "preferredSeriesType": "bar_stacked",
          "title": "Empty XY chart",
          "valueLabels": "hide",
          "yLeftExtent": Object {
            "mode": "full",
          },
          "yRightExtent": Object {
            "mode": "full",
          },
        },
      },
      "title": "User Risk Score (Max Risk Score Histogram)",
      "visualizationType": "lnsXY",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID2>",
    "migrationVersion": Object {
      "lens": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID10>",
        "name": "indexpattern-datasource-layer-b885eaad-3c68-49ad-9891-70158d912dbd",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "lens",
    "updated_at": "2022-08-12T16:31:30.450Z",
  },
  Object {
    "attributes": Object {
      "fieldAttrs": "{}",
      "fields": "[]",
      "runtimeFieldMap": "{}",
      "timeFieldName": "@timestamp",
      "title": ".alerts-security.alerts-default",
      "typeMeta": "{}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID11>",
    "migrationVersion": Object {
      "index-pattern": "8.0.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "index-pattern",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"user.name: root\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "Associated Users (Rule Breakdown)",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"Associated Users (Rule Breakdown)\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"2\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"},{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"user.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"User\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"4\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":50,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Name\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.type\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":50,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Type\\"},\\"schema\\":\\"bucket\\"}],\\"params\\":{\\"perPage\\":25,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true,\\"autoFitRowToContent\\":true}}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID3>",
    "migrationVersion": Object {
      "visualization": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID11>",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "Alerts by Hostname",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"Alerts by Hostname\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"2\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"},{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"host.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Host\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"4\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.name\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Name\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.type\\",\\"orderBy\\":\\"2\\",\\"order\\":\\"desc\\",\\"size\\":20,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Rule Type\\"},\\"schema\\":\\"bucket\\"}],\\"params\\":{\\"perPage\\":10,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true,\\"autoFitRowToContent\\":false}}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID4>",
    "migrationVersion": Object {
      "visualization": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID11>",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"not user.name : *$\\",\\"language\\":\\"kuery\\"},\\"filter\\":[],\\"indexRefName\\":\\"kibanaSavedObjectMeta.searchSourceJSON.index\\"}",
      },
      "title": "User Risk Score (Tactic Breakdown)- Verbose",
      "uiStateJSON": "{}",
      "version": 1,
      "visState": "{\\"title\\":\\"User Risk Score (Tactic Breakdown)- Verbose\\",\\"type\\":\\"table\\",\\"aggs\\":[{\\"id\\":\\"1\\",\\"enabled\\":true,\\"type\\":\\"sum\\",\\"params\\":{\\"field\\":\\"signal.rule.risk_score\\",\\"customLabel\\":\\"Total Risk Score\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"},{\\"id\\":\\"3\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"user.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":40,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":false,\\"missingBucketLabel\\":\\"Missing\\",\\"customLabel\\":\\"Username\\"},\\"schema\\":\\"split\\"},{\\"id\\":\\"5\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.threat.tactic.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":100,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":true,\\"missingBucketLabel\\":\\"Other\\",\\"customLabel\\":\\"Tactic\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"6\\",\\"enabled\\":true,\\"type\\":\\"terms\\",\\"params\\":{\\"field\\":\\"signal.rule.threat.technique.name\\",\\"orderBy\\":\\"1\\",\\"order\\":\\"desc\\",\\"size\\":100,\\"otherBucket\\":false,\\"otherBucketLabel\\":\\"Other\\",\\"missingBucket\\":true,\\"missingBucketLabel\\":\\"Other\\",\\"customLabel\\":\\"Technique\\"},\\"schema\\":\\"bucket\\"},{\\"id\\":\\"7\\",\\"enabled\\":true,\\"type\\":\\"count\\",\\"params\\":{\\"customLabel\\":\\"Number of Hits\\",\\"emptyAsNull\\":false},\\"schema\\":\\"metric\\"}],\\"params\\":{\\"perPage\\":10,\\"showPartialRows\\":false,\\"showMetricsAtAllLevels\\":false,\\"showTotal\\":false,\\"showToolbar\\":false,\\"totalFunc\\":\\"sum\\",\\"percentageCol\\":\\"\\",\\"row\\":true,\\"autoFitRowToContent\\":false}}",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID5>",
    "migrationVersion": Object {
      "visualization": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID11>",
        "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
        "type": "index-pattern",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "visualization",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "color": "#6edb7f",
      "description": "",
      "name": "experimental",
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID6>",
    "migrationVersion": Object {
      "tag": "8.0.0",
    },
    "references": Array [
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "tag",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "This dashboard allows users to drill down further into the details of the risk components associated with a particular user.",
      "hits": 0,
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}",
      },
      "optionsJSON": "{\\"hidePanelTitles\\":false,\\"useMargins\\":true}",
      "panelsJSON": "[{\\"version\\":\\"8.3.0\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":0,\\"w\\":48,\\"h\\":3,\\"i\\":\\"eaa57cf4-7ca3-4919-ab76-dbac0eb6a195\\"},\\"panelIndex\\":\\"eaa57cf4-7ca3-4919-ab76-dbac0eb6a195\\",\\"embeddableConfig\\":{\\"savedVis\\":{\\"title\\":\\"\\",\\"description\\":\\"\\",\\"type\\":\\"markdown\\",\\"params\\":{\\"fontSize\\":12,\\"openLinksInNewTab\\":false,\\"markdown\\":\\"The User Risk Score capability is an experimental feature. You can read further about it [here](https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/user-risk-score.md).\\"},\\"uiState\\":{},\\"data\\":{\\"aggs\\":[],\\"searchSource\\":{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}}},\\"hidePanelTitles\\":true,\\"enhancements\\":{}}},{\\"version\\":\\"8.3.0\\",\\"type\\":\\"lens\\",\\"gridData\\":{\\"x\\":0,\\"y\\":3,\\"w\\":48,\\"h\\":15,\\"i\\":\\"b3fdccab-59c1-47c8-9393-fa043e0dff83\\"},\\"panelIndex\\":\\"b3fdccab-59c1-47c8-9393-fa043e0dff83\\",\\"embeddableConfig\\":{\\"enhancements\\":{},\\"hidePanelTitles\\":false},\\"title\\":\\"Cumulative User Risk Score (multiple users)\\",\\"panelRefName\\":\\"panel_b3fdccab-59c1-47c8-9393-fa043e0dff83\\"},{\\"version\\":\\"8.3.0\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":18,\\"w\\":24,\\"h\\":45,\\"i\\":\\"8d09b97c-a023-4b7e-9e9d-1c46e726a487\\"},\\"panelIndex\\":\\"8d09b97c-a023-4b7e-9e9d-1c46e726a487\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[]}},\\"hidePanelTitles\\":false,\\"vis\\":{\\"params\\":{\\"colWidth\\":[{\\"colIndex\\":0,\\"width\\":410.5}]}}},\\"title\\":\\"Alert Counts by User\\",\\"panelRefName\\":\\"panel_8d09b97c-a023-4b7e-9e9d-1c46e726a487\\"},{\\"version\\":\\"8.3.0\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":24,\\"y\\":18,\\"w\\":24,\\"h\\":45,\\"i\\":\\"cae82aa1-20c8-4354-94ab-3934ac53b8fe\\"},\\"panelIndex\\":\\"cae82aa1-20c8-4354-94ab-3934ac53b8fe\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[]}},\\"hidePanelTitles\\":false,\\"vis\\":{\\"params\\":{\\"colWidth\\":[{\\"colIndex\\":0,\\"width\\":304}]}}},\\"title\\":\\"Alert Counts by Host\\",\\"panelRefName\\":\\"panel_cae82aa1-20c8-4354-94ab-3934ac53b8fe\\"},{\\"version\\":\\"8.3.0\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":63,\\"w\\":48,\\"h\\":15,\\"i\\":\\"ca3c8903-be5d-4265-820c-cc3d67443af2\\"},\\"panelIndex\\":\\"ca3c8903-be5d-4265-820c-cc3d67443af2\\",\\"embeddableConfig\\":{\\"enhancements\\":{},\\"hidePanelTitles\\":false},\\"title\\":\\"Tactic Breakdown of Risky Users\\",\\"panelRefName\\":\\"panel_ca3c8903-be5d-4265-820c-cc3d67443af2\\"}]",
      "refreshInterval": Object {
        "pause": false,
        "value": 0,
      },
      "timeFrom": "now-1w",
      "timeRestore": true,
      "timeTo": "now",
      "title": "Drilldown of User Risk Score",
      "version": 1,
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID8>",
    "migrationVersion": Object {
      "dashboard": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID2>",
        "name": "b3fdccab-59c1-47c8-9393-fa043e0dff83:panel_b3fdccab-59c1-47c8-9393-fa043e0dff83",
        "type": "lens",
      },
      Object {
        "id": "<REPLACE-WITH-ID3>",
        "name": "8d09b97c-a023-4b7e-9e9d-1c46e726a487:panel_8d09b97c-a023-4b7e-9e9d-1c46e726a487",
        "type": "visualization",
      },
      Object {
        "id": "<REPLACE-WITH-ID4>",
        "name": "cae82aa1-20c8-4354-94ab-3934ac53b8fe:panel_cae82aa1-20c8-4354-94ab-3934ac53b8fe",
        "type": "visualization",
      },
      Object {
        "id": "<REPLACE-WITH-ID5>",
        "name": "ca3c8903-be5d-4265-820c-cc3d67443af2:panel_ca3c8903-be5d-4265-820c-cc3d67443af2",
        "type": "visualization",
      },
      Object {
        "id": "<REPLACE-WITH-ID6>",
        "name": "tag-93fc0f00-1a57-11ed-bb53-ad8c26f4d942",
        "type": "tag",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "dashboard",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
  Object {
    "attributes": Object {
      "description": "",
      "hits": 0,
      "kibanaSavedObjectMeta": Object {
        "searchSourceJSON": "{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}",
      },
      "optionsJSON": "{\\"useMargins\\":true,\\"syncColors\\":false,\\"syncTooltips\\":false,\\"hidePanelTitles\\":false}",
      "panelsJSON": "[{\\"version\\":\\"8.3.0\\",\\"type\\":\\"visualization\\",\\"gridData\\":{\\"x\\":0,\\"y\\":0,\\"w\\":48,\\"h\\":3,\\"i\\":\\"02f0548a-aae6-460f-9300-be42b4ae9a1e\\"},\\"panelIndex\\":\\"02f0548a-aae6-460f-9300-be42b4ae9a1e\\",\\"embeddableConfig\\":{\\"savedVis\\":{\\"id\\":\\"\\",\\"title\\":\\"\\",\\"description\\":\\"\\",\\"type\\":\\"markdown\\",\\"params\\":{\\"fontSize\\":12,\\"openLinksInNewTab\\":false,\\"markdown\\":\\"User Risk Score is an experimental feature. You can read further about it [here](https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/user-risk-score.md).\\"},\\"uiState\\":{},\\"data\\":{\\"aggs\\":[],\\"searchSource\\":{\\"query\\":{\\"query\\":\\"\\",\\"language\\":\\"kuery\\"},\\"filter\\":[]}}},\\"hidePanelTitles\\":true,\\"enhancements\\":{}}},{\\"version\\":\\"8.3.0\\",\\"type\\":\\"lens\\",\\"gridData\\":{\\"x\\":17,\\"y\\":3,\\"w\\":14,\\"h\\":15,\\"i\\":\\"1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5\\"},\\"panelIndex\\":\\"1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5\\",\\"embeddableConfig\\":{\\"enhancements\\":{\\"dynamicActions\\":{\\"events\\":[{\\"eventId\\":\\"d26cff88-a061-494e-abb1-958216009585\\",\\"triggers\\":[\\"FILTER_TRIGGER\\"],\\"action\\":{\\"factoryId\\":\\"DASHBOARD_TO_DASHBOARD_DRILLDOWN\\",\\"name\\":\\"Go to Dashboard\\",\\"config\\":{\\"useCurrentFilters\\":true,\\"useCurrentDateRange\\":true,\\"openInNewTab\\":false}}}]}},\\"hidePanelTitles\\":false},\\"title\\":\\"Current Risk Scores for Users\\",\\"panelRefName\\":\\"panel_1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5\\"}]",
      "refreshInterval": Object {
        "pause": false,
        "value": 0,
      },
      "timeFrom": "now-1w",
      "timeRestore": true,
      "timeTo": "now",
      "title": "Current Risk Score for Users",
      "version": 1,
    },
    "coreMigrationVersion": "8.3.0",
    "id": "<REPLACE-WITH-ID7>",
    "migrationVersion": Object {
      "dashboard": "8.3.0",
    },
    "references": Array [
      Object {
        "id": "<REPLACE-WITH-ID1>",
        "name": "1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5:panel_1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5",
        "type": "lens",
      },
      Object {
        "id": "<REPLACE-WITH-ID8>",
        "name": "1e9c2cc7-ae0c-4ae7-8d03-8e079b5891b5:drilldown:DASHBOARD_TO_DASHBOARD_DRILLDOWN:d26cff88-a061-494e-abb1-958216009585:dashboardId",
        "type": "dashboard",
      },
      Object {
        "id": "<REPLACE-WITH-ID6>",
        "name": "tag-93fc0f00-1a57-11ed-bb53-ad8c26f4d942",
        "type": "tag",
      },
      Object {
        "id": "mockTagId",
        "name": "my tag",
        "type": "tag",
      },
    ],
    "type": "dashboard",
    "updated_at": "2022-08-12T16:20:10.121Z",
  },
]
`;
