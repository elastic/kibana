openapi: 3.0.0
info:
  title: Common Exception List Attributes
  version: 'not applicable'
paths: {}
components:
  x-codegen-enabled: true
  schemas:
    ExceptionListId:
      type: string
      minLength: 1
      format: nonempty
      description: Exception list's identifier.
      example: 9e5fc75a-a3da-46c5-96e3-a2ec59c6bb85

    ExceptionListHumanId:
      type: string
      minLength: 1
      format: nonempty
      description: The exception list's human readable string identifier, `endpoint_list`.
      example: 'simple_list'

    ExceptionListType:
      type: string
      description: The type of exception list to be created. Different list types may denote where they can be utilized.
      enum:
        - detection
        - rule_default
        - endpoint
        - endpoint_trusted_apps
        - endpoint_events
        - endpoint_host_isolation_exceptions
        - endpoint_blocklists

    ExceptionListName:
      type: string
      description: The name of the exception list.
      example: 'My exception list'

    ExceptionListDescription:
      type: string
      description: Describes the exception list.
      example: 'This list tracks allowlisted values.'

    ExceptionListMeta:
      type: object
      additionalProperties: true
      description: Placeholder for metadata about the list container.

    ExceptionNamespaceType:
      type: string
      enum:
        - agnostic
        - single
      description: |
        Determines whether the exception container is available in all Kibana spaces or just the space
        in which it is created, where:

        - `single`: Only available in the Kibana space in which it is created.
        - `agnostic`: Available in all Kibana spaces.

    ExceptionListTags:
      type: array
      items:
        type: string
      description: String array containing words and phrases to help categorize exception containers.

    ExceptionListOsType:
      type: string
      enum:
        - linux
        - macos
        - windows
      description: Use this field to specify the operating system.

    ExceptionListOsTypeArray:
      type: array
      items:
        $ref: '#/components/schemas/ExceptionListOsType'
      description: Use this field to specify the operating system. Only enter one value.

    ExceptionListVersion:
      type: integer
      minimum: 1
      description: The document version, automatically increasd on updates.

    ExceptionList:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/ExceptionListId'
        list_id:
          $ref: '#/components/schemas/ExceptionListHumanId'
        type:
          $ref: '#/components/schemas/ExceptionListType'
        name:
          $ref: '#/components/schemas/ExceptionListName'
        description:
          $ref: '#/components/schemas/ExceptionListDescription'
        immutable:
          type: boolean
        namespace_type:
          $ref: '#/components/schemas/ExceptionNamespaceType'
        os_types:
          $ref: '#/components/schemas/ExceptionListOsTypeArray'
        tags:
          $ref: '#/components/schemas/ExceptionListTags'
        meta:
          $ref: '#/components/schemas/ExceptionListMeta'
        version:
          $ref: '#/components/schemas/ExceptionListVersion'
        _version:
          type: string
          description: The version id, normally returned by the API when the item was retrieved. Use it ensure updates are done against the latest version.
        tie_breaker_id:
          type: string
          description: Field used in search to ensure all containers are sorted and returned correctly.
        created_at:
          type: string
          format: date-time
          description: Autogenerated date of object creation.
        created_by:
          type: string
          description: Autogenerated value - user that created object.
        updated_at:
          type: string
          format: date-time
          description: Autogenerated date of last object update.
        updated_by:
          type: string
          description: Autogenerated value - user that last updated object.
      required:
        - id
        - list_id
        - type
        - name
        - description
        - immutable
        - namespace_type
        - version
        - tie_breaker_id
        - created_at
        - created_by
        - updated_at
        - updated_by

    ExceptionListItemId:
      type: string
      minLength: 1
      format: nonempty
      description: Exception's identifier.
      example: 71a9f4b2-c85c-49b4-866f-c71eb9e67da2

    ExceptionListItemHumanId:
      type: string
      minLength: 1
      format: nonempty
      description: Human readable string identifier, e.g. `trusted-linux-processes`
      example: simple_list_item

    ExceptionListItemType:
      type: string
      enum: [simple]

    ExceptionListItemName:
      type: string
      minLength: 1
      format: nonempty
      description: Exception list name.

    ExceptionListItemDescription:
      type: string
      description: Describes the exception list.

    ExceptionListItemMeta:
      type: object
      additionalProperties: true

    ExceptionListItemExpireTime:
      type: string
      format: date-time
      description: The exception itemâ€™s expiration date, in ISO format. This field is only available for regular exception items, not endpoint exceptions.

    ExceptionListItemTags:
      type: array
      items:
        type: string
        minLength: 1
        format: nonempty
        description: String array containing words and phrases to help categorize exception items.

    ExceptionListItemOsType:
      type: string
      enum:
        - linux
        - macos
        - windows

    ExceptionListItemOsTypeArray:
      type: array
      items:
        $ref: '#/components/schemas/ExceptionListOsType'

    ExceptionListItemComment:
      type: object
      properties:
        id:
          $ref: '../../../../../../../src/platform/packages/shared/kbn-openapi-common/schemas/primitives.schema.yaml#/components/schemas/NonEmptyString'
        comment:
          $ref: '../../../../../../../src/platform/packages/shared/kbn-openapi-common/schemas/primitives.schema.yaml#/components/schemas/NonEmptyString'
        created_at:
          type: string
          format: date-time
          description: Autogenerated date of object creation.
        created_by:
          $ref: '../../../../../../../src/platform/packages/shared/kbn-openapi-common/schemas/primitives.schema.yaml#/components/schemas/NonEmptyString'
        updated_at:
          type: string
          format: date-time
          description: Autogenerated date of last object update.
        updated_by:
          $ref: '../../../../../../../src/platform/packages/shared/kbn-openapi-common/schemas/primitives.schema.yaml#/components/schemas/NonEmptyString'
      required:
        - id
        - comment
        - created_at
        - created_by

    ExceptionListItemCommentArray:
      type: array
      description: |
        Array of comment fields:

        - comment (string): Comments about the exception item.
      items:
        $ref: '#/components/schemas/ExceptionListItemComment'

    ExceptionListItem:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/ExceptionListItemId'
        item_id:
          $ref: '#/components/schemas/ExceptionListItemHumanId'
        list_id:
          $ref: '#/components/schemas/ExceptionListHumanId'
        type:
          $ref: '#/components/schemas/ExceptionListItemType'
        name:
          $ref: '#/components/schemas/ExceptionListItemName'
        description:
          $ref: '#/components/schemas/ExceptionListItemDescription'
        entries:
          $ref: './exception_list_item_entry.schema.yaml#/components/schemas/ExceptionListItemEntryArray'
        namespace_type:
          $ref: '#/components/schemas/ExceptionNamespaceType'
        os_types:
          $ref: '#/components/schemas/ExceptionListItemOsTypeArray'
        tags:
          $ref: '#/components/schemas/ExceptionListItemTags'
        meta:
          $ref: '#/components/schemas/ExceptionListItemMeta'
        expire_time:
          $ref: '#/components/schemas/ExceptionListItemExpireTime'
        comments:
          $ref: '#/components/schemas/ExceptionListItemCommentArray'
        _version:
          type: string
          description: The version id, normally returned by the API when the item was retrieved. Use it ensure updates are done against the latest version.
        tie_breaker_id:
          type: string
          description: Field used in search to ensure all containers are sorted and returned correctly.
        created_at:
          type: string
          format: date-time
          description: Autogenerated date of object creation.
        created_by:
          type: string
          description: Autogenerated value - user that created object.
        updated_at:
          type: string
          format: date-time
          description: Autogenerated date of last object update.
        updated_by:
          type: string
          description: Autogenerated value - user that last updated object.
      required:
        - id
        - item_id
        - list_id
        - type
        - name
        - description
        - entries
        - namespace_type
        - comments
        - tie_breaker_id
        - created_at
        - created_by
        - updated_at
        - updated_by

    ExceptionListSO:
      type: object
      properties:
        item_id:
          $ref: '#/components/schemas/ExceptionListItemHumanId'
        list_id:
          $ref: '#/components/schemas/ExceptionListHumanId'
        list_type:
          type: string
          enum: [item, list]
        immutable:
          type: boolean
        type:
          $ref: '#/components/schemas/ExceptionListItemType'
        name:
          $ref: '#/components/schemas/ExceptionListItemName'
        description:
          $ref: '#/components/schemas/ExceptionListItemDescription'
        entries:
          $ref: './exception_list_item_entry.schema.yaml#/components/schemas/ExceptionListItemEntryArray'
        os_types:
          $ref: '#/components/schemas/ExceptionListItemOsTypeArray'
        tags:
          $ref: '#/components/schemas/ExceptionListItemTags'
        meta:
          $ref: '#/components/schemas/ExceptionListItemMeta'
        expire_time:
          $ref: '#/components/schemas/ExceptionListItemExpireTime'
        comments:
          $ref: '#/components/schemas/ExceptionListItemCommentArray'
        version:
          $ref: '../../../../../../../src/platform/packages/shared/kbn-openapi-common/schemas/primitives.schema.yaml#/components/schemas/NonEmptyString'
        tie_breaker_id:
          type: string
          description: Field used in search to ensure all containers are sorted and returned correctly.
        created_at:
          type: string
          format: date-time
          description: Autogenerated date of object creation.
        created_by:
          type: string
          description: Autogenerated value - user that created object.
        updated_by:
          type: string
          description: Autogenerated value - user that last updated object.
      required:
        - list_id
        - list_type
        - type
        - name
        - description
        - tie_breaker_id
        - created_at
        - created_by
        - updated_at
        - updated_by
