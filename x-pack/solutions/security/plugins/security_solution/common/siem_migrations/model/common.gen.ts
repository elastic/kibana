/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: SIEM Migration common components
 *   version: not applicable
 */

import { z } from '@kbn/zod';

import { NonEmptyString } from '../../api/model/primitives.gen';

/**
 * The GenAI connector id to use.
 */
export type ConnectorId = z.infer<typeof ConnectorId>;
export const ConnectorId = z.string();

/**
 * The LangSmith options object.
 */
export type LangSmithOptions = z.infer<typeof LangSmithOptions>;
export const LangSmithOptions = z.object({
  /**
   * The project name.
   */
  project_name: z.string(),
  /**
   * The API key to use for tracing.
   */
  api_key: z.string(),
});

/**
 * The LangSmith settings object for evaluations.
 */
export type LangSmithEvaluationOptions = z.infer<typeof LangSmithEvaluationOptions>;
export const LangSmithEvaluationOptions = LangSmithOptions.merge(
  z.object({
    /**
     * The dataset name to use for evaluations.
     */
    dataset: z.string(),
  })
);

/**
 * The vendor identifier.
 */
export type SiemMigrationVendor = z.infer<typeof SiemMigrationVendor>;
export const SiemMigrationVendor = z.literal('splunk');

/**
 * A comment for the migration process
 */
export type MigrationComment = z.infer<typeof MigrationComment>;
export const MigrationComment = z.object({
  /**
   * The message of the migration comment
   */
  message: z.string(),
  /**
   * The moment of creation of the comment
   */
  created_at: z.string(),
  /**
   * The user profile ID of the user who created the comment, or `assistant` if it was generated by the LLM
   */
  created_by: z.string(),
});

/**
 * The comments for the migration including a summary from the LLM in markdown.
 */
export type MigrationComments = z.infer<typeof MigrationComments>;
export const MigrationComments = z.array(MigrationComment);

/**
 * The status of migration.
 */
export type MigrationStatus = z.infer<typeof MigrationStatus>;
export const MigrationStatus = z.enum(['pending', 'processing', 'completed', 'failed']);
export type MigrationStatusEnum = typeof MigrationStatus.enum;
export const MigrationStatusEnum = MigrationStatus.enum;

/**
 * The status of the migration task.
 */
export type MigrationTaskStatus = z.infer<typeof MigrationTaskStatus>;
export const MigrationTaskStatus = z.enum([
  'ready',
  'running',
  'stopped',
  'finished',
  'interrupted',
]);
export type MigrationTaskStatusEnum = typeof MigrationTaskStatus.enum;
export const MigrationTaskStatusEnum = MigrationTaskStatus.enum;

/**
 * The last execution of a migration task.
 */
export type MigrationLastExecution = z.infer<typeof MigrationLastExecution>;
export const MigrationLastExecution = z.object({
  /**
   * The total execution time in milliseconds for the migration. This includes duration of last_execution and any previous executions.
   */
  total_execution_time_ms: z.number().int().optional(),
  /**
   * The moment the last execution started.
   */
  started_at: z.string().optional(),
  /**
   * The moment the last execution finished.
   */
  finished_at: z.string().nullable().optional(),
  /**
   * The connector ID used for the last execution.
   */
  connector_id: z.string().optional(),
  /**
   * The error message if the last execution failed.
   */
  error: z.string().nullable().optional(),
  /**
   * Indicates if the last execution was stopped by the user.
   */
  is_stopped: z.boolean().optional(),
});

/**
 * The items migration translation stats object.
 */
export type MigrationTranslationStats = z.infer<typeof MigrationTranslationStats>;
export const MigrationTranslationStats = z.object({
  /**
   * The migration id
   */
  id: NonEmptyString,
  /**
   * The items migration translation stats.
   */
  items: z.object({
    /**
     * The total number of items in the migration.
     */
    total: z.number().int(),
    /**
     * The number of items that have been successfully translated.
     */
    success: z.object({
      /**
       * The total number of items that have been successfully translated.
       */
      total: z.number().int(),
      /**
       * The translation results
       */
      result: z.object({
        /**
         * The number of items that have been fully translated.
         */
        full: z.number().int(),
        /**
         * The number of items that have been partially translated.
         */
        partial: z.number().int(),
        /**
         * The number of items that could not be translated.
         */
        untranslatable: z.number().int(),
      }),
      /**
       * The number of items that have been successfully translated and can be installed.
       */
      installable: z.number().int(),
    }),
    /**
     * The number of items that have failed translation.
     */
    failed: z.number().int(),
  }),
});

/**
 * The migration translation result.
 */
export type MigrationTranslationResult = z.infer<typeof MigrationTranslationResult>;
export const MigrationTranslationResult = z.enum(['full', 'partial', 'untranslatable']);
export type MigrationTranslationResultEnum = typeof MigrationTranslationResult.enum;
export const MigrationTranslationResultEnum = MigrationTranslationResult.enum;

/**
 * The migration items stats.
 */
export type MigrationTaskItemsStats = z.infer<typeof MigrationTaskItemsStats>;
export const MigrationTaskItemsStats = z.object({
  /**
   * The total number of items to migrate.
   */
  total: z.number().int(),
  /**
   * The number of items that are pending migration.
   */
  pending: z.number().int(),
  /**
   * The number of items that are being migrated.
   */
  processing: z.number().int(),
  /**
   * The number of items that have been migrated successfully.
   */
  completed: z.number().int(),
  /**
   * The number of items that have failed migration.
   */
  failed: z.number().int(),
});

/**
 * The migration task stats object.
 */
export type MigrationTaskStats = z.infer<typeof MigrationTaskStats>;
export const MigrationTaskStats = z.object({
  /**
   * The migration id
   */
  id: NonEmptyString,
  /**
   * The migration name
   */
  name: NonEmptyString,
  /**
   * Indicates if the migration task status.
   */
  status: MigrationTaskStatus,
  /**
   * The migration items stats.
   */
  items: MigrationTaskItemsStats,
  /**
   * The moment the migration was created.
   */
  created_at: z.string(),
  /**
   * The moment of the last update.
   */
  last_updated_at: z.string(),
  /**
   * The last execution of the migration task.
   */
  last_execution: MigrationLastExecution.optional(),
});

/**
 * The type of the resource
 */
export type SiemMigrationResourceType = z.infer<typeof SiemMigrationResourceType>;
export const SiemMigrationResourceType = z.enum(['macro', 'lookup']);
export type SiemMigrationResourceTypeEnum = typeof SiemMigrationResourceType.enum;
export const SiemMigrationResourceTypeEnum = SiemMigrationResourceType.enum;

/**
 * A resource of a migration
 */
export type SiemMigrationResourceBase = z.infer<typeof SiemMigrationResourceBase>;
export const SiemMigrationResourceBase = z.object({
  type: SiemMigrationResourceType,
  /**
   * The name of the resource
   */
  name: NonEmptyString,
});

export type SiemMigrationResourceContent = z.infer<typeof SiemMigrationResourceContent>;
export const SiemMigrationResourceContent = z.object({
  /**
   * The resource content value. Can be an empty string.
   */
  content: z.string(),
  /**
   * The resource arbitrary metadata.
   */
  metadata: z.object({}).optional(),
});

/**
 * The rule migration resource data.
 */
export type SiemMigrationResourceData = z.infer<typeof SiemMigrationResourceData>;
export const SiemMigrationResourceData = SiemMigrationResourceBase.merge(
  SiemMigrationResourceContent
);

/**
 * The rule migration resource document object.
 */
export type SiemMigrationResource = z.infer<typeof SiemMigrationResource>;
export const SiemMigrationResource = SiemMigrationResourceBase.merge(
  SiemMigrationResourceContent.partial()
).merge(
  z.object({
    /**
     * The rule resource migration id
     */
    id: NonEmptyString,
    /**
     * The migration id
     */
    migration_id: NonEmptyString,
    /**
     * The moment of the last update
     */
    updated_at: z.string().optional(),
    /**
     * The user who last updated the resource
     */
    updated_by: z.string().optional(),
  })
);
