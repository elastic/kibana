/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: SIEM Migration common components
 *   version: not applicable
 */

import { z } from '@kbn/zod';

import { NonEmptyString } from '../../api/model/primitives.gen';

/**
 * The GenAI connector id to use.
 */
export type ConnectorId = z.infer<typeof ConnectorId>;
export const ConnectorId = z.string();

/**
 * The LangSmith options object.
 */
export type LangSmithOptions = z.infer<typeof LangSmithOptions>;
export const LangSmithOptions = z.object({
  /**
   * The project name.
   */
  project_name: z.string(),
  /**
   * The API key to use for tracing.
   */
  api_key: z.string(),
});

/**
 * The LangSmith settings object for evaluations.
 */
export type LangSmithEvaluationOptions = z.infer<typeof LangSmithEvaluationOptions>;
export const LangSmithEvaluationOptions = LangSmithOptions.merge(
  z.object({
    /**
     * The dataset name to use for evaluations.
     */
    dataset: z.string(),
  })
);

/**
 * The status of migration.
 */
export type MigrationStatus = z.infer<typeof MigrationStatus>;
export const MigrationStatus = z.enum(['pending', 'processing', 'completed', 'failed']);
export type MigrationStatusEnum = typeof MigrationStatus.enum;
export const MigrationStatusEnum = MigrationStatus.enum;

/**
 * The status of the migration task.
 */
export type MigrationTaskStatus = z.infer<typeof MigrationTaskStatus>;
export const MigrationTaskStatus = z.enum([
  'ready',
  'running',
  'stopped',
  'finished',
  'interrupted',
]);
export type MigrationTaskStatusEnum = typeof MigrationTaskStatus.enum;
export const MigrationTaskStatusEnum = MigrationTaskStatus.enum;

/**
 * The last execution of a migration task.
 */
export type MigrationLastExecution = z.infer<typeof MigrationLastExecution>;
export const MigrationLastExecution = z.object({
  /**
   * The moment the last execution started.
   */
  started_at: z.string().optional(),
  /**
   * The moment the last execution finished.
   */
  finished_at: z.string().nullable().optional(),
  /**
   * The connector ID used for the last execution.
   */
  connector_id: z.string().optional(),
  /**
   * The error message if the last execution failed.
   */
  error: z.string().nullable().optional(),
  /**
   * Indicates if the last execution was stopped by the user.
   */
  is_stopped: z.boolean().optional(),
});

/**
 * The type of the resource
 */
export type SiemMigrationResourceType = z.infer<typeof SiemMigrationResourceType>;
export const SiemMigrationResourceType = z.enum(['macro', 'lookup']);
export type SiemMigrationResourceTypeEnum = typeof SiemMigrationResourceType.enum;
export const SiemMigrationResourceTypeEnum = SiemMigrationResourceType.enum;

/**
 * A resource of a migration
 */
export type SiemMigrationResourceBase = z.infer<typeof SiemMigrationResourceBase>;
export const SiemMigrationResourceBase = z.object({
  type: SiemMigrationResourceType,
  /**
   * The name of the resource
   */
  name: NonEmptyString,
});

export type SiemMigrationResourceContent = z.infer<typeof SiemMigrationResourceContent>;
export const SiemMigrationResourceContent = z.object({
  /**
   * The resource content value. Can be an empty string.
   */
  content: z.string(),
  /**
   * The resource arbitrary metadata.
   */
  metadata: z.object({}).optional(),
});

/**
 * The rule migration resource data.
 */
export type SiemMigrationResourceData = z.infer<typeof SiemMigrationResourceData>;
export const SiemMigrationResourceData = SiemMigrationResourceBase.merge(
  SiemMigrationResourceContent
);

/**
 * The rule migration resource document object.
 */
export type SiemMigrationResource = z.infer<typeof SiemMigrationResource>;
export const SiemMigrationResource = SiemMigrationResourceBase.merge(
  SiemMigrationResourceContent.partial()
).merge(
  z.object({
    /**
     * The rule resource migration id
     */
    id: NonEmptyString,
    /**
     * The migration id
     */
    migration_id: NonEmptyString,
    /**
     * The moment of the last update
     */
    updated_at: z.string().optional(),
    /**
     * The user who last updated the resource
     */
    updated_by: z.string().optional(),
  })
);
