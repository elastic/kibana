openapi: 3.0.0
info:
  version: '2023-10-31'
  title: Entity Store - Upsert Entity
paths:
  /api/entity_store/entities/{entityType}:
    get:
      x-labels: [ess, serverless]
      x-codegen-enabled: true
      operationId: UpsertEntity
      summary: Updates or creates an entity in Entity Store
      description: >
        Given an entity type, an entity id and the contents of an entity, 
        update (or create) the contents of an entity. By default only a specific 
        set of fields are allowed to be modified, being that `entity.attributes.*, 
        entity.lifecyle.* and entity.behavior.*`. If you wish to update any 
        other field you must use the query parameter `force=true`. Be aware 
        that some fields always fetch the first seen value, thus your changes
        won't be seen. And also, due to technical limitations, there is no 
        guarantee that collected values will end up in the final list of 
        seen values.
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            $ref: '../common.schema.yaml#/components/schemas/EntityType'
        - name: force
          in: query
          required: false
          schema:
            type: boolean
            default: false
      requestBody:
        description: Schema for the updating a single entity
        required: true
        content:
          application/json:
            schema:
              $ref: './common.schema.yaml#/components/schemas/Entity'
      responses:
        '404':
          description: Entity not found
        '403':
          description: Operation on a not exposed field
        '400':
          description: Operation on a non existent field or on a not initiated Engine
        '200':
          description: Entity Updated or Created
          content:
            application/json:
              schema:
                $ref: './common.schema.yaml#/components/schemas/Entity'