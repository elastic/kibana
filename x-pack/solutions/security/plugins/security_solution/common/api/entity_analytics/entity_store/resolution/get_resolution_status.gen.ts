/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: Entity Store - Get Resolution Status (FIELDS Architecture)
 *   version: 2023-10-31
 */

import { z } from '@kbn/zod';

import { EntityType } from '../common.gen';
import { EntityField, Asset } from '../entities/common.gen';

/**
  * Resolution status of the entity: - primary: Entity has secondaries resolved to it (or is standalone with no resolution) - secondary: Entity is resolved to a primary via Resolved_by field - standalone: Entity has no resolution relationships

  */
export type ResolutionStatus = z.infer<typeof ResolutionStatus>;
export const ResolutionStatus = z.enum(['primary', 'secondary', 'standalone']);
export type ResolutionStatusEnum = typeof ResolutionStatus.enum;
export const ResolutionStatusEnum = ResolutionStatus.enum;

export type GraphNodeColor = z.infer<typeof GraphNodeColor>;
export const GraphNodeColor = z.enum(['primary', 'danger', 'warning']);
export type GraphNodeColorEnum = typeof GraphNodeColor.enum;
export const GraphNodeColorEnum = GraphNodeColor.enum;

export type GraphNodeShape = z.infer<typeof GraphNodeShape>;
export const GraphNodeShape = z.enum(['hexagon', 'pentagon', 'ellipse', 'rectangle', 'diamond']);
export type GraphNodeShapeEnum = typeof GraphNodeShape.enum;
export const GraphNodeShapeEnum = GraphNodeShape.enum;

export type GraphEdgeColor = z.infer<typeof GraphEdgeColor>;
export const GraphEdgeColor = z.enum(['primary', 'danger', 'warning', 'subdued']);
export type GraphEdgeColorEnum = typeof GraphEdgeColor.enum;
export const GraphEdgeColorEnum = GraphEdgeColor.enum;

export type GraphNode = z.infer<typeof GraphNode>;
export const GraphNode = z.object({
  /**
   * Unique node identifier (entity.id)
   */
  id: z.string(),
  /**
   * Display label (entity.name)
   */
  label: z.string().optional(),
  /**
   * Icon name (e.g., 'user', 'storage')
   */
  icon: z.string().optional(),
  color: GraphNodeColor,
  shape: GraphNodeShape,
  /**
   * Optional tag label
   */
  tag: z.string().optional(),
});

export type GraphEdge = z.infer<typeof GraphEdge>;
export const GraphEdge = z.object({
  /**
   * Unique edge identifier
   */
  id: z.string(),
  /**
   * Source node ID
   */
  source: z.string(),
  /**
   * Target node ID
   */
  target: z.string(),
  color: GraphEdgeColor,
});

export type GraphData = z.infer<typeof GraphData>;
export const GraphData = z.object({
  nodes: z.array(GraphNode),
  edges: z.array(GraphEdge),
});

/**
 * Simplified entity record for resolution response
 */
export type ResolutionEntity = z.infer<typeof ResolutionEntity>;
export const ResolutionEntity = z.object({
  '@timestamp': z.string().datetime().optional(),
  entity: EntityField.optional(),
  user: z.object({}).catchall(z.unknown()).optional(),
  host: z.object({}).catchall(z.unknown()).optional(),
  service: z.object({}).catchall(z.unknown()).optional(),
  asset: Asset.optional(),
});

export type GetResolutionStatusRequestQuery = z.infer<typeof GetResolutionStatusRequestQuery>;
export const GetResolutionStatusRequestQuery = z.object({
  /**
   * The entity.id to get resolution status for
   */
  entity_id: z.string(),
});
export type GetResolutionStatusRequestQueryInput = z.input<typeof GetResolutionStatusRequestQuery>;

export type GetResolutionStatusRequestParams = z.infer<typeof GetResolutionStatusRequestParams>;
export const GetResolutionStatusRequestParams = z.object({
  entityType: EntityType,
});
export type GetResolutionStatusRequestParamsInput = z.input<
  typeof GetResolutionStatusRequestParams
>;

export type GetResolutionStatusResponse = z.infer<typeof GetResolutionStatusResponse>;
export const GetResolutionStatusResponse = z.object({
  resolution_status: ResolutionStatus,
  /** 
      * The primary entity. If current entity is primary, this is itself. If current entity is secondary, this is the entity it's resolved to.
 
      */
  primary_entity: ResolutionEntity.optional(),
  /** 
      * Secondary entities resolved to the primary. Only populated if resolution_status is 'primary' or 'secondary'.
 
      */
  secondary_entities: z.array(ResolutionEntity).optional(),
  /**
   * Pre-formatted graph data for visualization
   */
  graph_data: GraphData,
});
