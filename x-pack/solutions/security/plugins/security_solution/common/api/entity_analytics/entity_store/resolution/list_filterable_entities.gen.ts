/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: Entity Store - List Filterable Entities
 *   version: 2023-10-31
 */

import { z } from '@kbn/zod';

import { EntityType } from '../common.gen';

export type FilterableEntity = z.infer<typeof FilterableEntity>;
export const FilterableEntity = z.object({
  /**
   * The entity ID (entity.id)
   */
  id: z.string(),
  /**
   * The entity name (entity.name)
   */
  name: z.string(),
  /**
   * The entity type (user, host, service, generic)
   */
  type: z.string(),
  /**
   * The entity's risk score (if available)
   */
  risk_score: z.number().nullable().optional(),
  /**
   * Whether this entity is a primary in its resolution group (null if not resolved)
   */
  is_primary: z.boolean().nullable().optional(),
  /**
   * The resolution ID if entity is resolved (null if not resolved)
   */
  resolution_id: z.string().nullable().optional(),
  /**
   * Number of entities in this resolution group (0 if not resolved)
   */
  resolved_count: z.number().int().optional(),
});

export type ListFilterableEntitiesRequestQuery = z.infer<typeof ListFilterableEntitiesRequestQuery>;
export const ListFilterableEntitiesRequestQuery = z.object({
  /** 
      * Filter mode: - primaries_and_unresolved: Returns entities that are either primary (is_primary=true) or not resolved (no resolution_id) - unresolved_only: Returns only entities that are not part of any resolution group
 
      */
  filter: z.enum(['primaries_and_unresolved', 'unresolved_only']),
  /**
   * Entity ID to exclude from results (used to exclude selected primary in step 2)
   */
  exclude_entity_id: z.string().optional(),
  /**
   * Search term to filter entities by name
   */
  search_term: z.string().optional(),
  /**
   * Maximum number of entities to return
   */
  limit: z.coerce.number().int().min(1).max(1000).optional().default(50),
});
export type ListFilterableEntitiesRequestQueryInput = z.input<
  typeof ListFilterableEntitiesRequestQuery
>;

export type ListFilterableEntitiesRequestParams = z.infer<
  typeof ListFilterableEntitiesRequestParams
>;
export const ListFilterableEntitiesRequestParams = z.object({
  entityType: EntityType,
});
export type ListFilterableEntitiesRequestParamsInput = z.input<
  typeof ListFilterableEntitiesRequestParams
>;

export type ListFilterableEntitiesResponse = z.infer<typeof ListFilterableEntitiesResponse>;
export const ListFilterableEntitiesResponse = z.object({
  entities: z.array(FilterableEntity),
  /**
   * Total number of matching entities
   */
  total: z.number().int(),
});
