/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: List Grouped Entities API
 *   version: 1.0.0
 */

import { z } from '@kbn/zod';

export type GroupedEntity = z.infer<typeof GroupedEntity>;
export const GroupedEntity = z.object({
  id: z.string(),
  name: z.string(),
  type: z.string(),
  risk_score: z.number().nullable().optional(),
  risk_level: z.string().nullable().optional(),
});

export type EntityGroup = z.infer<typeof EntityGroup>;
export const EntityGroup = z.object({
  /**
   * The resolution_id for resolved groups, or synthetic ID for unresolved entities
   */
  group_id: z.string(),
  /**
   * The resolution_id if this is a resolved group, null otherwise
   */
  resolution_id: z.string().nullable().optional(),
  /**
   * Whether this group contains resolved (linked) entities
   */
  is_resolved: z.boolean(),
  /**
   * Maximum risk score among entities in this group
   */
  max_risk_score: z.number().nullable(),
  /**
   * Risk level corresponding to max risk score
   */
  max_risk_level: z.string().nullable().optional(),
  entities: z.array(GroupedEntity),
});

export type ListGroupedEntitiesRequestQuery = z.infer<typeof ListGroupedEntitiesRequestQuery>;
export const ListGroupedEntitiesRequestQuery = z.object({
  /**
   * Maximum number of groups to return
   */
  limit: z.coerce.number().int().min(1).max(1000).optional().default(100),
});
export type ListGroupedEntitiesRequestQueryInput = z.input<typeof ListGroupedEntitiesRequestQuery>;

export type ListGroupedEntitiesRequestParams = z.infer<typeof ListGroupedEntitiesRequestParams>;
export const ListGroupedEntitiesRequestParams = z.object({
  /**
   * The entity type to query
   */
  entityType: z.enum(['user', 'host', 'service', 'generic']),
});
export type ListGroupedEntitiesRequestParamsInput = z.input<
  typeof ListGroupedEntitiesRequestParams
>;

export type ListGroupedEntitiesResponse = z.infer<typeof ListGroupedEntitiesResponse>;
export const ListGroupedEntitiesResponse = z.object({
  groups: z.array(EntityGroup),
  /**
   * Total number of groups
   */
  total_groups: z.number().int(),
  /**
   * Total number of entities across all groups
   */
  total_entities: z.number().int(),
});
