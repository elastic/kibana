openapi: 3.0.0

info:
  title: Entity Details highlights
  version: '1'
paths:
  /internal/entity_details/highlights:
    post:
      x-labels: [ess, serverless]
      x-codegen-enabled: true
      operationId: EntityDetailsHighlights
      summary: Initialize the Entity Store

      requestBody:
        description: Schema for the entity details highlights
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                entityType:
                  $ref: '../entity_store/common.schema.yaml#/components/schemas/EntityType'
                entityIdentifier:
                  type: string
                  description: The identifier of the entity.
                anonymizationFields:
                  type: array
                  items:
                    $ref: '../../../../../../../../platform/packages/shared/kbn-elastic-assistant-common/impl/schemas/anonymization_fields/bulk_crud_anonymization_fields_route.schema.yaml#/components/schemas/AnonymizationFieldResponse'
                from:
                  type: number
                  description: The 'from' date.
                to:
                  type: number
                  description: The 'to' date.      
                connectorId:
                  type: string
                  description: The connector id.
              required:
                - entityType
                - entityIdentifier
                - anonymizationFields
                - from
                - to      
                - connectorId  
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  summary:
                    type: object
                    properties:
                      assetCriticality:
                        type: array
                        items:
                          type: object
                      riskScore:
                        type: array
                        items:
                          type: object
                      vulnerabilities:
                        type: array
                        items:
                          type: object
                      vulnerabilitiesTotal:
                        type: object
                        additionalProperties:
                          type: number
                      anomalies:
                        type: array
                        items:
                          type: object
                    description: The highlights of the entity.
                  replacements:
                    $ref: '../../../../../../../../platform/packages/shared/kbn-elastic-assistant-common/impl/schemas/conversations/common_attributes.schema.yaml#/components/schemas/Replacements'
                  prompt:
                    type: string
                    description: The prompt used to generate the highlights.
                required:
                  - summary
                  - replacements
                  - prompt
        '400':
          description: Invalid request
