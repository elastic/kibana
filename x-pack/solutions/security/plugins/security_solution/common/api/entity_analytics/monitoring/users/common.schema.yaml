openapi: 3.0.0
info:
  title: Privilege Monitoring Users Common Schema
  description: Common schema for Privileged Users
  version: "1"
paths: {}
components:
  schemas:
    UserName:
      type: object
      properties:
        user:
          type: object
          properties:
            name:
              type: string
              description: The name of the user.
        entity_analytics_monitoring:
          type: object
          description: Entity analytics monitoring configuration for the user
          properties:
            labels:
              type: array
              description: Array of labels associated with the user
              items:
                type: object
                properties:
                  field:
                    type: string
                    description: The field name for the label
                  value:
                    type: string
                    description: The value of the label
                  source:
                    type: string
                    description: The source where this label was created (api, csv, or index_sync)
                    enum:
                      - api
                      - csv
                      - index_sync

    MonitoredUserUpdateDoc:
      type: object
      properties:
        id:
          type: string
        user:
          type: object
          properties:
            name:
              type: string
            is_privileged:
              type: boolean
              description: Indicates if the user is privileged.
        labels:
          type: object
          properties:
            sources:
              type: array
              items:
                enum:
                  - csv
                  - index_sync
                  - api
            source_ids:
              type: array
              items:
                type: string
            source_integrations:
              type: array
              items:
                type: string
        entity_analytics_monitoring:
          type: object
          properties:
            labels:
              type: array
              items:
                $ref: '#/components/schemas/MonitoringLabel'

    MonitoringLabel:
      type: object
      required:
        - field
        - value
        - source
      properties:
        field:
          type: string
        value:
          type: string
        source:
          type: string
    MonitoredUserDoc:
      allOf:
      - $ref: '#/components/schemas/MonitoredUserUpdateDoc'
      - type: object
        properties:
          event:
            type: object
            properties:
              ingested:
                type: string
                format: date-time
              "@timestamp":
                type: string
                format: date-time
          "@timestamp":
            type: string
            format: date-time
          user:
            type: object
            properties:
              name:
                type: string
              is_privileged:
                type: boolean
                description: Indicates if the user is privileged.
              entity:
                type: object
                properties:
                  attributes:
                    type: object
                    properties:
                       Privileged:
                        type: boolean
                        description: Indicates if the user is privileged.
