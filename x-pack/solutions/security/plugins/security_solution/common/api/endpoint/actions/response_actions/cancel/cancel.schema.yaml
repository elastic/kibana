openapi: 3.0.0
info:
  title: Cancel Action Schema
  version: '2023-10-31'
  description: Schema for canceling response actions
paths:
  /api/endpoint/action/cancel:
    post:
      summary: Cancel a response action
      operationId: CancelAction
      description: Cancel a running or pending response action (Applies only to some agent types).
      x-codegen-enabled: true
      x-labels: [ess, serverless]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelRouteRequestBody'
            examples:
              MicrosoftDefenderEndpoint:
                summary: Cancel a response action on a Microsoft Defender for Endpoint host
                value:
                  endpoint_ids:
                    - 'ed518850-681a-4d60-bb98-e22640cae2a8'
                  agent_type: 'microsoft_defender_endpoint'
                  parameters:
                    id: '7f8c9b2a-4d3e-4f5a-8b1c-2e3f4a5b6c7d'
                  comment: 'Cancelling action due to change in requirements'
      responses:
        '200':
          description: Successfully cancelled the response action
          content:
            application/json:
              schema:
                $ref: '../../../model/schema/common.schema.yaml#/components/schemas/ResponseActionCreateSuccessResponse'
components:
  schemas:
    CancelRouteRequestBody:
      allOf:
        - $ref: '../../../model/schema/common.schema.yaml#/components/schemas/BaseActionSchema'
        - type: object
          required:
            - parameters
          properties:
            parameters:
              required:
                - id
              type: object
              properties:
                id:
                  type: string
                  minLength: 1
                  description: ID of the response action to cancel
                  example: '7f8c9b2a-4d3e-4f5a-8b1c-2e3f4a5b6c7d'
