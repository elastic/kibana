openapi: 3.0.0
info:
  title: Read privileges API endpoint
  version: '2023-10-31'
paths:
  /api/detection_engine/privileges:
    get:
      x-labels: [serverless, ess]
      operationId: ReadPrivileges
      x-codegen-enabled: true
      summary: Returns user privileges for the Kibana space
      description: |
        Retrieves whether or not the user is authenticated, and the user's Kibana
        space and index privileges, which determine if the user can create an
        index for the Elastic Security alerts generated by
        detection engine rules.
      tags:
        - Privileges API
      responses:
        200:
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  is_authenticated:
                    type: boolean
                  has_encryption_key:
                    type: boolean
                required: [is_authenticated, has_encryption_key]
              examples:
                success:
                  value:
                    username: elastic
                    has_all_requested: true
                    cluster:
                      all: true
                      monitor_ml: true
                      manage_transform: true
                      manage_index_templates: true
                      monitor_transform: true
                      manage_ml: true
                      monitor: true
                      manage_pipeline: true
                      manage_api_key: true
                      manage_security: true
                      manage_own_api_key: true
                      manage: true
                    index:
                      .alerts-security.alerts-default:
                        all: true
                        create: true
                        create_doc: true
                        create_index: true
                        delete: true
                        delete_index: true
                        index: true
                        maintenance: true
                        manage: true
                        monitor: true
                        read: true
                        view_index_metadata: true
                        write: true
                    application: {}
                    is_authenticated: true
                    has_encryption_key: true
        401:
          description: Unsuccessful authentication response
          content:
            application/json:
              schema:
                $ref: '../../../model/error_responses.schema.yaml#/components/schemas/PlatformErrorResponse'
        500:
          description: Internal server error response
          content:
            application/json:
              schema:
                $ref: '../../../model/error_responses.schema.yaml#/components/schemas/SiemErrorResponse'
