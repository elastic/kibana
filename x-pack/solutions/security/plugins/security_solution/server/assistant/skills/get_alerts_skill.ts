/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import type { Skill } from '@kbn/onechat-common/skills';

/**
 * Skill for retrieving and analyzing security alerts.
 * This skill provides knowledge about how to query, filter, and analyze alerts
 * in the Elastic Security solution.
 */
export const GET_ALERTS_SKILL: Skill = {
  namespace: 'security.get_alerts',
  name: 'Get Security Alerts',
  description: 'Instructions for retrieving security alerts',
  content: `# Security Alerts Retrieval Guide

This skill provides comprehensive knowledge about working with security alerts in Elastic Security.

## Overview
Security alerts are generated by detection rules and represent potential security threats or suspicious activities detected in your environment.

## Key Concepts

### Alert States
- **Open**: New alerts that require investigation
- **Acknowledged**: Alerts that have been reviewed but not resolved
- **Closed**: Alerts that have been resolved or dismissed

### Alert Severity Levels
- **Critical**: Immediate attention required
- **High**: Important security events
- **Medium**: Moderate security concerns
- **Low**: Minor security observations
- **Info**: Informational alerts

### Common Alert Fields
- \`@timestamp\`: When the alert was generated
- \`kibana.alert.rule.name\`: Name of the detection rule
- \`kibana.alert.severity\`: Severity level
- \`kibana.alert.workflow_status\`: Current workflow status
- \`kibana.alert.risk_score\`: Calculated risk score
- \`event.action\`: Type of event that triggered the alert

## Query Patterns

### Get Recent Alerts
Query alerts from the last 24 hours:
\`\`\`
GET .alerts-security.alerts-default/_search
{
  "query": {
    "range": {
      "@timestamp": {
        "gte": "now-24h"
      }
    }
  }
}
\`\`\`

### Filter by Severity
Get only high and critical alerts:
\`\`\`
{
  "query": {
    "bool": {
      "must": [
        {
          "terms": {
            "kibana.alert.severity": ["high", "critical"]
          }
        }
      ]
    }
  }
}
\`\`\`

### Filter by Workflow Status
Get open alerts:
\`\`\`
{
  "query": {
    "term": {
      "kibana.alert.workflow_status": "open"
    }
  }
}
\`\`\`

## Best Practices

1. **Time Ranges**: Always specify appropriate time ranges to avoid querying too much data
2. **Filtering**: Use severity and workflow status filters to focus on relevant alerts
3. **Aggregations**: Use aggregations to summarize alert counts by severity, rule name, or other dimensions
4. **Pagination**: For large result sets, use pagination with \`from\` and \`size\` parameters

## Common Use Cases

- Count alerts by severity over a time period
- Find alerts from specific detection rules
- Identify alerts requiring immediate attention (critical + open)
- Analyze alert trends over time
- Correlate alerts by source IP, user, or other attributes`,
  tools: [],
};

