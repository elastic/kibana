---
title: "Outlaw Linux Malware: Persistent, Unsophisticated, and Surprisingly Effective"
slug: "outlaw-linux-malware"
date: "2025-04-01"
description: "Outlaw is a persistent Linux malware leveraging simple brute-force and mining tactics to maintain a long-lasting botnet."
author:
  - slug: remco-sprooten
  - slug: ruben-groenewoud
image: "outlaw.jpg"
category:
  - slug: malware-analysis
tags:
  - slug: OUTLAW
  - slug: linux
  - slug: malware
---
## Preface

OUTLAW is a persistent yet unsophisticated auto-propagating coinminer package observed across multiple versions over the past few years [[1](https://www.countercraftsec.com/blog/dota3-malware-again-and-again/)], [[2](https://blogs.juniper.net/en-us/threat-research/dota3-is-your-internet-of-things-device-moonlighting)], [[3](https://isc.sans.edu/diary/Hygiene+Hygiene+Hygiene+Guest+Diary/31260)], [[4](https://darktrace.com/blog/outlaw-returns-uncovering-returning-features-and-new-tactics)]. Despite lacking stealth and advanced evasion techniques, it remains active and effective by leveraging simple but impactful tactics such as SSH brute-forcing, SSH key and cron-based persistence, and manually modified commodity miners and IRC channels. This persistence highlights how botnet operators can achieve widespread impact without relying on sophisticated techniques.

To gain deeper insights into OUTLAW’s behavior and operational patterns, we deployed a honeypot designed to attract and observe the attackers in action. By carefully crafting an environment that mimicked a vulnerable system, we were able to bait the adversaries into interacting with our server. This interaction revealed automated and manual actions, with operators entering commands directly, making modifications on the fly, and even mistyping commands—clear indicators of human involvement. A captured GIF showcases these moments, providing a rare glimpse into their real-time decision-making process.

![Threat actors actions in a honeypot](/assets/images/outlaw-linux-malware/01-honeypot.gif "Threat actors actions in a honeypot")


By analyzing OUTLAW, we gain new insights into the tooling used by its operators and their evolving strategies over time. This malware presents a valuable opportunity to apply detection engineering principles, as its attack chain spans nearly the entire MITRE ATT&CK framework. Examining its infection process allows us to develop effective detection strategies that capitalize on its predictable and repetitive behaviors.

This report provides a full attack chain analysis, including detailed detection rules and hunting queries. By breaking down OUTLAW’s components, we demonstrate how even rudimentary malware can maintain longevity in modern environments and how defenders can leverage its simplicity to enhance detection and response.


## Key Takeaways

* **Persistent but unsophisticated**: OUTLAW remains active despite using basic techniques like SSH brute-forcing, SSH key manipulation, and cron-based persistence.
* **Commodity tooling**: The malware deploys modified `XMRig` miners, leverages IRC for C2, and includes publicly available scripts for persistence and defense evasion.
* **Extensive attack surface**: OUTLAW’s infection chain spans nearly the entire MITRE ATT&CK framework, offering many detection and hunting opportunities.
* **Worm-like propagation**: OUTLAW uses its compromised hosts to launch further SSH brute-force attacks on their local subnets, rapidly expanding the botnet.


## OUTLAW Overview

OUTLAW follows a multi-stage infection process that begins with downloading and executing its payload, establishing persistence, and expanding its botnet through SSH brute-force attacks. The execution chain is displayed below:


![OUTLAW infection chain overview](/assets/images/outlaw-linux-malware/02-flow.png "OUTLAW infection chain overview")


**1. Initial Infection & Deployment**

* The attack starts when `tddwrt7s.sh` downloads the `dota3.tar.gz` package from a C2 server.
* The extracted `initall.sh` script executes, kicking off the infection chain.

**2. Gaining Control & Persistence**



* The malware ensures dominance by killing competing brute-forcers and miners.
* It then deploys:
    * Modified XMRIG for crypto mining (connecting to a mining pool).
    * STEALTH SHELLBOT for remote control via IRC C2.
    * BLITZ to perform SSH brute force attacks.

**3. Propagation & Expansion**



* The brute-force module retrieves target lists from an SSH C2 server and attempts SSH brute-force attacks on new machines.
* Successfully compromised systems are infected, repeating the cycle.

This automated infection loop allows OUTLAW to remain active and profitable with minimal effort from attackers. Let’s take a deeper look at the entire attack chain.


## OUTLAW Execution Chain

OUTLAW effectively covers a wide range of tactics and techniques in the MITRE ATT&CK framework. This section maps its behavior to provide an overview of its infection chain and methods.


### Initial Access: blitz

OUTLAW gains initial access through opportunistic SSH brute-forcing, targeting systems with weak or default credentials. The malware employs its `blitz` component, also known under other names such as `kthreadadd`, to perform high-volume scanning and password-guessing attempts. It leverages lists of target IPs and credentials retrieved from its C2 servers.

OUTLAW also acts like a worm, automatically installing itself on every system that it successfully compromises. This self-propagation mechanism allows it to spread rapidly across networks, turning each newly infected device into another node for further brute-forcing and infection attempts.

We will take a deeper look into how OUTLAW performs these attacks and propagates itself later in the article.


### Execution: tddwrt7s.sh

The first infections of OUTLAW seem to originate from a straightforward dropper script: `tddwrt7s.sh`. This shell script checks for an existing installation. If the malware is already present and unpacked, it will run the initall script, kicking off the infection chain. Otherwise, it will attempt to download the package from a list of provided staging servers. For illustration purposes, a shortened snippet of the dropper is shown below:


![Dropper `tddwrt7s.sh` overview](/assets/images/outlaw-linux-malware/03-dropper.png "Dropper `tddwrt7s.sh` overview")

The extracted `dota3.tar.gz` package extracts its contents into a hidden folder called `.rsync`, and contains the following entries:

```text
 ├── a
 │   ├── a
 │   ├── init0
 │   ├── kswapd0
 │   ├── kswapd01
 │   ├── run
 │   ├── socat
 │   └── stop
 ├── b
 │   ├── a
 │   ├── run
 │   └── stop
 ├── c
 │   ├── blitz
 │   ├── blitz32
 │   ├── blitz64
 │   ├── go
 │   ├── run
 │   ├── start
 │   ├── stop
 │   └── v
 ├── init
 ├── init2
 └── initall
```

Let’s deconstruct the execution chains one by one.


### Main Initialization script: initall

The three `init` scripts control the overall execution flow and deployment of the malware. Starting with the `initall` script, the main initializer determines which execution path to take. It checks the system environment and decides whether to use `init` or `init2` based on file permissions and available directories.

These `init` scripts all use variable-based string concatenation obfuscation, where commands are split into small variable fragments that are dynamically concatenated and executed, making static analysis more difficult. For example, the `initall` script looks like this:


![Obfuscated `initall` script](/assets/images/outlaw-linux-malware/04-obfuscation.png "Obfuscated `initall` script")


However, by changing the `eval` to an `echo`, we can get the output without any effort: 


![De-obfuscated `initall` script](/assets/images/outlaw-linux-malware/05-deobfuscation.png "De-obfuscated `initall` script")
 


This script will, by default, consistently execute `init`. This is the primary execution path that installs the malware in the hidden directory `~/.configrc6`. The fallback execution path is `init2`, which is used when `~/.configrc6` is inaccessible. The main difference is that this path keeps all components in the current working directory. Applying the same deobfuscation principle as we did previously, we end up with the following two scripts:


![Conditional sub-routines: `init` and `init2`](/assets/images/outlaw-linux-malware/06-subroutine.png "Conditional sub-routines: `init` and `init2`")

The first script (`init`) hides its components in the hidden directory `~/.configrc6`, while the second script (`init2`) runs directly from the working directory. Despite this difference, the execution flow remains the same, starting the binary named `a` in the `a/` and `b/` directories as background processes and establishing persistence. In both scripts, the malware installs cron jobs that execute its binaries at regular intervals and on system reboots:

```text
5 6 * * 0   ~/.configrc6/a/upd
@reboot     ~/.configrc6/a/upd
5 8 * * 0   ~/.configrc6/b/sync
@reboot     ~/.configrc6/b/sync
0 0 */3 * * ~/.configrc6/c/aptitude
```

Although the scripts execute the `a` binary in the `a/` and `b/` directories nearly simultaneously, we will follow the execution flow of the `a/` directory first. 


### Subroutine Execution of a/ directory: XMRIG

The first script that is executed is `a`, which removes any existing cron jobs using `crontab -r` and then stores the current working directory in a variable. It then creates a shell script called `upd` that checks if a process (stored in `bash.pid`) is still running. If the process is not running, it executes `./run` as a background process, ensuring that the malware is continuously restarted if terminated.


![Startup script in the `a/` directory](/assets/images/outlaw-linux-malware/07-startup-a.png "Startup script in the `a/` directory")

Additionally, we see some commented commands, indicating that other versions of this malware may exist under names such as `rsync`, `go`, `kswapd0`, `blitz,` and `redtail`.

Further down the script, a function is created that checks if `/sys/module/msr/parameters/allow_writes` exists and sets it to "on" to enable writing to Model-Specific Registers (MSRs). If the file does not exist, it enables MSR writes through the `modprobe msr allow_writes=on` command.


![XMRig optimization function: enable MSR writes](/assets/images/outlaw-linux-malware/08-xmrig-optimize.png "XMRig optimization function: enable MSR writes")


Next, the function identifies the active CPU by checking `/proc/cpuinfo` and applies specific MSR register values to optimize performance. 


![XMRIG optimization function: apply MSR registers](/assets/images/outlaw-linux-malware/09-xmrig-registers.png "XMRIG optimization function: apply MSR registers")

Finally, the function optimizes memory usage by enabling `hugepages` for all CPU cores, increasing memory access efficiency. It calculates the number of `hugepages` needed based on the available processors (`nproc`) and sets them in the `/sys/devices/system/node/node*/hugepages/` directories.


![XMRig optimization function: enable `hugepages`](/assets/images/outlaw-linux-malware/10-xmrig-hugepages.png "XMRig optimization function: enable `hugepages`")


The `optimize_func()` function was not created by the threat actor. The threat actor used an open-source script from the `XMRig` repository, specifically the [randomx_boost.sh](https://github.com/xmrig/xmrig/blob/master/scripts/randomx_boost.sh) script, to aid in their infection chain.

Depending on the user's privileges, it will either run the whole optimization function, or attempt to set the number of `hugepages` through `sysctl`:


![Condition for running `optimize_func()` function](/assets/images/outlaw-linux-malware/11-condition-optimize.png "Condition for running `optimize_func()` function")


All steps performed in this chain show apparent signs of cryptocurrency mining system optimization. Finally, the script grants execution permissions to the `upd` file and "777" permissions to all files in its folder and runs `upd`.

As we saw earlier in the chain, the `upd` file checks whether the process stored in `bash.pid` is still running, and if it is not, it will execute the `run` script:


![The `run` script for the`a/` folder](/assets/images/outlaw-linux-malware/12-run-script-a.png "The `run` script for the `a/` folder")

The run script will start the `stop` script, which is a typical script that bring down the defenses of any known miner configurations any known miner configurations and kill any known miner processes based on name/process ID or network traffic. A shortened version of this script is illustrated below:


![The `stop` script for the `a/` folder](/assets/images/outlaw-linux-malware/13-stop-script-a.png "The `stop` script for the `a/` folder")


Interestingly enough, a second process-killing script called `init0` is present, which is an [open-source script](https://github.com/MinervaLabsResearch/BlogPosts/blob/master/MinerKiller/MinerKiller.sh) for killing cryptocurrency miners in a Linux environment. This script is not being run, as the execution flow for this script was commented out in the `a` script.

After the `stop` script has been successfully run, the `run` script starts the `kswapd01` and `kswapd0` binaries in the background via `nohup`. 


#### kswapd01 

The `kswap01` binary plays a critical role in ensuring persistent communication within the malware’s infrastructure. Its main task is to monitor and maintain a continuous `socat` process, which is essential for communication with the attacker’s C2 servers.


![The main function of the `kswapd01` `socat` wrapper](/assets/images/outlaw-linux-malware/14-kswapd01-main.png "image_toThe main function of the `kswapd01` `socat` wrapperoltip")

When executed, `kswap01` checks for any existing `socat` processes running on the infected machine. If no active connection is found, it proceeds to kill any running `socat` processes and selects an alternative IP address from a predefined list. The binary then establishes a new connection by launching a fresh `socat` process to listen on the local machine and forward traffic to a remote server, typically on port 4444. This ensures the malware maintains control over the infected system and can continue receiving commands from the attacker.

However, it's important to note that not every version of the OUTLAW malware package observed includes the `socat` binary. In these cases, the functionality provided by `socat` is either replicated by other means or simply omitted, relying on alternative methods for maintaining persistence and communication.

By performing these checks and modifications, `kswap01` helps maintain the persistence of the C2 connection, making it harder for defenders to interrupt the communication channel between the attacker and the compromised system.


#### kswapd0 

The file named `kswapd0` is a maliciously modified copy of the legitimate `XMRig` cryptocurrency miner (specifically version 6.22.1). 


![The `XMRig` version](/assets/images/outlaw-linux-malware/15-kswapd0-xmrig-version.png "The `XMRig` version")

Two major modifications define the malware’s behavior:


**1. Startup Shell Commands**
  * The malware removes and recreates the victim’s `~/.ssh` folder, injects an attacker-controlled SSH public key, and re-applies restrictive permissions (`chattr +ia`) to prevent modification. This grants persistent SSH access.
  * It also removes or locks existing `XMRig` configuration files (e.g., `~/.xmrig.json`, `~/.config/xmrig.json`) to ensure the attacker’s embedded miner settings remain intact.


**2. Embedded Miner Configuration**
  * The binary is compiled with an internal mining configuration, allowing XMRIG to run without an external config file.
  * Mining traffic is routed to multiple Monero pools over plaintext ports (`:80`, `:4444`), SSL (`:442`), and occasionally TOR addresses. Note that the port 442 here is not a typo. 
  * The configuration optimizes performance by:
      * Running the miner in the background
      * Enabling large pages for `RandomX`
      * Setting the donation level to zero
      * Maximizing CPU thread usage

By locking out administrators, preventing config changes, and injecting an attacker-controlled SSH key, `kswapd0` serves as a stealthy persistence mechanism — allowing for continuous Monero mining and unauthorized remote access, all while masquerading as a legitimate system process.


### Subroutine Execution of b/ directory: STEALTH SHELLBOT

As we described earlier, the `a` binary in the `b/` directory was also executed via the `init` scripts.

![The `a` script in the `b/` folder](/assets/images/outlaw-linux-malware/16-a-in-b-folder.png "The `a` script in the `b/` folder")


This script kicks off another `stop` script with the same purpose we described earlier: kill any known bad processes. Afterward, it creates a script called `sync`, with the sole purpose of executing the `run` script. This script is referenced in the cronjob we described earlier. The `run` script contains three base64-encoded blobs, which are piped to `perl`. An example of a shortened script is shown below:


![Base64 encoded code](/assets/images/outlaw-linux-malware/17-base64-encoded.png "Base64 encoded code")


Upon base64 decoding, obfuscated `perl` scripts are identified. These scripts leverage a [public Perl Obfuscator](https://perlobfuscator.com/) utility to obfuscate their contents, making them harder to analyze:


![Perl obfuscated code](/assets/images/outlaw-linux-malware/18-perl-obfuscated-code.png "Perl obfuscated code")


Fortunately, the author left the standard comments in the obfuscated scripts. By using the [publicly available deobfuscator](https://perlobfuscator.com/decode-stunnix-5.17.1.pl) we can deobfuscate the script through the following command:


```bash
perl decode-stunnix-5.17.1.pl < obfuscated_run.pl > deobfuscated_run.pl
```


After which we can view the deobfuscated contents:


![Part of the `Stealth Shellbot` Perl code](/assets/images/outlaw-linux-malware/19-perl-deobfuscated.png "Part of the `Stealth Shellbot` Perl code")


This is just the first few lines of the script, for illustrative purposes. This deobfuscation technique can also be used for the other obfuscated Perl scripts used by OUTLAW. We will take a closer look at these scripts in just a moment.

The script ends off with installing its own SSH public key for persistent access, setting restrictive permissions, and making the directory immutable to prevent modification through `chattr`:


![Persistence via SSH key](/assets/images/outlaw-linux-malware/20-persistence.png "Persistence via SSH key")


#### STEALTH SHELLBOT Scripts

The STEALTH SHELLBOT scripts used in OUTLAW are not custom-built but rather publicly available IRC bot scripts, often sourced from old GitHub repositories and underground forums. These scripts have been around for over a decade, originally designed for remote administration, automation, and botnet management. However, they have since been repurposed by malware authors for malicious activities.

SHELLBOT scripts operate as IRC-based backdoors, allowing attackers to remotely control infected machines via predefined commands sent through an IRC channel. Once connected to the attacker’s IRC server, these bots can:

* Execute arbitrary shell commands
* Download and execute additional payloads
* Launch DDoS attacks (in older variants)
* Steal credentials or exfiltrate system information
* Manage crypto miners or other malware components

OUTLAW integrates these legacy SHELLBOT scripts as a secondary persistence mechanism, ensuring that even if its brute-force modules are disrupted, attackers still retain a remote foothold. The bot connects to an attacker-controlled IRC C2, where it listens for further commands, enabling on-demand execution of malicious actions.

While these scripts are not novel, their continued use highlights how attackers rely on publicly available tools rather than developing new malware from scratch.


### Subroutine Execution of c/ directory: Customer Bruteforcer

As part of the third and final sub-routine, a custom bruteforce tool is deployed. This chain starts, similar to the previous sub-routines, from the `init` and `init2` scripts. These scripts both call the `start` script, containing the following contents:


![alt_tThe `start` script in the `c/` folderext](/assets/images/outlaw-linux-malware/21-start-script-in-c.png "The `start` script in the `c/` folder")


This script stores the current working directory, provides all permissions (777) to all files in the current directory, and creates a script named `aptitude` (which is also called by the previously set up cron job), to run the `run` script. After creating `aptitude`, it is granted execution permissions and is run. 

The `run` script is used to gather CPU architecture information and count CPU cores to determine execution behavior, as shown below:


![The `run` script in the `c/` folder](/assets/images/outlaw-linux-malware/22-run-script-in-c.png "The `run` script in the `c/` folder")


If the system is x86_64, it checks whether the CPU has fewer than 7 cores, introducing a randomized delay before executing `./go` in the background. If 7 or more cores are detected, execution is skipped or altered (with a previously used binary `golan` now commented out). The threat actor may have been testing or working with a Golang binary that can make full use of the number of cores present in a system, but that is just a guess. 

In most scenarios, the execution flow moves to the bash script called `go`:


![The `go` bash script in the `c/` folder](/assets/images/outlaw-linux-malware/23-go-script-in-c.png "The `go` bash script in the `c/` folder")




The script determines the CPU architecture and assigns a thread count accordingly:

* ARM-based systems → 75 threads
* i686 (32-bit x86) → 325 threads
* All others (default) → 475 threads

It then enters an infinite loop, executing the following actions:

1. Creates and cleans up temporary files (`v`, `p`, `ip`, `xtr*`, `a.*`, `b.*`).
2. Writes hardcoded values (`257.287.563.234` and `sdaferthqhr34312asdfa`) into files `c` and `d`.
3. Waits for a random delay (1-30 seconds) before launching `blitz`.
4. Executes `blitz` for 3 hours with specified parameters (`-t $threads` suggests multi-threaded processing).
5. Performs post-execution cleanup, removing temporary and log files before repeating the cycle.


#### BLITZ

OUTLAW is a self-propagating worm that spreads laterally through SSH brute-force attacks using BLITZ, its custom-built brute-forcer. Designed for aggressive, automated credential attacks, BLITZ systematically scans for and compromises systems with weak or default SSH credentials, allowing the malware to expand its foothold with minimal attacker intervention.


##### BLITZ Execution Process

Upon execution, BLITZ follows a structured attack sequence:



1. **IP Target and Credential Retrieval**
    * BLITZ contacts an SSH C2 server to fetch a list of target IPs and credential pairs.
2. **Brute-Force Authentication & System Profiling**
    * Using multi-threaded SSH brute-forcing, BLITZ attempts to authenticate with stolen credentials.
    * Once access is gained, it:
        * Changes the user’s password for persistent access.
        * Executes system reconnaissance commands, collecting:
            * User privileges
            * CPU details
            * SSH banner information
            * OS version
        * Exfiltrates gathered data to the C2 server.
3. **Subnet Scanning & Lateral Movement**
    * The malware scans the local subnet of newly compromised systems, identifying additional SSH-accessible machines to attack.
4. **Self-Replication & Malware Deployment**
    * Instead of downloading from an external C2, BLITZ directly transfers the dota3.tar.gz malware package from the infecting host to the new victim, reinforcing persistence and minimizing reliance on external infrastructure.

By combining automated brute-force attacks, system profiling, subnet scanning, and direct malware transfer, BLITZ maximizes infection efficiency while ensuring continued network expansion.


##### Binary Analysis & C2 Communication

Beyond brute-force operations, analysis reveals that BLITZ executes its tasks by interacting with system shell commands and an embedded SSH library. Once connected to a compromised system, it queries the C2 server for updated targets and relays authentication data.


![Random IP Selection for the C2 SSH server](/assets/images/outlaw-linux-malware/24-random-ip-select.png "Random IP Selection for the C2 SSH server")


Additionally, OUTLAW incorporates a hardcoded SSH key for C2 authentication, which must be unlocked using the password "pegasus". Upon successful authentication, Blitz logs attack details into a "v" file, structured as follows:

This log contains:

* Original username and password used in the attack.
* The victim’s IP address and the new password set by the malware.
* SSH port and OS details, including CPU specifications.

Once BLITZ completes its scanning cycle, the "v" file is exfiltrated to an SSH C2 server, providing attackers with a continuously updated list of infected systems.


## Post-Compromise

To analyze the attacker’s post-compromise behavior, we deliberately set up a honeypot and proactively uploaded its credentials to the same SSH C2 server used by the attacker. This effectively invited the attacker into our controlled environment, allowing us to closely monitor their subsequent actions.

A few days after BLITZ successfully brute-forced and set a new password on the honeypot system, we observed a remote login using these credentials. The login originated from 212.234.225[.]29.  The attacker immediately performed basic reconnaissance by running the w command to check who was logged in and then executing ps to see what processes were running. In the course of typing commands, they made a small typo and killed the prompt with a quick Ctrl+C, indicating a manual interaction rather than an automated script at this stage. Next, the attacker pasted a series of commands to download a fresh copy of dota3.tar.gz via `wget`, unpacked it, and executed the newly fetched script. 

This whole chain of activity can be displayed through [session view](https://www.elastic.co/guide/en/security/current/session-view.html), an investigation tool that allows you to examine Linux process data organized in a tree-like structure according to the Linux logical event model, with processes organized by parentage and time of execution. It displays events in a highly readable format that is inspired by the terminal. This makes it a powerful tool for monitoring and investigating session activity on your Linux infrastructure and understanding user and service behavior.


![Threat actors actions in a honeypot](/assets/images/outlaw-linux-malware/01-honeypot.gif "Threat actors actions in a honeypot")

The attack chain displayed above mirrors the original infection method, suggesting that the attacker was either updating components or re-infecting the host to maintain persistence. Soon after verifying that the updated payload was running, the attacker disconnected from the host, leaving behind an environment primed for continued SSH brute-forcing, cryptocurrency mining, and remote control via IRC.

This brief login serves as a reminder that even unsophisticated campaigns can include pockets of interactive attacker activity—a manual "quality check" of sorts—underscoring the importance of timely detection and swift containment.


## Detecting OUTLAW through MITRE ATT&CK

OUTLAW is a Linux malware that relies on SSH brute-force attacks, cryptocurrency mining, and worm-like propagation to infect and maintain control over systems. While not highly sophisticated, it covers a broad range of MITRE ATT&CK techniques, making it an effective case for detection engineering.

This section maps OUTLAW’s attack chain to MITRE ATT&CK, highlighting Elastic SIEM and endpoint rules and threat-hunting queries that can identify its activity at different stages.

OUTLAW follows a structured infection flow:

* **Initial Access** – SSH brute-force against weak credentials.
* **Execution** – Runs malicious scripts to kick off several stages of malware infection.
* **Persistence** – Installs cron jobs and modifies SSH keys.
* **Defense Evasion** – Hides in hidden directories, modifies file permissions, uses packing techniques, command encoding, and obfuscates scripts.
* **Credential Access** – Modifies credentials and injects public SSH keys.
* **Discovery** – Enumerates user, system, and hardware details.
* **Lateral Movement** – Spreads via internal SSH brute-force and malware transfer.
* **Collection & Exfiltration** – Collects and exfiltrates system data to its C2.
* **Command and Control** – Uses socat and STEALTH SHELLBOT for C2 communication.
* **Impact** – Launches XMRIG to mine cryptocurrency and leverages the infected host as a brute-force node.

The following sections detail detection strategies for each technique, helping defenders effectively identify and mitigate OUTLAW’s infections.


### TA001: Initial Access

OUTLAW gains initial access through opportunistic SSH brute-forcing, targeting systems with weak or default credentials. Elastic pre-built [detection rules](https://github.com/elastic/detection-rules/) can successfully detect this method of initial access. These include:



* [Potential External Linux SSH Brute Force Detected](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/linux/credential_access_potential_linux_ssh_bruteforce_external.toml) 
* [Potential Successful SSH Brute Force Attack](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/linux/credential_access_potential_successful_linux_ssh_bruteforce.toml)

Additionally, there are several rules based on authentication logs to detect suspicious SSH authentications:

* [Successful SSH Authentication from Unusual SSH Public Key](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_first_time_public_key_authentication.toml)
* [Successful SSH Authentication from Unusual User](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_successful_ssh_authentication_by_unusual_user.toml)
* [Successful SSH Authentication from Unusual IP Address](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_successful_ssh_authentication_by_unusual_ip.toml)

Besides relying on detections, it is important to incorporate threat hunting into your workflow. Elastic Security provides several hunting queries using [ES|QL](https://www.elastic.co/guide/en/elasticsearch/reference/current/esql.html) and [OSQuery](https://www.elastic.co/guide/en/kibana/current/osquery.html), publicly available in our [Detection Rules repository](https://github.com/elastic/detection-rules), specifically in the [Linux hunting subdirectory](https://github.com/elastic/detection-rules/tree/main/hunting). For example, the following two hunts may help in identifying different stages of the attack:



* [Logon Activity by Source IP](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/hunting/linux/queries/login_activity_by_source_address.toml)
* [Excessive SSH Network Activity to Unique Destinations](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/hunting/linux/queries/excessive_ssh_network_activity_unique_destinations.toml)


### TA002: Execution

After gaining initial access, OUTLAW executes a series of scripts and binaries to establish control. Upon downloading and unpacking, we detect:



* [File Downloaded from Suspicious Source by Web Server](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/behavior/rules/linux/persistence_file_downloaded_from_suspicious_source_by_web_server.toml)
* [Memory Threat Detection Alert: Linux.Trojan.Pornoasset](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/yara/rules/Linux_Trojan_Pornoasset.yar)

The STEALTH SHELLBOT script is detected through:



* [Script Executed Through Unusual Parent Process](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/behavior/rules/linux/execution_script_executed_through_unusual_parent_process.toml)

Additionally, the malware executes multiple suspicious system commands, triggering:

* [Suspicious System Commands Executed by Previously Unknown Executable](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/rules/linux/execution_suspicious_executable_running_system_commands.toml)


### TA003: Persistence

This combination of cron-based execution and SSH key manipulation allows OUTLAW to maintain a persistent foothold on compromised systems. Both of these persistence techniques are extensively researched in our "[Linux Detection Engineering -  A primer on persistence mechanisms](https://www.elastic.co/security-labs/primer-on-persistence-mechanisms)" publication. We can detect these techniques through the following SIEM and [endpoint rules](https://github.com/elastic/protections-artifacts):

* [Cron Job Created or Modified](https://github.com/elastic/detection-rules/blob/main/rules/linux/persistence_cron_job_creation.toml)
* [SSH Authorized Keys File Modification](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/cross-platform/persistence_ssh_authorized_keys_modification.toml)
* [Potential Persistence via File Modification](https://github.com/elastic/detection-rules/blob/main/rules/integrations/fim/persistence_suspicious_file_modifications.toml)

Additionally, we can hunt for these techniques through the following ES|QL and OSQuery hunts:

* [Persistence via Cron](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/hunting/linux/queries/persistence_via_cron.toml)
* [Persistence via SSH Configurations and/or Keys](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/hunting/linux/queries/persistence_via_ssh_configurations_and_keys.toml)


### TA005: Defense Evasion

OUTLAW employs multiple defense evasion techniques to avoid detection. One of its primary methods is Base64 decoding, which is detected through the following pre-built rules:

* [Base64 Decoded Payload Piped to Interpreter](https://github.com/elastic/detection-rules/blob/b9e8115c2fb55c328ea8e9830c96ce37d2f316c5/rules/linux/defense_evasion_interpreter_launched_from_decoded_payload.toml)
* [Unusual Base64 Encoding/Decoding Activity](https://github.com/elastic/detection-rules/blob/b9e8115c2fb55c328ea8e9830c96ce37d2f316c5/rules/linux/defense_evasion_base64_decoding_activity.toml)
* [Linux Payload Decoded and Decrypted via Built-in Utility](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/linux/defense_evasion_linux_payload_decoded_and_decrypted_via_built_in_utility.toml)

Additionally, the malware's binaries are packed with UPX, reducing their size and altering their signature to evade traditional malware detection. Once the malware unpacks in memory, this is detected through our general malware detections.

Continuing down the execution chain, the malware creates several hidden files and directories and modifies them using `chattr`:

* [File Permission Modification in Writable Directory](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/rules/linux/defense_evasion_file_mod_writable_dir.toml)
* [Creation of Hidden Files and Directories via CommandLine](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/rules/linux/defense_evasion_hidden_file_dir_tmp.toml)
* [File made Immutable by Chattr](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/rules/linux/defense_evasion_chattr_immutable_file.toml)
* [Chattr Execution from Unusual Parent](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/behavior/rules/linux/defense_evasion_chattr_execution_from_unusual_parent.toml)

We can further enhance detection through the following hunting query:

* [Hidden Process Execution](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/hunting/linux/queries/defense_evasion_via_hidden_process_execution.toml)


### TA006: Credential Access

OUTLAW maintains persistent access to a compromised system by manipulating credentials. Following successful SSH brute-force authentication, the malware replaces the existing SSH authorized_keys file with a new version containing a malicious SSH public key, thereby granting persistent access. This is detected through the following signals:



* [SSH Authorized Keys File Modification](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/cross-platform/persistence_ssh_authorized_keys_modification.toml)
* [SSH Authorized Keys File Deletion](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/defense_evasion_authorized_keys_file_deletion.toml)

The malware then changes the user credentials for the authenticated account by entering a new password using the `passwd` utility:

* [Linux User Account Credential Modification](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/persistence_user_credential_modification_via_echo.toml)


### TA007: Discovery

OUTLAW gathers system information upon successful infection to profile the compromised environment. The malware executes various commands to collect details about the system’s CPU, user privileges, operating system, memory usage, and available binaries. This reconnaissance step helps the attacker assess the system’s capabilities and determine how best to utilize the compromised machine. These are all detected through several [building block rules](https://www.elastic.co/guide/en/security/current/building-block-rule.html), as listed in our [rules_building_block directory](https://github.com/elastic/detection-rules/tree/main/rules_building_block). Below is a short list of the most important ones triggered by OUTLAW:

* [Linux System Information Discovery](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_linux_system_information_discovery.toml)
* [Process Discovery via Built-In Applications](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_process_discovery_via_builtin_tools.toml)
* [System Owner/User Discovery Linux](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_linux_system_owner_user_discovery.toml)
* [Account or Group Discovery via Built-In Tools](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_of_accounts_or_groups_via_builtin_tools.toml)
* [System Network Connections Discovery](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_system_network_connections.toml)

The default interface settings do not include building block rules due to their relatively high noise levels. However, these rules can be enabled to assist in the identification of potential threats.


### TA008: Lateral Movement

OUTLAW malware spreads through a compromised network by carrying out internal SSH brute-force attacks. We can identify this behavior through the following ES|QL rules:

* [Potential Port Scanning Activity from Compromised Host](https://github.com/elastic/detection-rules/blob/e28512a32fc643651a6bc91444e460ca8f5164be/rules/linux/discovery_port_scanning_activity_from_compromised_host.toml)
* [Potential Subnet Scanning Activity from Compromised Host](https://github.com/elastic/detection-rules/blob/e28512a32fc643651a6bc91444e460ca8f5164be/rules/linux/discovery_subnet_scanning_activity_from_compromised_host.toml)

Once a system is successfully brute-forced, the malware package, `dota3.tar.gz`, is deployed from the infected host to the new target. The local subnet is then scanned for additional targets to ensure the malware's continued propagation.

Elastic pre-built detection rules can identify these lateral movement attempts:

* [Potential Internal Linux SSH Brute Force Detected](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules/linux/credential_access_potential_linux_ssh_bruteforce_internal.toml)
* [Remote File Creation in World Writeable Directory](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/lateral_movement_remote_file_creation_world_writeable_dir.toml)
* [Unusual Remote File Creation](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/lateral_movement_unusual_remote_file_creation.toml)

Additionally, upon copying the OUTLAW malware to a remote host, malware prevention alerts kick in.

### TA009: Collection & TA010: Exfiltration

OUTLAW collects basic system information, credentials, and SSH details from compromised machines, primarily for tracking infected hosts and facilitating further attacks. This data is stored in a simple text file before being uploaded to a C2 server. Since this collection activity is limited to gathering system details and writing them to a file, it is not inherently suspicious on its own.

Exfiltration occurs when OUTLAW initiates an outbound SSH connection via sftp-server to transfer the collected information to a predefined C2 server. While this may resemble normal SSH activity, we can detect suspicious execution of file transfer utilities through ES|QL:

* [Unusual File Transfer Utility Launched](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/exfiltration_unusual_file_transfer_utility_launched.toml)


### TA011: Command and Control

OUTLAW maintains communication with its C2 infrastructure through multiple channels, allowing attackers to issue commands, exfiltrate data, and manage infected systems. We can detect several of the utilities used by the malware through the following rules:

* [Socat Reverse Shell or Listener Activity](https://github.com/elastic/protections-artifacts/blob/fbebc6f98eb1070bd96235ea432158756b3f2038/behavior/rules/linux/execution_socat_reverse_shell_or_listener_activity.toml)
* [High Number of Egress Network Connections from Unusual Executable](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/command_and_control_frequent_egress_netcon_from_sus_executable.toml)
* [Suspicious Network Activity to the Internet by Previously Unknown Executable](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/command_and_control_suspicious_network_activity_from_unknown_executable.toml).

The same hunting queries that were relevant for detecting the malware’s initial access attempts, can also be used to hunt for this C2 activity. Additionally, the following hunting queries can be used:

* [Low Volume External Network Connections from Process by Unique Agent](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/hunting/linux/queries/low_volume_external_network_connections_from_process.toml)
* [Unusual File Downloads from Source Addresses](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/hunting/linux/queries/command_and_control_via_unusual_file_downloads_from_source_addresses.toml)
* [Excessive SSH Network Activity to Unique Destinations](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/hunting/linux/queries/excessive_ssh_network_activity_unique_destinations.toml)


### TA040: Impact

OUTLAW impacts infected systems by consuming CPU resources for cryptocurrency mining and performing SSH brute-force attacks to propagate. Several CPU and memory optimizations are attempted before launching the modified XMRIG mining software, including enabling MSR write access and setting kernel parameters such as hugepages. These modifications can be detected through the following rules:



* [Suspicious Kernel Feature Activity](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/linux/defense_evasion_suspicious_kernel_feature_activity.toml)
* [MSR Write Access Enabled](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/linux/impact_msr_write_access_enabled.toml)

As OUTLAW attempts to enable MSR write access via modprobe but lacks the required permissions, kernel driver-related rules are triggered:



* [Kernel Driver Load by Non-Root User](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules/linux/persistence_kernel_driver_load_by_non_root.toml)
* [Kernel Driver Load](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules/linux/persistence_kernel_driver_load.toml)

These rules directly monitor for `init_module()` and `finit_module()` syscalls, through [Auditd](https://www.elastic.co/guide/en/integrations/current/auditd.html). For more information on how to set up the [Auditd Manager integration](https://www.elastic.co/guide/en/integrations/current/auditd_manager.html) to capture driver events and much more, check out the [Linux Detection Engineering with Auditd](https://www.elastic.co/security-labs/linux-detection-engineering-with-auditd) publication.

Simultaneously, SSH brute-force attempts are launched from the infected host, triggering:

* [Potential Malware-Driven SSH Brute Force Attempt](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/impact_potential_bruteforce_malware_infection.toml)

Throughout its execution, OUTLAW runs kill scripts to terminate competing malware or leftover processes from previous infections. This behavior triggers:

* [Kill Command Executed](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/defense_evasion_kill_command_executed.toml)
* [Kill Command Executed from Binary in Unusual Location](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/cross-platform/execution_kill_command_executed_from_binary_in_unusual_location.toml)
* [Kill Command Executed from a Hidden Process](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/cross-platform/defense_evasion_kill_command_executed_from_a_hidden_process.toml)


## Indicators of Compromise (IOCs)

The complete set of indicators can be found as a bundle on [Github](https://github.com/elastic/labs-releases/tree/main/indicators/outlaw).


#### Yara Signatures
```yara
rule Linux_Hacktool_Outlaw_cf069e73 {
    meta:
        author = "Elastic Security"
        description = "OUTLAW SSH bruteforce component fom the Dota3 package"
        reference_sample = "c3efbd6b5e512e36123f7b24da9d83f11fffaf3023d5677d37731ebaa959dd27"
      
    strings:
        $ssh_key_1 = "MIIJrTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQI8vKBZRGKsHoCAggA"
        $ssh_key_2 = "MAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAECBBBC3juWsJ7DsDd2wH2XI+vUBIIJ"
        $ssh_key_3 = "UCQ2viiVV8pk3QSUOiwionAoe4j4cBP3Ly4TQmpbLge9zRfYEUVe4LmlytlidI7H"
        $ssh_key_4 = "O+bWbjqkvRXT9g/SELQofRrjw/W2ZqXuWUjhuI9Ruq0qYKxCgG2DR3AcqlmOv54g"
        $path_1 = "/home/eax/up"
        $path_2 = "/var/tmp/dota"
        $path_3 = "/dev/shm/ip"
        $path_4 = "/dev/shm/p"
        $path_5 = "/var/tmp/.systemcache"
        $cmd_1 = "cat /proc/cpuinfo | grep name | head -n 1 | awk '{print $4,$5,$6,$7,$8,$9;}'"
        $cmd_2 = "cd ~; chattr -ia .ssh; lockr -ia .ssh"
        $cmd_3 = "sort -R b | awk '{ if ( NF == 2 ) print } '> p || cat b | awk '{ if ( NF == 2 ) print } '> p; sort -R a"
        $cmd_4 = "rm -rf /var/tmp/dota*"
        $cmd_5 = "rm -rf a b c d p ip ab.tar.gz"
    condition:
        (all of ($ssh_key*)) or (3 of ($path*) and 3 of ($cmd*))
}
```

#### SIEM and Endpoint Rules Overview by MITRE ATT&CK Tactic

| Technique ID | Description |
|-------------|-------------|
| **TA001: Initial Access** | [Potential External Linux SSH Brute Force Detected](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/linux/credential_access_potential_linux_ssh_bruteforce_external.toml) <br /> [Potential Successful SSH Brute Force Attack](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/linux/credential_access_potential_successful_linux_ssh_bruteforce.toml) <br /> [Successful SSH Authentication from Unusual SSH Public Key](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_first_time_public_key_authentication.toml) <br />        [Successful SSH Authentication from Unusual User](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_successful_ssh_authentication_by_unusual_user.toml) <br /> [Successful SSH Authentication from Unusual IP Address](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/initial_access_successful_ssh_authentication_by_unusual_ip.toml) |
| **TA002: Execution** | [File Downloaded from Suspicious Source by Web Server](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/behavior/rules/linux/persistence_file_downloaded_from_suspicious_source_by_web_server.toml) <br /> [Linux.Trojan.Pornoasset](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/yara/rules/Linux_Trojan_Pornoasset.yar) <br /> [Script Executed Through Unusual Parent Process](https://github.com/elastic/protections-artifacts/blob/1c9c6c33c20294422cfefb53c3f1f596bf308c7a/behavior/rules/linux/execution_script_executed_through_unusual_parent_process.toml) <br /> [Suspicious System Commands Executed by Previously Unknown Executable](https://github.com/elastic/detection-rules/blob/692a1382bf119c4b95e482fd6f64302528b0d813/rules/linux/execution_suspicious_executable_running_system_commands.toml) |
| **TA003: Persistence** | [Cron Job Created or Modified](https://github.com/elastic/detection-rules/blob/main/rules/linux/persistence_cron_job_creation.toml) <br /> [SSH Authorized Keys File Modification](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/cross-platform/persistence_ssh_authorized_keys_modification.toml) <br /> [Potential Persistence via File Modification](https://github.com/elastic/detection-rules/blob/main/rules/integrations/fim/persistence_suspicious_file_modifications.toml) |
| **TA005: Defense Evasion** | [Base64 Decoded Payload Piped to Interpreter](https://github.com/elastic/detection-rules/blob/b9e8115c2fb55c328ea8e9830c96ce37d2f316c5/rules/linux/defense_evasion_interpreter_launched_from_decoded_payload.toml) <br /> [Unusual Base64 Encoding/Decoding Activity](https://github.com/elastic/detection-rules/blob/b9e8115c2fb55c328ea8e9830c96ce37d2f316c5/rules/linux/defense_evasion_base64_decoding_activity.toml) |
| **TA006: Credential Access** | [SSH Authorized Keys File Modification](https://github.com/elastic/detection-rules/blob/bd62867465d6144783ce23d571083a7e982b6251/rules/cross-platform/persistence_ssh_authorized_keys_modification.toml) <br /> [SSH Authorized Keys File Deletion](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/defense_evasion_authorized_keys_file_deletion.toml) <br /> [Linux User Account Credential Modification](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/persistence_user_credential_modification_via_echo.toml) |
| **TA007: Discovery** | [Linux System Information Discovery](https://github.com/elastic/detection-rules/blob/0b98462cfe3499ed560f4bd0e97090533cf8a64d/rules_building_block/discovery_linux_system_information_discovery.toml) |
| **TA008: Lateral Movement** | [Potential Port Scanning Activity from Compromised Host](https://github.com/elastic/detection-rules/blob/e28512a32fc643651a6bc91444e460ca8f5164be/rules/linux/discovery_port_scanning_activity_from_compromised_host.toml) |
| **TA009 & TA010: Collection & Exfiltration** | [Unusual File Transfer Utility Launched](https://github.com/elastic/detection-rules/blob/467034ee5b97902421c24c94107e517b15db4062/rules/linux/exfiltration_unusual_file_transfer_utility_launched.toml) |
| **TA011: Command and Control** | [Socat Reverse Shell or Listener Activity](https://github.com/elastic/protections-artifacts/blob/fbebc6f98eb1070bd96235ea432158756b3f2038/behavior/rules/linux/execution_socat_reverse_shell_or_listener_activity.toml) |
| **TA040: Impact** | [Suspicious Kernel Feature Activity](https://github.com/elastic/protections-artifacts/blob/3fac07906582ca9615d0e291a4629445fd5ca37b/behavior/rules/linux/defense_evasion_suspicious_kernel_feature_activity.toml) |


## Conclusion

OUTLAW exemplifies how even unsophisticated malware can persist and scale effectively in modern environments. Despite lacking advanced evasion techniques, its combination of SSH brute-force attacks, self-replication, and modular components allows it to maintain a long-running botnet. OUTLAW ensures continuous expansion with minimal attacker intervention by leveraging compromised hosts to propagate infections further.

Our honeypot experiment provided a rare glimpse into the attacker's real-world behavior, confirming that while much of OUTLAW’s operation is automated, there are moments of direct human interaction. The ability to observe manual commands, reconnaissance attempts, and even simple typographical errors highlights an often-overlooked aspect of botnet maintenance—operator-driven quality control. These insights reinforce the need for detection strategies that account not just for automated attacks but also for manual post-compromise activity.

By understanding how OUTLAW operates, spreads, and monetizes infections, defenders can develop robust detection strategies to mitigate its impact. This report provides actionable SIEM rules, threat-hunting queries, and forensic insights, enabling security teams to stay ahead of similar evolving threats.


## References

[1] CounterCraft, [DOTA3 Malware Again and Again](https://www.countercraftsec.com/blog/dota3-malware-again-and-again/)

[2] Juniper Networks, [DOTA3: Is Your Internet of Things Device Moonlighting?](https://blogs.juniper.net/en-us/threat-research/dota3-is-your-internet-of-things-device-moonlighting)

[3] SANS ISC, [Hygiene Hygiene Hygiene](https://isc.sans.edu/diary/Hygiene+Hygiene+Hygiene+Guest+Diary/31260)

[4] Darktrace, [Outlaw Returns: Uncovering Returning Features and New Tactics](https://darktrace.com/blog/outlaw-returns-uncovering-returning-features-and-new-tactics)
