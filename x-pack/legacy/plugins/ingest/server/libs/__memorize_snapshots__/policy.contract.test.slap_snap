
exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "81a28d50-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib create should create a new policy - get - "81a28d50-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "81a28d50-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8253b4e0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-2",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "82e8f000-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-3",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "83846cb0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-4",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "8253b4e0-db19-11e9-a487-5f6358861e5b",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-2",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "82e8f000-db19-11e9-a487-5f6358861e5b",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-3",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "83846cb0-db19-11e9-a487-5f6358861e5b",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-4",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "84267910-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-5",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get - "84267910-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "84267910-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "84bd13c0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-5",
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "85f4d070-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-6",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "86909b40-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-7",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": [
    {
      "id": "84bd13c0-db19-11e9-a487-5f6358861e5b",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-5",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "85f4d070-db19-11e9-a487-5f6358861e5b",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-6",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "86909b40-db19-11e9-a487-5f6358861e5b",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-7",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "87360300-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-8",
    "version": 0
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "87360300-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "87360300-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "87cb3e20-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-8",
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "87cb3e20-db19-11e9-a487-5f6358861e5b" (6)'] = {
  "results": {
    "id": "87cb3e20-db19-11e9-a487-5f6358861e5b",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "87360300-db19-11e9-a487-5f6358861e5b" (7)'] = {
  "results": {
    "id": "87360300-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019 16:10:32 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "891a7a70-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-9",
    "version": 0
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "891a7a70-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "891a7a70-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "89b3fb50-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-9",
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "89b3fb50-db19-11e9-a487-5f6358861e5b",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "891a7a70-db19-11e9-a487-5f6358861e5b",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 16:10:35 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8aef1360-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-10",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "8aef1360-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "8aef1360-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "8b8734b0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-10",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "8aef1360-db19-11e9-a487-5f6358861e5b" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "8b8734b0-db19-11e9-a487-5f6358861e5b",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8d5b5870-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-11",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "8d5b5870-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "8d5b5870-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "8df48b30-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-11",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "8df48b30-db19-11e9-a487-5f6358861e5b",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "8d5b5870-db19-11e9-a487-5f6358861e5b",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 16:10:42 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "8df48b30-db19-11e9-a487-5f6358861e5b" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "8d5b5870-db19-11e9-a487-5f6358861e5b" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": []
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9061e1b0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "9061e1b0-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "9061e1b0-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "90fe48c0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "90fe48c0-db19-11e9-a487-5f6358861e5b",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "9061e1b0-db19-11e9-a487-5f6358861e5b",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-12",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "90fe48c0-db19-11e9-a487-5f6358861e5b",
      "name": "foo",
      "description": "description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-13",
      "version": 0,
      "agent_version": "8.0.0",
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson",
      "data_sources": []
    }
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9238c490-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-14",
    "version": 0
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "9238c490-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "9238c490-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [{"other":"{}","data_source_id":"uuid-15"},{"other":"{}","data_source_id":"uuid-15"}] (4)'] = {
  "results": [
    "92d049a0-db19-11e9-a487-5f6358861e5b",
    "9368b910-db19-11e9-a487-5f6358861e5b"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "94074300-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-14",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "94074300-db19-11e9-a487-5f6358861e5b" (7)'] = {
  "results": {
    "id": "94074300-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "92d049a0-db19-11e9-a487-5f6358861e5b",
          "9368b910-db19-11e9-a487-5f6358861e5b"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "95420cf0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-16",
    "version": 0
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "95420cf0-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "95420cf0-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [{"other":"{}","data_source_id":"uuid-17"},{"other":"{}","data_source_id":"uuid-17"}] (4)'] = {
  "results": [
    "95db18a0-db19-11e9-a487-5f6358861e5b",
    "9672ebd0-db19-11e9-a487-5f6358861e5b"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "97106450-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-16",
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "97106450-db19-11e9-a487-5f6358861e5b" (7)'] = {
  "results": {
    "id": "97106450-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "95db18a0-db19-11e9-a487-5f6358861e5b",
          "9672ebd0-db19-11e9-a487-5f6358861e5b"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "97106450-db19-11e9-a487-5f6358861e5b" (8)'] = {
  "results": {
    "id": "97106450-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "95db18a0-db19-11e9-a487-5f6358861e5b",
          "9672ebd0-db19-11e9-a487-5f6358861e5b"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "9848bd40-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-16",
    "version": 2
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "9848bd40-db19-11e9-a487-5f6358861e5b" (11)'] = {
  "results": {
    "id": "9848bd40-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571515795215
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "99850dd0-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-18",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "99850dd0-db19-11e9-a487-5f6358861e5b" (3)'] = {
  "results": {
    "id": "99850dd0-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-19"}] (4)'] = {
  "results": [
    "9a1ba880-db19-11e9-a487-5f6358861e5b"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "9abb9200-db19-11e9-a487-5f6358861e5b",
    "shared_id": "shared-uuid-18",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "9abb9200-db19-11e9-a487-5f6358861e5b" (7)'] = {
  "results": {
    "id": "9abb9200-db19-11e9-a487-5f6358861e5b",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "9a1ba880-db19-11e9-a487-5f6358861e5b"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0fe369c0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib create should create a new policy - get - "0fe369c0-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "0fe369c0-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1095c9d0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-2",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "112adde0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-3",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "11c5e560-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-4",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "1095c9d0-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-2",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "112adde0-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-3",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "11c5e560-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-4",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "12666b20-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-5",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get - "12666b20-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "12666b20-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "12fe3e50-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-5",
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "1437a8b0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-6",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "14d2d740-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-7",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": [
    {
      "id": "12fe3e50-db1c-11e9-b169-e5b8e36f8fed",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-5",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "1437a8b0-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-6",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "14d2d740-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-7",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "15724b90-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-8",
    "version": 0
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "15724b90-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "15724b90-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "160b0920-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-8",
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "160b0920-db1c-11e9-b169-e5b8e36f8fed" (6)'] = {
  "results": {
    "id": "160b0920-db1c-11e9-b169-e5b8e36f8fed",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "15724b90-db1c-11e9-b169-e5b8e36f8fed" (7)'] = {
  "results": {
    "id": "15724b90-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019 16:28:49 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "17492e70-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-9",
    "version": 0
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "17492e70-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "17492e70-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "17e03e50-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-9",
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "17e03e50-db1c-11e9-b169-e5b8e36f8fed",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "17492e70-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 16:28:52 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "191d0410-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-10",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "191d0410-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "191d0410-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "19b43b00-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-10",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "191d0410-db1c-11e9-b169-e5b8e36f8fed" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "19b43b00-db1c-11e9-b169-e5b8e36f8fed",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1b8acfc0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-11",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "1b8acfc0-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "1b8acfc0-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "1c216a70-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-11",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "1c216a70-db1c-11e9-b169-e5b8e36f8fed",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "1b8acfc0-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 16:28:59 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "1c216a70-db1c-11e9-b169-e5b8e36f8fed" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "1b8acfc0-db1c-11e9-b169-e5b8e36f8fed" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": []
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1e924360-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "1e924360-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "1e924360-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "1f2fe2f0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "1f2fe2f0-db1c-11e9-b169-e5b8e36f8fed",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "1e924360-db1c-11e9-b169-e5b8e36f8fed",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-12",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "1f2fe2f0-db1c-11e9-b169-e5b8e36f8fed",
      "name": "foo",
      "description": "description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-13",
      "version": 0,
      "agent_version": "8.0.0",
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson",
      "data_sources": []
    }
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "207f4650-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-14",
    "version": 0
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "207f4650-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "207f4650-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [{"other":"{}","data_source_id":"uuid-15"},{"other":"{}","data_source_id":"uuid-15"}] (4)'] = {
  "results": [
    "21119b40-db1c-11e9-b169-e5b8e36f8fed",
    "21b50730-db1c-11e9-b169-e5b8e36f8fed"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "22558cf0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-14",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "22558cf0-db1c-11e9-b169-e5b8e36f8fed" (7)'] = {
  "results": {
    "id": "22558cf0-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "21119b40-db1c-11e9-b169-e5b8e36f8fed",
          "21b50730-db1c-11e9-b169-e5b8e36f8fed"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2393d950-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-16",
    "version": 0
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2393d950-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "2393d950-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [{"other":"{}","data_source_id":"uuid-17"},{"other":"{}","data_source_id":"uuid-17"}] (4)'] = {
  "results": [
    "242a4cf0-db1c-11e9-b169-e5b8e36f8fed",
    "24c26e40-db1c-11e9-b169-e5b8e36f8fed"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "25608300-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-16",
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "25608300-db1c-11e9-b169-e5b8e36f8fed" (7)'] = {
  "results": {
    "id": "25608300-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "242a4cf0-db1c-11e9-b169-e5b8e36f8fed",
          "24c26e40-db1c-11e9-b169-e5b8e36f8fed"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "25608300-db1c-11e9-b169-e5b8e36f8fed" (8)'] = {
  "results": {
    "id": "25608300-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "242a4cf0-db1c-11e9-b169-e5b8e36f8fed",
          "24c26e40-db1c-11e9-b169-e5b8e36f8fed"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "2698dbf0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-16",
    "version": 2
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2698dbf0-db1c-11e9-b169-e5b8e36f8fed" (11)'] = {
  "results": {
    "id": "2698dbf0-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571516898683
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "27d3f400-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-18",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "27d3f400-db1c-11e9-b169-e5b8e36f8fed" (3)'] = {
  "results": {
    "id": "27d3f400-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-19"}] (4)'] = {
  "results": [
    "286c1550-db1c-11e9-b169-e5b8e36f8fed"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "2906a7a0-db1c-11e9-b169-e5b8e36f8fed",
    "shared_id": "shared-uuid-18",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "2906a7a0-db1c-11e9-b169-e5b8e36f8fed" (7)'] = {
  "results": {
    "id": "2906a7a0-db1c-11e9-b169-e5b8e36f8fed",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "286c1550-db1c-11e9-b169-e5b8e36f8fed"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["286c1550-db1c-11e9-b169-e5b8e36f8fed"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517038427
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "63035200-db1c-11e9-9963-aba8c56ebf02",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "63035200-db1c-11e9-9963-aba8c56ebf02" (3)'] = {
  "results": {
    "id": "63035200-db1c-11e9-9963-aba8c56ebf02",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "63c43100-db1c-11e9-9963-aba8c56ebf02"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "646e2ca0-db1c-11e9-9963-aba8c56ebf02",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "646e2ca0-db1c-11e9-9963-aba8c56ebf02" (7)'] = {
  "results": {
    "id": "646e2ca0-db1c-11e9-9963-aba8c56ebf02",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "63c43100-db1c-11e9-9963-aba8c56ebf02"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["63c43100-db1c-11e9-9963-aba8c56ebf02"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517155173
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a805f240-db1c-11e9-bcba-11b2c537a0d1",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "a805f240-db1c-11e9-bcba-11b2c537a0d1" (3)'] = {
  "results": {
    "id": "a805f240-db1c-11e9-bcba-11b2c537a0d1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "a8bd5b60-db1c-11e9-bcba-11b2c537a0d1"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "a957edb0-db1c-11e9-bcba-11b2c537a0d1",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "a957edb0-db1c-11e9-bcba-11b2c537a0d1" (7)'] = {
  "results": {
    "id": "a957edb0-db1c-11e9-bcba-11b2c537a0d1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a8bd5b60-db1c-11e9-bcba-11b2c537a0d1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["a8bd5b60-db1c-11e9-bcba-11b2c537a0d1"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517619107
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "bccb5ed0-db1d-11e9-a55e-f7e31b1dad89",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "bccb5ed0-db1d-11e9-a55e-f7e31b1dad89" (3)'] = {
  "results": {
    "id": "bccb5ed0-db1d-11e9-a55e-f7e31b1dad89",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "bd8befb0-db1d-11e9-a55e-f7e31b1dad89"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "be2f82b0-db1d-11e9-a55e-f7e31b1dad89",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "be2f82b0-db1d-11e9-a55e-f7e31b1dad89" (7)'] = {
  "results": {
    "id": "be2f82b0-db1d-11e9-a55e-f7e31b1dad89",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "bd8befb0-db1d-11e9-a55e-f7e31b1dad89"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["bd8befb0-db1d-11e9-a55e-f7e31b1dad89"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517680810
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e2aaa700-db1d-11e9-8dc0-278f06df2e67",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e2aaa700-db1d-11e9-8dc0-278f06df2e67" (3)'] = {
  "results": {
    "id": "e2aaa700-db1d-11e9-8dc0-278f06df2e67",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "e2fb8620-db1d-11e9-8dc0-278f06df2e67"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "e3941ca0-db1d-11e9-8dc0-278f06df2e67",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e3941ca0-db1d-11e9-8dc0-278f06df2e67" (7)'] = {
  "results": {
    "id": "e3941ca0-db1d-11e9-8dc0-278f06df2e67",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e2fb8620-db1d-11e9-8dc0-278f06df2e67"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["e2fb8620-db1d-11e9-8dc0-278f06df2e67"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517772100
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "18444560-db1e-11e9-a6b0-5fbc67e25f16",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "18444560-db1e-11e9-a6b0-5fbc67e25f16" (3)'] = {
  "results": {
    "id": "18444560-db1e-11e9-a6b0-5fbc67e25f16",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "18a79b10-db1e-11e9-a6b0-5fbc67e25f16"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "193e5cd0-db1e-11e9-a6b0-5fbc67e25f16",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "193e5cd0-db1e-11e9-a6b0-5fbc67e25f16" (7)'] = {
  "results": {
    "id": "193e5cd0-db1e-11e9-a6b0-5fbc67e25f16",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "18a79b10-db1e-11e9-a6b0-5fbc67e25f16"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["18a79b10-db1e-11e9-a6b0-5fbc67e25f16"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571517909137
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "69ad2ed0-db1e-11e9-bb16-91b6542ae719",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "69ad2ed0-db1e-11e9-bb16-91b6542ae719" (3)'] = {
  "results": {
    "id": "69ad2ed0-db1e-11e9-bb16-91b6542ae719",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "6a7a42d0-db1e-11e9-bb16-91b6542ae719"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "6b132770-db1e-11e9-bb16-91b6542ae719",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "6b132770-db1e-11e9-bb16-91b6542ae719" (7)'] = {
  "results": {
    "id": "6b132770-db1e-11e9-bb16-91b6542ae719",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6a7a42d0-db1e-11e9-bb16-91b6542ae719"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["6a7a42d0-db1e-11e9-bb16-91b6542ae719"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518113816
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e44eebb0-db1e-11e9-bfb1-f3f1e5594de9",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e44eebb0-db1e-11e9-bfb1-f3f1e5594de9" (3)'] = {
  "results": {
    "id": "e44eebb0-db1e-11e9-bfb1-f3f1e5594de9",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "e52c2c50-db1e-11e9-bfb1-f3f1e5594de9"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "e5d6eb40-db1e-11e9-bfb1-f3f1e5594de9",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e5d6eb40-db1e-11e9-bfb1-f3f1e5594de9" (7)'] = {
  "results": {
    "id": "e5d6eb40-db1e-11e9-bfb1-f3f1e5594de9",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e52c2c50-db1e-11e9-bfb1-f3f1e5594de9"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["e52c2c50-db1e-11e9-bfb1-f3f1e5594de9"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518166651
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "03c5baf0-db1f-11e9-b419-dbcc7077d02e",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "03c5baf0-db1f-11e9-b419-dbcc7077d02e" (3)'] = {
  "results": {
    "id": "03c5baf0-db1f-11e9-b419-dbcc7077d02e",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "0482c960-db1f-11e9-b419-dbcc7077d02e"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "051c9860-db1f-11e9-b419-dbcc7077d02e",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "051c9860-db1f-11e9-b419-dbcc7077d02e" (7)'] = {
  "results": {
    "id": "051c9860-db1f-11e9-b419-dbcc7077d02e",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0482c960-db1f-11e9-b419-dbcc7077d02e"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["0482c960-db1f-11e9-b419-dbcc7077d02e"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518253941
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "3a3546f0-db1f-11e9-aff6-7585e8c01e0f",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "3a3546f0-db1f-11e9-aff6-7585e8c01e0f" (3)'] = {
  "results": {
    "id": "3a3546f0-db1f-11e9-aff6-7585e8c01e0f",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "3b01beb0-db1f-11e9-aff6-7585e8c01e0f"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "3b9a5530-db1f-11e9-aff6-7585e8c01e0f",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "3b9a5530-db1f-11e9-aff6-7585e8c01e0f" (7)'] = {
  "results": {
    "id": "3b9a5530-db1f-11e9-aff6-7585e8c01e0f",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3b01beb0-db1f-11e9-aff6-7585e8c01e0f"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["3b01beb0-db1f-11e9-aff6-7585e8c01e0f"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518374957
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "80866030-db1f-11e9-8a21-ddff8833845d",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "80866030-db1f-11e9-8a21-ddff8833845d" (3)'] = {
  "results": {
    "id": "80866030-db1f-11e9-8a21-ddff8833845d",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "8165c3b0-db1f-11e9-8a21-ddff8833845d"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "82018e80-db1f-11e9-8a21-ddff8833845d",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "82018e80-db1f-11e9-8a21-ddff8833845d" (7)'] = {
  "results": {
    "id": "82018e80-db1f-11e9-8a21-ddff8833845d",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "8165c3b0-db1f-11e9-8a21-ddff8833845d"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["8165c3b0-db1f-11e9-8a21-ddff8833845d"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518503365
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "cb5d76c0-db1f-11e9-aed7-d9b0d7ee8233",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "cb5d76c0-db1f-11e9-aed7-d9b0d7ee8233" (3)'] = {
  "results": {
    "id": "cb5d76c0-db1f-11e9-aed7-d9b0d7ee8233",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "cc218a10-db1f-11e9-aed7-d9b0d7ee8233"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "ccb9f980-db1f-11e9-aed7-d9b0d7ee8233",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "ccb9f980-db1f-11e9-aed7-d9b0d7ee8233" (7)'] = {
  "results": {
    "id": "ccb9f980-db1f-11e9-aed7-d9b0d7ee8233",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "cc218a10-db1f-11e9-aed7-d9b0d7ee8233"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["cc218a10-db1f-11e9-aed7-d9b0d7ee8233"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518627595
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "15fc1830-db20-11e9-99c6-fdc62d579d97",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "15fc1830-db20-11e9-99c6-fdc62d579d97" (3)'] = {
  "results": {
    "id": "15fc1830-db20-11e9-99c6-fdc62d579d97",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "16a80fa0-db20-11e9-99c6-fdc62d579d97"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "17411b50-db20-11e9-99c6-fdc62d579d97",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "17411b50-db20-11e9-99c6-fdc62d579d97" (7)'] = {
  "results": {
    "id": "17411b50-db20-11e9-99c6-fdc62d579d97",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "16a80fa0-db20-11e9-99c6-fdc62d579d97"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["16a80fa0-db20-11e9-99c6-fdc62d579d97"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518738365
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "57e48020-db20-11e9-b6c4-8bc7306be262",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "57e48020-db20-11e9-b6c4-8bc7306be262" (3)'] = {
  "results": {
    "id": "57e48020-db20-11e9-b6c4-8bc7306be262",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "58af9850-db20-11e9-b6c4-8bc7306be262"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "5949dc80-db20-11e9-b6c4-8bc7306be262",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "5949dc80-db20-11e9-b6c4-8bc7306be262" (7)'] = {
  "results": {
    "id": "5949dc80-db20-11e9-b6c4-8bc7306be262",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "58af9850-db20-11e9-b6c4-8bc7306be262"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["58af9850-db20-11e9-b6c4-8bc7306be262"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518801206
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "7d2390b0-db20-11e9-90f1-fb8626c8f696",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7d2390b0-db20-11e9-90f1-fb8626c8f696" (3)'] = {
  "results": {
    "id": "7d2390b0-db20-11e9-90f1-fb8626c8f696",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "7de002e0-db20-11e9-90f1-fb8626c8f696"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "7e7983c0-db20-11e9-90f1-fb8626c8f696",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7e7983c0-db20-11e9-90f1-fb8626c8f696" (7)'] = {
  "results": {
    "id": "7e7983c0-db20-11e9-90f1-fb8626c8f696",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "7de002e0-db20-11e9-90f1-fb8626c8f696"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["7de002e0-db20-11e9-90f1-fb8626c8f696"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571518899471
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b7917370-db20-11e9-b1ba-53bc48983d95",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "b7917370-db20-11e9-b1ba-53bc48983d95" (3)'] = {
  "results": {
    "id": "b7917370-db20-11e9-b1ba-53bc48983d95",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "b84b74a0-db20-11e9-b1ba-53bc48983d95"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "b8e98960-db20-11e9-b1ba-53bc48983d95",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "b8e98960-db20-11e9-b1ba-53bc48983d95" (7)'] = {
  "results": {
    "id": "b8e98960-db20-11e9-b1ba-53bc48983d95",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b84b74a0-db20-11e9-b1ba-53bc48983d95"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["b84b74a0-db20-11e9-b1ba-53bc48983d95"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519021419
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "00299680-db21-11e9-b9b9-71a6f55a67dd",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "00299680-db21-11e9-b9b9-71a6f55a67dd" (3)'] = {
  "results": {
    "id": "00299680-db21-11e9-b9b9-71a6f55a67dd",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "00f068f0-db21-11e9-b9b9-71a6f55a67dd"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "0189c2c0-db21-11e9-b9b9-71a6f55a67dd",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "0189c2c0-db21-11e9-b9b9-71a6f55a67dd" (7)'] = {
  "results": {
    "id": "0189c2c0-db21-11e9-b9b9-71a6f55a67dd",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "00f068f0-db21-11e9-b9b9-71a6f55a67dd"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["00f068f0-db21-11e9-b9b9-71a6f55a67dd"],"page":1,"perPage":10000} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-2"
    }
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519152001
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "4e70cd90-db21-11e9-a688-934083cc0040",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "4e70cd90-db21-11e9-a688-934083cc0040" (3)'] = {
  "results": {
    "id": "4e70cd90-db21-11e9-a688-934083cc0040",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "4f388a60-db21-11e9-a688-934083cc0040"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "4fd2f5a0-db21-11e9-a688-934083cc0040",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "4fd2f5a0-db21-11e9-a688-934083cc0040" (7)'] = {
  "results": {
    "id": "4fd2f5a0-db21-11e9-a688-934083cc0040",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "4f388a60-db21-11e9-a688-934083cc0040"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["4f388a60-db21-11e9-a688-934083cc0040"],"page":1,"perPage":10000} (8)'] = {
  "results": []
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519490587
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "17ee1240-db22-11e9-8ef7-454d4c989b18",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "17ee1240-db22-11e9-8ef7-454d4c989b18" (3)'] = {
  "results": {
    "id": "17ee1240-db22-11e9-8ef7-454d4c989b18",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "18ab95e0-db22-11e9-8ef7-454d4c989b18"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "1944efb0-db22-11e9-8ef7-454d4c989b18",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "1944efb0-db22-11e9-8ef7-454d4c989b18" (7)'] = {
  "results": {
    "id": "1944efb0-db22-11e9-8ef7-454d4c989b18",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "18ab95e0-db22-11e9-8ef7-454d4c989b18"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["18ab95e0-db22-11e9-8ef7-454d4c989b18"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-2"
    }
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519682994
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8ab576b0-db22-11e9-9714-03644f1efe82",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "8ab576b0-db22-11e9-9714-03644f1efe82" (3)'] = {
  "results": {
    "id": "8ab576b0-db22-11e9-9714-03644f1efe82",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [{"other":"{\"foo\":\"bar\"}","data_source_id":"uuid-2"}] (4)'] = {
  "results": [
    "8b754440-db22-11e9-9714-03644f1efe82"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "8c0e7700-db22-11e9-9714-03644f1efe82",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "8c0e7700-db22-11e9-9714-03644f1efe82" (7)'] = {
  "results": {
    "id": "8c0e7700-db22-11e9-9714-03644f1efe82",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "8b754440-db22-11e9-9714-03644f1efe82"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["8b754440-db22-11e9-9714-03644f1efe82"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-2"
    }
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519798557
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d00a7cb0-db22-11e9-bc08-8d46fab4eff1",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "d00a7cb0-db22-11e9-bc08-8d46fab4eff1" (3)'] = {
  "results": {
    "id": "d00a7cb0-db22-11e9-bc08-8d46fab4eff1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - ["uuid-2"] (4)'] = {
  "results": [
    "d0be3c50-db22-11e9-bc08-8d46fab4eff1"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "d16c56a0-db22-11e9-bc08-8d46fab4eff1",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "d16c56a0-db22-11e9-bc08-8d46fab4eff1" (7)'] = {
  "results": {
    "id": "d16c56a0-db22-11e9-bc08-8d46fab4eff1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "d0be3c50-db22-11e9-bc08-8d46fab4eff1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["d0be3c50-db22-11e9-bc08-8d46fab4eff1"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-2"
    }
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571519934400
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "20ed4630-db23-11e9-8940-29e60274b341",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "20ed4630-db23-11e9-8940-29e60274b341" (3)'] = {
  "results": {
    "id": "20ed4630-db23-11e9-8940-29e60274b341",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "21b9bdf0-db23-11e9-8940-29e60274b341"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "22542930-db23-11e9-8940-29e60274b341",
    "shared_id": "shared-uuid-1",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "22542930-db23-11e9-8940-29e60274b341" (7)'] = {
  "results": {
    "id": "22542930-db23-11e9-8940-29e60274b341",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-2",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "21b9bdf0-db23-11e9-8940-29e60274b341"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["21b9bdf0-db23-11e9-8940-29e60274b341"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-2"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "cad44cc0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-1",
    "version": 0
  }
}

exports['Policies Lib create should create a new policy - get - "cad44cc0-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "cad44cc0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "cb99e6b0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-2",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "cc31e0f0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-3",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "cccc4c30-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-4",
    "version": 0
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "cb99e6b0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-2",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "cc31e0f0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-3",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "cccc4c30-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-4",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "cd6d2010-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-5",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get - "cd6d2010-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "cd6d2010-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "ce045700-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-5",
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "cf392d80-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-6",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "cfd3e6e0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-7",
    "version": 0
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": [
    {
      "id": "ce045700-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-5",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "cf392d80-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test2",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-6",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "cfd3e6e0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test3",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-7",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d073a950-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-8",
    "version": 0
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "d073a950-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "d073a950-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "d10a1cf0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-8",
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "d10a1cf0-db23-11e9-9d24-fb3c1e67cbc1" (6)'] = {
  "results": {
    "id": "d10a1cf0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "d073a950-db23-11e9-9d24-fb3c1e67cbc1" (7)'] = {
  "results": {
    "id": "d073a950-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019 17:24:09 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d24757e0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-9",
    "version": 0
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "d24757e0-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "d24757e0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "d2fac960-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-9",
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "d2fac960-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "d24757e0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 17:24:13 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d43d8290-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-10",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "d43d8290-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "d43d8290-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "d4d57cd0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-10",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "d43d8290-db23-11e9-9d24-fb3c1e67cbc1" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "d4d57cd0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d6a84100-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-11",
    "version": 0
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "d6a84100-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "d6a84100-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "d7406250-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-11",
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "d7406250-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "d6a84100-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019 17:24:20 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "d7406250-db23-11e9-9d24-fb3c1e67cbc1" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "d6a84100-db23-11e9-9d24-fb3c1e67cbc1" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": []
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d9addfe0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "d9addfe0-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "d9addfe0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "da467660-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-12",
    "version": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "da467660-db23-11e9-9d24-fb3c1e67cbc1",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "d9addfe0-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "test",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-12",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson"
    },
    {
      "id": "da467660-db23-11e9-9d24-fb3c1e67cbc1",
      "name": "foo",
      "description": "description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-13",
      "version": 0,
      "agent_version": "8.0.0",
      "created_on": "Thu Sep 19 2019",
      "created_by": "mattapperson",
      "updated_on": "Thu Sep 19 2019",
      "updated_by": "mattapperson",
      "data_sources": []
    }
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "db811940-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-14",
    "version": 0
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "db811940-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "db811940-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "dc178ce0-db23-11e9-9d24-fb3c1e67cbc1",
    "dcafae30-db23-11e9-9d24-fb3c1e67cbc1"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "dd4e8640-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-14",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "dd4e8640-db23-11e9-9d24-fb3c1e67cbc1" (7)'] = {
  "results": {
    "id": "dd4e8640-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "dc178ce0-db23-11e9-9d24-fb3c1e67cbc1",
          "dcafae30-db23-11e9-9d24-fb3c1e67cbc1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "de8bc130-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-16",
    "version": 0
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "de8bc130-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "de8bc130-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "df2234d0-db23-11e9-9d24-fb3c1e67cbc1",
    "dfba5620-db23-11e9-9d24-fb3c1e67cbc1"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "e057f5b0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-16",
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "e057f5b0-db23-11e9-9d24-fb3c1e67cbc1" (7)'] = {
  "results": {
    "id": "e057f5b0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "df2234d0-db23-11e9-9d24-fb3c1e67cbc1",
          "dfba5620-db23-11e9-9d24-fb3c1e67cbc1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "e057f5b0-db23-11e9-9d24-fb3c1e67cbc1" (8)'] = {
  "results": {
    "id": "e057f5b0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "df2234d0-db23-11e9-9d24-fb3c1e67cbc1",
          "dfba5620-db23-11e9-9d24-fb3c1e67cbc1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "e1909cc0-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-16",
    "version": 2
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "e1909cc0-db23-11e9-9d24-fb3c1e67cbc1" (11)'] = {
  "results": {
    "id": "e1909cc0-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571520038171
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e2ca0720-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-18",
    "version": 0
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e2ca0720-db23-11e9-9d24-fb3c1e67cbc1" (3)'] = {
  "results": {
    "id": "e2ca0720-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "e3620160-db23-11e9-9d24-fb3c1e67cbc1"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "e3fc4590-db23-11e9-9d24-fb3c1e67cbc1",
    "shared_id": "shared-uuid-18",
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "e3fc4590-db23-11e9-9d24-fb3c1e67cbc1" (7)'] = {
  "results": {
    "id": "e3fc4590-db23-11e9-9d24-fb3c1e67cbc1",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e3620160-db23-11e9-9d24-fb3c1e67cbc1"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "Thu Sep 19 2019",
    "created_by": "mattapperson",
    "updated_on": "Thu Sep 19 2019",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["e3620160-db23-11e9-9d24-fb3c1e67cbc1"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8db38b80-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:14:57.839Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:14:57.839Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "8db38b80-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "8db38b80-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:14:57.839Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:14:57.839Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8e6c7b40-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:14:59.054Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:14:59.054Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "8f014130-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:00.029Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:00.029Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "8f9c6fc0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:01.045Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:01.045Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "8e6c7b40-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:14:59.054Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:14:59.054Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "8f014130-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:00.029Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:00.029Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "8f9c6fc0-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:01.045Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:01.045Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "903eca40-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:02.110Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:02.110Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "903eca40-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "903eca40-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:02.110Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:02.110Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "90d564f0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:02.110Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:02.110Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "920bc210-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:05.130Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:05.130Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "92a7db00-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:06.154Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:06.154Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "90d564f0-dbd2-11e9-b79c-9d68546b66f0",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:02.110Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:02.110Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "920bc210-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:05.130Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:05.130Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "92a7db00-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:06.154Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:06.154Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9349e760-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:07.215Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:07.215Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "9349e760-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "9349e760-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:07.215Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:07.215Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "93f6f040-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:07.215Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:07.215Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "93f6f040-dbd2-11e9-b79c-9d68546b66f0" (6)'] = {
  "results": {
    "id": "93f6f040-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:07.215Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:07.215Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "9349e760-dbd2-11e9-b79c-9d68546b66f0" (7)'] = {
  "results": {
    "id": "9349e760-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:07.215Z",
    "created_by": "mattapperson",
    "updated_on": "Fri Sep 20 2019 14:15:09 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "95353ca0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:10.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:10.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "95353ca0-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "95353ca0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:10.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:10.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "95cb1400-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:10.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:10.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "95cb1400-dbd2-11e9-b79c-9d68546b66f0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-20T18:15:10.436Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-20T18:15:10.436Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "95353ca0-dbd2-11e9-b79c-9d68546b66f0",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-20T18:15:10.436Z",
      "created_by": "mattapperson",
      "updated_on": "Fri Sep 20 2019 14:15:12 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "97062c10-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:13.482Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:13.482Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "97062c10-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "97062c10-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:13.482Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:13.482Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "979c2a80-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:13.482Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:13.482Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "97062c10-dbd2-11e9-b79c-9d68546b66f0" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "979c2a80-dbd2-11e9-b79c-9d68546b66f0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-20T18:15:13.482Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-20T18:15:13.482Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "99735b80-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:17.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:17.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "99735b80-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "99735b80-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:17.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:17.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "9a07ac40-dbd2-11e9-b79c-9d68546b66f0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:17.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:17.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "9a07ac40-dbd2-11e9-b79c-9d68546b66f0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-20T18:15:17.551Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-20T18:15:17.551Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "99735b80-dbd2-11e9-b79c-9d68546b66f0",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-20T18:15:17.551Z",
      "created_by": "mattapperson",
      "updated_on": "Fri Sep 20 2019 14:15:19 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "9a07ac40-dbd2-11e9-b79c-9d68546b66f0" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "99735b80-dbd2-11e9-b79c-9d68546b66f0" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9c7bb980-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:22.641Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:22.641Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "9c7bb980-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "9c7bb980-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:22.641Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:22.641Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "9d145000-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-20T18:15:22.641Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:22.641Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "9d145000-dbd2-11e9-b79c-9d68546b66f0",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "9c7bb980-dbd2-11e9-b79c-9d68546b66f0",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-20T18:15:22.641Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:22.641Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "9d145000-dbd2-11e9-b79c-9d68546b66f0",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-20T18:15:22.641Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-20T18:15:22.641Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9e518af0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:25.720Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:25.720Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "9e518af0-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "9e518af0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:25.720Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:25.720Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "9ee76250-dbd2-11e9-b79c-9d68546b66f0",
    "9f7e4b20-dbd2-11e9-b79c-9d68546b66f0"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "a01dbf70-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "9ee76250-dbd2-11e9-b79c-9d68546b66f0",
          "9f7e4b20-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:25.720Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:25.720Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "a01dbf70-dbd2-11e9-b79c-9d68546b66f0" (7)'] = {
  "results": {
    "id": "a01dbf70-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "9ee76250-dbd2-11e9-b79c-9d68546b66f0",
          "9f7e4b20-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:25.720Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:25.720Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a15a8530-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "a15a8530-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "a15a8530-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "a1f31bb0-dbd2-11e9-b79c-9d68546b66f0",
    "a28a0480-dbd2-11e9-b79c-9d68546b66f0"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "a3277d00-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a1f31bb0-dbd2-11e9-b79c-9d68546b66f0",
          "a28a0480-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "a3277d00-dbd2-11e9-b79c-9d68546b66f0" (7)'] = {
  "results": {
    "id": "a3277d00-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a1f31bb0-dbd2-11e9-b79c-9d68546b66f0",
          "a28a0480-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "a3277d00-dbd2-11e9-b79c-9d68546b66f0" (8)'] = {
  "results": {
    "id": "a3277d00-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a1f31bb0-dbd2-11e9-b79c-9d68546b66f0",
          "a28a0480-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "a461aab0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "a461aab0-dbd2-11e9-b79c-9d68546b66f0" (11)'] = {
  "results": {
    "id": "a461aab0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:30.807Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:30.807Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571595264018
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a59d8610-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:37.962Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:37.963Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "a59d8610-dbd2-11e9-b79c-9d68546b66f0" (3)'] = {
  "results": {
    "id": "a59d8610-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-20T18:15:37.962Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:37.963Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "a6346ee0-dbd2-11e9-b79c-9d68546b66f0"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "a6cda1a0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a6346ee0-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:37.962Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:37.963Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "a6cda1a0-dbd2-11e9-b79c-9d68546b66f0" (7)'] = {
  "results": {
    "id": "a6cda1a0-dbd2-11e9-b79c-9d68546b66f0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "a6346ee0-dbd2-11e9-b79c-9d68546b66f0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-20T18:15:37.962Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-20T18:15:37.963Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["a6346ee0-dbd2-11e9-b79c-9d68546b66f0"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:29.346Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:29.346Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "d50fc790-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:29.346Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:29.346Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:29.296Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:25:29.296Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (2)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.296Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:25:29.296Z",
        "updated_by": "kibana"
      },
      {
        "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-1",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.346Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:29.346Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 2
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d5865720-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:30.124Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:30.124Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "d61b1d10-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:31.100Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:31.100Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "d6b699c0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:32.118Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:32.118Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.296Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:25:29.296Z",
        "updated_by": "kibana"
      },
      {
        "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-1",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.346Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:29.346Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d5865720-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:30.124Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:30.124Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d61b1d10-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:31.100Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:31.100Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d6b699c0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:32.118Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:32.118Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 5
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "d7560e10-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:33.163Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:33.163Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "d7560e10-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "d7560e10-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:33.163Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:33.163Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "d7f00420-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:33.163Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:33.163Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "d9411530-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:36.382Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:36.382Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "d9dda350-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:37.407Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:37.407Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.296Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:25:29.296Z",
        "updated_by": "kibana"
      },
      {
        "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-1",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.346Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:29.346Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d5865720-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:30.124Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:30.124Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d61b1d10-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:31.100Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:31.100Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d6b699c0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:32.118Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:32.118Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d7f00420-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:33.163Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:33.163Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9411530-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:36.382Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:36.382Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9dda350-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:37.407Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:37.407Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 9
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "da7a7f90-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:38.430Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:38.430Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "da7a7f90-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "da7a7f90-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:38.430Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:38.430Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "db1279d0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:38.430Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:38.430Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "db1279d0-df11-11e9-a59e-f7f6643e4dbf" (6)'] = {
  "results": {
    "id": "db1279d0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:38.430Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:38.430Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "da7a7f90-df11-11e9-a59e-f7f6643e4dbf" (7)'] = {
  "results": {
    "id": "da7a7f90-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:38.430Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:25:40 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "dc4c5960-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:41.488Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:41.488Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "dc4c5960-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "dc4c5960-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:41.488Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:41.488Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "dce67680-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:41.488Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:41.488Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "dce67680-df11-11e9-a59e-f7f6643e4dbf",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:25:41.488Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:25:41.488Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "dc4c5960-df11-11e9-a59e-f7f6643e4dbf",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:25:41.488Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:25:43 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "de39aa70-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:44.721Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:44.721Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "de39aa70-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "de39aa70-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:44.721Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:44.721Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "ded35260-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:44.721Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:44.721Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "de39aa70-df11-11e9-a59e-f7f6643e4dbf" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "ded35260-df11-11e9-a59e-f7f6643e4dbf",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:25:44.721Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:25:44.721Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e0a86080-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:48.802Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:48.802Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "e0a86080-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "e0a86080-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:48.802Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:48.802Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "e1425690-df11-11e9-a59e-f7f6643e4dbf",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:48.802Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:48.802Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "e1425690-df11-11e9-a59e-f7f6643e4dbf",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:25:48.802Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:25:48.802Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "e0a86080-df11-11e9-a59e-f7f6643e4dbf",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:25:48.802Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:25:50 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "e1425690-df11-11e9-a59e-f7f6643e4dbf" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "e0a86080-df11-11e9-a59e-f7f6643e4dbf" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "d61b1d10-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:31.100Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:31.100Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d5865720-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:30.124Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:30.124Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d7f00420-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:33.163Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:33.163Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d6b699c0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:32.118Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:32.118Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9411530-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:36.382Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:36.382Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9dda350-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:37.407Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:37.407Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-1",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.346Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:29.346Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.296Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:25:29.296Z",
        "updated_by": "kibana"
      },
      {
        "id": "db1279d0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-8",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:38.430Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:38.430Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "dce67680-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-9",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:41.488Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:41.488Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "ded35260-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-10",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:44.721Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:44.721Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 14
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e3b02240-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:53.886Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:53.886Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "e3b02240-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "e3b02240-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:53.886Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:53.886Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "e4492df0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:25:53.886Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:53.886Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "e4492df0-df11-11e9-a59e-f7f6643e4dbf",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "d61b1d10-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:31.100Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:31.100Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d5865720-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:30.124Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:30.124Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d7f00420-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:33.163Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:33.163Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d6b699c0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:32.118Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:32.118Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9411530-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:36.382Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:36.382Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d9dda350-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:37.407Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:37.407Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "d50fc790-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-1",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.346Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:29.346Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:29.296Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:25:29.296Z",
        "updated_by": "kibana"
      },
      {
        "id": "db1279d0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-8",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:38.430Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:38.430Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "dce67680-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-9",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:41.488Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:41.488Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "ded35260-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-10",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:44.721Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:44.721Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "e3b02240-df11-11e9-a59e-f7f6643e4dbf",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:25:53.886Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:53.886Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "e4492df0-df11-11e9-a59e-f7f6643e4dbf",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:25:53.886Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:25:53.886Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 16
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e58641d0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:56.967Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:56.967Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "e58641d0-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "e58641d0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:25:56.967Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:56.967Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "e61fc2b0-df11-11e9-a59e-f7f6643e4dbf",
    "e6b80b10-df11-11e9-a59e-f7f6643e4dbf"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "e755d1b0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e61fc2b0-df11-11e9-a59e-f7f6643e4dbf",
          "e6b80b10-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:25:56.967Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:56.967Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "e755d1b0-df11-11e9-a59e-f7f6643e4dbf" (7)'] = {
  "results": {
    "id": "e755d1b0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e61fc2b0-df11-11e9-a59e-f7f6643e4dbf",
          "e6b80b10-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:25:56.967Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:25:56.967Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "e88f1500-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "e88f1500-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "e88f1500-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "e929ce60-df11-11e9-a59e-f7f6643e4dbf",
    "e9bfccd0-df11-11e9-a59e-f7f6643e4dbf"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "ea5ef300-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e929ce60-df11-11e9-a59e-f7f6643e4dbf",
          "e9bfccd0-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "ea5ef300-df11-11e9-a59e-f7f6643e4dbf" (7)'] = {
  "results": {
    "id": "ea5ef300-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e929ce60-df11-11e9-a59e-f7f6643e4dbf",
          "e9bfccd0-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "ea5ef300-df11-11e9-a59e-f7f6643e4dbf" (8)'] = {
  "results": {
    "id": "ea5ef300-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "e929ce60-df11-11e9-a59e-f7f6643e4dbf",
          "e9bfccd0-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "eb963a80-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "eb963a80-df11-11e9-a59e-f7f6643e4dbf" (11)'] = {
  "results": {
    "id": "eb963a80-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:02.058Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:02.058Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952305836
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "eccf2fb0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:09.188Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:09.188Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "eccf2fb0-df11-11e9-a59e-f7f6643e4dbf" (3)'] = {
  "results": {
    "id": "eccf2fb0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:26:09.188Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:09.188Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "ed70edf0-df11-11e9-a59e-f7f6643e4dbf"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "ee02cdb0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "ed70edf0-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:26:09.188Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:09.188Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "ee02cdb0-df11-11e9-a59e-f7f6643e4dbf" (7)'] = {
  "results": {
    "id": "ee02cdb0-df11-11e9-a59e-f7f6643e4dbf",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "ed70edf0-df11-11e9-a59e-f7f6643e4dbf"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:26:09.188Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:26:09.188Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["ed70edf0-df11-11e9-a59e-f7f6643e4dbf"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "18797850-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:22.442Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:22.442Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "18797850-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "18797850-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:22.442Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:22.442Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:23.994Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:27:23.994Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:23.994Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:27:23.994Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "19fc20b0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:24.981Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:24.981Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "1a93a5c0-df12-11e9-97e5-17bda8500ff2",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:25.968Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:25.968Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "1b2fe5c0-df12-11e9-97e5-17bda8500ff2",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:26.996Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:26.996Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "19fc20b0-df12-11e9-97e5-17bda8500ff2",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:24.981Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:24.981Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1a93a5c0-df12-11e9-97e5-17bda8500ff2",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:25.968Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:25.968Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1b2fe5c0-df12-11e9-97e5-17bda8500ff2",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:26.996Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:26.996Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1bd26750-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:28.061Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:28.061Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "1bd26750-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "1bd26750-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:28.061Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:28.061Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "1c699e40-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:28.061Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:28.061Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "1d9ffb60-df12-11e9-97e5-17bda8500ff2",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:31.088Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:31.088Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "1e3adbd0-df12-11e9-97e5-17bda8500ff2",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:32.102Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:32.102Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "1c699e40-df12-11e9-97e5-17bda8500ff2",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:28.061Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:28.061Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1d9ffb60-df12-11e9-97e5-17bda8500ff2",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:31.088Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:31.088Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1e3adbd0-df12-11e9-97e5-17bda8500ff2",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:32.102Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:32.102Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1edff570-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:33.181Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:33.181Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "1edff570-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "1edff570-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:33.181Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:33.181Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "1f7de320-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:33.181Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:33.181Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "1f7de320-df12-11e9-97e5-17bda8500ff2" (6)'] = {
  "results": {
    "id": "1f7de320-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:33.181Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:33.181Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "1edff570-df12-11e9-97e5-17bda8500ff2" (7)'] = {
  "results": {
    "id": "1edff570-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:33.181Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:27:35 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "20d1b350-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:36.442Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:36.442Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "20d1b350-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "20d1b350-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:36.442Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:36.442Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "214cd6c0-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:36.442Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:36.442Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "214cd6c0-df12-11e9-97e5-17bda8500ff2",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:27:36.442Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:27:36.442Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "20d1b350-df12-11e9-97e5-17bda8500ff2",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:27:36.442Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:27:38 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "229f2050-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:39.470Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:39.470Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "229f2050-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "229f2050-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:39.470Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:39.470Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "23365740-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:39.470Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:39.470Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "229f2050-df12-11e9-97e5-17bda8500ff2" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "23365740-df12-11e9-97e5-17bda8500ff2",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:27:39.470Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:27:39.470Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "250c9de0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:43.541Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:43.541Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "250c9de0-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "250c9de0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:43.541Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:43.541Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "25a693f0-df12-11e9-97e5-17bda8500ff2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:43.541Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:43.541Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "25a693f0-df12-11e9-97e5-17bda8500ff2",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:27:43.541Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:27:43.541Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "250c9de0-df12-11e9-97e5-17bda8500ff2",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:27:43.541Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:27:45 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "25a693f0-df12-11e9-97e5-17bda8500ff2" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "250c9de0-df12-11e9-97e5-17bda8500ff2" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2815bf30-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:48.636Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:48.636Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "2815bf30-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "2815bf30-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:48.636Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:48.636Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "28aecae0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:27:48.636Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:48.636Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "28aecae0-df12-11e9-97e5-17bda8500ff2",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "2815bf30-df12-11e9-97e5-17bda8500ff2",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:27:48.636Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:48.636Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "28aecae0-df12-11e9-97e5-17bda8500ff2",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:27:48.636Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:27:48.636Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "29ec2ce0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:51.719Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:51.719Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "29ec2ce0-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "29ec2ce0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:51.719Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:51.719Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "2a820440-df12-11e9-97e5-17bda8500ff2",
    "2b1c2160-df12-11e9-97e5-17bda8500ff2"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "2bba3620-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2a820440-df12-11e9-97e5-17bda8500ff2",
          "2b1c2160-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:27:51.719Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:51.719Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "2bba3620-df12-11e9-97e5-17bda8500ff2" (7)'] = {
  "results": {
    "id": "2bba3620-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2a820440-df12-11e9-97e5-17bda8500ff2",
          "2b1c2160-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:27:51.719Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:51.719Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2cf79820-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2cf79820-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "2cf79820-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "2d8e80f0-df12-11e9-97e5-17bda8500ff2",
    "2e2590d0-df12-11e9-97e5-17bda8500ff2"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "2ec41ac0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2d8e80f0-df12-11e9-97e5-17bda8500ff2",
          "2e2590d0-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2ec41ac0-df12-11e9-97e5-17bda8500ff2" (7)'] = {
  "results": {
    "id": "2ec41ac0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2d8e80f0-df12-11e9-97e5-17bda8500ff2",
          "2e2590d0-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2ec41ac0-df12-11e9-97e5-17bda8500ff2" (8)'] = {
  "results": {
    "id": "2ec41ac0-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2d8e80f0-df12-11e9-97e5-17bda8500ff2",
          "2e2590d0-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "2ffbfe80-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2ffbfe80-df12-11e9-97e5-17bda8500ff2" (11)'] = {
  "results": {
    "id": "2ffbfe80-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:27:56.827Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:27:56.827Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952422627
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "31384f10-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:28:03.961Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:28:03.961Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "31384f10-df12-11e9-97e5-17bda8500ff2" (3)'] = {
  "results": {
    "id": "31384f10-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:28:03.961Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:28:03.961Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "31cfd420-df12-11e9-97e5-17bda8500ff2"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "326a1850-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "31cfd420-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:28:03.961Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:28:03.961Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "326a1850-df12-11e9-97e5-17bda8500ff2" (7)'] = {
  "results": {
    "id": "326a1850-df12-11e9-97e5-17bda8500ff2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "31cfd420-df12-11e9-97e5-17bda8500ff2"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:28:03.961Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:28:03.961Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["31cfd420-df12-11e9-97e5-17bda8500ff2"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8668c7d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:26.874Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:26.874Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "8668c7d0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "8668c7d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:26.874Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:26.874Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:27.668Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:30:27.668Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:27.668Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:30:27.668Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:28.736Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:30:28.736Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:28.736Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:30:28.736Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:28.736Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:30:28.736Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "881406d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:29.686Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:29.686Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "88a83080-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:30.652Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:30.652Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "8944bea0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:31.681Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:31.681Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "881406d0-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:29.686Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:29.686Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "88a83080-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:30.652Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:30.652Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "8944bea0-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:31.681Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:31.681Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "89e5e0a0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:32.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:32.739Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "89e5e0a0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "89e5e0a0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:32.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:32.739Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "8a8a0fe0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:32.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:32.739Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "8bdc3260-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:36.030Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:36.030Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "8c7712d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:37.045Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:37.045Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "8a8a0fe0-df12-11e9-8ad6-0b7b85fefae5",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:32.739Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:32.739Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "8bdc3260-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:36.030Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:36.030Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "8c7712d0-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:37.045Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:37.045Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8d1faee0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:38.150Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:38.150Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "8d1faee0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "8d1faee0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:38.150Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:38.150Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "8db7d030-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:38.150Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:38.150Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "8db7d030-df12-11e9-8ad6-0b7b85fefae5" (6)'] = {
  "results": {
    "id": "8db7d030-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:38.150Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:38.150Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "8d1faee0-df12-11e9-8ad6-0b7b85fefae5" (7)'] = {
  "results": {
    "id": "8d1faee0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:38.150Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:30:40 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "8ef33660-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:41.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:41.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "8ef33660-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "8ef33660-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:41.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:41.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "8f8675b0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:41.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:41.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "8f8675b0-df12-11e9-8ad6-0b7b85fefae5",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:30:41.214Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:30:41.214Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "8ef33660-df12-11e9-8ad6-0b7b85fefae5",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:30:41.214Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:30:43 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "90c49b00-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:44.264Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:44.264Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "90c49b00-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "90c49b00-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:44.264Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:44.264Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "91598800-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:44.264Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:44.264Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "90c49b00-df12-11e9-8ad6-0b7b85fefae5" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "91598800-df12-11e9-8ad6-0b7b85fefae5",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:30:44.264Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:30:44.264Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9332b4d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:48.339Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:48.339Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "9332b4d0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "9332b4d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:48.339Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:48.339Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "93c77ac0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:48.339Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:48.339Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "93c77ac0-df12-11e9-8ad6-0b7b85fefae5",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:30:48.339Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:30:48.339Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "9332b4d0-df12-11e9-8ad6-0b7b85fefae5",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:30:48.339Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:30:50 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "93c77ac0-df12-11e9-8ad6-0b7b85fefae5" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "9332b4d0-df12-11e9-8ad6-0b7b85fefae5" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9638a1d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:53.413Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.413Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "963c7260-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:53.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "9638a1d0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "9638a1d0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:53.413Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.413Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "963c7260-df12-11e9-8ad6-0b7b85fefae5" (4)'] = {
  "results": {
    "id": "963c7260-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:53.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "96d1d490-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:30:53.413Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.413Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (6)'] = {
  "results": [
    "96d35b30-df12-11e9-8ad6-0b7b85fefae5",
    "9769ced0-df12-11e9-8ad6-0b7b85fefae5"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"foo","description":"description"} (7)'] = {
  "results": {
    "id": "96d1d490-df12-11e9-8ad6-0b7b85fefae5",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "9638a1d0-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:53.413Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:53.413Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "963c7260-df12-11e9-8ad6-0b7b85fefae5",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:30:53.436Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:53.436Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "96d1d490-df12-11e9-8ad6-0b7b85fefae5",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-15",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:30:53.413Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:30:53.413Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 3
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (8)'] = {
  "results": {
    "id": "980a0670-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "96d35b30-df12-11e9-8ad6-0b7b85fefae5",
          "9769ced0-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:30:53.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "980a0670-df12-11e9-8ad6-0b7b85fefae5" (11)'] = {
  "results": {
    "id": "980a0670-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "96d35b30-df12-11e9-8ad6-0b7b85fefae5",
          "9769ced0-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:30:53.436Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:53.436Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "99491620-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "99491620-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "99491620-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "99de9f60-df12-11e9-8ad6-0b7b85fefae5",
    "9a749dd0-df12-11e9-8ad6-0b7b85fefae5"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "9b146040-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "99de9f60-df12-11e9-8ad6-0b7b85fefae5",
          "9a749dd0-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "9b146040-df12-11e9-8ad6-0b7b85fefae5" (7)'] = {
  "results": {
    "id": "9b146040-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "99de9f60-df12-11e9-8ad6-0b7b85fefae5",
          "9a749dd0-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "9b146040-df12-11e9-8ad6-0b7b85fefae5" (8)'] = {
  "results": {
    "id": "9b146040-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "99de9f60-df12-11e9-8ad6-0b7b85fefae5",
          "9a749dd0-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "9c4b80b0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "9c4b80b0-df12-11e9-8ad6-0b7b85fefae5" (11)'] = {
  "results": {
    "id": "9c4b80b0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:30:58.554Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:30:58.554Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952607708
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "9d8b53b0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:31:05.699Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:31:05.699Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "9d8b53b0-df12-11e9-8ad6-0b7b85fefae5" (3)'] = {
  "results": {
    "id": "9d8b53b0-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:31:05.699Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:31:05.699Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "9e1fa470-df12-11e9-8ad6-0b7b85fefae5"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "9eb8fe40-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "9e1fa470-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:31:05.699Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:31:05.699Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "9eb8fe40-df12-11e9-8ad6-0b7b85fefae5" (7)'] = {
  "results": {
    "id": "9eb8fe40-df12-11e9-8ad6-0b7b85fefae5",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "9e1fa470-df12-11e9-8ad6-0b7b85fefae5"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:31:05.699Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:31:05.699Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["9e1fa470-df12-11e9-8ad6-0b7b85fefae5"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "27cb0520-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:34:57.637Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:34:57.637Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "27cb0520-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "27cb0520-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:34:57.637Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:34:57.637Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:34:58.404Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:34:58.404Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:34:58.404Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:34:58.404Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:34:59.395Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:34:59.395Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:34:59.395Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:34:59.395Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:34:59.395Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:34:59.395Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "29709ed0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:00.404Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:00.404Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "2a0516a0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:01.377Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:01.377Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "2aa10880-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:02.399Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:02.399Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "29709ed0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:00.404Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:00.404Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2a0516a0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:01.377Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:01.377Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2aa10880-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:02.399Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:02.399Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2b422a80-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:03.456Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:03.456Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "2b422a80-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "2b422a80-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:03.456Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:03.456Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "2bd7dad0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:03.456Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:03.456Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "2d0e5f00-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:06.471Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:06.471Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "2daac610-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:07.494Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:07.494Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "2bd7dad0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:03.456Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:03.456Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2d0e5f00-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:06.471Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:06.471Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2daac610-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:07.494Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:07.494Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2e4a6170-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:08.542Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:08.542Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "2e4a6170-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "2e4a6170-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:08.542Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:08.542Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "2ee20d90-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:08.542Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:08.542Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "2ee20d90-df13-11e9-a2c4-67809dd3e5d4" (6)'] = {
  "results": {
    "id": "2ee20d90-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:08.542Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:08.542Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "2e4a6170-df13-11e9-a2c4-67809dd3e5d4" (7)'] = {
  "results": {
    "id": "2e4a6170-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:08.542Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:35:10 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "301e8530-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:11.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:11.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "301e8530-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "301e8530-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:11.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:11.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "30b2aee0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:11.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:11.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "30b2aee0-df13-11e9-a2c4-67809dd3e5d4",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:35:11.608Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:35:11.608Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "301e8530-df13-11e9-a2c4-67809dd3e5d4",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:35:11.608Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:35:13 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "31ee8a40-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:14.649Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:14.649Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "31ee8a40-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "31ee8a40-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:14.649Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:14.649Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "32863660-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:14.649Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:14.649Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "31ee8a40-df13-11e9-a2c4-67809dd3e5d4" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "32863660-df13-11e9-a2c4-67809dd3e5d4",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:35:14.649Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:35:14.649Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "345fb150-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:18.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:18.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "345fb150-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "345fb150-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:18.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:18.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "34f3b3f0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:18.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:18.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "34f3b3f0-df13-11e9-a2c4-67809dd3e5d4",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:35:18.748Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:35:18.748Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "345fb150-df13-11e9-a2c4-67809dd3e5d4",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:35:18.748Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:35:20 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "34f3b3f0-df13-11e9-a2c4-67809dd3e5d4" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "345fb150-df13-11e9-a2c4-67809dd3e5d4" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "376417b0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:23.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.810Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "3766fde0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:23.829Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.829Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "376417b0-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "376417b0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:23.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.810Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "3766fde0-df13-11e9-a2c4-67809dd3e5d4" (4)'] = {
  "results": {
    "id": "3766fde0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:23.829Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.829Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "37fe0dc0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:35:23.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.810Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (6)'] = {
  "results": [
    "380030a0-df13-11e9-a2c4-67809dd3e5d4",
    "38951da0-df13-11e9-a2c4-67809dd3e5d4"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"foo","description":"description"} (7)'] = {
  "results": {
    "id": "37fe0dc0-df13-11e9-a2c4-67809dd3e5d4",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "376417b0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:23.810Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:23.810Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "3766fde0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:35:23.829Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:23.829Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "37fe0dc0-df13-11e9-a2c4-67809dd3e5d4",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-15",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:35:23.810Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:35:23.810Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 3
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (8)'] = {
  "results": {
    "id": "39313690-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "380030a0-df13-11e9-a2c4-67809dd3e5d4",
          "38951da0-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:23.829Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.829Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "39313690-df13-11e9-a2c4-67809dd3e5d4" (11)'] = {
  "results": {
    "id": "39313690-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "380030a0-df13-11e9-a2c4-67809dd3e5d4",
          "38951da0-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:23.829Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:23.829Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "3a701f30-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "3a701f30-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "3a701f30-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "3b0644b0-df13-11e9-a2c4-67809dd3e5d4",
    "3b9c1c10-df13-11e9-a2c4-67809dd3e5d4"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "3c3af420-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3b0644b0-df13-11e9-a2c4-67809dd3e5d4",
          "3b9c1c10-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "3c3af420-df13-11e9-a2c4-67809dd3e5d4" (7)'] = {
  "results": {
    "id": "3c3af420-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3b0644b0-df13-11e9-a2c4-67809dd3e5d4",
          "3b9c1c10-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "3c3af420-df13-11e9-a2c4-67809dd3e5d4" (8)'] = {
  "results": {
    "id": "3c3af420-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3b0644b0-df13-11e9-a2c4-67809dd3e5d4",
          "3b9c1c10-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "3d741060-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "3d741060-df13-11e9-a2c4-67809dd3e5d4" (11)'] = {
  "results": {
    "id": "3d741060-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:28.922Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:28.922Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952876464
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "3eaf9da0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:36.050Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:36.050Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "3eaf9da0-df13-11e9-a2c4-67809dd3e5d4" (3)'] = {
  "results": {
    "id": "3eaf9da0-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:35:36.050Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:36.050Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "3f63f980-df13-11e9-a2c4-67809dd3e5d4"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "3ffd2c40-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3f63f980-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:36.050Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:36.050Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "3ffd2c40-df13-11e9-a2c4-67809dd3e5d4" (7)'] = {
  "results": {
    "id": "3ffd2c40-df13-11e9-a2c4-67809dd3e5d4",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "3f63f980-df13-11e9-a2c4-67809dd3e5d4"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:35:36.050Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:35:36.050Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["3f63f980-df13-11e9-a2c4-67809dd3e5d4"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "61db85a0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:35.019Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:35.019Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "61db85a0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "61db85a0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:35.019Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:35.019Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:36.738Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:36:36.738Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:36.738Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:36:36.738Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:37.742Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:36:37.742Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:37.742Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:36:37.742Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:37.742Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:36:37.742Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "64103ff0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:38.757Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:38.757Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "64a490b0-df13-11e9-9522-67c9a8309146",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:39.729Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:39.729Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "6540f7c0-df13-11e9-9522-67c9a8309146",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:40.750Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:40.750Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "64103ff0-df13-11e9-9522-67c9a8309146",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:38.757Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:38.757Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "64a490b0-df13-11e9-9522-67c9a8309146",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:39.729Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:39.729Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "6540f7c0-df13-11e9-9522-67c9a8309146",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:40.750Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:40.750Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "65e240d0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:41.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:41.810Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "65e240d0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "65e240d0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:41.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:41.810Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6678b470-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:41.810Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:41.810Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "67c1d640-df13-11e9-9522-67c9a8309146",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:44.953Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:44.953Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "685cb6b0-df13-11e9-9522-67c9a8309146",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:45.969Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:45.969Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "6678b470-df13-11e9-9522-67c9a8309146",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:41.810Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:41.810Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "67c1d640-df13-11e9-9522-67c9a8309146",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:44.953Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:44.953Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "685cb6b0-df13-11e9-9522-67c9a8309146",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:36:45.969Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:36:45.969Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6909e6a0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:47.073Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:47.073Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "6909e6a0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "6909e6a0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:47.073Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:47.073Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "69973280-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:47.073Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:47.073Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "69973280-df13-11e9-9522-67c9a8309146" (6)'] = {
  "results": {
    "id": "69973280-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:47.073Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:47.073Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "6909e6a0-df13-11e9-9522-67c9a8309146" (7)'] = {
  "results": {
    "id": "6909e6a0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:47.073Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:36:49 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6af22ea0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:50.301Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:50.301Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "6af22ea0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "6af22ea0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:50.301Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:50.301Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6b8b8870-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:50.301Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:50.301Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "6b8b8870-df13-11e9-9522-67c9a8309146",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:36:50.301Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:36:50.301Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "6af22ea0-df13-11e9-9522-67c9a8309146",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:36:50.301Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:36:52 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6cc763d0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:53.377Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:53.377Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "6cc763d0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "6cc763d0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:53.377Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:53.377Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6d5d3b30-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:53.377Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:53.377Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "6cc763d0-df13-11e9-9522-67c9a8309146" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "6d5d3b30-df13-11e9-9522-67c9a8309146",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:36:53.377Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:36:53.377Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6f36dd30-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:57.464Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:57.464Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "6f36dd30-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "6f36dd30-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:57.464Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:57.464Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6fcb2df0-df13-11e9-9522-67c9a8309146",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:36:57.464Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:36:57.464Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "6fcb2df0-df13-11e9-9522-67c9a8309146",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:36:57.464Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:36:57.464Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "6f36dd30-df13-11e9-9522-67c9a8309146",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:36:57.464Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:36:59 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "6fcb2df0-df13-11e9-9522-67c9a8309146" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "6f36dd30-df13-11e9-9522-67c9a8309146" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "723bb8c0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:02.529Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.529Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "723eed10-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:02.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "723bb8c0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "723bb8c0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:02.529Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.529Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "723eed10-df13-11e9-9522-67c9a8309146" (4)'] = {
  "results": {
    "id": "723eed10-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:02.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "72d73570-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:37:02.529Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.529Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (6)'] = {
  "results": [
    "72d93140-df13-11e9-9522-67c9a8309146",
    "736b1100-df13-11e9-9522-67c9a8309146"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"foo","description":"description"} (7)'] = {
  "results": {
    "id": "72d73570-df13-11e9-9522-67c9a8309146",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "723bb8c0-df13-11e9-9522-67c9a8309146",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:37:02.529Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:37:02.529Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "723eed10-df13-11e9-9522-67c9a8309146",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:37:02.551Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:37:02.551Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "72d73570-df13-11e9-9522-67c9a8309146",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-15",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:37:02.529Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:37:02.529Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 3
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (8)'] = {
  "results": {
    "id": "7405f170-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "72d93140-df13-11e9-9522-67c9a8309146",
          "736b1100-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:02.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "7405f170-df13-11e9-9522-67c9a8309146" (11)'] = {
  "results": {
    "id": "7405f170-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "72d93140-df13-11e9-9522-67c9a8309146",
          "736b1100-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:02.551Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:02.551Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "75488390-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "75488390-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "75488390-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "75dde5c0-df13-11e9-9522-67c9a8309146",
    "7672f9d0-df13-11e9-9522-67c9a8309146"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "77133170-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "75dde5c0-df13-11e9-9522-67c9a8309146",
          "7672f9d0-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "77133170-df13-11e9-9522-67c9a8309146" (7)'] = {
  "results": {
    "id": "77133170-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "75dde5c0-df13-11e9-9522-67c9a8309146",
          "7672f9d0-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "77133170-df13-11e9-9522-67c9a8309146" (8)'] = {
  "results": {
    "id": "77133170-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "75dde5c0-df13-11e9-9522-67c9a8309146",
          "7672f9d0-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "784dfb60-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "784dfb60-df13-11e9-9522-67c9a8309146" (11)'] = {
  "results": {
    "id": "784dfb60-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:07.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:07.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571952973341
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "7989fdd0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:14.786Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:14.786Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7989fdd0-df13-11e9-9522-67c9a8309146" (3)'] = {
  "results": {
    "id": "7989fdd0-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:37:14.786Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:14.786Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "7a1e75a0-df13-11e9-9522-67c9a8309146"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "7ab9a430-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "7a1e75a0-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:14.786Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:14.786Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7ab9a430-df13-11e9-9522-67c9a8309146" (7)'] = {
  "results": {
    "id": "7ab9a430-df13-11e9-9522-67c9a8309146",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "7a1e75a0-df13-11e9-9522-67c9a8309146"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:37:14.786Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:37:14.786Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["7a1e75a0-df13-11e9-9522-67c9a8309146"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1b8a28d0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:46.566Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:46.566Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "1b8a28d0-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "1b8a28d0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:46.566Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:46.566Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:48.333Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:41:48.333Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:48.333Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:41:48.333Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:49.402Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:41:49.402Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:49.402Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:41:49.402Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:49.402Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:41:49.402Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1dd35580-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:50.409Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:50.409Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "1e64e720-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:51.368Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:51.368Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "1f010010-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:52.390Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:52.390Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "1dd35580-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:50.409Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:50.409Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1e64e720-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:51.368Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:51.368Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "1f010010-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:52.390Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:52.390Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1fa27030-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:53.448Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:53.448Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "1fa27030-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "1fa27030-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:53.448Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:53.448Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "203a6a70-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:53.448Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:53.448Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "2171b1f0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:56.484Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:56.484Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "220f0360-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:57.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:57.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "203a6a70-df14-11e9-b7f1-0be9fcb846ac",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:53.448Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:53.448Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2171b1f0-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:56.484Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:56.484Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "220f0360-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:41:57.507Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:41:57.507Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "22b184f0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:58.581Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:58.581Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "22b184f0-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "22b184f0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:58.581Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:58.581Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "2346c010-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:58.581Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:58.581Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "2346c010-df14-11e9-b7f1-0be9fcb846ac" (6)'] = {
  "results": {
    "id": "2346c010-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:58.581Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:41:58.581Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "22b184f0-df14-11e9-b7f1-0be9fcb846ac" (7)'] = {
  "results": {
    "id": "22b184f0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:41:58.581Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:42:00 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2487a480-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:01.661Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:01.661Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "2487a480-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "2487a480-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:01.661Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:01.661Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "251bce30-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:01.661Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:01.661Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "251bce30-df14-11e9-b7f1-0be9fcb846ac",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:42:01.661Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:42:01.661Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "2487a480-df14-11e9-b7f1-0be9fcb846ac",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:42:01.661Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:42:03 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "265b2c00-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:04.722Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:04.722Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "265b2c00-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "265b2c00-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:04.722Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:04.722Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "26ee4440-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:04.722Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:04.722Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "265b2c00-df14-11e9-b7f1-0be9fcb846ac" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "26ee4440-df14-11e9-b7f1-0be9fcb846ac",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:42:04.722Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:42:04.722Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "28c8a990-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:08.798Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:08.798Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "28c8a990-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "28c8a990-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:08.798Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:08.798Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "295fe080-df14-11e9-b7f1-0be9fcb846ac",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:08.798Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:08.798Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "295fe080-df14-11e9-b7f1-0be9fcb846ac",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:42:08.798Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:42:08.798Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "28c8a990-df14-11e9-b7f1-0be9fcb846ac",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:42:08.798Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:42:10 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "295fe080-df14-11e9-b7f1-0be9fcb846ac" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "28c8a990-df14-11e9-b7f1-0be9fcb846ac" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2bd57460-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:13.915Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.915Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2bda7d70-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:13.944Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.944Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "2bd57460-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "2bd57460-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:13.915Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.915Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "2bda7d70-df14-11e9-b7f1-0be9fcb846ac" (4)'] = {
  "results": {
    "id": "2bda7d70-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:13.944Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.944Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "2c6dbcc0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:42:13.915Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.915Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (6)'] = {
  "results": [
    "2c6fb890-df14-11e9-b7f1-0be9fcb846ac",
    "2d04f3b0-df14-11e9-b7f1-0be9fcb846ac"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"foo","description":"description"} (7)'] = {
  "results": {
    "id": "2c6dbcc0-df14-11e9-b7f1-0be9fcb846ac",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "2bd57460-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:42:13.915Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:42:13.915Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2bda7d70-df14-11e9-b7f1-0be9fcb846ac",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:42:13.944Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:42:13.944Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "2c6dbcc0-df14-11e9-b7f1-0be9fcb846ac",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-15",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:42:13.915Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:42:13.915Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 3
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (8)'] = {
  "results": {
    "id": "2da181d0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2c6fb890-df14-11e9-b7f1-0be9fcb846ac",
          "2d04f3b0-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:13.944Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.944Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "2da181d0-df14-11e9-b7f1-0be9fcb846ac" (11)'] = {
  "results": {
    "id": "2da181d0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2c6fb890-df14-11e9-b7f1-0be9fcb846ac",
          "2d04f3b0-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:13.944Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:13.944Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "2ef503e0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "2ef503e0-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "2ef503e0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "2f7a1260-df14-11e9-b7f1-0be9fcb846ac",
    "30245c20-df14-11e9-b7f1-0be9fcb846ac"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "30c38250-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2f7a1260-df14-11e9-b7f1-0be9fcb846ac",
          "30245c20-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "30c38250-df14-11e9-b7f1-0be9fcb846ac" (7)'] = {
  "results": {
    "id": "30c38250-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2f7a1260-df14-11e9-b7f1-0be9fcb846ac",
          "30245c20-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "30c38250-df14-11e9-b7f1-0be9fcb846ac" (8)'] = {
  "results": {
    "id": "30c38250-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "2f7a1260-df14-11e9-b7f1-0be9fcb846ac",
          "30245c20-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "31fdfe20-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "31fdfe20-df14-11e9-b7f1-0be9fcb846ac" (11)'] = {
  "results": {
    "id": "31fdfe20-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:19.152Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:19.152Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953282633
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "3339d980-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:26.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:26.317Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "3339d980-df14-11e9-b7f1-0be9fcb846ac" (3)'] = {
  "results": {
    "id": "3339d980-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:42:26.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:26.317Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "33d27000-df14-11e9-b7f1-0be9fcb846ac"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "346b54a0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "33d27000-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:26.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:26.317Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "346b54a0-df14-11e9-b7f1-0be9fcb846ac" (7)'] = {
  "results": {
    "id": "346b54a0-df14-11e9-b7f1-0be9fcb846ac",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "33d27000-df14-11e9-b7f1-0be9fcb846ac"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:42:26.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:42:26.317Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["33d27000-df14-11e9-b7f1-0be9fcb846ac"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "62c83a20-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:46.099Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:46.099Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "62c83a20-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "62c83a20-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:46.099Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:46.099Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:46.912Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:43:46.912Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:46.912Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:43:46.912Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:47.904Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:43:47.904Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:47.904Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:43:47.904Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:47.904Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:43:47.904Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "64783410-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:48.930Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:48.930Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "650ab010-df14-11e9-80ee-315908b2baff",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:49.893Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:49.893Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "65a653d0-df14-11e9-80ee-315908b2baff",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:50.913Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:50.913Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "64783410-df14-11e9-80ee-315908b2baff",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:48.930Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:48.930Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "650ab010-df14-11e9-80ee-315908b2baff",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:49.893Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:49.893Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "65a653d0-df14-11e9-80ee-315908b2baff",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:50.913Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:50.913Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6648ae50-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:51.977Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:51.977Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "6648ae50-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "6648ae50-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:51.977Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:51.977Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "66df9720-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:51.977Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:51.977Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "6825f9d0-df14-11e9-80ee-315908b2baff",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:55.055Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:55.055Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "68b1bf10-df14-11e9-80ee-315908b2baff",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:56.021Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:56.021Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "66df9720-df14-11e9-80ee-315908b2baff",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:51.977Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:51.977Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "6825f9d0-df14-11e9-80ee-315908b2baff",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:55.055Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:55.055Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "68b1bf10-df14-11e9-80ee-315908b2baff",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:43:56.021Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:43:56.021Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6970f060-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:57.274Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:57.274Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "6970f060-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "6970f060-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:57.274Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:57.274Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6a06eed0-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:57.274Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:57.274Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "6a06eed0-df14-11e9-80ee-315908b2baff" (6)'] = {
  "results": {
    "id": "6a06eed0-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:57.274Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:43:57.274Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "6970f060-df14-11e9-80ee-315908b2baff" (7)'] = {
  "results": {
    "id": "6970f060-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:43:57.274Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:43:59 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6b469ac0-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:00.353Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:00.353Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "6b469ac0-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "6b469ac0-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:00.353Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:00.353Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6bdb1290-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:00.353Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:00.353Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "6bdb1290-df14-11e9-80ee-315908b2baff",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:44:00.353Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:44:00.353Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "6b469ac0-df14-11e9-80ee-315908b2baff",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:44:00.353Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:44:02 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6d1a2240-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:03.417Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:03.417Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "6d1a2240-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "6d1a2240-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:03.417Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:03.417Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "6daf3650-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:03.417Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:03.417Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "6d1a2240-df14-11e9-80ee-315908b2baff" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "6daf3650-df14-11e9-80ee-315908b2baff",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:44:03.417Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:44:03.417Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6f88b140-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:07.496Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:07.496Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "6f88b140-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "6f88b140-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:07.496Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:07.496Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "701d9e40-df14-11e9-80ee-315908b2baff",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:07.496Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:07.496Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "701d9e40-df14-11e9-80ee-315908b2baff",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:44:07.496Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:44:07.496Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "6f88b140-df14-11e9-80ee-315908b2baff",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:44:07.496Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:44:09 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "701d9e40-df14-11e9-80ee-315908b2baff" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "6f88b140-df14-11e9-80ee-315908b2baff" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should never delete the default policy - listVersions - {"sharedID":"default","activeOnly":false,"page":1,"perPage":10000} (1)'] = {
  "results": []
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "72910f40-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:12.584Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:12.584Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "72910f40-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "72910f40-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:12.584Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:12.584Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "732c8bf0-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:44:12.584Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:12.584Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "732c8bf0-df14-11e9-80ee-315908b2baff",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "72910f40-df14-11e9-80ee-315908b2baff",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:44:12.584Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:44:12.584Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "732c8bf0-df14-11e9-80ee-315908b2baff",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:44:12.584Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:44:12.584Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "746b2670-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:15.691Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:15.691Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "746b2670-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "746b2670-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:15.691Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:15.691Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "75003a80-df14-11e9-80ee-315908b2baff",
    "7596fc40-df14-11e9-80ee-315908b2baff"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "76362270-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "75003a80-df14-11e9-80ee-315908b2baff",
          "7596fc40-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:15.691Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:15.691Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "76362270-df14-11e9-80ee-315908b2baff" (7)'] = {
  "results": {
    "id": "76362270-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "75003a80-df14-11e9-80ee-315908b2baff",
          "7596fc40-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:15.691Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:15.691Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "7775f570-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "7775f570-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "7775f570-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "780d0550-df14-11e9-80ee-315908b2baff",
    "78a1a430-df14-11e9-80ee-315908b2baff"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "793fe000-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "780d0550-df14-11e9-80ee-315908b2baff",
          "78a1a430-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "793fe000-df14-11e9-80ee-315908b2baff" (7)'] = {
  "results": {
    "id": "793fe000-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "780d0550-df14-11e9-80ee-315908b2baff",
          "78a1a430-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "793fe000-df14-11e9-80ee-315908b2baff" (8)'] = {
  "results": {
    "id": "793fe000-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "780d0550-df14-11e9-80ee-315908b2baff",
          "78a1a430-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "7a7db730-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "7a7db730-df14-11e9-80ee-315908b2baff" (11)'] = {
  "results": {
    "id": "7a7db730-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:20.793Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:20.793Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953403055
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "7bb96b80-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:27.947Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:27.947Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7bb96b80-df14-11e9-80ee-315908b2baff" (3)'] = {
  "results": {
    "id": "7bb96b80-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:44:27.947Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:27.947Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "7c4e3170-df14-11e9-80ee-315908b2baff"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "7ce875a0-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "7c4e3170-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:27.947Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:27.947Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7ce875a0-df14-11e9-80ee-315908b2baff" (7)'] = {
  "results": {
    "id": "7ce875a0-df14-11e9-80ee-315908b2baff",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "7c4e3170-df14-11e9-80ee-315908b2baff"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:44:27.947Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:44:27.947Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["7c4e3170-df14-11e9-80ee-315908b2baff"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b4116690-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:02.467Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:02.467Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "b4116690-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "b4116690-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:02.467Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:02.467Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:04.184Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:46:04.184Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:04.184Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:46:04.184Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:05.304Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:46:05.304Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:05.304Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:46:05.304Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:05.304Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:46:05.304Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b65eb1f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:06.338Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:06.338Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "b6f1a320-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:07.301Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:07.301Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "b78f1ba0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:08.333Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:08.333Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "b65eb1f0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:06.338Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:06.338Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "b6f1a320-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:07.301Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:07.301Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "b78f1ba0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:08.333Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:08.333Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b83371f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:09.409Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:09.409Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "b83371f0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "b83371f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:09.409Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:09.409Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "b8cc7da0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:09.409Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:09.409Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "ba0524b0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:12.463Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:12.463Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "baa24f10-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:13.492Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:13.492Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "b8cc7da0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:09.409Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:09.409Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "ba0524b0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:12.463Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:12.463Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "baa24f10-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:13.492Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:13.492Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "bb4593f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:14.563Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:14.563Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "bb4593f0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "bb4593f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:14.563Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:14.563Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "bbdfb110-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:14.563Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:14.563Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "bbdfb110-df14-11e9-8e7f-231f13bcb3a0" (6)'] = {
  "results": {
    "id": "bbdfb110-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:14.563Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:14.563Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "bb4593f0-df14-11e9-8e7f-231f13bcb3a0" (7)'] = {
  "results": {
    "id": "bb4593f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:14.563Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:46:16 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "bd246610-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:17.701Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:17.701Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "bd246610-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "bd246610-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:17.701Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:17.701Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "bdbb4ee0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:17.701Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:17.701Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "bdbb4ee0-df14-11e9-8e7f-231f13bcb3a0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:46:17.701Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:46:17.701Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "bd246610-df14-11e9-8e7f-231f13bcb3a0",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:46:17.701Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:46:19 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "befad3c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:20.780Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:20.780Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "befad3c0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "befad3c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:20.780Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:20.780Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "bf91e3a0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:20.780Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:20.780Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "befad3c0-df14-11e9-8e7f-231f13bcb3a0" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "bf91e3a0-df14-11e9-8e7f-231f13bcb3a0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:46:20.780Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:46:20.780Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "c1734dd0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:24.926Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:24.926Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "c1734dd0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "c1734dd0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:24.926Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:24.926Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "c20aabd0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:24.926Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:24.926Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "c20aabd0-df14-11e9-8e7f-231f13bcb3a0",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:46:24.926Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:46:24.926Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "c1734dd0-df14-11e9-8e7f-231f13bcb3a0",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:46:24.926Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:46:26 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "c20aabd0-df14-11e9-8e7f-231f13bcb3a0" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "c1734dd0-df14-11e9-8e7f-231f13bcb3a0" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "c482fed0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:30.064Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.064Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "c487b9c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:30.095Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.095Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "c482fed0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "c482fed0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:30.064Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.064Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "c487b9c0-df14-11e9-8e7f-231f13bcb3a0" (4)'] = {
  "results": {
    "id": "c487b9c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:30.095Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.095Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "c534c2a0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:46:30.064Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.064Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (6)'] = {
  "results": [
    "c536e580-df14-11e9-8e7f-231f13bcb3a0",
    "c5cbab70-df14-11e9-8e7f-231f13bcb3a0"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"foo","description":"description"} (7)'] = {
  "results": {
    "id": "c534c2a0-df14-11e9-8e7f-231f13bcb3a0",
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [
      {
        "id": "c482fed0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:30.064Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:30.064Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "c487b9c0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:46:30.095Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:30.095Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "c534c2a0-df14-11e9-8e7f-231f13bcb3a0",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-15",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:46:30.064Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:46:30.064Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 3
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (8)'] = {
  "results": {
    "id": "c66af8b0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "c536e580-df14-11e9-8e7f-231f13bcb3a0",
          "c5cbab70-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:30.095Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.095Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "c66af8b0-df14-11e9-8e7f-231f13bcb3a0" (11)'] = {
  "results": {
    "id": "c66af8b0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-13",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-14",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "c536e580-df14-11e9-8e7f-231f13bcb3a0",
          "c5cbab70-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:30.095Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:30.095Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "c7b13450-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "c7b13450-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "c7b13450-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "c849cad0-df14-11e9-8e7f-231f13bcb3a0",
    "c8df5410-df14-11e9-8e7f-231f13bcb3a0"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "c98027f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "c849cad0-df14-11e9-8e7f-231f13bcb3a0",
          "c8df5410-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "c98027f0-df14-11e9-8e7f-231f13bcb3a0" (7)'] = {
  "results": {
    "id": "c98027f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "c849cad0-df14-11e9-8e7f-231f13bcb3a0",
          "c8df5410-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "c98027f0-df14-11e9-8e7f-231f13bcb3a0" (8)'] = {
  "results": {
    "id": "c98027f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "c849cad0-df14-11e9-8e7f-231f13bcb3a0",
          "c8df5410-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "cabd89f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "cabd89f0-df14-11e9-8e7f-231f13bcb3a0" (11)'] = {
  "results": {
    "id": "cabd89f0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:35.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:35.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953538187
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "cbff58c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:42.618Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:42.618Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "cbff58c0-df14-11e9-8e7f-231f13bcb3a0" (3)'] = {
  "results": {
    "id": "cbff58c0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:46:42.618Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:42.618Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "cc95f370-df14-11e9-8e7f-231f13bcb3a0"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "cd305eb0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "cc95f370-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:42.618Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:42.618Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "cd305eb0-df14-11e9-8e7f-231f13bcb3a0" (7)'] = {
  "results": {
    "id": "cd305eb0-df14-11e9-8e7f-231f13bcb3a0",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "cc95f370-df14-11e9-8e7f-231f13bcb3a0"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:46:42.618Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:46:42.618Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["cc95f370-df14-11e9-8e7f-231f13bcb3a0"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "599c8d10-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:40.208Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:40.208Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "599c8d10-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "599c8d10-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:40.208Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:40.208Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:41.062Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:50:41.063Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:41.062Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:50:41.063Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:41.995Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:50:41.995Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:41.995Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:50:41.995Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:41.995Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:50:41.995Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "5b57f8b0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:43.071Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:43.071Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "5bdb8090-df15-11e9-8440-557596cb8d08",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:43.978Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:43.978Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "5c7aa6c0-df15-11e9-8440-557596cb8d08",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:44.989Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:44.989Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "5b57f8b0-df15-11e9-8440-557596cb8d08",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:43.071Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:43.071Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "5bdb8090-df15-11e9-8440-557596cb8d08",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:43.978Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:43.978Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "5c7aa6c0-df15-11e9-8440-557596cb8d08",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:44.989Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:44.989Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "5d1a1b10-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:46.066Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:46.066Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "5d1a1b10-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "5d1a1b10-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:46.066Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:46.066Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "5dc91fc0-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:46.066Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:46.066Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "5f001920-df15-11e9-8440-557596cb8d08",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:49.251Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:49.251Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "5f9b47b0-df15-11e9-8440-557596cb8d08",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:50.269Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:50.269Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "5dc91fc0-df15-11e9-8440-557596cb8d08",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:46.066Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:46.066Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "5f001920-df15-11e9-8440-557596cb8d08",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:49.251Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:49.251Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "5f9b47b0-df15-11e9-8440-557596cb8d08",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:50:50.269Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:50:50.269Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "603cdee0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:51.328Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:51.328Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "603cdee0-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "603cdee0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:51.328Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:51.328Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "60d4b210-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:51.328Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:51.328Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "60d4b210-df15-11e9-8440-557596cb8d08" (6)'] = {
  "results": {
    "id": "60d4b210-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:51.328Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:51.328Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "603cdee0-df15-11e9-8440-557596cb8d08" (7)'] = {
  "results": {
    "id": "603cdee0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:51.328Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:50:53 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "621aedb0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:54.460Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:54.460Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "621aedb0-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "621aedb0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:54.460Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:54.460Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "62ae05f0-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:54.460Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:54.460Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "62ae05f0-df15-11e9-8440-557596cb8d08",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:50:54.460Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:50:54.460Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "621aedb0-df15-11e9-8440-557596cb8d08",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:50:54.460Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:50:56 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "63ed15a0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:57.513Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:57.513Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "63ed15a0-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "63ed15a0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:57.513Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:57.513Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "648054f0-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:50:57.513Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:50:57.513Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "63ed15a0-df15-11e9-8440-557596cb8d08" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "648054f0-df15-11e9-8440-557596cb8d08",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:50:57.513Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:50:57.513Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "665b2f70-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:01.589Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:01.589Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "665b2f70-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "665b2f70-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:01.589Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:01.589Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "66eee3f0-df15-11e9-8440-557596cb8d08",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:01.589Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:01.589Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "66eee3f0-df15-11e9-8440-557596cb8d08",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:51:01.589Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:51:01.589Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "665b2f70-df15-11e9-8440-557596cb8d08",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:51:01.589Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:51:03 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "66eee3f0-df15-11e9-8440-557596cb8d08" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "665b2f70-df15-11e9-8440-557596cb8d08" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6960ce50-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:06.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:06.663Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "6960ce50-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "6960ce50-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:06.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:06.663Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "69f76900-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:51:06.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:06.663Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "69f76900-df15-11e9-8440-557596cb8d08",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "6960ce50-df15-11e9-8440-557596cb8d08",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:51:06.663Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:51:06.663Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "69f76900-df15-11e9-8440-557596cb8d08",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:51:06.663Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:51:06.663Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6b33b990-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:09.715Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:09.715Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "6b33b990-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "6b33b990-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:09.715Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:09.715Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "6bc7e340-df15-11e9-8440-557596cb8d08",
    "6c5de1b0-df15-11e9-8440-557596cb8d08"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "6cfd2ef0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6bc7e340-df15-11e9-8440-557596cb8d08",
          "6c5de1b0-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:09.715Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:09.715Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "6cfd2ef0-df15-11e9-8440-557596cb8d08" (7)'] = {
  "results": {
    "id": "6cfd2ef0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6bc7e340-df15-11e9-8440-557596cb8d08",
          "6c5de1b0-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:09.715Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:09.715Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "6e3e6180-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "6e3e6180-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "6e3e6180-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "6ed2d950-df15-11e9-8440-557596cb8d08",
    "6f683b80-df15-11e9-8440-557596cb8d08"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "7009aba0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6ed2d950-df15-11e9-8440-557596cb8d08",
          "6f683b80-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "7009aba0-df15-11e9-8440-557596cb8d08" (7)'] = {
  "results": {
    "id": "7009aba0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6ed2d950-df15-11e9-8440-557596cb8d08",
          "6f683b80-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "7009aba0-df15-11e9-8440-557596cb8d08" (8)'] = {
  "results": {
    "id": "7009aba0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "6ed2d950-df15-11e9-8440-557596cb8d08",
          "6f683b80-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "714782d0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "714782d0-df15-11e9-8440-557596cb8d08" (11)'] = {
  "results": {
    "id": "714782d0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:14.826Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:14.826Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953816638
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "7281fea0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:21.979Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:21.979Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "7281fea0-df15-11e9-8440-557596cb8d08" (3)'] = {
  "results": {
    "id": "7281fea0-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:51:21.979Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:21.979Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "73193590-df15-11e9-8440-557596cb8d08"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "73b21a30-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "73193590-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:21.979Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:21.979Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "73b21a30-df15-11e9-8440-557596cb8d08" (7)'] = {
  "results": {
    "id": "73b21a30-df15-11e9-8440-557596cb8d08",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "73193590-df15-11e9-8440-557596cb8d08"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:51:21.979Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:51:21.979Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["73193590-df15-11e9-8440-557596cb8d08"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a2195ff0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:41.821Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:41.821Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "a2195ff0-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "a2195ff0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:41.821Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:41.821Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:42.607Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:52:42.607Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:42.607Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:52:42.607Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:43.616Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:52:43.616Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:43.616Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:52:43.616Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:43.616Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:52:43.616Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a3c4c600-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:44.625Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:44.625Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "a4574200-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:45.584Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:45.584Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "a4f11100-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:46.594Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:46.594Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "a3c4c600-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:44.625Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:44.625Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "a4574200-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:45.584Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:45.584Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "a4f11100-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:46.594Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:46.594Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a594cb10-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:47.666Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:47.666Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "a594cb10-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "a594cb10-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:47.666Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:47.666Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "a6291bd0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:47.666Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:47.666Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "a7606350-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:50.678Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:50.678Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "a7fbe000-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:51.698Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:51.698Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "a6291bd0-df15-11e9-925c-dbb99b7eb4ae",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:47.666Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:47.666Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "a7606350-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:50.678Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:50.678Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "a7fbe000-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:52:51.698Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:52:51.698Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "a89dc550-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:52.759Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:52.759Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "a89dc550-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "a89dc550-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:52.759Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:52.759Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "a9435420-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:52.759Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:52.759Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "a9435420-df15-11e9-925c-dbb99b7eb4ae" (6)'] = {
  "results": {
    "id": "a9435420-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:52.759Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:52.759Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "a89dc550-df15-11e9-925c-dbb99b7eb4ae" (7)'] = {
  "results": {
    "id": "a89dc550-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:52.759Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:52:54 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "aa832720-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:55.938Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:55.938Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "aa832720-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "aa832720-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:55.938Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:55.938Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "ab126ed0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:55.938Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:55.938Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "ab126ed0-df15-11e9-925c-dbb99b7eb4ae",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:52:55.938Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:52:55.938Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "aa832720-df15-11e9-925c-dbb99b7eb4ae",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:52:55.938Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:52:57 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "ac58aa70-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:58.983Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:58.983Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "ac58aa70-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "ac58aa70-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:58.983Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:58.983Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "ace88e60-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:52:58.983Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:52:58.983Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "ac58aa70-df15-11e9-925c-dbb99b7eb4ae" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "ace88e60-df15-11e9-925c-dbb99b7eb4ae",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:52:58.983Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:52:58.983Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "aed9d710-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:03.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:03.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "aed9d710-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "aed9d710-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:03.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:03.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "af552190-df15-11e9-925c-dbb99b7eb4ae",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:03.214Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:03.214Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "af552190-df15-11e9-925c-dbb99b7eb4ae",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:53:03.214Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:53:03.214Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "aed9d710-df15-11e9-925c-dbb99b7eb4ae",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:53:03.214Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:53:05 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "af552190-df15-11e9-925c-dbb99b7eb4ae" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "aed9d710-df15-11e9-925c-dbb99b7eb4ae" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b1ec4730-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:08.372Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:08.372Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "b1ec4730-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "b1ec4730-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:08.372Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:08.372Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "b28070e0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:53:08.372Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:08.372Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "b28070e0-df15-11e9-925c-dbb99b7eb4ae",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "b1ec4730-df15-11e9-925c-dbb99b7eb4ae",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:53:08.372Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:53:08.372Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "b28070e0-df15-11e9-925c-dbb99b7eb4ae",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:53:08.372Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:53:08.372Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b3bc7350-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:11.415Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:11.415Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "b3bc7350-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "b3bc7350-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:11.415Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:11.415Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "b44f8b90-df15-11e9-925c-dbb99b7eb4ae",
    "b4e53be0-df15-11e9-925c-dbb99b7eb4ae"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "b5848920-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b44f8b90-df15-11e9-925c-dbb99b7eb4ae",
          "b4e53be0-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:11.415Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:11.415Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "b5848920-df15-11e9-925c-dbb99b7eb4ae" (7)'] = {
  "results": {
    "id": "b5848920-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b44f8b90-df15-11e9-925c-dbb99b7eb4ae",
          "b4e53be0-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:11.415Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:11.415Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "b6c5bbb0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "b6c5bbb0-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "b6c5bbb0-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "b756ff30-df15-11e9-925c-dbb99b7eb4ae",
    "b7ebc520-df15-11e9-925c-dbb99b7eb4ae"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "b88a7620-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b756ff30-df15-11e9-925c-dbb99b7eb4ae",
          "b7ebc520-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "b88a7620-df15-11e9-925c-dbb99b7eb4ae" (7)'] = {
  "results": {
    "id": "b88a7620-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b756ff30-df15-11e9-925c-dbb99b7eb4ae",
          "b7ebc520-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "b88a7620-df15-11e9-925c-dbb99b7eb4ae" (8)'] = {
  "results": {
    "id": "b88a7620-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "b756ff30-df15-11e9-925c-dbb99b7eb4ae",
          "b7ebc520-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "b9c5b540-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "b9c5b540-df15-11e9-925c-dbb99b7eb4ae" (11)'] = {
  "results": {
    "id": "b9c5b540-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:16.507Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:16.507Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571953937314
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "bb005820-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:23.601Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:23.601Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "bb005820-df15-11e9-925c-dbb99b7eb4ae" (3)'] = {
  "results": {
    "id": "bb005820-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:53:23.601Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:23.601Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "bb937060-df15-11e9-925c-dbb99b7eb4ae"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "bc2b1c80-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "bb937060-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:23.601Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:23.601Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "bc2b1c80-df15-11e9-925c-dbb99b7eb4ae" (7)'] = {
  "results": {
    "id": "bc2b1c80-df15-11e9-925c-dbb99b7eb4ae",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "bb937060-df15-11e9-925c-dbb99b7eb4ae"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:53:23.601Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:53:23.601Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["bb937060-df15-11e9-925c-dbb99b7eb4ae"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "f8e31650-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:07.424Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:07.424Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "f8e31650-df15-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "f8e31650-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:07.424Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:07.424Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:08.156Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:55:08.156Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:08.156Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:55:08.156Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default Policy","description":"default policy create by kibana (not possible to delete)"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:09.274Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:55:09.274Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default Policy",
    "description": "default policy create by kibana (not possible to delete)",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:09.274Z",
    "created_by": "kibana",
    "updated_on": "2019-09-24T21:55:09.274Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default Policy",
        "description": "default policy create by kibana (not possible to delete)",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:09.274Z",
        "created_by": "kibana",
        "updated_on": "2019-09-24T21:55:09.274Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "fa98b590-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:10.299Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:10.299Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "fb2fec80-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:11.288Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:11.288Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "fbcc7aa0-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:12.313Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:12.313Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "fa98b590-df15-11e9-9c0c-7fd75b06fb22",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:10.299Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:10.299Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "fb2fec80-df15-11e9-9c0c-7fd75b06fb22",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:11.288Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:11.288Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "fbcc7aa0-df15-11e9-9c0c-7fd75b06fb22",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:12.313Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:12.313Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "fc6dc3b0-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:13.370Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:13.370Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "fc6dc3b0-df15-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "fc6dc3b0-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:13.370Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:13.370Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "fd03c220-df15-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:13.370Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:13.370Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "fe3c1b10-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:16.400Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:16.400Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "fed4d8a0-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:17.401Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:17.401Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "fd03c220-df15-11e9-9c0c-7fd75b06fb22",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:13.370Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:13.370Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "fe3c1b10-df15-11e9-9c0c-7fd75b06fb22",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:16.400Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:16.400Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "fed4d8a0-df15-11e9-9c0c-7fd75b06fb22",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:17.401Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:17.401Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "ff79cb30-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:18.483Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:18.483Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "ff79cb30-df15-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "ff79cb30-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:18.483Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:18.483Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "000d0a80-df16-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:18.483Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:18.483Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "000d0a80-df16-11e9-9c0c-7fd75b06fb22" (6)'] = {
  "results": {
    "id": "000d0a80-df16-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:18.483Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:18.483Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "ff79cb30-df15-11e9-9c0c-7fd75b06fb22" (7)'] = {
  "results": {
    "id": "ff79cb30-df15-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:18.483Z",
    "created_by": "mattapperson",
    "updated_on": "Tue Sep 24 2019 17:55:20 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "014c1a30-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:21.540Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:21.540Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "014c1a30-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "014c1a30-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:21.540Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:21.540Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "01dfa7a0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:21.540Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:21.540Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "01dfa7a0-df16-11e9-9c0c-7fd75b06fb22",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:55:21.540Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:55:21.540Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "014c1a30-df16-11e9-9c0c-7fd75b06fb22",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:55:21.540Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:55:23 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0320b320-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:24.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:24.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "0320b320-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "0320b320-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:24.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:24.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "03b2e100-df16-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:24.608Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:24.608Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "0320b320-df16-11e9-9c0c-7fd75b06fb22" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "03b2e100-df16-11e9-9c0c-7fd75b06fb22",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:55:24.608Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:55:24.608Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "058b2370-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:28.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:28.663Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "058b2370-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "058b2370-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:28.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:28.663Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "06223350-df16-11e9-9c0c-7fd75b06fb22",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:28.663Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:28.663Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "06223350-df16-11e9-9c0c-7fd75b06fb22",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:55:28.663Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-24T21:55:28.663Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "058b2370-df16-11e9-9c0c-7fd75b06fb22",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-24T21:55:28.663Z",
      "created_by": "mattapperson",
      "updated_on": "Tue Sep 24 2019 17:55:30 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "06223350-df16-11e9-9c0c-7fd75b06fb22" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "058b2370-df16-11e9-9c0c-7fd75b06fb22" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0891acb0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:33.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:33.739Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "0891acb0-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "0891acb0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:33.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:33.739Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "092735f0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-24T21:55:33.739Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:33.739Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "092735f0-df16-11e9-9c0c-7fd75b06fb22",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "0891acb0-df16-11e9-9c0c-7fd75b06fb22",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-24T21:55:33.739Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:33.739Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "092735f0-df16-11e9-9c0c-7fd75b06fb22",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-24T21:55:33.739Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-24T21:55:33.739Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0a66e1e0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:36.808Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:36.808Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "0a66e1e0-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "0a66e1e0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:36.808Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:36.808Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "0af69ec0-df16-11e9-9c0c-7fd75b06fb22",
    "0b8c4f10-df16-11e9-9c0c-7fd75b06fb22"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "0c2b9c50-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0af69ec0-df16-11e9-9c0c-7fd75b06fb22",
          "0b8c4f10-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:36.808Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:36.808Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "0c2b9c50-df16-11e9-9c0c-7fd75b06fb22" (7)'] = {
  "results": {
    "id": "0c2b9c50-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0af69ec0-df16-11e9-9c0c-7fd75b06fb22",
          "0b8c4f10-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:36.808Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:36.808Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0d6c0b90-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "0d6c0b90-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "0d6c0b90-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "0e023110-df16-11e9-9c0c-7fd75b06fb22",
    "0e9437e0-df16-11e9-9c0c-7fd75b06fb22"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "0f3273b0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0e023110-df16-11e9-9c0c-7fd75b06fb22",
          "0e9437e0-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "0f3273b0-df16-11e9-9c0c-7fd75b06fb22" (7)'] = {
  "results": {
    "id": "0f3273b0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0e023110-df16-11e9-9c0c-7fd75b06fb22",
          "0e9437e0-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "0f3273b0-df16-11e9-9c0c-7fd75b06fb22" (8)'] = {
  "results": {
    "id": "0f3273b0-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "0e023110-df16-11e9-9c0c-7fd75b06fb22",
          "0e9437e0-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "106f6080-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "106f6080-df16-11e9-9c0c-7fd75b06fb22" (11)'] = {
  "results": {
    "id": "106f6080-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:41.882Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:41.882Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1571954083697
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "11ba7e20-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:49.035Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:49.035Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "11ba7e20-df16-11e9-9c0c-7fd75b06fb22" (3)'] = {
  "results": {
    "id": "11ba7e20-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-24T21:55:49.035Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:49.035Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "12407700-df16-11e9-9c0c-7fd75b06fb22"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "12d5d930-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "12407700-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:49.035Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:49.035Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "12d5d930-df16-11e9-9c0c-7fd75b06fb22" (7)'] = {
  "results": {
    "id": "12d5d930-df16-11e9-9c0c-7fd75b06fb22",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "12407700-df16-11e9-9c0c-7fd75b06fb22"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-24T21:55:49.035Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-24T21:55:49.035Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["12407700-df16-11e9-9c0c-7fd75b06fb22"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}

exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "012efa60-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:31.758Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:31.758Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib create should create a new policy - get - "012efa60-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "012efa60-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-1",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:31.758Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:31.758Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default policy","description":"Default policy created by Kibana"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:32.682Z",
    "created_by": "kibana",
    "updated_on": "2019-09-25T19:09:32.682Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"page":1,"perPage":25} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default policy",
        "description": "Default policy created by Kibana",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:32.682Z",
        "created_by": "kibana",
        "updated_on": "2019-09-25T19:09:32.682Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Saved object [policies/default] not found\",\"name\":\"Error\",\"stack\":\"Error: Saved object [policies/default] not found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:142:28)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Saved object [policies/default] not found\"},\"headers\":{}}}",
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default policy","description":"Default policy created by Kibana"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:33.682Z",
    "created_by": "kibana",
    "updated_on": "2019-09-25T19:09:33.682Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "default",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:33.682Z",
    "created_by": "kibana",
    "updated_on": "2019-09-25T19:09:33.682Z",
    "updated_by": "kibana"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"page":1,"perPage":25} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default policy",
        "description": "Default policy created by Kibana",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "default",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:33.682Z",
        "created_by": "kibana",
        "updated_on": "2019-09-25T19:09:33.682Z",
        "updated_by": "kibana"
      }
    ],
    "total": 1
  }
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "02f11cc0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-2",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:34.714Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:34.714Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "037fc830-dfc8-11e9-8532-fbebb427011c",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-3",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:35.645Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:35.645Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "041b9300-dfc8-11e9-8532-fbebb427011c",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-4",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:36.671Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:36.671Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should list all active policies - list - {"page":1,"perPage":25} (7)'] = {
  "results": {
    "items": [
      {
        "id": "02f11cc0-dfc8-11e9-8532-fbebb427011c",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-2",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:34.714Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:34.714Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "037fc830-dfc8-11e9-8532-fbebb427011c",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-3",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:35.645Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:35.645Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "041b9300-dfc8-11e9-8532-fbebb427011c",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-4",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:36.671Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:36.671Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 3
  }
}

exports['Policies Lib list should not list inactive policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "04c01060-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:37.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:37.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get - "04c01060-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "04c01060-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:37.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:37.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "05539dd0-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-5",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:37.748Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:37.748Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list should not list inactive policies - get info (6)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test2","description":"test description"} (7)'] = {
  "results": {
    "id": "068e19a0-dfc8-11e9-8532-fbebb427011c",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-6",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:40.768Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:40.768Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - get info (8)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should not list inactive policies - create - {"name":"test3","description":"test description"} (9)'] = {
  "results": {
    "id": "07272550-dfc8-11e9-8532-fbebb427011c",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-7",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:41.780Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:41.780Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list should not list inactive policies - list - {"page":1,"perPage":25} (10)'] = {
  "results": {
    "items": [
      {
        "id": "05539dd0-dfc8-11e9-8532-fbebb427011c",
        "name": "foo",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-5",
        "version": 1,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:37.748Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:37.748Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "068e19a0-dfc8-11e9-8532-fbebb427011c",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-6",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:40.768Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:40.768Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "07272550-dfc8-11e9-8532-fbebb427011c",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-7",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:41.780Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:41.780Z",
        "updated_by": "mattapperson"
      }
    ],
    "total": 4
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "07cb0670-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:42.854Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:42.854Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "07cb0670-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "07cb0670-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:42.854Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:42.854Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "0860b6c0-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:42.854Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:42.854Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "0860b6c0-dfc8-11e9-8532-fbebb427011c" (6)'] = {
  "results": {
    "id": "0860b6c0-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:42.854Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:42.854Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib update should update a policy and invalidate the origional - get - "07cb0670-dfc8-11e9-8532-fbebb427011c" (7)'] = {
  "results": {
    "id": "07cb0670-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "locked",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-8",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:42.854Z",
    "created_by": "mattapperson",
    "updated_on": "Wed Sep 25 2019 15:09:44 GMT-0400 (GMT-04:00)",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "09a0b0d0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:45.932Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:45.932Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - get - "09a0b0d0-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "09a0b0d0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:45.932Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:45.932Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "0a32deb0-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-9",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:45.932Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:45.932Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib list versions Should list past locked versions of a policy - listVersions - {"sharedID":"shared-uuid-9","activeOnly":false,"page":1,"perPage":25} (6)'] = {
  "results": [
    {
      "id": "0a32deb0-dfc8-11e9-8532-fbebb427011c",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-25T19:09:45.932Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-25T19:09:45.932Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "09a0b0d0-dfc8-11e9-8532-fbebb427011c",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-9",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-25T19:09:45.932Z",
      "created_by": "mattapperson",
      "updated_on": "Wed Sep 25 2019 15:09:47 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the version by the versions ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0b7326e0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:48.985Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:48.985Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - get - "0b7326e0-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "0b7326e0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:48.985Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:48.985Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "0c063f20-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-10",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:48.985Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:48.985Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - deleteVersion - "0b7326e0-dfc8-11e9-8532-fbebb427011c" (6)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the version by the versions ID - listVersions - {"sharedID":"shared-uuid-10","activeOnly":false,"page":1,"perPage":25} (7)'] = {
  "results": [
    {
      "id": "0c063f20-dfc8-11e9-8532-fbebb427011c",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-10",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-25T19:09:48.985Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-25T19:09:48.985Z",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0de2a040-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:53.071Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:53.071Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - get - "0de2a040-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "0de2a040-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:53.071Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:53.071Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - create - {"name":"foo","description":"test description"} (4)'] = {
  "results": {
    "id": "0e7606a0-dfc8-11e9-8532-fbebb427011c",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-11",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:53.071Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:53.071Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - update - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - listVersions - {"sharedID":"shared-uuid-11","activeOnly":false,"page":1,"perPage":10000} (6)'] = {
  "results": [
    {
      "id": "0e7606a0-dfc8-11e9-8532-fbebb427011c",
      "name": "foo",
      "description": "test description",
      "status": "active",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 1,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-25T19:09:53.071Z",
      "created_by": "mattapperson",
      "updated_on": "2019-09-25T19:09:53.071Z",
      "updated_by": "mattapperson"
    },
    {
      "id": "0de2a040-dfc8-11e9-8532-fbebb427011c",
      "name": "test",
      "description": "test description",
      "status": "locked",
      "monitoring_enabled": true,
      "shared_id": "shared-uuid-11",
      "version": 0,
      "agent_version": "8.0.0",
      "data_sources": [],
      "created_on": "2019-09-25T19:09:53.071Z",
      "created_by": "mattapperson",
      "updated_on": "Wed Sep 25 2019 15:09:55 GMT-0400 (GMT-04:00)",
      "updated_by": "mattapperson"
    }
  ]
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "0e7606a0-dfc8-11e9-8532-fbebb427011c" (7)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - deleteVersion - "0de2a040-dfc8-11e9-8532-fbebb427011c" (8)'] = {
  "results": {
    "success": true
  }
}

exports['Policies Lib delete Should delete the all versions when deleting the shared ID - list - {"page":1,"perPage":25} (9)'] = {
  "results": {
    "items": [],
    "total": 0
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "11034130-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:58.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:58.318Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - get - "11034130-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "11034130-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:09:58.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:58.318Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - create - {"name":"test","description":"test description"} (4)'] = {
  "results": {
    "id": "119a2a00-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-12",
    "version": 0,
    "agent_version": "8.0.0",
    "created_on": "2019-09-25T19:09:58.317Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:09:58.318Z",
    "updated_by": "mattapperson",
    "data_sources": []
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - update - {"name":"foo","description":"description"} (5)'] = {
  "results": {
    "id": "119a2a00-dfc8-11e9-8532-fbebb427011c",
    "version": 1
  }
}

exports['Policies Lib createNewPolicyFrom Should duplicate policy but with a new shared_id - list - {"page":1,"perPage":25} (6)'] = {
  "results": {
    "items": [
      {
        "id": "11034130-dfc8-11e9-8532-fbebb427011c",
        "name": "test",
        "description": "test description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-12",
        "version": 0,
        "agent_version": "8.0.0",
        "data_sources": [],
        "created_on": "2019-09-25T19:09:58.317Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:58.318Z",
        "updated_by": "mattapperson"
      },
      {
        "id": "119a2a00-dfc8-11e9-8532-fbebb427011c",
        "name": "foo",
        "description": "description",
        "status": "active",
        "monitoring_enabled": true,
        "shared_id": "shared-uuid-13",
        "version": 0,
        "agent_version": "8.0.0",
        "created_on": "2019-09-25T19:09:58.317Z",
        "created_by": "mattapperson",
        "updated_on": "2019-09-25T19:09:58.318Z",
        "updated_by": "mattapperson",
        "data_sources": []
      }
    ],
    "total": 2
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "12d9fd00-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:01.407Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:01.407Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "12d9fd00-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "12d9fd00-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:01.407Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:01.407Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - addInputs - [null,null] (4)'] = {
  "results": [
    "13721e50-dfc8-11e9-8532-fbebb427011c",
    "14053690-dfc8-11e9-8532-fbebb427011c"
  ]
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "14a59540-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "13721e50-dfc8-11e9-8532-fbebb427011c",
          "14053690-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:01.407Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:01.407Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestAddDataSource Should add data sources and inputs to the policy - get - "14a59540-dfc8-11e9-8532-fbebb427011c" (7)'] = {
  "results": {
    "id": "14a59540-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-14",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-15",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "13721e50-dfc8-11e9-8532-fbebb427011c",
          "14053690-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:01.407Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:01.407Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "15e652a0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "15e652a0-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "15e652a0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - addInputs - [null,null] (4)'] = {
  "results": [
    "167e4ce0-dfc8-11e9-8532-fbebb427011c",
    "17122870-dfc8-11e9-8532-fbebb427011c"
  ]
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "17b19cc0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "167e4ce0-dfc8-11e9-8532-fbebb427011c",
          "17122870-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "17b19cc0-dfc8-11e9-8532-fbebb427011c" (7)'] = {
  "results": {
    "id": "17b19cc0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "167e4ce0-dfc8-11e9-8532-fbebb427011c",
          "17122870-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "17b19cc0-dfc8-11e9-8532-fbebb427011c" (8)'] = {
  "results": {
    "id": "17b19cc0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-17",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "167e4ce0-dfc8-11e9-8532-fbebb427011c",
          "17122870-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - create - {"name":"test","description":"test description"} (9)'] = {
  "results": {
    "id": "18f121a0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - update - {"name":"test","description":"test description"} (10)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib requestDeleteDataSource Should delete data sources - get - "18f121a0-dfc8-11e9-8532-fbebb427011c" (11)'] = {
  "results": {
    "id": "18f121a0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-16",
    "version": 2,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:06.521Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:06.521Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1572030549255
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "1a2a16d0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:13.676Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:13.676Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "1a2a16d0-dfc8-11e9-8532-fbebb427011c" (3)'] = {
  "results": {
    "id": "1a2a16d0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 0,
    "agent_version": "8.0.0",
    "data_sources": [],
    "created_on": "2019-09-25T19:10:13.676Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:13.676Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - addInputs - [null] (4)'] = {
  "results": [
    "1addaf60-dfc8-11e9-8532-fbebb427011c"
  ]
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - create - {"name":"test","description":"test description"} (5)'] = {
  "results": {
    "id": "1b6c0cb0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "1addaf60-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:13.676Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:13.676Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - update - {"name":"test","description":"test description"} (6)'] = {
  "results": {
    "version": 1
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - get - "1b6c0cb0-dfc8-11e9-8532-fbebb427011c" (7)'] = {
  "results": {
    "id": "1b6c0cb0-dfc8-11e9-8532-fbebb427011c",
    "name": "test",
    "description": "test description",
    "status": "active",
    "monitoring_enabled": true,
    "shared_id": "shared-uuid-18",
    "version": 1,
    "agent_version": "8.0.0",
    "data_sources": [
      {
        "uuid": "uuid-19",
        "output": "43hi34hi5y3i53o4",
        "inputs": [
          "1addaf60-dfc8-11e9-8532-fbebb427011c"
        ],
        "queue": "\"\""
      }
    ],
    "created_on": "2019-09-25T19:10:13.676Z",
    "created_by": "mattapperson",
    "updated_on": "2019-09-25T19:10:13.676Z",
    "updated_by": "mattapperson"
  }
}

exports['Policies Lib getFull Should return a policy with all inputs, not just refs to the inputs - getInputsById - {"ids":["1addaf60-dfc8-11e9-8532-fbebb427011c"]} (8)'] = {
  "results": [
    {
      "other": "{\"foo\":\"bar\"}",
      "data_source_id": "uuid-19"
    }
  ]
}
