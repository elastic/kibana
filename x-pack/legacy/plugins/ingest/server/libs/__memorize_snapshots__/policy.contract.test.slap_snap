
exports['Policies Lib create should create a new policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib create should create a new policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "0dfa5cc0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:50.056Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib create should create a new policy - get - "0dfa5cc0-1bba-11ea-847d-5b5d0dfb7fa2" (3)'] = {
  "results": {
    "id": "0dfa5cc0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:50.056Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib create should create a new policy - get by IDs - [] (4)'] = {
  "results": []
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get - "default" (1)'] = {
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - create - {"name":"Default policy","description":"Default policy created by Kibana"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "datasources": [],
    "updated_on": "2019-12-11T02:00:51.964Z",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - list - {"username":"internal","options":{"page":1,"perPage":20}} (4)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default policy",
        "description": "Default policy created by Kibana",
        "status": "active",
        "datasources": [],
        "updated_on": "2019-12-11T02:00:51.964Z",
        "updated_by": "Fleet (system action)"
      }
    ],
    "total": 1,
    "page": 1,
    "perPage": 20
  }
}

exports['Policies Lib ensureDefaultPolicy should create a new default policy if none exists - get by IDs - [] (5)'] = {
  "results": []
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (1)'] = {
  "results": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get info (2)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - create - {"name":"Default policy","description":"Default policy created by Kibana"} (3)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "datasources": [],
    "updated_on": "2019-12-11T02:00:53.008Z",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get - "default" (4)'] = {
  "results": {
    "id": "default",
    "name": "Default policy",
    "description": "Default policy created by Kibana",
    "status": "active",
    "datasources": [],
    "updated_on": "2019-12-11T02:00:53.008Z",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - list - {"username":"internal","options":{"page":1,"perPage":20}} (5)'] = {
  "results": {
    "items": [
      {
        "id": "default",
        "name": "Default policy",
        "description": "Default policy created by Kibana",
        "status": "active",
        "datasources": [],
        "updated_on": "2019-12-11T02:00:53.008Z",
        "updated_by": "Fleet (system action)"
      }
    ],
    "total": 1,
    "page": 1,
    "perPage": 20
  }
}

exports['Policies Lib ensureDefaultPolicy should not create the new default policy more than once - get by IDs - [] (6)'] = {
  "results": []
}

exports['Policies Lib list should list all active policies - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "10575f90-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:54.024Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib list should list all active policies - get info (3)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test2","description":"test description"} (4)'] = {
  "results": {
    "id": "10eb8940-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test2",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test2",
    "updated_on": "2019-12-11T02:00:54.995Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib list should list all active policies - get info (5)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib list should list all active policies - create - {"name":"test3","description":"test description"} (6)'] = {
  "results": {
    "id": "11872d00-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test3",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test3",
    "updated_on": "2019-12-11T02:00:56.014Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib list should list all active policies - list - {"username":"internal","options":{"page":1,"perPage":20}} (7)'] = {
  "results": {
    "items": [
      {
        "id": "10575f90-1bba-11ea-847d-5b5d0dfb7fa2",
        "name": "test",
        "description": "test description",
        "status": "active",
        "datasources": [],
        "label": "test",
        "updated_on": "2019-12-11T02:00:54.024Z",
        "updated_by": "system (Fleet)"
      },
      {
        "id": "10eb8940-1bba-11ea-847d-5b5d0dfb7fa2",
        "name": "test2",
        "description": "test description",
        "status": "active",
        "datasources": [],
        "label": "test2",
        "updated_on": "2019-12-11T02:00:54.995Z",
        "updated_by": "system (Fleet)"
      },
      {
        "id": "11872d00-1bba-11ea-847d-5b5d0dfb7fa2",
        "name": "test3",
        "description": "test description",
        "status": "active",
        "datasources": [],
        "label": "test3",
        "updated_on": "2019-12-11T02:00:56.014Z",
        "updated_by": "system (Fleet)"
      }
    ],
    "total": 3,
    "page": 1,
    "perPage": 20
  }
}

exports['Policies Lib list should list all active policies - get by IDs - [] (8)'] = {
  "results": []
}

exports['Policies Lib update should update a policy and invalidate the original - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should update a policy and invalidate the original - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:57.066Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib update should update a policy and invalidate the original - get - "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2" (3)'] = {
  "results": {
    "id": "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:57.066Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib update should update a policy and invalidate the original - update - {"id":"12278bb0-1bba-11ea-847d-5b5d0dfb7fa2","name":"foo","description":"test description","status":"active","datasources":[],"label":"test","updated_on":"Tue Dec 10 2019 18:00:58 GMT-0800 (Pacific Standard Time)","updated_by":"Fleet (system action)"} (4)'] = {
  "results": {
    "id": "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:00:58 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should update a policy and invalidate the original - get - "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2" (5)'] = {
  "results": {
    "id": "12278bb0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "foo",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:00:58 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should update a policy and invalidate the original - get by IDs - [] (6)'] = {
  "results": []
}

exports['Policies Lib update should assign and unassign data sources to policy - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib update should assign and unassign data sources to policy - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:59.115Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - get - "136059d0-1bba-11ea-847d-5b5d0dfb7fa2" (3)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:00:59.115Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - update - {"id":"136059d0-1bba-11ea-847d-5b5d0dfb7fa2","name":"test","description":"test description","status":"active","datasources":["foo","bar"],"label":"test","updated_on":"Tue Dec 10 2019 18:01:00 GMT-0800 (Pacific Standard Time)","updated_by":"Fleet (system action)"} (4)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [
      "foo",
      "bar"
    ],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:01:00 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - get - "136059d0-1bba-11ea-847d-5b5d0dfb7fa2" (5)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [
      "foo",
      "bar"
    ],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:01:00 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - update - {"id":"136059d0-1bba-11ea-847d-5b5d0dfb7fa2","name":"test","description":"test description","status":"active","datasources":["foo","bar","test"],"label":"test","updated_on":"Tue Dec 10 2019 18:01:01 GMT-0800 (Pacific Standard Time)","updated_by":"Fleet (system action)"} (6)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [
      "foo",
      "bar",
      "test"
    ],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:01:01 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - get - "136059d0-1bba-11ea-847d-5b5d0dfb7fa2" (7)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [
      "foo",
      "bar",
      "test"
    ],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:01:01 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib update should assign and unassign data sources to policy - update - {"id":"136059d0-1bba-11ea-847d-5b5d0dfb7fa2","name":"test","description":"test description","status":"active","datasources":["bar"],"label":"test","updated_on":"Tue Dec 10 2019 18:01:02 GMT-0800 (Pacific Standard Time)","updated_by":"Fleet (system action)"} (8)'] = {
  "results": {
    "id": "136059d0-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [
      "bar"
    ],
    "label": "test",
    "updated_on": "Tue Dec 10 2019 18:01:02 GMT-0800 (Pacific Standard Time)",
    "updated_by": "Fleet (system action)"
  }
}

exports['Policies Lib delete Should delete the by the ID - get info (1)'] = {
  "results": {
    "kibana": {
      "version": "8.0.0"
    },
    "license": {
      "type": "trial",
      "expired": false,
      "expiry_date_in_millis": 1578621628829
    },
    "security": {
      "enabled": true,
      "available": true
    },
    "watcher": {
      "enabled": true,
      "available": true
    }
  },
  "thrownError": null
}

exports['Policies Lib delete Should delete the by the ID - create - {"name":"test","description":"test description"} (2)'] = {
  "results": {
    "id": "15d50350-1bba-11ea-847d-5b5d0dfb7fa2",
    "name": "test",
    "description": "test description",
    "status": "active",
    "datasources": [],
    "label": "test",
    "updated_on": "2019-12-11T02:01:03.235Z",
    "updated_by": "system (Fleet)"
  }
}

exports['Policies Lib delete Should delete the by the ID - delete - 15d50350-1bba-11ea-847d-5b5d0dfb7fa2'] = {}

exports['Policies Lib delete Should delete the by the ID - list - {"username":"internal","options":{"page":1,"perPage":20}} (3)'] = {
  "results": {
    "items": [],
    "total": 0,
    "page": 1,
    "perPage": 20
  }
}

exports['Policies Lib delete Should delete the by the ID - get by IDs - [] (4)'] = {
  "results": []
}
