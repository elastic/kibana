{
  "id": "siem_auditbeat_ecs",
  "title": "SIEM Auditbeat",
  "description": "Detect suspicious logins and unusual processes in Auditbeat ECS data (beta)",
  "type": "Auditbeat data",
  "logoFile": "logo.json",
  "defaultIndexPattern": "auditbeat-*",
  "query": {
    "bool" : {
      "filter": [
        {
          "bool": {
            "should" : [
              { "terms": { "event.action": [ "process_started", "executed" ] } },
              { "term": { "event.category": "authentication" }}
            ],
            "minimum_should_match" : 1
          }
        },
        { "term": { "agent.type": "auditbeat" } }
      ]
    }
  },
  "jobs": [
    {
      "id": "rare_process_by_host_linux_ecs",
      "file": "rare_process_by_host_linux_ecs.json"
    },
    {
      "id": "suspicious_login_activity_ecs",
      "file": "suspicious_login_activity_ecs.json"
    },
    {
      "id": "linux_anomalous_network_activity",
      "file": "linux_anomalous_network_activity.json"
    },
    {
      "id": "linux_anomalous_network_port_activity",
      "file": "linux_anomalous_network_port_activity.json"
    },
    {
      "id": "linux_anomalous_network_service",
      "file": "linux_anomalous_network_service.json"
    },
    {
      "id": "linux_anomalous_network_url_activity",
      "file": "linux_anomalous_network_url_activity.json"
    },
    {
      "id": "linux_anomalous_process_all_hosts",
      "file": "linux_anomalous_process_all_hosts.json"
    },
    {
      "id": "linux_anomalous_user_name",
      "file": "linux_anomalous_user_name.json"
    }
  ],
  "datafeeds": [
    {
      "id": "datafeed-rare_process_by_host_linux_ecs",
      "file": "datafeed_rare_process_by_host_linux_ecs.json",
      "job_id": "rare_process_by_host_linux_ecs"
    },
    {
      "id": "datafeed-suspicious_login_activity_ecs",
      "file": "datafeed_suspicious_login_activity_ecs.json",
      "job_id": "suspicious_login_activity_ecs"
    },
    {
      "id": "datafeed-linux_anomalous_network_activity",
      "file": "datafeed_linux_anomalous_network_activity.json",
      "job_id": "linux_anomalous_network_activity"
    },
    {
      "id": "datafeed-linux_anomalous_network_port_activity",
      "file": "datafeed_linux_anomalous_network_port_activity.json",
      "job_id": "linux_anomalous_network_port_activity"
    },
    {
      "id": "datafeed-linux_anomalous_network_service",
      "file": "datafeed_linux_anomalous_network_service.json",
      "job_id": "linux_anomalous_network_service"
    },
    {
      "id": "datafeed-linux_anomalous_network_url_activity",
      "file": "datafeed_linux_anomalous_network_url_activity.json",
      "job_id": "linux_anomalous_network_url_activity"
    },
    {
      "id": "datafeed-linux_anomalous_process_all_hosts",
      "file": "datafeed_linux_anomalous_process_all_hosts.json",
      "job_id": "linux_anomalous_process_all_hosts"
    },
    {
      "id": "datafeed-linux_anomalous_user_name",
      "file": "datafeed_linux_anomalous_user_name.json",
      "job_id": "linux_anomalous_user_name"
    }
  ]
}
