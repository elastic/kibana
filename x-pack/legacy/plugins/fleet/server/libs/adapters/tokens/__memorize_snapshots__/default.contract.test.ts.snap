
exports['Agent Adapter create allow to create a token - create (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1b037010-bebc-11e9-bd17-cb41664c5500",
    "attributes": {
      "created_at": "2019-08-14T17:51:12.781Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-08-14T17:51:12.784Z",
    "version": "WzAsMV0="
  }
}

exports['Agent Adapter create allow to create a token - delete (4)'] = {
  "results": {}
}

exports['Agent Adapter create allow to create a token - find (2)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent Adapter create allow to create a token - find (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1b037010-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "created_at": "2019-08-14T17:51:12.781Z",
          "type": 1,
          "token": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:12.784Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Agent Adapter create allow to create a token - get (2)'] = {
  "results": {
    "id": "1b037010-bebc-11e9-bd17-cb41664c5500",
    "type": "tokens",
    "updated_at": "2019-08-14T17:51:12.784Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-08-14T17:51:12.781Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Agent Adapter delete allow to update a token - create (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1fb9cc30-bebc-11e9-bd17-cb41664c5500",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-14T17:51:20.691Z",
    "version": "WzEyLDFd"
  }
}

exports['Agent Adapter delete allow to update a token - delete (2)'] = {
  "results": {}
}

exports['Agent Adapter delete allow to update a token - find (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent Adapter delete allow to update a token - get (3)'] = {
  "results": null
}

exports['Agent Adapter getByToken allow to find a token - create (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1c177820-bebc-11e9-bd17-cb41664c5500",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-14T17:51:14.594Z",
    "version": "WzUsMV0="
  }
}

exports['Agent Adapter getByToken allow to find a token - create (2)'] = {
  "results": {
    "type": "tokens",
    "id": "4632c080-beb5-11e9-b0b3-1bb7b3f9759d",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-14T17:02:18.760Z",
    "version": "WzE0NiwxXQ=="
  }
}

exports['Agent Adapter getByToken allow to find a token - delete (5)'] = {
  "results": {}
}

exports['Agent Adapter getByToken allow to find a token - delete (6)'] = {
  "results": {}
}

exports['Agent Adapter getByToken allow to find a token - find (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1c179f30-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:14.595Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['Agent Adapter getByToken allow to find a token - find (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1c179f30-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:14.595Z",
        "version": "WzQsMV0="
      },
      {
        "type": "tokens",
        "id": "1c177820-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:14.594Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Agent Adapter getByToken allow to update a token - create (1)'] = {
  "results": {
    "type": "tokens",
    "id": "60a67970-bdd4-11e9-a184-cf08611ad970",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-13T14:12:26.375Z",
    "version": "WzcsMV0="
  }
}

exports['Agent Adapter getByToken allow to update a token - delete (5)'] = {
  "results": {}
}

exports['Agent Adapter getByToken allow to update a token - find (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "60a67970-bdd4-11e9-a184-cf08611ad970",
        "attributes": {
          "active": false,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-13T14:12:27.399Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Agent Adapter getByToken allow to update a token - get (3)'] = {
  "results": {
    "id": "60a67970-bdd4-11e9-a184-cf08611ad970",
    "type": "tokens",
    "updated_at": "2019-08-13T14:12:27.399Z",
    "version": "WzgsMV0=",
    "attributes": {
      "active": false,
      "type": 1,
      "token": "qwerty"
    },
    "references": []
  }
}

exports['Agent Adapter getByToken allow to update a token - update (2)'] = {
  "results": {
    "id": "60a67970-bdd4-11e9-a184-cf08611ad970",
    "type": "tokens",
    "updated_at": "2019-08-13T14:12:27.399Z",
    "version": "WzgsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Agent Adapter getByToken return null if the token does not exists - create (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1de33770-bebc-11e9-bd17-cb41664c5500",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-14T17:51:17.607Z",
    "version": "WzgsMV0="
  }
}

exports['Agent Adapter getByToken return null if the token does not exists - create (2)'] = {
  "results": {
    "type": "tokens",
    "id": "480388e0-beb5-11e9-b0b3-1bb7b3f9759d",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-14T17:02:21.806Z",
    "version": "WzE1MSwxXQ=="
  }
}

exports['Agent Adapter getByToken return null if the token does not exists - delete (5)'] = {
  "results": {}
}

exports['Agent Adapter getByToken return null if the token does not exists - delete (6)'] = {
  "results": {}
}

exports['Agent Adapter getByToken return null if the token does not exists - find (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent Adapter getByToken return null if the token does not exists - find (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1de35e80-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:17.608Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "1de33770-bebc-11e9-bd17-cb41664c5500",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-14T17:51:17.607Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Agent Adapter update allow to update a token - create (1)'] = {
  "thrownError": "{\"msg\":\"[strict_dynamic_mapping_exception] mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\",\"path\":\"/.kibana/_doc/tokens%3A1c0f88e0-bebc-11e9-bd17-cb41664c5500\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":1,\\\"token\\\":\\\"qwerty\\\",\\\"config\\\":{\\\"id\\\":\\\"policyId\\\",\\\"sharedId\\\":\\\"sharedId\\\"}},\\\"type\\\":\\\"tokens\\\",\\\"references\\\":[],\\\"updated_at\\\":\\\"2019-08-14T17:51:14.542Z\\\"}\",\"statusCode\":400,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"strict_dynamic_mapping_exception\\\",\\\"reason\\\":\\\"mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\\\"}],\\\"type\\\":\\\"strict_dynamic_mapping_exception\\\",\\\"reason\\\":\\\"mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\\\"},\\\"status\\\":400}\"}",
  "results": null
}

exports['Agent Adapter update allow to update a token - delete (5)'] = {
  "results": {}
}

exports['Agent Adapter update allow to update a token - find (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent Adapter update allow to update a token - find (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f1ccc2c0-bdfb-11e9-bad2-df414974216e",
        "attributes": {
          "active": false,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-13T18:55:41.283Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Agent Adapter update allow to update a token - get (3)'] = {
  "results": {
    "id": "f1ccc2c0-bdfb-11e9-bad2-df414974216e",
    "type": "tokens",
    "updated_at": "2019-08-13T18:55:41.283Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": false,
      "type": 1,
      "token": "qwerty"
    },
    "references": []
  }
}

exports['Agent Adapter update allow to update a token - update (2)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as update] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:637:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2322ddf0-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "created_at": "2019-08-19T13:20:39.243Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:39.247Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:2322ddf0-c284-11e9-8bf7-8ff6aaf97b53:{} (2)'] = {
  "results": {
    "id": "2322ddf0-c284-11e9-8bf7-8ff6aaf97b53",
    "type": "tokens",
    "updated_at": "2019-08-19T13:20:39.247Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-08-19T13:20:39.243Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2322ddf0-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "created_at": "2019-08-19T13:20:39.243Z",
          "type": 1,
          "token": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:39.247Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:2322ddf0-c284-11e9-8bf7-8ff6aaf97b53:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[strict_dynamic_mapping_exception] mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\",\"path\":\"/.kibana/_doc/tokens%3A242ef6c0-c284-11e9-8bf7-8ff6aaf97b53\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":1,\\\"token\\\":\\\"qwerty\\\",\\\"config\\\":{\\\"id\\\":\\\"policyId\\\",\\\"sharedId\\\":\\\"sharedId\\\"}},\\\"type\\\":\\\"tokens\\\",\\\"references\\\":[],\\\"updated_at\\\":\\\"2019-08-19T13:20:41.004Z\\\"}\",\"statusCode\":400,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"strict_dynamic_mapping_exception\\\",\\\"reason\\\":\\\"mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\\\"}],\\\"type\\\":\\\"strict_dynamic_mapping_exception\\\",\\\"reason\\\":\\\"mapping set to strict, dynamic introduction of [config] within [tokens] is not allowed\\\"},\\\"status\\\":400}\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as update] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:637:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByToken allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "24378240-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:41.060Z",
    "version": "WzQsMV0="
  }
}

exports['Token Adapter getByToken allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "24375b30-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:41.058Z",
    "version": "WzMsMV0="
  }
}

exports['Token Adapter getByToken allow to find a token - find:{"type":"tokens","searchFields":["token"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "24378240-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:41.060Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['Token Adapter getByToken allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "24378240-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:41.060Z",
        "version": "WzQsMV0="
      },
      {
        "type": "tokens",
        "id": "24375b30-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:41.058Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter getByToken allow to find a token - delete:tokens:24378240-c284-11e9-8bf7-8ff6aaf97b53:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByToken allow to find a token - delete:tokens:24375b30-c284-11e9-8bf7-8ff6aaf97b53:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByToken return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "26038fb0-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:44.075Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByToken return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "260368a0-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:44.074Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByToken return null if the token does not exists - find:{"type":"tokens","searchFields":["token"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByToken return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "26038fb0-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:44.075Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "260368a0-c284-11e9-8bf7-8ff6aaf97b53",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:20:44.074Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByToken return null if the token does not exists - delete:tokens:26038fb0-c284-11e9-8bf7-8ff6aaf97b53:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByToken return null if the token does not exists - delete:tokens:260368a0-c284-11e9-8bf7-8ff6aaf97b53:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "27d76550-c284-11e9-8bf7-8ff6aaf97b53",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:20:47.141Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:27d76550-c284-11e9-8bf7-8ff6aaf97b53:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:27d76550-c284-11e9-8bf7-8ff6aaf97b53:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "d6c0c520-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "created_at": "2019-08-19T13:25:40.589Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:40.593Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:d6c0c520-c284-11e9-95a0-09c2c5f8dfab:{} (2)'] = {
  "results": {
    "id": "d6c0c520-c284-11e9-95a0-09c2c5f8dfab",
    "type": "tokens",
    "updated_at": "2019-08-19T13:25:40.593Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-08-19T13:25:40.589Z",
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "d6c0c520-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "created_at": "2019-08-19T13:25:40.589Z",
          "type": 1,
          "token": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:40.593Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:d6c0c520-c284-11e9-95a0-09c2c5f8dfab:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "d7cda140-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:42.356Z",
    "version": "WzQsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:d7cda140-c284-11e9-95a0-09c2c5f8dfab:{"active":false}:{} (2)'] = {
  "results": {
    "id": "d7cda140-c284-11e9-95a0-09c2c5f8dfab",
    "type": "tokens",
    "updated_at": "2019-08-19T13:25:43.379Z",
    "version": "WzUsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:d7cda140-c284-11e9-95a0-09c2c5f8dfab:{} (3)'] = {
  "results": {
    "id": "d7cda140-c284-11e9-95a0-09c2c5f8dfab",
    "type": "tokens",
    "updated_at": "2019-08-19T13:25:43.379Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": false,
      "type": 1,
      "token": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "d7cda140-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": false,
          "type": 1,
          "token": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:43.379Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:d7cda140-c284-11e9-95a0-09c2c5f8dfab:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByToken allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "d9a26140-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:45.427Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByToken allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "d9a28850-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:45.429Z",
    "version": "WzcsMV0="
  }
}

exports['Token Adapter getByToken allow to find a token - find:{"type":"tokens","searchFields":["token"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "d9a28850-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:45.429Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Token Adapter getByToken allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "d9a28850-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:45.429Z",
        "version": "WzcsMV0="
      },
      {
        "type": "tokens",
        "id": "d9a26140-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:45.427Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByToken allow to find a token - delete:tokens:d9a28850-c284-11e9-95a0-09c2c5f8dfab:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByToken allow to find a token - delete:tokens:d9a26140-c284-11e9-95a0-09c2c5f8dfab:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByToken return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "db8ea0e0-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:48.654Z",
    "version": "WzExLDFd"
  }
}

exports['Token Adapter getByToken return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "db8e79d0-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:48.653Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByToken return null if the token does not exists - find:{"type":"tokens","searchFields":["token"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByToken return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "db8ea0e0-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:48.654Z",
        "version": "WzExLDFd"
      },
      {
        "type": "tokens",
        "id": "db8e79d0-c284-11e9-95a0-09c2c5f8dfab",
        "attributes": {
          "active": true,
          "type": 1,
          "token": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-19T13:25:48.653Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Token Adapter getByToken return null if the token does not exists - delete:tokens:db8ea0e0-c284-11e9-95a0-09c2c5f8dfab:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByToken return null if the token does not exists - delete:tokens:db8e79d0-c284-11e9-95a0-09c2c5f8dfab:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "dd66e350-c284-11e9-95a0-09c2c5f8dfab",
    "attributes": {
      "active": true,
      "type": 1,
      "token": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-19T13:25:51.749Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:dd66e350-c284-11e9-95a0-09c2c5f8dfab:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:dd66e350-c284-11e9-95a0-09c2c5f8dfab:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "0c049260-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "created_at": "2019-08-26T15:34:52.288Z",
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-08-26T15:34:52.293Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:0c049260-c817-11e9-8f16-8b3dba96cc9f:{} (2)'] = {
  "results": {
    "id": "0c049260-c817-11e9-8f16-8b3dba96cc9f",
    "type": "tokens",
    "updated_at": "2019-08-26T15:34:52.293Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-08-26T15:34:52.288Z",
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "0c049260-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "created_at": "2019-08-26T15:34:52.288Z",
          "type": 1,
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-08-26T15:34:52.293Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:0c049260-c817-11e9-8f16-8b3dba96cc9f:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "0d147bc0-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-08-26T15:34:54.076Z",
    "version": "WzMsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:0d147bc0-c817-11e9-8f16-8b3dba96cc9f:{"active":false}:{} (2)'] = {
  "results": {
    "id": "0d147bc0-c817-11e9-8f16-8b3dba96cc9f",
    "type": "tokens",
    "updated_at": "2019-08-26T15:34:55.117Z",
    "version": "WzQsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:0d147bc0-c817-11e9-8f16-8b3dba96cc9f:{} (3)'] = {
  "results": {
    "id": "0d147bc0-c817-11e9-8f16-8b3dba96cc9f",
    "type": "tokens",
    "updated_at": "2019-08-26T15:34:55.117Z",
    "version": "WzQsMV0=",
    "attributes": {
      "active": false,
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "0d147bc0-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": false,
          "type": 1,
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-08-26T15:34:55.117Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:0d147bc0-c817-11e9-8f16-8b3dba96cc9f:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "0eed3360-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:34:57.174Z",
    "version": "WzcsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "0eed8180-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:34:57.176Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "0eed8180-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:34:57.176Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "0eed3360-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:34:57.174Z",
        "version": "WzcsMV0="
      },
      {
        "type": "tokens",
        "id": "0eed8180-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:34:57.176Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:0eed3360-c817-11e9-8f16-8b3dba96cc9f:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:0eed8180-c817-11e9-8f16-8b3dba96cc9f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "10c4b280-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:35:00.264Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "10c46460-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:35:00.262Z",
    "version": "WzExLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "10c4b280-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:35:00.264Z",
        "version": "WzEyLDFd"
      },
      {
        "type": "tokens",
        "id": "10c46460-c817-11e9-8f16-8b3dba96cc9f",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:35:00.262Z",
        "version": "WzExLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:10c4b280-c817-11e9-8f16-8b3dba96cc9f:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:10c46460-c817-11e9-8f16-8b3dba96cc9f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "12997280-c817-11e9-8f16-8b3dba96cc9f",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:35:03.336Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:12997280-c817-11e9-8f16-8b3dba96cc9f:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:12997280-c817-11e9-8f16-8b3dba96cc9f:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "518e6400-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "created_at": "2019-08-26T15:36:48.952Z",
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:48.960Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:518e6400-c817-11e9-acc3-b5414d75e669:{} (2)'] = {
  "results": {
    "id": "518e6400-c817-11e9-acc3-b5414d75e669",
    "type": "tokens",
    "updated_at": "2019-08-26T15:36:48.960Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-08-26T15:36:48.952Z",
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "518e6400-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "created_at": "2019-08-26T15:36:48.952Z",
          "type": 1,
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:48.960Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:518e6400-c817-11e9-acc3-b5414d75e669:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "52a1f6e0-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:50.766Z",
    "version": "WzMsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:52a1f6e0-c817-11e9-acc3-b5414d75e669:{"active":false}:{} (2)'] = {
  "results": {
    "id": "52a1f6e0-c817-11e9-acc3-b5414d75e669",
    "type": "tokens",
    "updated_at": "2019-08-26T15:36:51.784Z",
    "version": "WzQsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:52a1f6e0-c817-11e9-acc3-b5414d75e669:{} (3)'] = {
  "results": {
    "id": "52a1f6e0-c817-11e9-acc3-b5414d75e669",
    "type": "tokens",
    "updated_at": "2019-08-26T15:36:51.784Z",
    "version": "WzQsMV0=",
    "attributes": {
      "active": false,
      "type": 1,
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "52a1f6e0-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": false,
          "type": 1,
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:51.784Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:52a1f6e0-c817-11e9-acc3-b5414d75e669:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5475f390-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:53.833Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "54761aa0-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:53.834Z",
    "version": "WzcsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "54761aa0-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:53.834Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "54761aa0-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:53.834Z",
        "version": "WzcsMV0="
      },
      {
        "type": "tokens",
        "id": "5475f390-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:53.833Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:54761aa0-c817-11e9-acc3-b5414d75e669:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:5475f390-c817-11e9-acc3-b5414d75e669:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "5649c930-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:56.899Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5649a220-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:56.898Z",
    "version": "WzExLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5649a220-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:56.898Z",
        "version": "WzExLDFd"
      },
      {
        "type": "tokens",
        "id": "5649c930-c817-11e9-acc3-b5414d75e669",
        "attributes": {
          "active": true,
          "type": 1,
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-08-26T15:36:56.899Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:5649a220-c817-11e9-acc3-b5414d75e669:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:5649c930-c817-11e9-acc3-b5414d75e669:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "581decf0-c817-11e9-acc3-b5414d75e669",
    "attributes": {
      "active": true,
      "type": 1,
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-08-26T15:36:59.967Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:581decf0-c817-11e9-acc3-b5414d75e669:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:581decf0-c817-11e9-acc3-b5414d75e669:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fb7cd2a0-d030-11e9-a60d-673487ffae4d",
    "attributes": {
      "created_at": "2019-09-05T23:00:40.770Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:40.778Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:fb7cd2a0-d030-11e9-a60d-673487ffae4d:{} (2)'] = {
  "results": {
    "id": "fb7cd2a0-d030-11e9-a60d-673487ffae4d",
    "type": "tokens",
    "updated_at": "2019-09-05T23:00:40.778Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-05T23:00:40.770Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fb7cd2a0-d030-11e9-a60d-673487ffae4d",
        "attributes": {
          "created_at": "2019-09-05T23:00:40.770Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:40.778Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:fb7cd2a0-d030-11e9-a60d-673487ffae4d:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fc745200-d030-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:42.400Z",
    "version": "WzMsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:fc745200-d030-11e9-a60d-673487ffae4d:{"active":false}:{} (2)'] = {
  "results": {
    "id": "fc745200-d030-11e9-a60d-673487ffae4d",
    "type": "tokens",
    "updated_at": "2019-09-05T23:00:43.409Z",
    "version": "WzQsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:fc745200-d030-11e9-a60d-673487ffae4d:{} (3)'] = {
  "results": {
    "id": "fc745200-d030-11e9-a60d-673487ffae4d",
    "type": "tokens",
    "updated_at": "2019-09-05T23:00:43.409Z",
    "version": "WzQsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fc745200-d030-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:43.409Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:fc745200-d030-11e9-a60d-673487ffae4d:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fe46c810-d030-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:45.457Z",
    "version": "WzcsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "fe471630-d030-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:45.459Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fe471630-d030-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:45.459Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fe46c810-d030-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:45.457Z",
        "version": "WzcsMV0="
      },
      {
        "type": "tokens",
        "id": "fe471630-d030-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:45.459Z",
        "version": "WzgsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:fe46c810-d030-11e9-a60d-673487ffae4d:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:fe471630-d030-11e9-a60d-673487ffae4d:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "001bfd40-d031-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:48.532Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "001d35c0-d031-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:48.540Z",
    "version": "WzExLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "001bfd40-d031-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:48.532Z",
        "version": "WzEyLDFd"
      },
      {
        "type": "tokens",
        "id": "001d35c0-d031-11e9-a60d-673487ffae4d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-05T23:00:48.540Z",
        "version": "WzExLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:001bfd40-d031-11e9-a60d-673487ffae4d:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:001d35c0-d031-11e9-a60d-673487ffae4d:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "0205f2f0-d031-11e9-a60d-673487ffae4d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-05T23:00:51.743Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:0205f2f0-d031-11e9-a60d-673487ffae4d:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:0205f2f0-d031-11e9-a60d-673487ffae4d:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "0fe85560-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "created_at": "2019-09-09T14:49:44.626Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:44.629Z",
    "version": "WzE0NiwxXQ=="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:0fe85560-d311-11e9-96dd-bf9e1d409798:{} (2)'] = {
  "results": {
    "id": "0fe85560-d311-11e9-96dd-bf9e1d409798",
    "type": "tokens",
    "updated_at": "2019-09-09T14:49:44.629Z",
    "version": "WzE0NiwxXQ==",
    "attributes": {
      "created_at": "2019-09-09T14:49:44.626Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "0fe85560-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "created_at": "2019-09-09T14:49:44.626Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:44.629Z",
        "version": "WzE0NiwxXQ=="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:0fe85560-d311-11e9-96dd-bf9e1d409798:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "10ca7800-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:46.112Z",
    "version": "WzE0OCwxXQ=="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:10ca7800-d311-11e9-96dd-bf9e1d409798:{"active":false}:{} (2)'] = {
  "results": {
    "id": "10ca7800-d311-11e9-96dd-bf9e1d409798",
    "type": "tokens",
    "updated_at": "2019-09-09T14:49:47.131Z",
    "version": "WzE0OSwxXQ==",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:10ca7800-d311-11e9-96dd-bf9e1d409798:{} (3)'] = {
  "results": {
    "id": "10ca7800-d311-11e9-96dd-bf9e1d409798",
    "type": "tokens",
    "updated_at": "2019-09-09T14:49:47.131Z",
    "version": "WzE0OSwxXQ==",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "10ca7800-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:47.131Z",
        "version": "WzE0OSwxXQ=="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:10ca7800-d311-11e9-96dd-bf9e1d409798:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "129cee10-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:49.169Z",
    "version": "WzE1MSwxXQ=="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "129d1520-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:49.170Z",
    "version": "WzE1MiwxXQ=="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "129d1520-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:49.170Z",
        "version": "WzE1MiwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "129cee10-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:49.169Z",
        "version": "WzE1MSwxXQ=="
      },
      {
        "type": "tokens",
        "id": "129d1520-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:49.170Z",
        "version": "WzE1MiwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:129cee10-d311-11e9-96dd-bf9e1d409798:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:129d1520-d311-11e9-96dd-bf9e1d409798:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "146cf320-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:52.210Z",
    "version": "WzE1NSwxXQ=="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "146ccc10-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:52.209Z",
    "version": "WzE1NiwxXQ=="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "146ccc10-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:52.209Z",
        "version": "WzE1NiwxXQ=="
      },
      {
        "type": "tokens",
        "id": "146cf320-d311-11e9-96dd-bf9e1d409798",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-09T14:49:52.210Z",
        "version": "WzE1NSwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:146ccc10-d311-11e9-96dd-bf9e1d409798:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:146cf320-d311-11e9-96dd-bf9e1d409798:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "163cf830-d311-11e9-96dd-bf9e1d409798",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-09T14:49:55.251Z",
    "version": "WzE1OSwxXQ=="
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:163cf830-d311-11e9-96dd-bf9e1d409798:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:163cf830-d311-11e9-96dd-bf9e1d409798:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "556566a0-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "created_at": "2019-09-10T15:19:08.038Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:08.042Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:556566a0-d3de-11e9-9812-9dda36cb0ae3:{} (2)'] = {
  "results": {
    "id": "556566a0-d3de-11e9-9812-9dda36cb0ae3",
    "type": "tokens",
    "updated_at": "2019-09-10T15:19:08.042Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-10T15:19:08.038Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "556566a0-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "created_at": "2019-09-10T15:19:08.038Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:08.042Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:556566a0-d3de-11e9-9812-9dda36cb0ae3:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "56604160-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:09.686Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:56604160-d3de-11e9-9812-9dda36cb0ae3:{"active":false}:{} (2)'] = {
  "results": {
    "id": "56604160-d3de-11e9-9812-9dda36cb0ae3",
    "type": "tokens",
    "updated_at": "2019-09-10T15:19:10.699Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:56604160-d3de-11e9-9812-9dda36cb0ae3:{} (3)'] = {
  "results": {
    "id": "56604160-d3de-11e9-9812-9dda36cb0ae3",
    "type": "tokens",
    "updated_at": "2019-09-10T15:19:10.699Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "56604160-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:10.699Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:56604160-d3de-11e9-9812-9dda36cb0ae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "582faa30-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:12.722Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "582fd140-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:12.724Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "582fd140-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:12.724Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "582fd140-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:12.724Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "582faa30-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:12.722Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:582fd140-d3de-11e9-9812-9dda36cb0ae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:582faa30-d3de-11e9-9812-9dda36cb0ae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5a00e7c0-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:15.772Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "5a0135e0-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:15.774Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5a00e7c0-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:15.772Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "5a0135e0-d3de-11e9-9812-9dda36cb0ae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T15:19:15.774Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:5a00e7c0-d3de-11e9-9812-9dda36cb0ae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:5a0135e0-d3de-11e9-9812-9dda36cb0ae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5bd580b0-d3de-11e9-9812-9dda36cb0ae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T15:19:18.842Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:5bd580b0-d3de-11e9-9812-9dda36cb0ae3:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:5bd580b0-d3de-11e9-9812-9dda36cb0ae3:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6a290d60-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "created_at": "2019-09-10T19:08:46.770Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:46.774Z",
    "version": "WzE0NCwxXQ=="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:6a290d60-d3fe-11e9-af72-f15cc0e02dbb:{} (2)'] = {
  "results": {
    "id": "6a290d60-d3fe-11e9-af72-f15cc0e02dbb",
    "type": "tokens",
    "updated_at": "2019-09-10T19:08:46.774Z",
    "version": "WzE0NCwxXQ==",
    "attributes": {
      "created_at": "2019-09-10T19:08:46.770Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6a290d60-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "created_at": "2019-09-10T19:08:46.770Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:46.774Z",
        "version": "WzE0NCwxXQ=="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:6a290d60-d3fe-11e9-af72-f15cc0e02dbb:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6b189d80-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:48.343Z",
    "version": "WzE0NiwxXQ=="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:6b189d80-d3fe-11e9-af72-f15cc0e02dbb:{"active":false}:{} (2)'] = {
  "results": {
    "id": "6b189d80-d3fe-11e9-af72-f15cc0e02dbb",
    "type": "tokens",
    "updated_at": "2019-09-10T19:08:49.367Z",
    "version": "WzE0NywxXQ==",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:6b189d80-d3fe-11e9-af72-f15cc0e02dbb:{} (3)'] = {
  "results": {
    "id": "6b189d80-d3fe-11e9-af72-f15cc0e02dbb",
    "type": "tokens",
    "updated_at": "2019-09-10T19:08:49.367Z",
    "version": "WzE0NywxXQ==",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6b189d80-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:49.367Z",
        "version": "WzE0NywxXQ=="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:6b189d80-d3fe-11e9-af72-f15cc0e02dbb:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6cefce80-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:51.432Z",
    "version": "WzE0OSwxXQ=="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "6cf091d0-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:51.437Z",
    "version": "WzE1MCwxXQ=="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6cf091d0-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:51.437Z",
        "version": "WzE1MCwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6cefce80-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:51.432Z",
        "version": "WzE0OSwxXQ=="
      },
      {
        "type": "tokens",
        "id": "6cf091d0-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:51.437Z",
        "version": "WzE1MCwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:6cefce80-d3fe-11e9-af72-f15cc0e02dbb:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:6cf091d0-d3fe-11e9-af72-f15cc0e02dbb:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6ebfac80-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:54.472Z",
    "version": "WzE1NCwxXQ=="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "6ebffaa0-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:54.473Z",
    "version": "WzE1MywxXQ=="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6ebffaa0-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:54.473Z",
        "version": "WzE1MywxXQ=="
      },
      {
        "type": "tokens",
        "id": "6ebfac80-d3fe-11e9-af72-f15cc0e02dbb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-10T19:08:54.472Z",
        "version": "WzE1NCwxXQ=="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:6ebffaa0-d3fe-11e9-af72-f15cc0e02dbb:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:6ebfac80-d3fe-11e9-af72-f15cc0e02dbb:{} (6)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7090c300-d3fe-11e9-af72-f15cc0e02dbb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-10T19:08:57.520Z",
    "version": "WzE1NywxXQ=="
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:7090c300-d3fe-11e9-af72-f15cc0e02dbb:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:7090c300-d3fe-11e9-af72-f15cc0e02dbb:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c5fe20d0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "created_at": "2019-09-11T19:03:00.182Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:00.189Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:c5fe20d0-d4c6-11e9-9785-69a7ea8871d7:{} (2)'] = {
  "results": {
    "id": "c5fe20d0-d4c6-11e9-9785-69a7ea8871d7",
    "type": "tokens",
    "updated_at": "2019-09-11T19:03:00.189Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-11T19:03:00.182Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c5fe20d0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "created_at": "2019-09-11T19:03:00.182Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:00.189Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:c5fe20d0-d4c6-11e9-9785-69a7ea8871d7:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c6dfa730-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:01.667Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:c6dfa730-d4c6-11e9-9785-69a7ea8871d7:{"active":false}:{} (2)'] = {
  "results": {
    "id": "c6dfa730-d4c6-11e9-9785-69a7ea8871d7",
    "type": "tokens",
    "updated_at": "2019-09-11T19:03:02.680Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:c6dfa730-d4c6-11e9-9785-69a7ea8871d7:{} (3)'] = {
  "results": {
    "id": "c6dfa730-d4c6-11e9-9785-69a7ea8871d7",
    "type": "tokens",
    "updated_at": "2019-09-11T19:03:02.680Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c6dfa730-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:02.680Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:c6dfa730-d4c6-11e9-9785-69a7ea8871d7:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c8b096a0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:04.714Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "c8b0e4c0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:04.716Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c8b0e4c0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:04.716Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c8b0e4c0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:04.716Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "c8b096a0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:04.714Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:c8b0e4c0-d4c6-11e9-9785-69a7ea8871d7:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:c8b096a0-d4c6-11e9-9785-69a7ea8871d7:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ca849350-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:07.780Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ca84ba60-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:07.782Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ca849350-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:07.780Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "ca84ba60-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:07.782Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:ca849350-d4c6-11e9-9785-69a7ea8871d7:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:ca84ba60-d4c6-11e9-9785-69a7ea8871d7:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "cc59a170-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:10.855Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "cc5a16a0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:10.858Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "cc59ef90-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:10.857Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "cc59ef90-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:10.857Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "cc5a16a0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:10.858Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "cc59a170-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:10.855Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "cc59ef90-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:10.857Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:cc5a16a0-d4c6-11e9-9785-69a7ea8871d7:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:cc59a170-d4c6-11e9-9785-69a7ea8871d7:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:cc59ef90-d4c6-11e9-9785-69a7ea8871d7:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "cec8f3c0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:14.940Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "cec8ccb0-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:14.939Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "cec80960-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:14.934Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "cec80960-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:14.934Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "cec8ccb0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:14.939Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "cec8f3c0-d4c6-11e9-9785-69a7ea8871d7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-11T19:03:14.940Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cec80960-d4c6-11e9-9785-69a7ea8871d7:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cec8ccb0-d4c6-11e9-9785-69a7ea8871d7:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cec8f3c0-d4c6-11e9-9785-69a7ea8871d7:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "d1389430-d4c6-11e9-9785-69a7ea8871d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-11T19:03:19.027Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:d1389430-d4c6-11e9-9785-69a7ea8871d7:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:d1389430-d4c6-11e9-9785-69a7ea8871d7:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "91e27e60-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "created_at": "2019-09-12T13:16:45.759Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:45.766Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:91e27e60-d55f-11e9-9e46-dbe30725aae3:{} (2)'] = {
  "results": {
    "id": "91e27e60-d55f-11e9-9e46-dbe30725aae3",
    "type": "tokens",
    "updated_at": "2019-09-12T13:16:45.766Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:16:45.759Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "91e27e60-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "created_at": "2019-09-12T13:16:45.759Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:45.766Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:91e27e60-d55f-11e9-9e46-dbe30725aae3:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "92ca1f40-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:47.284Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:92ca1f40-d55f-11e9-9e46-dbe30725aae3:{"active":false}:{} (2)'] = {
  "results": {
    "id": "92ca1f40-d55f-11e9-9e46-dbe30725aae3",
    "type": "tokens",
    "updated_at": "2019-09-12T13:16:48.305Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:92ca1f40-d55f-11e9-9e46-dbe30725aae3:{} (3)'] = {
  "results": {
    "id": "92ca1f40-d55f-11e9-9e46-dbe30725aae3",
    "type": "tokens",
    "updated_at": "2019-09-12T13:16:48.305Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "92ca1f40-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:48.305Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:92ca1f40-d55f-11e9-9e46-dbe30725aae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "949da6c0-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:50.348Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "949d58a0-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:50.346Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "949da6c0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:50.348Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "949d58a0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:50.346Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "949da6c0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:50.348Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:949d58a0-d55f-11e9-9e46-dbe30725aae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:949da6c0-d55f-11e9-9e46-dbe30725aae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "96723fb0-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:53.419Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "9671f190-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:53.417Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "96723fb0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:53.419Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "9671f190-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:53.417Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:96723fb0-d55f-11e9-9e46-dbe30725aae3:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:9671f190-d55f-11e9-9e46-dbe30725aae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "9849e5e0-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:56.510Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "984997c0-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:56.508Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "9848fb80-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:16:56.504Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "984997c0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:56.508Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "9849e5e0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:56.510Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "9848fb80-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:56.504Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "984997c0-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:16:56.508Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:9849e5e0-d55f-11e9-9e46-dbe30725aae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:9848fb80-d55f-11e9-9e46-dbe30725aae3:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:984997c0-d55f-11e9-9e46-dbe30725aae3:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "9ab91120-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:17:00.594Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "9ab93830-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:17:00.595Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "9ab98650-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:17:00.597Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "9ab98650-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:17:00.597Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "9ab93830-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:17:00.595Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "9ab91120-d55f-11e9-9e46-dbe30725aae3",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:17:00.594Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:9ab98650-d55f-11e9-9e46-dbe30725aae3:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:9ab93830-d55f-11e9-9e46-dbe30725aae3:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:9ab91120-d55f-11e9-9e46-dbe30725aae3:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "9d29ea10-d55f-11e9-9e46-dbe30725aae3",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:17:04.689Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:9d29ea10-d55f-11e9-9e46-dbe30725aae3:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:9d29ea10-d55f-11e9-9e46-dbe30725aae3:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "a5a3c160-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "created_at": "2019-09-12T13:24:28.398Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:28.406Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:a5a3c160-d560-11e9-a95e-2591f30e80ce:{} (2)'] = {
  "results": {
    "id": "a5a3c160-d560-11e9-a95e-2591f30e80ce",
    "type": "tokens",
    "updated_at": "2019-09-12T13:24:28.406Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:24:28.398Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "a5a3c160-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "created_at": "2019-09-12T13:24:28.398Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:28.406Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:a5a3c160-d560-11e9-a95e-2591f30e80ce:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "a6891850-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:29.909Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:a6891850-d560-11e9-a95e-2591f30e80ce:{"active":false}:{} (2)'] = {
  "results": {
    "id": "a6891850-d560-11e9-a95e-2591f30e80ce",
    "type": "tokens",
    "updated_at": "2019-09-12T13:24:30.930Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:a6891850-d560-11e9-a95e-2591f30e80ce:{} (3)'] = {
  "results": {
    "id": "a6891850-d560-11e9-a95e-2591f30e80ce",
    "type": "tokens",
    "updated_at": "2019-09-12T13:24:30.930Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "a6891850-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:30.930Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:a6891850-d560-11e9-a95e-2591f30e80ce:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "a85cc6e0-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:32.974Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "a85d1500-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:32.976Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "a85d1500-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:32.976Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:18:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted [as getByTokenHash] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:69:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "a85d1500-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:32.976Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "a85cc6e0-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:32.974Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:a85d1500-d560-11e9-a95e-2591f30e80ce:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:a85cc6e0-d560-11e9-a95e-2591f30e80ce:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "aa300040-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:36.036Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "aa304e60-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:36.038Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "aa300040-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:36.036Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "aa304e60-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:36.038Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:aa300040-d560-11e9-a95e-2591f30e80ce:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:aa304e60-d560-11e9-a95e-2591f30e80ce:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ac049930-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:39.107Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ac04e750-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:39.109Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ac05aaa0-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:39.114Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ac04e750-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:39.109Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:18:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:81:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ac05aaa0-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:39.114Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "ac04e750-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:39.109Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "ac049930-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:39.107Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ac05aaa0-d560-11e9-a95e-2591f30e80ce:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ac04e750-d560-11e9-a95e-2591f30e80ce:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ac049930-d560-11e9-a95e-2591f30e80ce:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ae760e60-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:43.206Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ae765c80-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:43.208Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ae75c040-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:43.204Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ae765c80-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:43.208Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "ae760e60-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:43.206Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "ae75c040-d560-11e9-a95e-2591f30e80ce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:24:43.204Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ae765c80-d560-11e9-a95e-2591f30e80ce:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ae760e60-d560-11e9-a95e-2591f30e80ce:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ae75c040-d560-11e9-a95e-2591f30e80ce:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "b0e3da10-d560-11e9-a95e-2591f30e80ce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:24:47.281Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:b0e3da10-d560-11e9-a95e-2591f30e80ce:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:b0e3da10-d560-11e9-a95e-2591f30e80ce:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e39f85d0-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "created_at": "2019-09-12T13:26:12.390Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:12.397Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:e39f85d0-d560-11e9-993c-5fc7162a8958:{} (2)'] = {
  "results": {
    "id": "e39f85d0-d560-11e9-993c-5fc7162a8958",
    "type": "tokens",
    "updated_at": "2019-09-12T13:26:12.397Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:26:12.390Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e39f85d0-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "created_at": "2019-09-12T13:26:12.390Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:12.397Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:e39f85d0-d560-11e9-993c-5fc7162a8958:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e48af740-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:13.940Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e48af740-d560-11e9-993c-5fc7162a8958:{"active":false}:{} (2)'] = {
  "results": {
    "id": "e48af740-d560-11e9-993c-5fc7162a8958",
    "type": "tokens",
    "updated_at": "2019-09-12T13:26:14.949Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e48af740-d560-11e9-993c-5fc7162a8958:{} (3)'] = {
  "results": {
    "id": "e48af740-d560-11e9-993c-5fc7162a8958",
    "type": "tokens",
    "updated_at": "2019-09-12T13:26:14.949Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e48af740-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:14.949Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:e48af740-d560-11e9-993c-5fc7162a8958:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e65d1f30-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:16.995Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e65cd110-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:16.993Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e65d1f30-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:16.995Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:18:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted [as getByTokenHash] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:69:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e65d1f30-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:16.995Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "e65cd110-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:16.993Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:e65d1f30-d560-11e9-993c-5fc7162a8958:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:e65cd110-d560-11e9-993c-5fc7162a8958:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e82fbc50-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:20.053Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e82f6e30-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:20.051Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e82fbc50-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:20.053Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "e82f6e30-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:20.051Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:e82fbc50-d560-11e9-993c-5fc7162a8958:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:e82f6e30-d560-11e9-993c-5fc7162a8958:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ea04a360-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:23.126Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ea04ca70-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:23.127Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ea045540-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:23.124Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ea04a360-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:23.126Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:18:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:81:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ea045540-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:23.124Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "ea04a360-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:23.126Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "ea04ca70-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:23.127Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ea045540-d560-11e9-993c-5fc7162a8958:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ea04a360-d560-11e9-993c-5fc7162a8958:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ea04ca70-d560-11e9-993c-5fc7162a8958:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ec7925d0-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:27.244Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ec777820-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:27.234Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ec763fa0-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:27.225Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ec7925d0-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:27.244Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "ec777820-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:27.234Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "ec763fa0-d560-11e9-993c-5fc7162a8958",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:26:27.225Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ec7925d0-d560-11e9-993c-5fc7162a8958:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ec777820-d560-11e9-993c-5fc7162a8958:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ec763fa0-d560-11e9-993c-5fc7162a8958:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "eefe2300-d560-11e9-993c-5fc7162a8958",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:26:31.472Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:eefe2300-d560-11e9-993c-5fc7162a8958:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:eefe2300-d560-11e9-993c-5fc7162a8958:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "20a1cf10-d561-11e9-a953-11e393858a37",
    "attributes": {
      "created_at": "2019-09-12T13:27:54.745Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:27:54.753Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:20a1cf10-d561-11e9-a953-11e393858a37:{} (2)'] = {
  "results": {
    "id": "20a1cf10-d561-11e9-a953-11e393858a37",
    "type": "tokens",
    "updated_at": "2019-09-12T13:27:54.753Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:27:54.745Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "20a1cf10-d561-11e9-a953-11e393858a37",
        "attributes": {
          "created_at": "2019-09-12T13:27:54.745Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:27:54.753Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:20a1cf10-d561-11e9-a953-11e393858a37:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2179b880-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:27:56.168Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:2179b880-d561-11e9-a953-11e393858a37:{"active":false}:{} (2)'] = {
  "results": {
    "id": "2179b880-d561-11e9-a953-11e393858a37",
    "type": "tokens",
    "updated_at": "2019-09-12T13:27:57.180Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:2179b880-d561-11e9-a953-11e393858a37:{} (3)'] = {
  "results": {
    "id": "2179b880-d561-11e9-a953-11e393858a37",
    "type": "tokens",
    "updated_at": "2019-09-12T13:27:57.180Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2179b880-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:27:57.180Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:2179b880-d561-11e9-a953-11e393858a37:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "2351faf0-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:27:59.263Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "234f14c0-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:27:59.244Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2351faf0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:27:59.263Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:19:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted [as getByTokenHash] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:69:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2351faf0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:27:59.263Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "234f14c0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:27:59.244Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:2351faf0-d561-11e9-a953-11e393858a37:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:234f14c0-d561-11e9-a953-11e393858a37:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "25386e30-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:02.451Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "25389540-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:02.452Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "25389540-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:02.452Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "25386e30-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:02.451Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:25389540-d561-11e9-a953-11e393858a37:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:25386e30-d561-11e9-a953-11e393858a37:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "2716cb20-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:05.585Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "271607d0-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:05.581Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "271655f0-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:05.583Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "271655f0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:05.583Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:19:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:25:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:81:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2716cb20-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:05.585Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "271655f0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:05.583Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "271607d0-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:05.581Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:2716cb20-d561-11e9-a953-11e393858a37:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:271655f0-d561-11e9-a953-11e393858a37:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:271607d0-d561-11e9-a953-11e393858a37:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "29884050-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:09.685Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2987f230-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:09.683Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "29886760-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:09.686Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "29886760-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:09.686Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "2987f230-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:09.683Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "29884050-d561-11e9-a953-11e393858a37",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:28:09.685Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:29886760-d561-11e9-a953-11e393858a37:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:2987f230-d561-11e9-a953-11e393858a37:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:29884050-d561-11e9-a953-11e393858a37:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2bfbff70-d561-11e9-a953-11e393858a37",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:28:13.799Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:2bfbff70-d561-11e9-a953-11e393858a37:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:2bfbff70-d561-11e9-a953-11e393858a37:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "79a262a0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "created_at": "2019-09-12T13:30:24.063Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:24.073Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:79a262a0-d561-11e9-a6dc-af37b91c2d19:{} (2)'] = {
  "results": {
    "id": "79a262a0-d561-11e9-a6dc-af37b91c2d19",
    "type": "tokens",
    "updated_at": "2019-09-12T13:30:24.073Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:30:24.063Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "79a262a0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "created_at": "2019-09-12T13:30:24.063Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:24.073Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:79a262a0-d561-11e9-a6dc-af37b91c2d19:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7a96fbd0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:25.676Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7a96fbd0-d561-11e9-a6dc-af37b91c2d19:{"active":false}:{} (2)'] = {
  "results": {
    "id": "7a96fbd0-d561-11e9-a6dc-af37b91c2d19",
    "type": "tokens",
    "updated_at": "2019-09-12T13:30:26.695Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7a96fbd0-d561-11e9-a6dc-af37b91c2d19:{} (3)'] = {
  "results": {
    "id": "7a96fbd0-d561-11e9-a6dc-af37b91c2d19",
    "type": "tokens",
    "updated_at": "2019-09-12T13:30:26.695Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7a96fbd0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:26.695Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:7a96fbd0-d561-11e9-a6dc-af37b91c2d19:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "7c694ad0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:28.733Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7c68d5a0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:28.730Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7c694ad0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:28.733Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:19:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:29:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted [as getByTokenHash] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:69:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7c694ad0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:28.733Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "7c68d5a0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:28.730Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:7c694ad0-d561-11e9-a6dc-af37b91c2d19:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:7c68d5a0-d561-11e9-a6dc-af37b91c2d19:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7e3d4780-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:31.800Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "7e3d95a0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:31.802Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7e3d95a0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:31.802Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "7e3d4780-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:31.800Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:7e3d95a0-d561-11e9-a6dc-af37b91c2d19:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:7e3d4780-d561-11e9-a6dc-af37b91c2d19:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8012cad0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:34.877Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "8012f1e0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:34.878Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "80127cb0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:34.875Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8012cad0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:34.877Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"this.plugin.getDecryptedAsInternalUser is not a function\",\"name\":\"TypeError\",\"stack\":\"TypeError: this.plugin.getDecryptedAsInternalUser is not a function\\n    at EncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/default.ts:19:30)\\n    at getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:29:35)\\n    at memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeEncryptedSavedObjects.getDecryptedAsInternalUser (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/encrypted_saved_objects/memorize_adapter.ts:22:18)\\n    at TokenAdapter.getDecryptedAsInternalUser [as _getDecrypted] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:98:39)\\n    at TokenAdapter._getDecrypted (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:81:31)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8012f1e0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:34.878Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "8012cad0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:34.877Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "80127cb0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:34.875Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:8012f1e0-d561-11e9-a6dc-af37b91c2d19:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:8012cad0-d561-11e9-a6dc-af37b91c2d19:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:80127cb0-d561-11e9-a6dc-af37b91c2d19:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "828180e0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:38.958Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "82810bb0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:38.955Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8280bd90-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:38.953Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8280bd90-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:38.953Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "82810bb0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:38.955Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "828180e0-d561-11e9-a6dc-af37b91c2d19",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:30:38.958Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:8280bd90-d561-11e9-a6dc-af37b91c2d19:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:82810bb0-d561-11e9-a6dc-af37b91c2d19:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:828180e0-d561-11e9-a6dc-af37b91c2d19:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "84f259d0-d561-11e9-a6dc-af37b91c2d19",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:30:43.052Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:84f259d0-d561-11e9-a6dc-af37b91c2d19:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:84f259d0-d561-11e9-a6dc-af37b91c2d19:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ef2eda80-d561-11e9-b482-2d464def109a",
    "attributes": {
      "created_at": "2019-09-12T13:33:41.258Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:41.288Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:ef2eda80-d561-11e9-b482-2d464def109a:{} (2)'] = {
  "results": {
    "id": "ef2eda80-d561-11e9-b482-2d464def109a",
    "type": "tokens",
    "updated_at": "2019-09-12T13:33:41.288Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:33:41.258Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ef2eda80-d561-11e9-b482-2d464def109a",
        "attributes": {
          "created_at": "2019-09-12T13:33:41.258Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:41.288Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:ef2eda80-d561-11e9-b482-2d464def109a:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f00e3e00-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:42.752Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:f00e3e00-d561-11e9-b482-2d464def109a:{"active":false}:{} (2)'] = {
  "results": {
    "id": "f00e3e00-d561-11e9-b482-2d464def109a",
    "type": "tokens",
    "updated_at": "2019-09-12T13:33:43.769Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:f00e3e00-d561-11e9-b482-2d464def109a:{} (3)'] = {
  "results": {
    "id": "f00e3e00-d561-11e9-b482-2d464def109a",
    "type": "tokens",
    "updated_at": "2019-09-12T13:33:43.769Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f00e3e00-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:43.769Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:f00e3e00-d561-11e9-b482-2d464def109a:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f1e1ec90-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:45.817Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "f1e261c0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:45.820Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f1e261c0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:45.820Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f1e261c0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:45.820Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "f1e1ec90-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:45.817Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:f1e261c0-d561-11e9-b482-2d464def109a:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:f1e1ec90-d561-11e9-b482-2d464def109a:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f3b6d3a0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:48.890Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "f3b721c0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:48.892Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f3b6d3a0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:48.890Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "f3b721c0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:48.892Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:f3b6d3a0-d561-11e9-b482-2d464def109a:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:f3b721c0-d561-11e9-b482-2d464def109a:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "f58d8f70-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:51.974Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f58d4150-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:51.972Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "f58ddd90-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:51.977Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f58d8f70-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:51.974Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f58d4150-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:51.972Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "f58ddd90-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:51.977Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "f58d8f70-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:51.974Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:f58d4150-d561-11e9-b482-2d464def109a:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:f58ddd90-d561-11e9-b482-2d464def109a:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:f58d8f70-d561-11e9-b482-2d464def109a:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "f7fda510-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:56.065Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "f7fd56f0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:56.062Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f7fce1c0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:33:56.060Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "f7fce1c0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:56.060Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "f7fd56f0-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:56.062Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "f7fda510-d561-11e9-b482-2d464def109a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:33:56.065Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:f7fce1c0-d561-11e9-b482-2d464def109a:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:f7fd56f0-d561-11e9-b482-2d464def109a:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:f7fda510-d561-11e9-b482-2d464def109a:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fa6e2fe0-d561-11e9-b482-2d464def109a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:34:00.158Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:fa6e2fe0-d561-11e9-b482-2d464def109a:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:fa6e2fe0-d561-11e9-b482-2d464def109a:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "551f59a0-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "created_at": "2019-09-12T13:36:32.300Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:32.314Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:551f59a0-d562-11e9-bf2b-998e209d6359:{} (2)'] = {
  "results": {
    "id": "551f59a0-d562-11e9-bf2b-998e209d6359",
    "type": "tokens",
    "updated_at": "2019-09-12T13:36:32.314Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:36:32.300Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "551f59a0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "created_at": "2019-09-12T13:36:32.300Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:32.314Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:551f59a0-d562-11e9-bf2b-998e209d6359:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "560f10d0-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:33.885Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:560f10d0-d562-11e9-bf2b-998e209d6359:{"active":false}:{} (2)'] = {
  "results": {
    "id": "560f10d0-d562-11e9-bf2b-998e209d6359",
    "type": "tokens",
    "updated_at": "2019-09-12T13:36:34.901Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:560f10d0-d562-11e9-bf2b-998e209d6359:{} (3)'] = {
  "results": {
    "id": "560f10d0-d562-11e9-bf2b-998e209d6359",
    "type": "tokens",
    "updated_at": "2019-09-12T13:36:34.901Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "560f10d0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "iamatoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:34.901Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:560f10d0-d562-11e9-bf2b-998e209d6359:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "57e15fd0-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:36.941Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "57e111b0-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:36.939Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "57e15fd0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:36.941Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "57e111b0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:36.939Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "57e15fd0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:36.941Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:57e111b0-d562-11e9-bf2b-998e209d6359:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:57e15fd0-d562-11e9-bf2b-998e209d6359:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "59b44b10-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:40.001Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "59b49930-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:40.002Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "59b49930-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:40.002Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "59b44b10-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:40.001Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:59b49930-d562-11e9-bf2b-998e209d6359:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:59b44b10-d562-11e9-bf2b-998e209d6359:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "5b895930-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:43.075Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "5b890b10-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:43.073Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5b88bcf0-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:43.071Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5b890b10-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:43.073Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5b890b10-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:43.073Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "5b88bcf0-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:43.071Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "5b895930-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:43.075Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:5b890b10-d562-11e9-bf2b-998e209d6359:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:5b88bcf0-d562-11e9-bf2b-998e209d6359:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:5b895930-d562-11e9-bf2b-998e209d6359:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "5df80f40-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:47.156Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "5df85d60-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:47.158Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "5df8d290-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:47.161Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5df80f40-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:47.156Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "5df8d290-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:47.161Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "5df85d60-d562-11e9-bf2b-998e209d6359",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:36:47.158Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:5df80f40-d562-11e9-bf2b-998e209d6359:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:5df8d290-d562-11e9-bf2b-998e209d6359:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:5df85d60-d562-11e9-bf2b-998e209d6359:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6068c120-d562-11e9-bf2b-998e209d6359",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:36:51.250Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:6068c120-d562-11e9-bf2b-998e209d6359:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:6068c120-d562-11e9-bf2b-998e209d6359:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8d3087b0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "created_at": "2019-09-12T13:38:06.367Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:06.379Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:8d3087b0-d562-11e9-a6e6-c9f3826d021f:{} (2)'] = {
  "results": {
    "id": "8d3087b0-d562-11e9-a6e6-c9f3826d021f",
    "type": "tokens",
    "updated_at": "2019-09-12T13:38:06.379Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:38:06.367Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8d3087b0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "created_at": "2019-09-12T13:38:06.367Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:06.379Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:8d3087b0-d562-11e9-a6e6-c9f3826d021f:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8e260b40-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:07.988Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:8e260b40-d562-11e9-a6e6-c9f3826d021f:{"active":false}:{} (2)'] = {
  "results": {
    "id": "8e260b40-d562-11e9-a6e6-c9f3826d021f",
    "type": "tokens",
    "updated_at": "2019-09-12T13:38:09.002Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:8e260b40-d562-11e9-a6e6-c9f3826d021f:{} (3)'] = {
  "results": {
    "id": "8e260b40-d562-11e9-a6e6-c9f3826d021f",
    "type": "tokens",
    "updated_at": "2019-09-12T13:38:09.002Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8e260b40-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "iamatoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:09.002Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:8e260b40-d562-11e9-a6e6-c9f3826d021f:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8ff8a860-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:11.046Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8ff83330-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:11.043Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8ff8a860-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:11.046Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:undefined (4)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8ff83330-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:11.043Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "8ff8a860-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:11.046Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8ff83330-d562-11e9-a6e6-c9f3826d021f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8ff8a860-d562-11e9-a6e6-c9f3826d021f:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "91cb6c90-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:14.105Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "91cbbab0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:14.107Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "91cb6c90-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:14.105Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "91cbbab0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:14.107Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:91cb6c90-d562-11e9-a6e6-c9f3826d021f:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:91cbbab0-d562-11e9-a6e6-c9f3826d021f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "939e30c0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:17.164Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "939ea5f0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:17.166Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "939ef410-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:17.169Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "939ea5f0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:17.166Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:undefined (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Not Found\",\"name\":\"Error\",\"stack\":\"Error: Not Found\\n    at Function.notFound [as createGenericNotFoundError] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:144:26)\\n    at SavedObjectsRepository.createGenericNotFoundError [as get] (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:580:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"data\":null,\"isBoom\":true,\"isServer\":false,\"output\":{\"statusCode\":404,\"payload\":{\"statusCode\":404,\"error\":\"Not Found\",\"message\":\"Not Found\"},\"headers\":{}}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "939e30c0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:17.164Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "939ef410-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:17.169Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "939ea5f0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:17.166Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:939e30c0-d562-11e9-a6e6-c9f3826d021f:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:939ef410-d562-11e9-a6e6-c9f3826d021f:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:939ea5f0-d562-11e9-a6e6-c9f3826d021f:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "960ac3f0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:21.231Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "960a4ec0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:21.228Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "960ce6d0-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:21.244Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "960a4ec0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:21.228Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "960ac3f0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:21.231Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "960ce6d0-d562-11e9-a6e6-c9f3826d021f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:38:21.244Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:960a4ec0-d562-11e9-a6e6-c9f3826d021f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:960ac3f0-d562-11e9-a6e6-c9f3826d021f:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:960ce6d0-d562-11e9-a6e6-c9f3826d021f:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "989bf620-d562-11e9-a6e6-c9f3826d021f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:38:25.538Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:989bf620-d562-11e9-a6e6-c9f3826d021f:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:989bf620-d562-11e9-a6e6-c9f3826d021f:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c36b2100-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "created_at": "2019-09-12T13:39:37.334Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:37.360Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:c36b2100-d562-11e9-ae07-6b54c678cbb5:{} (2)'] = {
  "results": {
    "id": "c36b2100-d562-11e9-ae07-6b54c678cbb5",
    "type": "tokens",
    "updated_at": "2019-09-12T13:39:37.360Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:39:37.334Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c36b2100-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "created_at": "2019-09-12T13:39:37.334Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:37.360Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:c36b2100-d562-11e9-ae07-6b54c678cbb5:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c457f200-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:38.912Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:c457f200-d562-11e9-ae07-6b54c678cbb5:{"active":false}:{} (2)'] = {
  "results": {
    "id": "c457f200-d562-11e9-ae07-6b54c678cbb5",
    "type": "tokens",
    "updated_at": "2019-09-12T13:39:39.930Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:c457f200-d562-11e9-ae07-6b54c678cbb5:{} (3)'] = {
  "results": {
    "id": "c457f200-d562-11e9-ae07-6b54c678cbb5",
    "type": "tokens",
    "updated_at": "2019-09-12T13:39:39.930Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "iamatoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c457f200-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "iamatoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:39.930Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:c457f200-d562-11e9-ae07-6b54c678cbb5:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c62a8f20-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:41.970Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "c62add40-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:41.972Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c62add40-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:41.972Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:c62add40-d562-11e9-ae07-6b54c678cbb5 (4)'] = {
  "results": {
    "id": "c62add40-d562-11e9-ae07-6b54c678cbb5",
    "type": "tokens",
    "updated_at": "2019-09-12T13:39:41.972Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c62add40-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:41.972Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "c62a8f20-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:41.970Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:c62add40-d562-11e9-ae07-6b54c678cbb5:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:c62a8f20-d562-11e9-ae07-6b54c678cbb5:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "c7ffc450-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:45.045Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c7ff4f20-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:45.042Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c7ffc450-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:45.045Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "c7ff4f20-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:45.042Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:c7ffc450-d562-11e9-ae07-6b54c678cbb5:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:c7ff4f20-d562-11e9-ae07-6b54c678cbb5:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "c9d63200-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:48.128Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c9d5bcd0-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:48.125Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "c9d68020-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:48.130Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c9d63200-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:48.128Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:c9d63200-d562-11e9-ae07-6b54c678cbb5 (5)'] = {
  "results": {
    "id": "c9d63200-d562-11e9-ae07-6b54c678cbb5",
    "type": "tokens",
    "updated_at": "2019-09-12T13:39:48.128Z",
    "version": "WzE0LDFd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": []
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "c9d68020-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:48.130Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "c9d63200-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:48.128Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "c9d5bcd0-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:48.125Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:c9d68020-d562-11e9-ae07-6b54c678cbb5:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:c9d63200-d562-11e9-ae07-6b54c678cbb5:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:c9d5bcd0-d562-11e9-ae07-6b54c678cbb5:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "cc4472e0-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:52.206Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "cc44c100-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:52.208Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "cc4424c0-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:52.204Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "cc44c100-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:52.208Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "cc4424c0-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:52.204Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "cc4472e0-d562-11e9-ae07-6b54c678cbb5",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:39:52.206Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cc44c100-d562-11e9-ae07-6b54c678cbb5:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cc4424c0-d562-11e9-ae07-6b54c678cbb5:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:cc4472e0-d562-11e9-ae07-6b54c678cbb5:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "cecaf6b0-d562-11e9-ae07-6b54c678cbb5",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:39:56.443Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:cecaf6b0-d562-11e9-ae07-6b54c678cbb5:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:cecaf6b0-d562-11e9-ae07-6b54c678cbb5:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7eadb530-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "created_at": "2019-09-12T13:52:01.015Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:01.027Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:7eadb530-d564-11e9-8437-ff4efac0df51:{} (2)'] = {
  "results": {
    "id": "7eadb530-d564-11e9-8437-ff4efac0df51",
    "type": "tokens",
    "updated_at": "2019-09-12T13:52:01.027Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:52:01.015Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7eadb530-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "created_at": "2019-09-12T13:52:01.015Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:01.027Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:7eadb530-d564-11e9-8437-ff4efac0df51:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7fa42320-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:02.642Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7fa42320-d564-11e9-8437-ff4efac0df51:{"active":false}:{} (2)'] = {
  "results": {
    "id": "7fa42320-d564-11e9-8437-ff4efac0df51",
    "type": "tokens",
    "updated_at": "2019-09-12T13:52:03.655Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7fa42320-d564-11e9-8437-ff4efac0df51:{} (3)'] = {
  "results": {
    "id": "7fa42320-d564-11e9-8437-ff4efac0df51",
    "type": "tokens",
    "updated_at": "2019-09-12T13:52:03.655Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7fa42320-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:03.655Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:7fa42320-d564-11e9-8437-ff4efac0df51:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "81767220-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:05.698Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8176c040-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:05.700Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8176c040-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:05.700Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:8176c040-d564-11e9-8437-ff4efac0df51 (4)'] = {
  "results": {
    "id": "8176c040-d564-11e9-8437-ff4efac0df51",
    "type": "tokens",
    "updated_at": "2019-09-12T13:52:05.700Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8176c040-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:05.700Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "81767220-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:05.698Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8176c040-d564-11e9-8437-ff4efac0df51:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:81767220-d564-11e9-8437-ff4efac0df51:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "834ae400-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:08.768Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "834c4390-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:08.777Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "834c4390-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:08.777Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "834ae400-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:08.768Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:834c4390-d564-11e9-8437-ff4efac0df51:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:834ae400-d564-11e9-8437-ff4efac0df51:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "851f7cf0-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:11.839Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "851ff220-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:11.842Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "851f2ed0-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:11.837Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "851f7cf0-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:11.839Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:851f7cf0-d564-11e9-8437-ff4efac0df51 (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "851f2ed0-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:11.837Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "851f7cf0-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:11.839Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "851ff220-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:11.842Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:851f2ed0-d564-11e9-8437-ff4efac0df51:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:851f7cf0-d564-11e9-8437-ff4efac0df51:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:851ff220-d564-11e9-8437-ff4efac0df51:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "8790f220-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:15.937Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "879007c0-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:15.932Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "87907cf0-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:15.935Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8790f220-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:15.937Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "87907cf0-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:15.935Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "879007c0-d564-11e9-8437-ff4efac0df51",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:52:15.932Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:8790f220-d564-11e9-8437-ff4efac0df51:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:87907cf0-d564-11e9-8437-ff4efac0df51:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:879007c0-d564-11e9-8437-ff4efac0df51:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8a024040-d564-11e9-8437-ff4efac0df51",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:52:20.036Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:8a024040-d564-11e9-8437-ff4efac0df51:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:8a024040-d564-11e9-8437-ff4efac0df51:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fb8082e0-d564-11e9-8280-cf039906b07e",
    "attributes": {
      "created_at": "2019-09-12T13:55:30.426Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:30.445Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:fb8082e0-d564-11e9-8280-cf039906b07e:{} (2)'] = {
  "results": {
    "id": "fb8082e0-d564-11e9-8280-cf039906b07e",
    "type": "tokens",
    "updated_at": "2019-09-12T13:55:30.445Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:55:30.426Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fb8082e0-d564-11e9-8280-cf039906b07e",
        "attributes": {
          "created_at": "2019-09-12T13:55:30.426Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:30.445Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:fb8082e0-d564-11e9-8280-cf039906b07e:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fc6b3100-d564-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:31.984Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:fc6b3100-d564-11e9-8280-cf039906b07e:{"active":false}:{} (2)'] = {
  "results": {
    "id": "fc6b3100-d564-11e9-8280-cf039906b07e",
    "type": "tokens",
    "updated_at": "2019-09-12T13:55:32.999Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:fc6b3100-d564-11e9-8280-cf039906b07e:{} (3)'] = {
  "results": {
    "id": "fc6b3100-d564-11e9-8280-cf039906b07e",
    "type": "tokens",
    "updated_at": "2019-09-12T13:55:32.999Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fc6b3100-d564-11e9-8280-cf039906b07e",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:32.999Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:fc6b3100-d564-11e9-8280-cf039906b07e:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "fe3df530-d564-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:35.043Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "fe3da710-d564-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:35.041Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fe3df530-d564-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:35.043Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:fe3df530-d564-11e9-8280-cf039906b07e (4)'] = {
  "results": {
    "id": "fe3df530-d564-11e9-8280-cf039906b07e",
    "type": "tokens",
    "updated_at": "2019-09-12T13:55:35.043Z",
    "version": "WzYsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "fe3da710-d564-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:35.041Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "fe3df530-d564-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:35.043Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:fe3da710-d564-11e9-8280-cf039906b07e:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:fe3df530-d564-11e9-8280-cf039906b07e:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "00128e20-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:38.114Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "001155a0-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:38.106Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "00128e20-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:38.114Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "001155a0-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:38.106Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:00128e20-d565-11e9-8280-cf039906b07e:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:001155a0-d565-11e9-8280-cf039906b07e:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "01e52b40-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:41.172Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "01e68ad0-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:41.181Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "01e5c780-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:41.176Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "01e5c780-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:41.176Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:01e5c780-d565-11e9-8280-cf039906b07e (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "01e68ad0-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:41.181Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "01e52b40-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:41.172Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "01e5c780-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:41.176Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:01e68ad0-d565-11e9-8280-cf039906b07e:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:01e52b40-d565-11e9-8280-cf039906b07e:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:01e5c780-d565-11e9-8280-cf039906b07e:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "04582710-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:45.281Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "04534510-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:45.249Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "0454a4a0-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:45.258Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "04534510-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:45.249Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "04582710-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:45.281Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "0454a4a0-d565-11e9-8280-cf039906b07e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:55:45.258Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:04534510-d565-11e9-8280-cf039906b07e:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:04582710-d565-11e9-8280-cf039906b07e:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:0454a4a0-d565-11e9-8280-cf039906b07e:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "06e0cdc0-d565-11e9-8280-cf039906b07e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:55:49.532Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:06e0cdc0-d565-11e9-8280-cf039906b07e:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:06e0cdc0-d565-11e9-8280-cf039906b07e:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8b747870-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "created_at": "2019-09-12T13:59:31.945Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:31.959Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:8b747870-d565-11e9-8e5d-3b485732bbc4:{} (2)'] = {
  "results": {
    "id": "8b747870-d565-11e9-8e5d-3b485732bbc4",
    "type": "tokens",
    "updated_at": "2019-09-12T13:59:31.959Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T13:59:31.945Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8b747870-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "created_at": "2019-09-12T13:59:31.945Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:31.959Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:8b747870-d565-11e9-8e5d-3b485732bbc4:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8c68ea90-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:33.561Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:8c68ea90-d565-11e9-8e5d-3b485732bbc4:{"active":false}:{} (2)'] = {
  "results": {
    "id": "8c68ea90-d565-11e9-8e5d-3b485732bbc4",
    "type": "tokens",
    "updated_at": "2019-09-12T13:59:34.567Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:8c68ea90-d565-11e9-8e5d-3b485732bbc4:{} (3)'] = {
  "results": {
    "id": "8c68ea90-d565-11e9-8e5d-3b485732bbc4",
    "type": "tokens",
    "updated_at": "2019-09-12T13:59:34.567Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8c68ea90-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:34.567Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:8c68ea90-d565-11e9-8e5d-3b485732bbc4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8e3d3560-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:36.630Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8e3cc030-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:36.627Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8e3d3560-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:36.630Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:8e3d3560-d565-11e9-8e5d-3b485732bbc4 (4)'] = {
  "results": {
    "id": "8e3d3560-d565-11e9-8e5d-3b485732bbc4",
    "type": "tokens",
    "updated_at": "2019-09-12T13:59:36.630Z",
    "version": "WzYsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8e3cc030-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:36.627Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "8e3d3560-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:36.630Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8e3cc030-d565-11e9-8e5d-3b485732bbc4:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8e3d3560-d565-11e9-8e5d-3b485732bbc4:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "901020a0-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:39.689Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "901095d0-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:39.693Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "901020a0-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:39.689Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "901095d0-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:39.693Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:901020a0-d565-11e9-8e5d-3b485732bbc4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:901095d0-d565-11e9-8e5d-3b485732bbc4:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "91e30be0-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:42.750Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "91e296b0-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:42.747Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "91e22180-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:42.744Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "91e296b0-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:42.747Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:91e296b0-d565-11e9-8e5d-3b485732bbc4 (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "91e30be0-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:42.750Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "91e22180-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:42.744Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "91e296b0-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:42.747Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:91e30be0-d565-11e9-8e5d-3b485732bbc4:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:91e22180-d565-11e9-8e5d-3b485732bbc4:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:91e296b0-d565-11e9-8e5d-3b485732bbc4:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "944fed30-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:46.818Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "94508970-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:46.823Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "94503b50-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:46.821Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "944fed30-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:46.818Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "94503b50-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:46.821Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "94508970-d565-11e9-8e5d-3b485732bbc4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T13:59:46.823Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:944fed30-d565-11e9-8e5d-3b485732bbc4:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:94503b50-d565-11e9-8e5d-3b485732bbc4:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:94508970-d565-11e9-8e5d-3b485732bbc4:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "96bf8da0-d565-11e9-8e5d-3b485732bbc4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T13:59:50.906Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:96bf8da0-d565-11e9-8e5d-3b485732bbc4:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:96bf8da0-d565-11e9-8e5d-3b485732bbc4:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e3099520-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "created_at": "2019-09-12T14:01:58.879Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T14:01:58.897Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:e3099520-d565-11e9-b63e-03acb2b8838b:{} (2)'] = {
  "results": {
    "id": "e3099520-d565-11e9-b63e-03acb2b8838b",
    "type": "tokens",
    "updated_at": "2019-09-12T14:01:58.897Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T14:01:58.879Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e3099520-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "created_at": "2019-09-12T14:01:58.879Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T14:01:58.897Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:e3099520-d565-11e9-b63e-03acb2b8838b:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e40496f0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:00.543Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e40496f0-d565-11e9-b63e-03acb2b8838b:{"active":false}:{} (2)'] = {
  "results": {
    "id": "e40496f0-d565-11e9-b63e-03acb2b8838b",
    "type": "tokens",
    "updated_at": "2019-09-12T14:02:01.559Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e40496f0-d565-11e9-b63e-03acb2b8838b:{} (3)'] = {
  "results": {
    "id": "e40496f0-d565-11e9-b63e-03acb2b8838b",
    "type": "tokens",
    "updated_at": "2019-09-12T14:02:01.559Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e40496f0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:01.559Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:e40496f0-d565-11e9-b63e-03acb2b8838b:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e5d6e5f0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:03.599Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e5d670c0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:03.596Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e5d6e5f0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:03.599Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:e5d6e5f0-d565-11e9-b63e-03acb2b8838b (4)'] = {
  "results": {
    "id": "e5d6e5f0-d565-11e9-b63e-03acb2b8838b",
    "type": "tokens",
    "updated_at": "2019-09-12T14:02:03.599Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e5d6e5f0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:03.599Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "e5d670c0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:03.596Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:e5d6e5f0-d565-11e9-b63e-03acb2b8838b:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:e5d670c0-d565-11e9-b63e-03acb2b8838b:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e7abf410-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:06.673Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e7ab7ee0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:06.670Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e7ab7ee0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:06.670Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "e7abf410-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:06.673Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:e7ab7ee0-d565-11e9-b63e-03acb2b8838b:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:e7abf410-d565-11e9-b63e-03acb2b8838b:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e98213a0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:09.754Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "e982fe00-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:09.760Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e98288d0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:09.757Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e98288d0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:09.757Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:e98288d0-d565-11e9-b63e-03acb2b8838b (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e98213a0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:09.754Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "e982fe00-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:09.760Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "e98288d0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:09.757Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:e98213a0-d565-11e9-b63e-03acb2b8838b:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:e982fe00-d565-11e9-b63e-03acb2b8838b:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:e98288d0-d565-11e9-b63e-03acb2b8838b:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ebf33ab0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:13.851Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ebf2c580-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:13.848Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ebf3afe0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:13.854Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ebf3afe0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:13.854Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "ebf2c580-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:13.848Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "ebf33ab0-d565-11e9-b63e-03acb2b8838b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:02:13.851Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ebf3afe0-d565-11e9-b63e-03acb2b8838b:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ebf2c580-d565-11e9-b63e-03acb2b8838b:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ebf33ab0-d565-11e9-b63e-03acb2b8838b:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ee6720e0-d565-11e9-b63e-03acb2b8838b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:02:17.966Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:ee6720e0-d565-11e9-b63e-03acb2b8838b:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:ee6720e0-d565-11e9-b63e-03acb2b8838b:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2b233960-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "created_at": "2019-09-12T14:03:59.844Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T14:03:59.861Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:2b233960-d566-11e9-8f85-8b99a4a393cc:{} (2)'] = {
  "results": {
    "id": "2b233960-d566-11e9-8f85-8b99a4a393cc",
    "type": "tokens",
    "updated_at": "2019-09-12T14:03:59.861Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T14:03:59.844Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2b233960-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "created_at": "2019-09-12T14:03:59.844Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T14:03:59.861Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:2b233960-d566-11e9-8f85-8b99a4a393cc:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2bfde1f0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:01.294Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:2bfde1f0-d566-11e9-8f85-8b99a4a393cc:{"active":false}:{} (2)'] = {
  "results": {
    "id": "2bfde1f0-d566-11e9-8f85-8b99a4a393cc",
    "type": "tokens",
    "updated_at": "2019-09-12T14:04:02.303Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:2bfde1f0-d566-11e9-8f85-8b99a4a393cc:{} (3)'] = {
  "results": {
    "id": "2bfde1f0-d566-11e9-8f85-8b99a4a393cc",
    "type": "tokens",
    "updated_at": "2019-09-12T14:04:02.303Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2bfde1f0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:02.303Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:2bfde1f0-d566-11e9-8f85-8b99a4a393cc:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2de93730-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:04.515Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "2de9ac60-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:04.518Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2de9ac60-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:04.518Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:2de9ac60-d566-11e9-8f85-8b99a4a393cc (4)'] = {
  "results": {
    "id": "2de9ac60-d566-11e9-8f85-8b99a4a393cc",
    "type": "tokens",
    "updated_at": "2019-09-12T14:04:04.518Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2de9ac60-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:04.518Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "2de93730-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:04.515Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:2de9ac60-d566-11e9-8f85-8b99a4a393cc:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:2de93730-d566-11e9-8f85-8b99a4a393cc:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2fbf7dd0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:07.597Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "2fbfcbf0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:07.599Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "2fbfcbf0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:07.599Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "2fbf7dd0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:07.597Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:2fbfcbf0-d566-11e9-8f85-8b99a4a393cc:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:2fbf7dd0-d566-11e9-8f85-8b99a4a393cc:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "3195eb80-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:10.680Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "319660b0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:10.683Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "31957650-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:10.677Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "3195eb80-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:10.680Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:3195eb80-d566-11e9-8f85-8b99a4a393cc (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "3195eb80-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:10.680Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "319660b0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:10.683Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "31957650-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:10.677Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:3195eb80-d566-11e9-8f85-8b99a4a393cc:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:319660b0-d566-11e9-8f85-8b99a4a393cc:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:31957650-d566-11e9-8f85-8b99a4a393cc:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "34058bf0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:14.767Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "3404a190-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:14.761Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "340516c0-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:14.764Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "340516c0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:14.764Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "34058bf0-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:14.767Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "3404a190-d566-11e9-8f85-8b99a4a393cc",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:04:14.761Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:340516c0-d566-11e9-8f85-8b99a4a393cc:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:34058bf0-d566-11e9-8f85-8b99a4a393cc:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:3404a190-d566-11e9-8f85-8b99a4a393cc:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "36792400-d566-11e9-8f85-8b99a4a393cc",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:04:18.880Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:36792400-d566-11e9-8f85-8b99a4a393cc:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:36792400-d566-11e9-8f85-8b99a4a393cc:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "466c6f10-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T14:11:55.136Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "466c6f10-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T14:11:55.136Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:466c6f10-d567-11e9-9ce5-b527b0a2bae4:{} (3)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "474b5d60-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:11:56.598Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "474bf9a0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:11:56.601Z",
    "version": "WzMsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "474b5d60-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:11:56.598Z",
        "version": "WzIsMV0="
      },
      {
        "type": "tokens",
        "id": "474bf9a0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:11:56.601Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:474b5d60-d567-11e9-9ce5-b527b0a2bae4:{} (4)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:474bf9a0-d567-11e9-9ce5-b527b0a2bae4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "49217cf0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:11:59.679Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "492107c0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:11:59.676Z",
    "version": "WzcsMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "492107c0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:11:59.676Z",
        "version": "WzcsMV0="
      },
      {
        "type": "tokens",
        "id": "49217cf0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:11:59.679Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:492107c0-d567-11e9-9ce5-b527b0a2bae4:{} (4)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:49217cf0-d567-11e9-9ce5-b527b0a2bae4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "4af52b80-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:02.744Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "4af66400-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:02.752Z",
    "version": "WzExLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "4af70040-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:02.755Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "4af52b80-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:02.744Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "4af66400-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:02.752Z",
        "version": "WzExLDFd"
      },
      {
        "type": "tokens",
        "id": "4af70040-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:02.755Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:4af52b80-d567-11e9-9ce5-b527b0a2bae4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:4af66400-d567-11e9-9ce5-b527b0a2bae4:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:4af70040-d567-11e9-9ce5-b527b0a2bae4:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "4d689c80-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:06.856Z",
    "version": "WzE4LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "4d69adf0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:06.863Z",
    "version": "WzE2LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "4d6938c0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:06.860Z",
    "version": "WzE3LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "4d69adf0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:06.863Z",
        "version": "WzE2LDFd"
      },
      {
        "type": "tokens",
        "id": "4d6938c0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:06.860Z",
        "version": "WzE3LDFd"
      },
      {
        "type": "tokens",
        "id": "4d689c80-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:06.856Z",
        "version": "WzE4LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:4d69adf0-d567-11e9-9ce5-b527b0a2bae4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:4d6938c0-d567-11e9-9ce5-b527b0a2bae4:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:4d689c80-d567-11e9-9ce5-b527b0a2bae4:{} (7)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "4fda5fd0-d567-11e9-9ce5-b527b0a2bae4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:12:10.957Z",
    "version": "WzIyLDFd"
  }
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "4fda5fd0-d567-11e9-9ce5-b527b0a2bae4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:12:10.957Z",
        "version": "WzIyLDFd"
      }
    ]
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:4fda5fd0-d567-11e9-9ce5-b527b0a2bae4:{} (3)'] = {
  "results": {}
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7ebe2890-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "created_at": "2019-09-12T14:13:29.599Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:29.624Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:7ebe2890-d567-11e9-8f8e-d36ffb900437:{} (2)'] = {
  "results": {
    "id": "7ebe2890-d567-11e9-8f8e-d36ffb900437",
    "type": "tokens",
    "updated_at": "2019-09-12T14:13:29.624Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T14:13:29.599Z",
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7ebe2890-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "created_at": "2019-09-12T14:13:29.599Z",
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:29.624Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:7ebe2890-d567-11e9-8f8e-d36ffb900437:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "7f959cd0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:31.037Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7f959cd0-d567-11e9-8f8e-d36ffb900437:{"active":false}:{} (2)'] = {
  "results": {
    "id": "7f959cd0-d567-11e9-8f8e-d36ffb900437",
    "type": "tokens",
    "updated_at": "2019-09-12T14:13:32.053Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:7f959cd0-d567-11e9-8f8e-d36ffb900437:{} (3)'] = {
  "results": {
    "id": "7f959cd0-d567-11e9-8f8e-d36ffb900437",
    "type": "tokens",
    "updated_at": "2019-09-12T14:13:32.053Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "token": "notencryptedtoken"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "7f959cd0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "token": "notencryptedtoken"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:32.053Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:7f959cd0-d567-11e9-8f8e-d36ffb900437:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "816839f0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:34.095Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8167c4c0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:34.092Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "816839f0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:34.095Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:816839f0-d567-11e9-8f8e-d36ffb900437 (4)'] = {
  "results": {
    "id": "816839f0-d567-11e9-8f8e-d36ffb900437",
    "type": "tokens",
    "updated_at": "2019-09-12T14:13:34.095Z",
    "version": "WzUsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "816839f0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:34.095Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "8167c4c0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:34.092Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:816839f0-d567-11e9-8f8e-d36ffb900437:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8167c4c0-d567-11e9-8f8e-d36ffb900437:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "833f6af0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:37.183Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "83402e40-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:37.188Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "833f6af0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:37.183Z",
        "version": "WzEwLDFd"
      },
      {
        "type": "tokens",
        "id": "83402e40-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:37.188Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:833f6af0-d567-11e9-8f8e-d36ffb900437:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:83402e40-d567-11e9-8f8e-d36ffb900437:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "85158a80-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:40.264Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "851674e0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:40.270Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8515ffb0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:40.267Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8515ffb0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:40.267Z",
        "version": "WzEzLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:8515ffb0-d567-11e9-8f8e-d36ffb900437 (5)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"Unable to decrypt attribute \\\"token\\\"\",\"name\":\"Error\",\"stack\":\"Error: Unable to decrypt attribute \\\"token\\\"\\n    at EncryptedSavedObjectsService.decryptAttributes (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:244:15)\",\"attributeName\":\"token\",\"cause\":{}}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "851674e0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:40.270Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "8515ffb0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:40.267Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "85158a80-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:40.264Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:851674e0-d567-11e9-8f8e-d36ffb900437:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:8515ffb0-d567-11e9-8f8e-d36ffb900437:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:85158a80-d567-11e9-8f8e-d36ffb900437:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "87a70ad0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:44.573Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "87a5ab40-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:44.564Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "87a66e90-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:44.569Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "87a5ab40-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:44.564Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "87a66e90-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "token": "notencryptedtoken",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:44.569Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "87a70ad0-d567-11e9-8f8e-d36ffb900437",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T14:13:44.573Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:87a5ab40-d567-11e9-8f8e-d36ffb900437:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:87a66e90-d567-11e9-8f8e-d36ffb900437:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:87a70ad0-d567-11e9-8f8e-d36ffb900437:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8a1795a0-d567-11e9-8f8e-d36ffb900437",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T14:13:48.666Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:8a1795a0-d567-11e9-8f8e-d36ffb900437:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:8a1795a0-d567-11e9-8f8e-d36ffb900437:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Acf320180-0df1-4a46-abb1-aae37f72fac3?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Acf320180-0df1-4a46-abb1-aae37f72fac3\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T14:28:31.184Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"1mIJDyJRNAGODClxsAzW0/Hyvg5M6lnhvQuZ1k9Xz/6KKR5kBLSskBnL5A1hQyXc1Fbppt/uO38m66rMgay95DCGWXUdRz5KYgni0D4tlIhgYaCiOZbTbgEGbxlobmf4NhYi8s0pPRvNuASBz9vL\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.224Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Acf320180-0df1-4a46-abb1-aae37f72fac3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Acf320180-0df1-4a46-abb1-aae37f72fac3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad673f937-d9fd-4227-bd9a-b6796909957f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ad673f937-d9fd-4227-bd9a-b6796909957f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"zeyOLPSx7KZrMp3z0XufsrLO9lQu4xO3gQvhtZiZkAaL1/0wqzn6jOIWWfBD9te+sny+E5k5yHZW9OAVwoVIs35H1AEIzXkQ2q0l3hnqecJPEPeIb9Ep4tAVMXFbV0pFosObkI5/gUgqS1GDvzTi\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.308Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad673f937-d9fd-4227-bd9a-b6796909957f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad673f937-d9fd-4227-bd9a-b6796909957f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A9834a4a0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A9834a4a0-d569-11e9-8de9-7bcf5ba33ba0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T14:28:31.338Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A9834a4a0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A9834a4a0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A47cfd545-2946-45cd-b8c2-cba0e001b543?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A47cfd545-2946-45cd-b8c2-cba0e001b543\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.453Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A47cfd545-2946-45cd-b8c2-cba0e001b543?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A47cfd545-2946-45cd-b8c2-cba0e001b543?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A05f1793f-302f-446f-9f20-6b72370449d7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A05f1793f-302f-446f-9f20-6b72370449d7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.453Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A05f1793f-302f-446f-9f20-6b72370449d7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A05f1793f-302f-446f-9f20-6b72370449d7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0e0ab3d8-1aaa-4e95-a310-92bc7e474f47?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0e0ab3d8-1aaa-4e95-a310-92bc7e474f47\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.582Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0e0ab3d8-1aaa-4e95-a310-92bc7e474f47?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0e0ab3d8-1aaa-4e95-a310-92bc7e474f47?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Af646b100-1a90-4f06-9ee8-9bd03894d3e5?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Af646b100-1a90-4f06-9ee8-9bd03894d3e5\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.583Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af646b100-1a90-4f06-9ee8-9bd03894d3e5?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af646b100-1a90-4f06-9ee8-9bd03894d3e5?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae63b7bb0-4563-4b61-b918-2299e73605f0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae63b7bb0-4563-4b61-b918-2299e73605f0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.639Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae63b7bb0-4563-4b61-b918-2299e73605f0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae63b7bb0-4563-4b61-b918-2299e73605f0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d6fb1d0-07f7-401f-9efe-baefdcdd38a9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A2d6fb1d0-07f7-401f-9efe-baefdcdd38a9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.639Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d6fb1d0-07f7-401f-9efe-baefdcdd38a9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d6fb1d0-07f7-401f-9efe-baefdcdd38a9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4cb23537-9100-4a4b-b7e4-ef6595baaea4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4cb23537-9100-4a4b-b7e4-ef6595baaea4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"w4GSvE/ofitBp2Am1Jt7IDvbX6ZKF7c8Z92DTmo6fc/d7XSz1hx45IMMyLfcq8VHGlWbtvm2jEMBRhuG+9o61pL6LH0mBKWzPfTH6YnuO77jzS1iHl0z8/f30NZ0TtNOxlrM8KZx6LIWNAzh9FV2\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.659Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4cb23537-9100-4a4b-b7e4-ef6595baaea4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4cb23537-9100-4a4b-b7e4-ef6595baaea4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb777255-ac93-4dc4-a235-fe16154dd56c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Afb777255-ac93-4dc4-a235-fe16154dd56c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.700Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb777255-ac93-4dc4-a235-fe16154dd56c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb777255-ac93-4dc4-a235-fe16154dd56c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A91210263-fbbd-40ad-b7cc-ebdeb85748c0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A91210263-fbbd-40ad-b7cc-ebdeb85748c0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.700Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A91210263-fbbd-40ad-b7cc-ebdeb85748c0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A91210263-fbbd-40ad-b7cc-ebdeb85748c0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ce439b6-c1da-4054-b521-3c8f9df2c0ac?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9ce439b6-c1da-4054-b521-3c8f9df2c0ac\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"efFOxyxCA7TwosBqZahOKKLK+2x6PnmuusdwauqnWzApS2SYUgZB9kMnoq3sgL8FQbxZshmm8GbCcKzyOJKA2IgJCsB45nCki8osp+xUESMQNdtc6wOhmtoJvkI+xWBmTQY7iBmuYmfeBojvWqiF\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.716Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ce439b6-c1da-4054-b521-3c8f9df2c0ac?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ce439b6-c1da-4054-b521-3c8f9df2c0ac?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A96372877-e716-4367-bbed-21b000cb4f93?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A96372877-e716-4367-bbed-21b000cb4f93\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:28:31.741Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A96372877-e716-4367-bbed-21b000cb4f93?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A96372877-e716-4367-bbed-21b000cb4f93?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A98741ea0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A98741ea0-d569-11e9-8de9-7bcf5ba33ba0\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A98741ea0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A98741ea0-d569-11e9-8de9-7bcf5ba33ba0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A478ba48b-e2ad-4475-8f4b-816ff4d1384d?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A478ba48b-e2ad-4475-8f4b-816ff4d1384d\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T14:29:33.789Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"kVhYTz7HwMgBOgG+vO7guCjUhGVfOTi7gQeRsvOCD0gqQYIWHtPUXfaR5+SbQqjpJoXUSMDE5Bf4pO5TIqn7kAobrq6faKemLCzy/mI5oA+wBlWKuLTn4R9W0tL/i5YPAk78zt0gxDxB7+tXP0Un\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:33.826Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A478ba48b-e2ad-4475-8f4b-816ff4d1384d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A478ba48b-e2ad-4475-8f4b-816ff4d1384d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A71971876-b548-47f1-a2c2-6e7b4cf393c6?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A71971876-b548-47f1-a2c2-6e7b4cf393c6\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"rO+Sk5ZeX+IFokf2pkcehL0gRDF3eGR9yyhd5+6ijDLvJ8hHklkDnEUmcJ9/cUPlkAq+fzdbd0MMY61NQV4bu6ggAHgKZ/6E9zLB3jhIJepaFN9vxVDZNiBZaeYKf/4j0PQc+c0zdpHE8RDbA2yZ\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:33.899Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A71971876-b548-47f1-a2c2-6e7b4cf393c6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A71971876-b548-47f1-a2c2-6e7b4cf393c6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3Abd8170d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3Abd8170d0-d569-11e9-926c-cdfea4820c2a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T14:29:33.917Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Abd8170d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Abd8170d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Adf02332b-60ef-4003-995b-33e9c4f62df0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Adf02332b-60ef-4003-995b-33e9c4f62df0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:33.960Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Adf02332b-60ef-4003-995b-33e9c4f62df0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Adf02332b-60ef-4003-995b-33e9c4f62df0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A862b8abb-4543-4263-886b-be5d926862f0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A862b8abb-4543-4263-886b-be5d926862f0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:33.961Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A862b8abb-4543-4263-886b-be5d926862f0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A862b8abb-4543-4263-886b-be5d926862f0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A23f21a2f-0fb2-4d4f-8ba6-e08f18d25753?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A23f21a2f-0fb2-4d4f-8ba6-e08f18d25753\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.013Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A23f21a2f-0fb2-4d4f-8ba6-e08f18d25753?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A23f21a2f-0fb2-4d4f-8ba6-e08f18d25753?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7a1309a4-c42b-4413-b72c-bad2b1ae821f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7a1309a4-c42b-4413-b72c-bad2b1ae821f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.013Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7a1309a4-c42b-4413-b72c-bad2b1ae821f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7a1309a4-c42b-4413-b72c-bad2b1ae821f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aecaf3e3f-5d7f-4681-853b-171234f0101c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aecaf3e3f-5d7f-4681-853b-171234f0101c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.061Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aecaf3e3f-5d7f-4681-853b-171234f0101c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aecaf3e3f-5d7f-4681-853b-171234f0101c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9a7c7852-abf8-40a1-8a94-e45dd45acad1?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9a7c7852-abf8-40a1-8a94-e45dd45acad1\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.061Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9a7c7852-abf8-40a1-8a94-e45dd45acad1?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9a7c7852-abf8-40a1-8a94-e45dd45acad1?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb99c707-13d1-4b83-aa67-6dfac6b293d4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Afb99c707-13d1-4b83-aa67-6dfac6b293d4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"WwElqVVKv/EdRTK4aDFCebE7bnqqKW+m0qLHmC4eatyFTq8B7UaSSETDXSCad/93tvqJ4p+HyFqWB+wHcVfgqwtpyBXVlxzp4Y+vNMY+I99bIzLOOH/tVzFQ8beOAInpdpzYOwLwHiq//psDeWEa\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.079Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb99c707-13d1-4b83-aa67-6dfac6b293d4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afb99c707-13d1-4b83-aa67-6dfac6b293d4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A30656382-cfd2-4b2c-8c20-2680f72d07fd?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A30656382-cfd2-4b2c-8c20-2680f72d07fd\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.112Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A30656382-cfd2-4b2c-8c20-2680f72d07fd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A30656382-cfd2-4b2c-8c20-2680f72d07fd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A8084d4d5-2eb9-490b-ac39-7a9928cc74a7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A8084d4d5-2eb9-490b-ac39-7a9928cc74a7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.112Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8084d4d5-2eb9-490b-ac39-7a9928cc74a7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8084d4d5-2eb9-490b-ac39-7a9928cc74a7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7b9b3e4f-d274-4247-b34b-6b5bd018acac?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7b9b3e4f-d274-4247-b34b-6b5bd018acac\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"+0tG+s+lL3pPfGcICuB+qHm64eqs/B1cp4hql6FdHDgx3mBcs9kcm+5mnkad+a2EXCBtp//mOYG0CfEiCkPsnIApb3pULHvPkK6iTsPt257RQWHJ4eyr7TXHqym94EgVrMYayUTSOTKZE2rZjM+V\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.139Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7b9b3e4f-d274-4247-b34b-6b5bd018acac?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7b9b3e4f-d274-4247-b34b-6b5bd018acac?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4fda1425-c454-4409-9606-a44e513d0590?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4fda1425-c454-4409-9606-a44e513d0590\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:29:34.154Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4fda1425-c454-4409-9606-a44e513d0590?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4fda1425-c454-4409-9606-a44e513d0590?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3Abda880d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3Abda880d0-d569-11e9-926c-cdfea4820c2a\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Abda880d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Abda880d0-d569-11e9-926c-cdfea4820c2a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9983503-efdc-447d-a608-96b3250847b4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ad9983503-efdc-447d-a608-96b3250847b4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T14:37:31.285Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"zEjnDT2u9hTLuEThgqtWNwJ8x4c4zlSs21UVDuxEDL9+oWb1vGHHieTwXATZT0evRD0FMA/5lIsjEmMuPCKlyILz5BLUP5P/B32HPHNXMI6BGlTQ1GBUrY/o14mWLDLhJGzl5ZquLSN3UIy3uJ4a\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.343Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9983503-efdc-447d-a608-96b3250847b4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9983503-efdc-447d-a608-96b3250847b4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A5340f162-344f-43e6-80cb-9eaa7974aa26?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A5340f162-344f-43e6-80cb-9eaa7974aa26\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"nTnYdltgY0VsnzGtRmgh5IoNYqNeiPgKQ/fUoktxmplzcpNI8xe1SzzvRRmOgGIJzg9rh2TP4da7XDpP9UOpRyhr/+PTRaBPrzykw5TPXcNlFbMc5BsDOeisliYeyyvJ4UgsTGTTl988MWgR+eAi\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.559Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5340f162-344f-43e6-80cb-9eaa7974aa26?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5340f162-344f-43e6-80cb-9eaa7974aa26?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3Ada36b9a0-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3Ada36b9a0-d56a-11e9-a2c8-c31f79b80640\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T14:37:31.578Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Ada36b9a0-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Ada36b9a0-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab02387c0-8806-495e-af01-74be4bc37d04?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab02387c0-8806-495e-af01-74be4bc37d04\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.627Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab02387c0-8806-495e-af01-74be4bc37d04?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab02387c0-8806-495e-af01-74be4bc37d04?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A2072abb7-730a-4adb-9d01-dcfd78f2f566?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A2072abb7-730a-4adb-9d01-dcfd78f2f566\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.627Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2072abb7-730a-4adb-9d01-dcfd78f2f566?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2072abb7-730a-4adb-9d01-dcfd78f2f566?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae83a69a1-6ef5-44a7-836c-8b235a63f9a4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae83a69a1-6ef5-44a7-836c-8b235a63f9a4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.692Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae83a69a1-6ef5-44a7-836c-8b235a63f9a4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae83a69a1-6ef5-44a7-836c-8b235a63f9a4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A43baa227-8bc5-4422-a4c4-62a935b55a65?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A43baa227-8bc5-4422-a4c4-62a935b55a65\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.692Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A43baa227-8bc5-4422-a4c4-62a935b55a65?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A43baa227-8bc5-4422-a4c4-62a935b55a65?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A901d23c7-ed93-43fe-920d-ae0a8d5d29ce?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A901d23c7-ed93-43fe-920d-ae0a8d5d29ce\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.749Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A901d23c7-ed93-43fe-920d-ae0a8d5d29ce?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A901d23c7-ed93-43fe-920d-ae0a8d5d29ce?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab062f986-f3c3-4a8e-965c-f7f0d62cb9ce?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab062f986-f3c3-4a8e-965c-f7f0d62cb9ce\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.749Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab062f986-f3c3-4a8e-965c-f7f0d62cb9ce?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab062f986-f3c3-4a8e-965c-f7f0d62cb9ce?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A2e37726c-35f4-4f72-9391-e9ff0432d657?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A2e37726c-35f4-4f72-9391-e9ff0432d657\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.804Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2e37726c-35f4-4f72-9391-e9ff0432d657?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2e37726c-35f4-4f72-9391-e9ff0432d657?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0d12b0f7-6a41-498e-97a4-0c93f0a8d139?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0d12b0f7-6a41-498e-97a4-0c93f0a8d139\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.804Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0d12b0f7-6a41-498e-97a4-0c93f0a8d139?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0d12b0f7-6a41-498e-97a4-0c93f0a8d139?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A30c47154-58cf-42c3-b0f4-3192796ec17a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A30c47154-58cf-42c3-b0f4-3192796ec17a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"D0XERjx4izHtFAiXpsCN4vsYQqUYlpIKtyxcT5jNDR0nnULplBTXbBWXSkwgcc9u+2nJprchSq1e4sSaFLXvdK7mJgoi0/+HrMvsyyaSJcD+K1Xcn0NG0NqZtRCm14lCrJtEvaZWZ3j2P9kaTuUz\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.750Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A30c47154-58cf-42c3-b0f4-3192796ec17a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A30c47154-58cf-42c3-b0f4-3192796ec17a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A572c348f-d56c-4eda-b20b-4b57528fa9be?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A572c348f-d56c-4eda-b20b-4b57528fa9be\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"/ccO1oGKSgQPRzj2bU14NTAqYc7eENVOf35vqTVpcqc77dWTJfD6pKzQo5C8/HSvB+vJksCQalUOM7brXARQbeVrLs1ZCDM+fINYnlkRabYbcns1aSq/TXFB4Eoax+JOgzBUZ2O9U0gflZ65w6y5\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.843Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A572c348f-d56c-4eda-b20b-4b57528fa9be?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A572c348f-d56c-4eda-b20b-4b57528fa9be?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae56deddd-9964-4a99-8716-b91d54b0ce9f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae56deddd-9964-4a99-8716-b91d54b0ce9f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:37:31.860Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae56deddd-9964-4a99-8716-b91d54b0ce9f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae56deddd-9964-4a99-8716-b91d54b0ce9f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ada64a770-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3Ada64a770-d56a-11e9-a2c8-c31f79b80640\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ada64a770-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ada64a770-d56a-11e9-a2c8-c31f79b80640?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A8a32560e-52db-44ba-a7fa-3808a00ec0e9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A8a32560e-52db-44ba-a7fa-3808a00ec0e9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T14:52:22.357Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"D6VrHZHksZQHCkj5g0CKQ+sZOz1KWs1uydLY7TvmR27tYZ1KRV7/BM4uXZV7xGuIup/3mvtJJWe6SsMMKgyQl0eIZcwj35ISMw0L9lOJakcn/keggWqoOpaqbHqqbJLylEK+t90g5mNJzJH0Yx9q\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.405Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8a32560e-52db-44ba-a7fa-3808a00ec0e9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8a32560e-52db-44ba-a7fa-3808a00ec0e9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Adce4419a-a82b-4b77-8d38-acd65569ffdc?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Adce4419a-a82b-4b77-8d38-acd65569ffdc\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"K36UCWGjg7SJCXqujwCBaJDkxPEA/XdeeKSHKYW4MOJTycbLpcvbA+xOaM+s4+TI6HsJgKR90h5cL+MhViCqAebGCGFAsOI+uYJy1FFUsC7bRVOSlEwuW6NABF7Zgntw/cy+6/aD014k1a9fcRVF\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.509Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Adce4419a-a82b-4b77-8d38-acd65569ffdc?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Adce4419a-a82b-4b77-8d38-acd65569ffdc?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3Aed43f970-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3Aed43f970-d56c-11e9-9703-cf9bb13c3d0e\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T14:52:22.535Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Aed43f970-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Aed43f970-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c639ce9-50bb-4b2e-b93d-4a61703f3729?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7c639ce9-50bb-4b2e-b93d-4a61703f3729\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.590Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c639ce9-50bb-4b2e-b93d-4a61703f3729?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c639ce9-50bb-4b2e-b93d-4a61703f3729?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A15616c2d-be21-465f-b295-eea67b019134?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A15616c2d-be21-465f-b295-eea67b019134\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.591Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A15616c2d-be21-465f-b295-eea67b019134?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A15616c2d-be21-465f-b295-eea67b019134?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa9f3269d-b873-4145-b2cc-2e367a8aea3c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa9f3269d-b873-4145-b2cc-2e367a8aea3c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.650Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa9f3269d-b873-4145-b2cc-2e367a8aea3c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa9f3269d-b873-4145-b2cc-2e367a8aea3c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A2f9f8b03-3fe8-4dcc-b455-11730dda4379?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A2f9f8b03-3fe8-4dcc-b455-11730dda4379\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.650Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2f9f8b03-3fe8-4dcc-b455-11730dda4379?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2f9f8b03-3fe8-4dcc-b455-11730dda4379?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9786081c-57e6-41eb-ab72-4c2ed2f99b42?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9786081c-57e6-41eb-ab72-4c2ed2f99b42\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.721Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9786081c-57e6-41eb-ab72-4c2ed2f99b42?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9786081c-57e6-41eb-ab72-4c2ed2f99b42?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab873c78c-fda6-4615-8475-abead6806ebc?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab873c78c-fda6-4615-8475-abead6806ebc\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.721Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab873c78c-fda6-4615-8475-abead6806ebc?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab873c78c-fda6-4615-8475-abead6806ebc?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A8fc45c09-6b04-47b1-9a31-479f3817e59c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A8fc45c09-6b04-47b1-9a31-479f3817e59c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"83o4H30DQHB5FI11lyQk0BBQhHsg8Fwh9vxQYBvkn8VI6P6/C/rEWzsmWlG4x4WizF9dB7gjC2mS2Wqw+9UchEGLc7KygAdV2o5J4W8Fr4rbOnsJdMF/Pgb4hPnTYROpt9difyVgBk2Pd4HLz2cI\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.778Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8fc45c09-6b04-47b1-9a31-479f3817e59c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8fc45c09-6b04-47b1-9a31-479f3817e59c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A071d9c52-87e3-4286-8c34-0b8b79e0420b?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A071d9c52-87e3-4286-8c34-0b8b79e0420b\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.804Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A071d9c52-87e3-4286-8c34-0b8b79e0420b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A071d9c52-87e3-4286-8c34-0b8b79e0420b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1e1221b-c39f-42f4-8bde-11d6288c639b?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa1e1221b-c39f-42f4-8bde-11d6288c639b\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.804Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1e1221b-c39f-42f4-8bde-11d6288c639b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1e1221b-c39f-42f4-8bde-11d6288c639b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A5152c988-4af5-449e-bea4-498ab7d13a65?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A5152c988-4af5-449e-bea4-498ab7d13a65\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"LpWVS6193l0G5ODap7s1EM3R8hwPt+9y4rhptIdsCrTOWKcL7GoW6KzODpsEA3AdIjalvFgIFw6okhpTLaPnZSpfuLEnITZxgGpf+JY1yp8Z1C5X6lkfdVvE4STZIH8/M/b2hpD6z7QIXuQtzT+T\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.823Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5152c988-4af5-449e-bea4-498ab7d13a65?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5152c988-4af5-449e-bea4-498ab7d13a65?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A3f9cacd0-d683-4949-8d87-b1f06de642a8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A3f9cacd0-d683-4949-8d87-b1f06de642a8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T14:52:22.857Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3f9cacd0-d683-4949-8d87-b1f06de642a8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3f9cacd0-d683-4949-8d87-b1f06de642a8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aed77b3a0-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3Aed77b3a0-d56c-11e9-9703-cf9bb13c3d0e\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aed77b3a0-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aed77b3a0-d56c-11e9-9703-cf9bb13c3d0e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A62b3ae44-fd88-445d-811f-8b557d502342?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A62b3ae44-fd88-445d-811f-8b557d502342\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T15:11:38.907Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"2UHPIB3Peb98aj+KSlZaPKaeKTYDzpo63XVmV47RekAkh6/r7NJm4Ps8ixddvUqGaCtOgEmLpKljOwb0TkHTXFBiukVX0DpxQvJoQaaq9DdS63wJGLm7Z/DnOwSJYYqvuJ8ubeYTpACx1SU3aCHy\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:38.966Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A62b3ae44-fd88-445d-811f-8b557d502342?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A62b3ae44-fd88-445d-811f-8b557d502342?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A39e0ce44-87ae-4b91-a7e2-55f1d5e68b86?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A39e0ce44-87ae-4b91-a7e2-55f1d5e68b86\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"tY4lh7V3EgmptTAv2O1maNKo801wXgErYKyRrDf1HSjyhHEfoJR6MMYDhlLcTQAOu0sr2lLAelyuXOUC0VMFGVNBpNOPkqOyDDEFRekJ/8aAzPgtYJ8mJcONIsUgjIqzAnJaaO9MfyVoov5Vv1Lm\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.076Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A39e0ce44-87ae-4b91-a7e2-55f1d5e68b86?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A39e0ce44-87ae-4b91-a7e2-55f1d5e68b86?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A9ea23ef0-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A9ea23ef0-d56f-11e9-a90c-c3ed8994a898\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T15:11:39.103Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A9ea23ef0-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A9ea23ef0-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9459b698-72f3-43a4-ab99-308581dea793?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9459b698-72f3-43a4-ab99-308581dea793\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.165Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9459b698-72f3-43a4-ab99-308581dea793?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9459b698-72f3-43a4-ab99-308581dea793?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9787b14b-7ee1-4bf7-8be8-e8047bc0f7d6?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9787b14b-7ee1-4bf7-8be8-e8047bc0f7d6\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.166Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9787b14b-7ee1-4bf7-8be8-e8047bc0f7d6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9787b14b-7ee1-4bf7-8be8-e8047bc0f7d6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A40896e61-d754-427d-8d16-d27db9defb7f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A40896e61-d754-427d-8d16-d27db9defb7f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.247Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A40896e61-d754-427d-8d16-d27db9defb7f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A40896e61-d754-427d-8d16-d27db9defb7f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Abfb3de05-0e2e-46f5-837d-a20029e300e3?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Abfb3de05-0e2e-46f5-837d-a20029e300e3\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.247Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abfb3de05-0e2e-46f5-837d-a20029e300e3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abfb3de05-0e2e-46f5-837d-a20029e300e3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b98c5ab-baf6-4acc-b87c-303c5a0e8091?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A3b98c5ab-baf6-4acc-b87c-303c5a0e8091\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.336Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b98c5ab-baf6-4acc-b87c-303c5a0e8091?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b98c5ab-baf6-4acc-b87c-303c5a0e8091?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A444ec631-cdc0-43db-8bfc-96e33467f8c2?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A444ec631-cdc0-43db-8bfc-96e33467f8c2\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.336Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A444ec631-cdc0-43db-8bfc-96e33467f8c2?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A444ec631-cdc0-43db-8bfc-96e33467f8c2?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A272b29c5-2e8a-4f2d-986f-6468f9a68fc8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A272b29c5-2e8a-4f2d-986f-6468f9a68fc8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.552Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A272b29c5-2e8a-4f2d-986f-6468f9a68fc8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A272b29c5-2e8a-4f2d-986f-6468f9a68fc8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4c790b6a-81bf-4584-83e9-b418217b703a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4c790b6a-81bf-4584-83e9-b418217b703a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"kMj5ABm5mu2cfQ85S8RQVPXc4NGcHZfHnU08WUzLegQDxHa/mKEUXXDxut3KUEpM8Qjf1Kwwqk9V2e7nTdGsbasWwD7B/PVyeB+/GNZv0EzpUEdj3N6VNY2Wgxbz6thSY2DlFjeuMGxXJCByXPAy\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.430Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4c790b6a-81bf-4584-83e9-b418217b703a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4c790b6a-81bf-4584-83e9-b418217b703a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae29622ec-1b30-4b8f-966f-f6fb97470c54?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae29622ec-1b30-4b8f-966f-f6fb97470c54\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"oOL2mfjF7B9YyGhv1XJtoLjp+OSlp30O+qV790D/C29KeMK47cyrEevI0GXwSJ6tVco399GFMZwCTdygo7MdA/3Fbyy9cJTkyNsB1H8b/3HDIa9kL4YgMgDXq/ZhSbjECzYgQ2oOnXTUXmzvpqEj\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.624Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae29622ec-1b30-4b8f-966f-f6fb97470c54?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae29622ec-1b30-4b8f-966f-f6fb97470c54?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7bc7fad8-93a5-41f5-969a-eebce7bd6ac0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7bc7fad8-93a5-41f5-969a-eebce7bd6ac0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.650Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7bc7fad8-93a5-41f5-969a-eebce7bd6ac0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7bc7fad8-93a5-41f5-969a-eebce7bd6ac0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae98d1b19-8282-4711-a6ec-5056c1673d62?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae98d1b19-8282-4711-a6ec-5056c1673d62\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T15:11:39.553Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae98d1b19-8282-4711-a6ec-5056c1673d62?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae98d1b19-8282-4711-a6ec-5056c1673d62?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A9ef8c360-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A9ef8c360-d56f-11e9-a90c-c3ed8994a898\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A9ef8c360-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A9ef8c360-d56f-11e9-a90c-c3ed8994a898?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4b5e4f3c-8bab-4f65-adbe-a8c4db64ff92?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4b5e4f3c-8bab-4f65-adbe-a8c4db64ff92\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:19:09.599Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"zjz2Y1okRvpoteRfwPpqXMGUUXHm7hFi2u+cMulnXD6V1RF9CB0mrKFjw2ryVgsDfEku8l8yERDjqRKBt1kiHKehOlm/RE34E9BvF3wrYbCLnYTjMOduTjkIKjBoV9BxwTOO4Lu1r3NVpQ7t3pZJ\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.635Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4b5e4f3c-8bab-4f65-adbe-a8c4db64ff92?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4b5e4f3c-8bab-4f65-adbe-a8c4db64ff92?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A376e9a89-669c-4de5-aef2-dab800c6d2be?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A376e9a89-669c-4de5-aef2-dab800c6d2be\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"vqc6xyiXA52Dx8kWJk3JBSWnHMaN7cd1RkHouLFhKzltDl6MfCYPwSSXzpUwvtjhoh0JYluLEKWrq01Knvv5A4fdZpa8HHfc8ktBH+zTp+laxd4U3D3Videi1uJtmy5QLonnWaBZAaN2SqPKx7da\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.711Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A376e9a89-669c-4de5-aef2-dab800c6d2be?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A376e9a89-669c-4de5-aef2-dab800c6d2be?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3Ad0889a80-d589-11e9-b29f-872356ebab82?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3Ad0889a80-d589-11e9-b29f-872356ebab82\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:19:09.735Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Ad0889a80-d589-11e9-b29f-872356ebab82?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Ad0889a80-d589-11e9-b29f-872356ebab82?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab2540a68-5671-491d-b958-d20b3c5cbe32?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab2540a68-5671-491d-b958-d20b3c5cbe32\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.774Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab2540a68-5671-491d-b958-d20b3c5cbe32?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab2540a68-5671-491d-b958-d20b3c5cbe32?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A81f57d08-2217-4d39-ac2e-e556d0b65495?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A81f57d08-2217-4d39-ac2e-e556d0b65495\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.774Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A81f57d08-2217-4d39-ac2e-e556d0b65495?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A81f57d08-2217-4d39-ac2e-e556d0b65495?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A559f61a8-ccb1-4844-9a65-fb0b906982b4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A559f61a8-ccb1-4844-9a65-fb0b906982b4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.828Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A559f61a8-ccb1-4844-9a65-fb0b906982b4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A559f61a8-ccb1-4844-9a65-fb0b906982b4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ee24836-4f7b-42dd-aa88-fe639be91284?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9ee24836-4f7b-42dd-aa88-fe639be91284\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.828Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ee24836-4f7b-42dd-aa88-fe639be91284?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9ee24836-4f7b-42dd-aa88-fe639be91284?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A970f9d6e-c2f8-44eb-895e-b328a4124187?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A970f9d6e-c2f8-44eb-895e-b328a4124187\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.887Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A970f9d6e-c2f8-44eb-895e-b328a4124187?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A970f9d6e-c2f8-44eb-895e-b328a4124187?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa278196f-2a1c-4282-ac9d-d0bd41802e17?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa278196f-2a1c-4282-ac9d-d0bd41802e17\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.888Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa278196f-2a1c-4282-ac9d-d0bd41802e17?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa278196f-2a1c-4282-ac9d-d0bd41802e17?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A189e59f8-8baf-4a44-8ace-057a0bf70a59?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A189e59f8-8baf-4a44-8ace-057a0bf70a59\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"nN2OTXFn1ZBSd2BQYrGC16VQvT6/RYq6pCznv0rlvxa9dSNcZoFghHRcrTs/EQesN3KJBJc8vQjf3rDtEs5BlB4PWa1avo9t2mqMspTjP/RHo+tNxpLH6OCYk4oxksGF7qlqBYvwvRiLiv51sQMD\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.906Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A189e59f8-8baf-4a44-8ace-057a0bf70a59?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A189e59f8-8baf-4a44-8ace-057a0bf70a59?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A940fe1b5-cfb7-4725-a638-e204c95170dd?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A940fe1b5-cfb7-4725-a638-e204c95170dd\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.943Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A940fe1b5-cfb7-4725-a638-e204c95170dd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A940fe1b5-cfb7-4725-a638-e204c95170dd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aac2fe6be-9f37-4ad0-a970-b32b1e9541a8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aac2fe6be-9f37-4ad0-a970-b32b1e9541a8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.943Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aac2fe6be-9f37-4ad0-a970-b32b1e9541a8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aac2fe6be-9f37-4ad0-a970-b32b1e9541a8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aab9ef8ad-f84d-421c-bf59-8499b401555d?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aab9ef8ad-f84d-421c-bf59-8499b401555d\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"5kZzBxLkbldHWq6VomlsJdRDUmL8BYeAxuShrVBtLkSPCcZJNC0BojbaxfaQhw+RYp7hr1DJu2Y4u27EJz796Wq+vTC0IxJtuxkm1/Fk3sdCBbhbPzzO7+I4N+j05/lfyCXdh2EnOoN85xPrVTcR\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.960Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aab9ef8ad-f84d-421c-bf59-8499b401555d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aab9ef8ad-f84d-421c-bf59-8499b401555d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Abf77b1fb-e7e9-431a-8d55-6e6dbeda5ad1?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Abf77b1fb-e7e9-431a-8d55-6e6dbeda5ad1\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:19:09.990Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abf77b1fb-e7e9-431a-8d55-6e6dbeda5ad1?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abf77b1fb-e7e9-431a-8d55-6e6dbeda5ad1?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ad0b1a650-d589-11e9-b29f-872356ebab82?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3Ad0b1a650-d589-11e9-b29f-872356ebab82\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ad0b1a650-d589-11e9-b29f-872356ebab82?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Ad0b1a650-d589-11e9-b29f-872356ebab82?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A60f40a6e-4d2e-40e6-9fc0-2e19862561d9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A60f40a6e-4d2e-40e6-9fc0-2e19862561d9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:20:48.324Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"wlb/8aK8K01SUdFf5Y8sAypizI12ZxsvT5bZ7y1DihdIDIH6aj3h5ZxTpKcUq/dzQdWMXoq0ckrsOr4jD/2Ka7MTCQsYcR0Tb3FVKMyJ3r0Uup1WgGxwqeC3NHloebsz1rWWRKONkGI7TED2oASJ\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.359Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A60f40a6e-4d2e-40e6-9fc0-2e19862561d9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A60f40a6e-4d2e-40e6-9fc0-2e19862561d9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0f358857-7ac5-4afc-be06-b775761aa81d?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0f358857-7ac5-4afc-be06-b775761aa81d\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"DGcrUyHe4e+NjKpJqVBRrGGglBPj6pxxom/nZvzV7PkCs+joy1NEPBXb9gASp7TrwlIeVYpJCxRayJGNVMss0q2TqFCOJWHdoTQAls6ILVO6lAomcRaESeFe2HVGfyDwrt4g44gKffQ2jFHRt2dR\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.428Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0f358857-7ac5-4afc-be06-b775761aa81d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0f358857-7ac5-4afc-be06-b775761aa81d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A0b5edc00-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A0b5edc00-d58a-11e9-89c1-cdf4a702537a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:20:48.448Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A0b5edc00-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A0b5edc00-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aca984745-a527-49c2-b673-d096e3ebea54?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aca984745-a527-49c2-b673-d096e3ebea54\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.486Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aca984745-a527-49c2-b673-d096e3ebea54?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aca984745-a527-49c2-b673-d096e3ebea54?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A82862a2f-43bd-4a4f-87d7-cb41ba84cc1c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A82862a2f-43bd-4a4f-87d7-cb41ba84cc1c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.486Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A82862a2f-43bd-4a4f-87d7-cb41ba84cc1c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A82862a2f-43bd-4a4f-87d7-cb41ba84cc1c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d556656-152a-4f62-ab8c-0e9b2f7e89f7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1d556656-152a-4f62-ab8c-0e9b2f7e89f7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.546Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d556656-152a-4f62-ab8c-0e9b2f7e89f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d556656-152a-4f62-ab8c-0e9b2f7e89f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa47c1607-b16f-40ed-93c1-05cfe5d8483f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa47c1607-b16f-40ed-93c1-05cfe5d8483f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.547Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa47c1607-b16f-40ed-93c1-05cfe5d8483f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa47c1607-b16f-40ed-93c1-05cfe5d8483f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A01f09e3c-825f-4bdf-b4c2-15d646878a07?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A01f09e3c-825f-4bdf-b4c2-15d646878a07\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.599Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A01f09e3c-825f-4bdf-b4c2-15d646878a07?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A01f09e3c-825f-4bdf-b4c2-15d646878a07?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d7c4564-a9b8-4d7b-b93e-82233eeec631?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1d7c4564-a9b8-4d7b-b93e-82233eeec631\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.599Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d7c4564-a9b8-4d7b-b93e-82233eeec631?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1d7c4564-a9b8-4d7b-b93e-82233eeec631?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f1ca5eb-6439-4d5b-9212-a1e2b9e69717?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1f1ca5eb-6439-4d5b-9212-a1e2b9e69717\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"thpOvpg4gq5kAluJBpxjO1xDWECS8GvzDGGm88tmqfiKQKlzD83GPbdaJ62KDQ16bQSBAXQtohLcfchCihfTECwkrIhSf1TcsIWhtT87gtv6+yPXqQhsRItPJtkr59QQG48iexniwp/O+t8fgoHe\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.615Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f1ca5eb-6439-4d5b-9212-a1e2b9e69717?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f1ca5eb-6439-4d5b-9212-a1e2b9e69717?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A69d0df02-9e58-4929-a4d8-19d8f8c23155?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A69d0df02-9e58-4929-a4d8-19d8f8c23155\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.657Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A69d0df02-9e58-4929-a4d8-19d8f8c23155?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A69d0df02-9e58-4929-a4d8-19d8f8c23155?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A015195a5-7fff-4cc1-bc91-59a3425bf47a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A015195a5-7fff-4cc1-bc91-59a3425bf47a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.657Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A015195a5-7fff-4cc1-bc91-59a3425bf47a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A015195a5-7fff-4cc1-bc91-59a3425bf47a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d7e15fc-da5b-497d-89b5-ae4108ab8351?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A2d7e15fc-da5b-497d-89b5-ae4108ab8351\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"Szyup19zIpRW2plz7VHKNI7Sbih0MMoKj5KSAvuIwV6q5M12beQOlFreNGOAvHx5Er0wWhh1zCOPiyIlsowmArU+0Q7e8gdB3SLkAlvoODWXC3ZE8ef8WKBCgtOyXpJLG5wHG2Ul9Oy4coYm6pRj\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.688Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d7e15fc-da5b-497d-89b5-ae4108ab8351?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A2d7e15fc-da5b-497d-89b5-ae4108ab8351?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A98c0f3ea-f446-4e92-92c5-e64d490a5dc0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A98c0f3ea-f446-4e92-92c5-e64d490a5dc0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:20:48.704Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A98c0f3ea-f446-4e92-92c5-e64d490a5dc0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A98c0f3ea-f446-4e92-92c5-e64d490a5dc0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A0b888410-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A0b888410-d58a-11e9-89c1-cdf4a702537a\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A0b888410-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A0b888410-d58a-11e9-89c1-cdf4a702537a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Abe80ade0-f066-467d-a4ee-df004372569b?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Abe80ade0-f066-467d-a4ee-df004372569b\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:23:16.500Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"CqrlZaIP0x7Vq+KZDLJh3PV7kM0leUhu2WSnakbEhEO9qHRJWCIxt3086zcQR5/8R8Ja8zikRKDoQbbY8GAdNJnxOoiVVvw4D/Wfq0C69O5EtI5Vl9kh/f9KzzKoQ57YCGSFYS90C6yXonS0u4h4\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.538Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abe80ade0-f066-467d-a4ee-df004372569b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abe80ade0-f066-467d-a4ee-df004372569b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Acd159883-d26e-4cdf-af3d-02d1c81fad41?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Acd159883-d26e-4cdf-af3d-02d1c81fad41\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"KrgRN0nmNX9rKqDi0qSohoDKnz5t0V74rGRABNct7ezMrgmCTDMnLazebX3URRW3SIKEn9XGnCxvSwJHuqzuT9eFWMDefd5c40hT+i/jqGdtTG2ME8vuOAiR/FbK6EHTxPXNmxIAwJMAQ9ghIKWQ\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.635Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Acd159883-d26e-4cdf-af3d-02d1c81fad41?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Acd159883-d26e-4cdf-af3d-02d1c81fad41?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A63b54ce0-d58a-11e9-ad59-75821be16203?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A63b54ce0-d58a-11e9-ad59-75821be16203\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:23:16.653Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A63b54ce0-d58a-11e9-ad59-75821be16203?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A63b54ce0-d58a-11e9-ad59-75821be16203?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A09944b21-6751-4898-b478-c81712298720?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A09944b21-6751-4898-b478-c81712298720\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.695Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A09944b21-6751-4898-b478-c81712298720?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A09944b21-6751-4898-b478-c81712298720?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A96f81622-edae-4b11-87cb-f5649cbe2c62?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A96f81622-edae-4b11-87cb-f5649cbe2c62\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.695Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A96f81622-edae-4b11-87cb-f5649cbe2c62?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A96f81622-edae-4b11-87cb-f5649cbe2c62?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1166738a-f4d8-45be-a7a5-ff0654fb74cd?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1166738a-f4d8-45be-a7a5-ff0654fb74cd\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.763Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1166738a-f4d8-45be-a7a5-ff0654fb74cd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1166738a-f4d8-45be-a7a5-ff0654fb74cd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4994b107-d3fb-4bd7-b818-717a1eba3668?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4994b107-d3fb-4bd7-b818-717a1eba3668\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.763Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4994b107-d3fb-4bd7-b818-717a1eba3668?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4994b107-d3fb-4bd7-b818-717a1eba3668?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9fac88d7-48ef-4e36-b9f1-fd7eac2c515d?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9fac88d7-48ef-4e36-b9f1-fd7eac2c515d\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.830Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9fac88d7-48ef-4e36-b9f1-fd7eac2c515d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9fac88d7-48ef-4e36-b9f1-fd7eac2c515d?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8b20d51-e14f-443f-9751-e59b7e7f3766?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa8b20d51-e14f-443f-9751-e59b7e7f3766\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.831Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8b20d51-e14f-443f-9751-e59b7e7f3766?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8b20d51-e14f-443f-9751-e59b7e7f3766?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A88c3cc84-09e6-4577-91d5-d32b1d111c31?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A88c3cc84-09e6-4577-91d5-d32b1d111c31\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"peTIA5PwymmpiB2eTbHrBTCbKGDm3KZh+Cma1zZj3hqbLVhEpJc5HC1WbZLIb5HmFycq8giHCcClDuNXcVwlHS8oVn5EqSNrr3moIe6F06RkX04oLuCUCKxx0mjLcIVGHF7qVyVBIH+BAufm4u3T\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.853Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A88c3cc84-09e6-4577-91d5-d32b1d111c31?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A88c3cc84-09e6-4577-91d5-d32b1d111c31?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A01735944-f3b4-4122-8ce4-9117b0874ae0?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A01735944-f3b4-4122-8ce4-9117b0874ae0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.894Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A01735944-f3b4-4122-8ce4-9117b0874ae0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A01735944-f3b4-4122-8ce4-9117b0874ae0?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad73ea767-866e-4ac2-9ac8-edc58df0ab55?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ad73ea767-866e-4ac2-9ac8-edc58df0ab55\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.895Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad73ea767-866e-4ac2-9ac8-edc58df0ab55?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad73ea767-866e-4ac2-9ac8-edc58df0ab55?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae6896fe6-392a-4fd6-923b-508d46382b08?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ae6896fe6-392a-4fd6-923b-508d46382b08\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"DW1+tUhPKFM9HF8MWcInb0smdhqDRVcGroxcZ3dV2MUrcMldKwVzoPAFAqwQIj19BThVKEQJ8Yy8k+8YOfBSape6CZla+m8w0gzWWucB+oCcmSlEInpbUr8xE6YNcfNTQvS2pr7PU6cqSmzm9KJh\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.928Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae6896fe6-392a-4fd6-923b-508d46382b08?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ae6896fe6-392a-4fd6-923b-508d46382b08?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b316377-ad2b-4c9f-a940-c28025b62953?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A3b316377-ad2b-4c9f-a940-c28025b62953\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:23:16.945Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b316377-ad2b-4c9f-a940-c28025b62953?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b316377-ad2b-4c9f-a940-c28025b62953?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A63e47330-d58a-11e9-ad59-75821be16203?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A63e47330-d58a-11e9-ad59-75821be16203\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A63e47330-d58a-11e9-ad59-75821be16203?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A63e47330-d58a-11e9-ad59-75821be16203?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab317ccb3-b5be-4721-a0da-db8a444e676e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab317ccb3-b5be-4721-a0da-db8a444e676e\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:27:44.923Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"I2sbw5TdShG46B3Gh7nM3D/gnm6J3RZyFPrgfjVSWhe2F/mmK/p6iwdaVwBC+rBQAJQj0on36l5lgEMZJbqVB4CjJDEqJJ6zS6seCMUp832vH0N6awtuqlkP8xRyiPGxJWnysmffBH65014L16YR\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:44.963Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab317ccb3-b5be-4721-a0da-db8a444e676e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab317ccb3-b5be-4721-a0da-db8a444e676e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b8982ec-9479-42bf-b038-6ec579abcc5a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A3b8982ec-9479-42bf-b038-6ec579abcc5a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"J1LjId4pur6H5b3qEhmT+jQPDNcMLKNtYOsysmdGGCRzFy7o2Uz7/4aVhtTiHPLGlkmrOhu/vEuaJY1SvbrpdzqXNFMQR81H47YRltY2d7wj5Fpi/oVvR4QeSwllhLac1NMeicXNHtZKhP4Ai3p9\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.042Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b8982ec-9479-42bf-b038-6ec579abcc5a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b8982ec-9479-42bf-b038-6ec579abcc5a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A03b19190-d58b-11e9-9663-edff22e28f1e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A03b19190-d58b-11e9-9663-edff22e28f1e\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:27:45.065Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A03b19190-d58b-11e9-9663-edff22e28f1e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A03b19190-d58b-11e9-9663-edff22e28f1e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A74143e48-6a42-422f-a385-b415f6364a00?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A74143e48-6a42-422f-a385-b415f6364a00\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.116Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A74143e48-6a42-422f-a385-b415f6364a00?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A74143e48-6a42-422f-a385-b415f6364a00?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa3a07888-1490-4d82-86c2-079c2cc96855?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa3a07888-1490-4d82-86c2-079c2cc96855\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.116Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa3a07888-1490-4d82-86c2-079c2cc96855?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa3a07888-1490-4d82-86c2-079c2cc96855?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Af06e2c37-902b-49ad-9413-1877b5e00eb8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Af06e2c37-902b-49ad-9413-1877b5e00eb8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.169Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af06e2c37-902b-49ad-9413-1877b5e00eb8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af06e2c37-902b-49ad-9413-1877b5e00eb8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Abd28527b-8482-4fd8-9891-b11ba86f4fc8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Abd28527b-8482-4fd8-9891-b11ba86f4fc8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.169Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abd28527b-8482-4fd8-9891-b11ba86f4fc8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abd28527b-8482-4fd8-9891-b11ba86f4fc8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A56e35604-3390-4822-b485-f86fef7c156f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A56e35604-3390-4822-b485-f86fef7c156f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.238Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A56e35604-3390-4822-b485-f86fef7c156f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A56e35604-3390-4822-b485-f86fef7c156f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4be73024-edd1-4620-a052-97764b9133ee?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4be73024-edd1-4620-a052-97764b9133ee\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.238Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4be73024-edd1-4620-a052-97764b9133ee?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4be73024-edd1-4620-a052-97764b9133ee?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A19c8d579-fc44-471d-a762-93d462ddf4e4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A19c8d579-fc44-471d-a762-93d462ddf4e4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"fEsvglYh0O7mfWo9fVGYkWOkX+cuI74HBFPthHQyyBtieiTW9i8Dp0sTrDZdp3e8i4MYZNegTAOaU/sju8YOcPd14/qTV4lKdT3An1/NgH265hv16kLwDinDqS6Zm9VclxXzDXDrR5S2bPdZr3S4\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.258Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A19c8d579-fc44-471d-a762-93d462ddf4e4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A19c8d579-fc44-471d-a762-93d462ddf4e4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A902288d0-9639-450e-a845-c67645ac5840?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A902288d0-9639-450e-a845-c67645ac5840\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.299Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A902288d0-9639-450e-a845-c67645ac5840?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A902288d0-9639-450e-a845-c67645ac5840?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f05995c-858a-4fb7-8c47-2293b1466e07?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7f05995c-858a-4fb7-8c47-2293b1466e07\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.299Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f05995c-858a-4fb7-8c47-2293b1466e07?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f05995c-858a-4fb7-8c47-2293b1466e07?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A72c95e6f-8968-47ea-bfff-c1b8cf0d09f7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A72c95e6f-8968-47ea-bfff-c1b8cf0d09f7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"BTsOc1Ao6lrLU22gsxHJYp57huVMpUbVz/DnKAVU7krUihEIsytNmqjQHdZJLt6GlBY9USqiI/rECg68AunnLly6eW3jI7RdUTP9LJlEopfLfQOoiCv00497giTPTbSkw30y6IG6NpHBuo5BfYLW\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.412Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A72c95e6f-8968-47ea-bfff-c1b8cf0d09f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A72c95e6f-8968-47ea-bfff-c1b8cf0d09f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab3817785-0ae7-4154-8252-d66d34bb1344?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab3817785-0ae7-4154-8252-d66d34bb1344\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:27:45.488Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab3817785-0ae7-4154-8252-d66d34bb1344?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab3817785-0ae7-4154-8252-d66d34bb1344?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A03f9be20-d58b-11e9-9663-edff22e28f1e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A03f9be20-d58b-11e9-9663-edff22e28f1e\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A03f9be20-d58b-11e9-9663-edff22e28f1e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A03f9be20-d58b-11e9-9663-edff22e28f1e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A222b627b-81ae-4ffa-bffa-69dd07f0a78c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A222b627b-81ae-4ffa-bffa-69dd07f0a78c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:28:46.467Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"80INfapjn4J0YPsaeUu04fJ5oZvcPb3UeNbW8Qg7vEKK2hGpQqkeTJRD1cunIXHh3k/tEinIJ1BVsTbPTlV2g1RQXXb75Vr2iQW62lMKX2WVHhi2IOtfCIbWZpSxZZsehC3Cig+KwXjfJo2/iah7\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.509Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A222b627b-81ae-4ffa-bffa-69dd07f0a78c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A222b627b-81ae-4ffa-bffa-69dd07f0a78c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A08887e9d-6549-4d43-92bc-05e222284284?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A08887e9d-6549-4d43-92bc-05e222284284\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"+FY8oh7foJx/z8+PDhtWiJFGL0ecSx8DV4JxUiSM8DoVHlEnqfCxzBld3F811H82zhb6RWffqM6nACGt18j6Z70bBhnNFhT1QISmSD8/QIV8Tb9CQOBi/Pc2JTOteDtDoqF/7VIFLFw1duR0CkIT\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.584Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A08887e9d-6549-4d43-92bc-05e222284284?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A08887e9d-6549-4d43-92bc-05e222284284?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A286021f0-d58b-11e9-a2fa-99199347c512?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A286021f0-d58b-11e9-a2fa-99199347c512\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:28:46.607Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A286021f0-d58b-11e9-a2fa-99199347c512?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A286021f0-d58b-11e9-a2fa-99199347c512?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0850c148-99ab-44e9-a8dd-dc42e6817ceb?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0850c148-99ab-44e9-a8dd-dc42e6817ceb\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.656Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0850c148-99ab-44e9-a8dd-dc42e6817ceb?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0850c148-99ab-44e9-a8dd-dc42e6817ceb?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A80e1f0ba-35aa-43c4-9af7-117a4272cc5f?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A80e1f0ba-35aa-43c4-9af7-117a4272cc5f\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.656Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A80e1f0ba-35aa-43c4-9af7-117a4272cc5f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A80e1f0ba-35aa-43c4-9af7-117a4272cc5f?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9aad8528-a1e0-49cb-9d66-2091e2faf297?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9aad8528-a1e0-49cb-9d66-2091e2faf297\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.712Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9aad8528-a1e0-49cb-9d66-2091e2faf297?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9aad8528-a1e0-49cb-9d66-2091e2faf297?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Afcc8dae0-df88-4eed-b5ab-0084a08ce4f7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Afcc8dae0-df88-4eed-b5ab-0084a08ce4f7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.712Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afcc8dae0-df88-4eed-b5ab-0084a08ce4f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Afcc8dae0-df88-4eed-b5ab-0084a08ce4f7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d72c35-dd3d-4e7f-a1a5-8ed8f3785223?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Af7d72c35-dd3d-4e7f-a1a5-8ed8f3785223\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.775Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d72c35-dd3d-4e7f-a1a5-8ed8f3785223?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d72c35-dd3d-4e7f-a1a5-8ed8f3785223?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A95917ced-ea23-4119-9af7-081189aa60b6?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A95917ced-ea23-4119-9af7-081189aa60b6\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.775Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A95917ced-ea23-4119-9af7-081189aa60b6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A95917ced-ea23-4119-9af7-081189aa60b6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d7294c-f2f5-4a56-94d6-3cf16061766a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Af7d7294c-f2f5-4a56-94d6-3cf16061766a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"cEbg16gbMGiHfvobrm1Ouq5YWnB2Jf0hcOnYRlh3CdLT5ggV0TFyyVBIMW+xj5KszbXXeFTYZdZCLSoFsHLtOf9OT88tvcwNlWUuPHIBH1ax3ojKzS5KyWijoCSybqWdjsrNrHjzFWUnlfVM82fU\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.777Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d7294c-f2f5-4a56-94d6-3cf16061766a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Af7d7294c-f2f5-4a56-94d6-3cf16061766a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1833cff1-c8aa-44c3-8e42-2e8439c24493?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1833cff1-c8aa-44c3-8e42-2e8439c24493\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.833Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1833cff1-c8aa-44c3-8e42-2e8439c24493?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1833cff1-c8aa-44c3-8e42-2e8439c24493?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4eec6afe-ad1a-48ef-ab89-b7bf28c97836?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4eec6afe-ad1a-48ef-ab89-b7bf28c97836\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.833Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4eec6afe-ad1a-48ef-ab89-b7bf28c97836?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4eec6afe-ad1a-48ef-ab89-b7bf28c97836?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b15fc3e-30fc-4e69-9f8e-a872681ef8ad?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A3b15fc3e-30fc-4e69-9f8e-a872681ef8ad\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"iScIyli5SCZBFb4aszdGn3szWQ0PGD2drGmp9/YuXaRdTvZXSqhwlRKBjBuVbLBGP0OAUR370guI6aRogWJXY9eqFWixkxLu+Cm8BjDlfHIq6DBzHg9n2SQ75WAIxasaaKXqlVwXhw7ijsm+Tp+U\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.853Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b15fc3e-30fc-4e69-9f8e-a872681ef8ad?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A3b15fc3e-30fc-4e69-9f8e-a872681ef8ad?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1825a78-5453-434e-80aa-13b76b4a3f9a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa1825a78-5453-434e-80aa-13b76b4a3f9a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:28:46.886Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1825a78-5453-434e-80aa-13b76b4a3f9a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa1825a78-5453-434e-80aa-13b76b4a3f9a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A288d7380-d58b-11e9-a2fa-99199347c512?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A288d7380-d58b-11e9-a2fa-99199347c512\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A288d7380-d58b-11e9-a2fa-99199347c512?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A288d7380-d58b-11e9-a2fa-99199347c512?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A03b2b046-e086-4b42-9d5f-58bb67548212?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A03b2b046-e086-4b42-9d5f-58bb67548212\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:30:35.210Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"MSfLovWTZdDshUT2yOPMd5S2O8yYrns1bcIT0KoEjHBZky9UlcAxE4jXFZ0nOcchtuFjVRr3k82q+o+Ske08RDFrbArR95U+h2n4Sv2BAPGmkYcIfp7vNOhfZGzSiQZ3jZuUiiZtzI0vRNfGgOON\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.253Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A03b2b046-e086-4b42-9d5f-58bb67548212?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A03b2b046-e086-4b42-9d5f-58bb67548212?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f964a4e-d1ff-4dfc-b0b1-2b682176d0d4?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7f964a4e-d1ff-4dfc-b0b1-2b682176d0d4\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"hv3R4Xc5hdvhsPTtL+JvFMIlfxiFL0qNMpA9YR6uLBxzSXqVeosVs/au4gmP0z2t9OtHDj9yBjUSghgigCg0b1f6ldxoWLXAhvXRp1WMEVdukTeigwSjxKvSLo2LoJCGqMRGWdt2ahAEMGVtZVtf\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.347Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f964a4e-d1ff-4dfc-b0b1-2b682176d0d4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7f964a4e-d1ff-4dfc-b0b1-2b682176d0d4?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3A693ebb00-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3A693ebb00-d58b-11e9-b7f3-5f5809f67aa3\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:30:35.431Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A693ebb00-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3A693ebb00-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A4ef516c3-81ec-4e52-b104-102d06de0ab3?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A4ef516c3-81ec-4e52-b104-102d06de0ab3\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.565Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4ef516c3-81ec-4e52-b104-102d06de0ab3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A4ef516c3-81ec-4e52-b104-102d06de0ab3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A9e3efb56-cc7e-463a-9ba1-687ebb38a7e9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A9e3efb56-cc7e-463a-9ba1-687ebb38a7e9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.565Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9e3efb56-cc7e-463a-9ba1-687ebb38a7e9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A9e3efb56-cc7e-463a-9ba1-687ebb38a7e9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A20f69e84-8c57-4e46-836d-7bbdf23da58c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A20f69e84-8c57-4e46-836d-7bbdf23da58c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.638Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A20f69e84-8c57-4e46-836d-7bbdf23da58c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A20f69e84-8c57-4e46-836d-7bbdf23da58c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab962197b-8f19-4101-9d94-e3084cf1ef55?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab962197b-8f19-4101-9d94-e3084cf1ef55\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.638Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab962197b-8f19-4101-9d94-e3084cf1ef55?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab962197b-8f19-4101-9d94-e3084cf1ef55?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f2737a1-afa7-4257-8cc3-e8f1e3f1d124?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A1f2737a1-afa7-4257-8cc3-e8f1e3f1d124\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.712Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f2737a1-afa7-4257-8cc3-e8f1e3f1d124?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A1f2737a1-afa7-4257-8cc3-e8f1e3f1d124?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ada54b0ac-c9e4-442d-90a7-e03e6bacb944?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ada54b0ac-c9e4-442d-90a7-e03e6bacb944\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.711Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ada54b0ac-c9e4-442d-90a7-e03e6bacb944?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ada54b0ac-c9e4-442d-90a7-e03e6bacb944?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A04b3d121-2071-4394-a748-500e440a440e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A04b3d121-2071-4394-a748-500e440a440e\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"agoc1jubK6yf+Tf7ZK9iziMIbvJcsYHREYACXsNRrhJYJtwF7PKo9w1+fopSnbV5Mg6IICNs0H+g+4K12CsR69eQuqAQvGRpRqPEf+eVogw7XOgldwROHHbmlYUhe6ulV7ahNp8LDg6St7pLZJ+M\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.771Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A04b3d121-2071-4394-a748-500e440a440e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A04b3d121-2071-4394-a748-500e440a440e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A40e7cd6c-5eea-4a69-969b-fb387904a0fd?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A40e7cd6c-5eea-4a69-969b-fb387904a0fd\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.803Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A40e7cd6c-5eea-4a69-969b-fb387904a0fd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A40e7cd6c-5eea-4a69-969b-fb387904a0fd?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0275095d-7c65-4b5e-860b-d19c2d50eea8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0275095d-7c65-4b5e-860b-d19c2d50eea8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.803Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0275095d-7c65-4b5e-860b-d19c2d50eea8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0275095d-7c65-4b5e-860b-d19c2d50eea8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c5094c4-cf82-425f-8973-ccbc91287409?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A7c5094c4-cf82-425f-8973-ccbc91287409\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"Alm1K5wISxg7ibFW6fTxP5KcebMYK5kdxTayubrRewQRB4B/m7y8gmL7yYLL8MpOD/6PbY2Yyi0aA2VYyotmXof4RqI296yoeOmWHUEdWSL0C/0Gwph7FZhOEskU7nn+HC+SjxuErQRNqftgd76h\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.840Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c5094c4-cf82-425f-8973-ccbc91287409?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A7c5094c4-cf82-425f-8973-ccbc91287409?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A80bdbb9f-a333-4804-b4f4-5e54dc73c083?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A80bdbb9f-a333-4804-b4f4-5e54dc73c083\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:30:35.858Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A80bdbb9f-a333-4804-b4f4-5e54dc73c083?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A80bdbb9f-a333-4804-b4f4-5e54dc73c083?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A69814240-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A69814240-d58b-11e9-b7f3-5f5809f67aa3\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A69814240-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A69814240-d58b-11e9-b7f3-5f5809f67aa3?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A846a5ceb-d57a-40df-91ae-70f415717ad2?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A846a5ceb-d57a-40df-91ae-70f415717ad2\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:39:36.200Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"C9YRxxJfNbApTDisfgC4eeIDWBFnyLbTpCnUSg66aGrtW/X17TRbDYfV7FABxE3ToTj5rcRiNBnA6BvgHlEgHm7Pfi3GGNipHM5BF0tZ3MUy+zrw7TlN3CIg7gXB7moCeKMohtKQxbSag5jFMPqh\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.243Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A846a5ceb-d57a-40df-91ae-70f415717ad2?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A846a5ceb-d57a-40df-91ae-70f415717ad2?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8442384-44d2-4947-be89-513fa46252c9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa8442384-44d2-4947-be89-513fa46252c9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"b70xBxkLPQOwdKIJ3BC8w9WZBlpqct7l2h0nF4T1HD2WJChsD4MMN0FqRTHihDPW1faBya5Z0DsENW4JdDhEi0F6Euhtni3VHuPi8UXo9HFNn6+bppb0sDx49/L0wBbygAn2m8r+7VMsDJgdtW+b\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.331Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8442384-44d2-4947-be89-513fa46252c9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa8442384-44d2-4947-be89-513fa46252c9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_update/tokens%3Aaba7cf30-d58c-11e9-bf5a-e3d093298201?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_update/tokens%3Aaba7cf30-d58c-11e9-bf5a-e3d093298201\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:39:36.354Z\\\",\\\"references\\\":[]}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Aaba7cf30-d58c-11e9-bf5a-e3d093298201?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_update/tokens%3Aaba7cf30-d58c-11e9-bf5a-e3d093298201?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Abde7d3c3-fd2c-4604-b63e-9fc65d3c080b?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Abde7d3c3-fd2c-4604-b63e-9fc65d3c080b\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.397Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abde7d3c3-fd2c-4604-b63e-9fc65d3c080b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Abde7d3c3-fd2c-4604-b63e-9fc65d3c080b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A5b5c14a6-5aa7-4348-a71e-1e799eecc9f9?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A5b5c14a6-5aa7-4348-a71e-1e799eecc9f9\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.397Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5b5c14a6-5aa7-4348-a71e-1e799eecc9f9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A5b5c14a6-5aa7-4348-a71e-1e799eecc9f9?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A93f4312b-1e53-47e6-b9a8-af230eea08b6?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A93f4312b-1e53-47e6-b9a8-af230eea08b6\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.454Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A93f4312b-1e53-47e6-b9a8-af230eea08b6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A93f4312b-1e53-47e6-b9a8-af230eea08b6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9a3e9e0-cbbd-47c6-92de-b1687399d2b7?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ad9a3e9e0-cbbd-47c6-92de-b1687399d2b7\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.454Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9a3e9e0-cbbd-47c6-92de-b1687399d2b7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad9a3e9e0-cbbd-47c6-92de-b1687399d2b7?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A8c10e038-e3c5-464a-9e50-16741fd0cfb8?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A8c10e038-e3c5-464a-9e50-16741fd0cfb8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.517Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8c10e038-e3c5-464a-9e50-16741fd0cfb8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A8c10e038-e3c5-464a-9e50-16741fd0cfb8?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A0a1c26bb-a41d-4261-853c-484e4ffe9568?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A0a1c26bb-a41d-4261-853c-484e4ffe9568\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.517Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0a1c26bb-a41d-4261-853c-484e4ffe9568?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A0a1c26bb-a41d-4261-853c-484e4ffe9568?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa919e6f4-9e79-4181-a1f2-7cf55c15d94a?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Aa919e6f4-9e79-4181-a1f2-7cf55c15d94a\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"78ZiYUW3qvVFLKP86gTMLNrX57qWpvmJevpD4Ws/0DBV5ONvD0TLuLqFiFBt9bnTgH/E4ca85IR0+7KswwGjPzChcot31UDuZz4GzFU+TnyVl062JH38+vS/5zyZhdOVz0irLfXyBoimtJON5Z6p\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.553Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa919e6f4-9e79-4181-a1f2-7cf55c15d94a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Aa919e6f4-9e79-4181-a1f2-7cf55c15d94a?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab24d9e6a-5300-402d-a893-b90bf9b2d363?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ab24d9e6a-5300-402d-a893-b90bf9b2d363\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.584Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab24d9e6a-5300-402d-a893-b90bf9b2d363?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ab24d9e6a-5300-402d-a893-b90bf9b2d363?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A47de7c43-06b7-47a1-8e46-f1a1ff1edc5e?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A47de7c43-06b7-47a1-8e46-f1a1ff1edc5e\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"ZDOd1fs6uJ0+ujJ1/YFc40Ol9/vkZmXF+SEGJVPf+kCZtTg7x89FFmAu1VWxYyuGn9O4fuXq+QimhtFCm1iUDDr74DErLrOf8LtWtCiuOUFqswuQFwy6orpVqxBFMaB1V3Szr94W+dHnhuklTi7y\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.603Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A47de7c43-06b7-47a1-8e46-f1a1ff1edc5e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A47de7c43-06b7-47a1-8e46-f1a1ff1edc5e?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3A698535f5-4ec7-46b3-bd9e-961c3699786c?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3A698535f5-4ec7-46b3-bd9e-961c3699786c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.584Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A698535f5-4ec7-46b3-bd9e-961c3699786c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3A698535f5-4ec7-46b3-bd9e-961c3699786c?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad22f3db9-2ea6-4aa0-a391-f0dfbbe1641b?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_create/tokens%3Ad22f3db9-2ea6-4aa0-a391-f0dfbbe1641b\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:39:36.637Z\\\"}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad22f3db9-2ea6-4aa0-a391-f0dfbbe1641b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_create/tokens%3Ad22f3db9-2ea6-4aa0-a391-f0dfbbe1641b?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aabd547d0-d58c-11e9-bf5a-e3d093298201?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3Aabd547d0-d58c-11e9-bf5a-e3d093298201\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aabd547d0-d58c-11e9-bf5a-e3d093298201?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3Aabd547d0-d58c-11e9-bf5a-e3d093298201?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=1000&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A8093f0c6-96b8-4e67-8283-d77c242496b0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"created_at\\\":\\\"2019-09-12T18:40:52.661Z\\\",\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"Tp/Wq/JrprtmGpoZyJYmCSwNBtTs8ACL+SzDShBAgMJEqS5uUfZUoc1SiB6zmplyX0Lz593pAoBzUjNaQGbjh9GI97Wx83Vln479JrLUWuAZIiTxFxZYMMdQjynsGZlRJFL/Jaxc0vHeUAxxUuTn\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"active\\\":true},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:52.701Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3Aba05c9a1-a7ec-474a-ba15-68ad7b104bf8\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policyId\\\",\\\"policy_shared_id\\\":\\\"sharedId\\\",\\\"token\\\":\\\"uquluB2sXidqFC9pfZfYjyaPNwwGj9ov1EXFaLeA48LgI+d93tMRMPp855Qja8LHG06HNyPi3rO7psYRyj9kpvAZeCxTcw+SlDcLMZMou+YeNTCxhJ/0Sm0V1GUILE3QNg5Nyr+isRO1QAQdxQ47\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:52.905Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - get:tokens:undefined:{"active":false}:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/update] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_update/tokens%3Ad94b9de0-d58c-11e9-8824-fbd6cf9ce0ef\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"doc\\\":{\\\"tokens\\\":{\\\"active\\\":false},\\\"updated_at\\\":\\\"2019-09-12T18:40:52.925Z\\\",\\\"references\\\":[]}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/update] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/update] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3Aed3ffbb8-18f9-45ca-8013-e7c01eb15f25\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:52.968Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A56b87598-0366-47f4-b19a-d49d8b916ec0\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:52.968Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"azerty\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A1ff28ab3-c404-4019-ae1a-2f3465fc4598\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.027Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A4c56d736-1946-42d1-a406-f3f3166b47be\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.026Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"idonotexists\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A009fcf20-59d8-433f-a92f-8c2758b65ce5\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.091Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3Ae075ae89-0db4-4b31-9393-c001cd610295\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.091Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy12\\\",\\\"fields\\\":[\\\"tokens.policy_id\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A8dc97775-287a-4966-ab2c-fda99ab2a016\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"Gow8vffCD+qXpSWHonCJGwGckNmojO5yN7RRp7J62nazSlhQlRDtXIfL0Vb/UH55UwX36KxYyJJCV8JIBBj07B29kkTPlrBLqjKUaCxzVyCrmrBd4BNCuemx/gpkCGEXk8nLfs4fJiLbgtiu23i8\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.112Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A86977ad4-800d-4ae8-a9e8-cd9fe4e6e18c\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\",\\\"policy_id\\\":\\\"policy1\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.155Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3Aa6b535f2-d82f-4170-85ee-092433a0caf2\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy123\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.155Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}],\\\"must\\\":[{\\\"simple_query_string\\\":{\\\"query\\\":\\\"policy1234\\\",\\\"fields\\\":[\\\"tokens.tokenHash\\\"],\\\"default_operator\\\":\\\"OR\\\"}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3A3635bee2-98b2-49a9-b871-9e93c16d4adf\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"token\\\":\\\"YznKCx0ZZRlhhwCWOc9v8w54YMoIsBBrEzbndo0LFygsmwFk49z/MTuvDR5KyJLju/mNf7tF9dSemVlhNJ0l9uije/WMMn/UDL0ffN25So/lzYnciKG1oTSPhoEOjcD6/Pj2XTuoNAtfrQKjN2rQ\\\",\\\"tokenHash\\\":\\\"azerty\\\",\\\"policy_id\\\":\\\"policy12\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.178Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_create/tokens%3Ae3e8e480-d0f0-4aeb-8f54-427faf521ebe\",\"query\":{\"refresh\":\"wait_for\"},\"body\":\"{\\\"tokens\\\":{\\\"active\\\":true,\\\"type\\\":\\\"ACCESS_TOKEN\\\",\\\"tokenHash\\\":\\\"qwerty\\\"},\\\"type\\\":\\\"tokens\\\",\\\"updated_at\\\":\\\"2019-09-12T18:40:53.223Z\\\"}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_doc/tokens%3Ad97b8780-d58c-11e9-8824-fbd6cf9ce0ef\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/write/bulk[s]] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] action [indices:data/read/search] is unauthorized for user [kibana]\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":1000,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":403,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"action [indices:data/read/search] is unauthorized for user [kibana]\\\"},\\\"status\\\":403}\"}",
  "results": null
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1cb2267b-b523-45fd-8cd0-196a8593aeef",
    "attributes": {
      "created_at": "2019-09-12T18:42:12.456Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:12.490Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:1cb2267b-b523-45fd-8cd0-196a8593aeef:{} (2)'] = {
  "results": {
    "id": "1cb2267b-b523-45fd-8cd0-196a8593aeef",
    "type": "tokens",
    "updated_at": "2019-09-12T18:42:12.490Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T18:42:12.456Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1cb2267b-b523-45fd-8cd0-196a8593aeef",
        "attributes": {
          "created_at": "2019-09-12T18:42:12.456Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:12.490Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:1cb2267b-b523-45fd-8cd0-196a8593aeef:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "aa99a010-97ad-4dec-aa96-b6d149aafe7a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:14.089Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:aa99a010-97ad-4dec-aa96-b6d149aafe7a:{"active":false}:{} (2)'] = {
  "results": {
    "id": "aa99a010-97ad-4dec-aa96-b6d149aafe7a",
    "type": "tokens",
    "updated_at": "2019-09-12T18:42:15.097Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:aa99a010-97ad-4dec-aa96-b6d149aafe7a:{} (3)'] = {
  "results": {
    "id": "aa99a010-97ad-4dec-aa96-b6d149aafe7a",
    "type": "tokens",
    "updated_at": "2019-09-12T18:42:15.097Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "aa99a010-97ad-4dec-aa96-b6d149aafe7a",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:15.097Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:aa99a010-97ad-4dec-aa96-b6d149aafe7a:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6cb77018-f123-43bb-9250-53f0bf5a9a7f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:17.140Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8b0747e3-17d9-432e-ade5-1c1106367e1a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:17.140Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "8b0747e3-17d9-432e-ade5-1c1106367e1a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:17.140Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:8b0747e3-17d9-432e-ade5-1c1106367e1a (4)'] = {
  "results": {
    "id": "8b0747e3-17d9-432e-ade5-1c1106367e1a",
    "type": "tokens",
    "updated_at": "2019-09-12T18:42:17.140Z",
    "version": "WzYsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6cb77018-f123-43bb-9250-53f0bf5a9a7f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:17.140Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "8b0747e3-17d9-432e-ade5-1c1106367e1a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:17.140Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:6cb77018-f123-43bb-9250-53f0bf5a9a7f:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:8b0747e3-17d9-432e-ade5-1c1106367e1a:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8b8fd2db-20b6-493f-a103-035fd359a47e",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:20.206Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "e55a9a9c-6726-4a13-b86e-09fa748308d4",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:20.206Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e55a9a9c-6726-4a13-b86e-09fa748308d4",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:20.206Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "8b8fd2db-20b6-493f-a103-035fd359a47e",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:20.206Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:e55a9a9c-6726-4a13-b86e-09fa748308d4:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:8b8fd2db-20b6-493f-a103-035fd359a47e:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "2bbd5afa-102f-4be0-9db7-671da36e6324",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:23.291Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "6fc0aeb2-ab60-44ac-a25f-7333731c25da",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:23.291Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "82b44986-0b46-49e7-b2db-83a9c2801ba7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:23.299Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "82b44986-0b46-49e7-b2db-83a9c2801ba7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:23.299Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:82b44986-0b46-49e7-b2db-83a9c2801ba7 (5)'] = {
  "results": {
    "id": "82b44986-0b46-49e7-b2db-83a9c2801ba7",
    "type": "tokens",
    "updated_at": "2019-09-12T18:42:23.299Z",
    "version": "WzE1LDFd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": []
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "6fc0aeb2-ab60-44ac-a25f-7333731c25da",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:23.291Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "82b44986-0b46-49e7-b2db-83a9c2801ba7",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:23.299Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "2bbd5afa-102f-4be0-9db7-671da36e6324",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:23.291Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:6fc0aeb2-ab60-44ac-a25f-7333731c25da:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:82b44986-0b46-49e7-b2db-83a9c2801ba7:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:2bbd5afa-102f-4be0-9db7-671da36e6324:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "5026c5f0-8c1a-4a3c-990b-dc9a0d2da138",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:27.552Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "6a236a1e-4396-426a-91de-6236f6437c88",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:27.552Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "87a40d46-b09a-48d5-a9b0-eb88dd5f276d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:27.559Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "5026c5f0-8c1a-4a3c-990b-dc9a0d2da138",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:27.552Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "6a236a1e-4396-426a-91de-6236f6437c88",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:27.552Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "87a40d46-b09a-48d5-a9b0-eb88dd5f276d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:42:27.559Z",
        "version": "WzIxLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:5026c5f0-8c1a-4a3c-990b-dc9a0d2da138:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:6a236a1e-4396-426a-91de-6236f6437c88:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:87a40d46-b09a-48d5-a9b0-eb88dd5f276d:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "953491de-dbdc-47e9-a6ee-67301a12ebd6",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:42:31.695Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:953491de-dbdc-47e9-a6ee-67301a12ebd6:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:953491de-dbdc-47e9-a6ee-67301a12ebd6:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1b732a41-27f9-4944-afa4-a64d1e75ff14",
    "attributes": {
      "created_at": "2019-09-12T18:45:16.739Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:16.789Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:1b732a41-27f9-4944-afa4-a64d1e75ff14:{} (2)'] = {
  "results": {
    "id": "1b732a41-27f9-4944-afa4-a64d1e75ff14",
    "type": "tokens",
    "updated_at": "2019-09-12T18:45:16.789Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-12T18:45:16.739Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1b732a41-27f9-4944-afa4-a64d1e75ff14",
        "attributes": {
          "created_at": "2019-09-12T18:45:16.739Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:16.789Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:1b732a41-27f9-4944-afa4-a64d1e75ff14:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e50c6c42-e121-47e5-8560-8eeff6d67524",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:18.260Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e50c6c42-e121-47e5-8560-8eeff6d67524:{"active":false,"token":"notencryptedtoken"}:{} (2)'] = {
  "results": {
    "id": "e50c6c42-e121-47e5-8560-8eeff6d67524",
    "type": "tokens",
    "updated_at": "2019-09-12T18:45:19.289Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:e50c6c42-e121-47e5-8560-8eeff6d67524:{} (3)'] = {
  "results": {
    "id": "e50c6c42-e121-47e5-8560-8eeff6d67524",
    "type": "tokens",
    "updated_at": "2019-09-12T18:45:19.289Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e50c6c42-e121-47e5-8560-8eeff6d67524",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:19.289Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:e50c6c42-e121-47e5-8560-8eeff6d67524:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ecc7a0a3-8642-486d-8c3c-4bf8409a80aa",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:21.338Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:21.338Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:21.338Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641 (4)'] = {
  "results": {
    "id": "60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641",
    "type": "tokens",
    "updated_at": "2019-09-12T18:45:21.338Z",
    "version": "WzYsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ecc7a0a3-8642-486d-8c3c-4bf8409a80aa",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:21.338Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:21.338Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:ecc7a0a3-8642-486d-8c3c-4bf8409a80aa:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:60693b28-f4cd-4d9e-bc3f-a3ccc6aa7641:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "d4d5903a-b623-4e6c-a5f8-04a78dc7c507",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:24.391Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "b49b6397-bee8-4876-8b15-02495117e97b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:24.391Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "d4d5903a-b623-4e6c-a5f8-04a78dc7c507",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:24.391Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "b49b6397-bee8-4876-8b15-02495117e97b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:24.391Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:d4d5903a-b623-4e6c-a5f8-04a78dc7c507:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:b49b6397-bee8-4876-8b15-02495117e97b:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "14e4510f-0ed3-48c2-8a92-9018c5a01ecb",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:27.545Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "6c40da62-cad3-4c69-911f-6089eb80754c",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:27.545Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "481cc72a-716a-43b0-8707-30982bf603dd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:27.553Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "481cc72a-716a-43b0-8707-30982bf603dd",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:27.553Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:481cc72a-716a-43b0-8707-30982bf603dd (5)'] = {
  "results": {
    "id": "481cc72a-716a-43b0-8707-30982bf603dd",
    "type": "tokens",
    "updated_at": "2019-09-12T18:45:27.553Z",
    "version": "WzE1LDFd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": []
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "14e4510f-0ed3-48c2-8a92-9018c5a01ecb",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:27.545Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "6c40da62-cad3-4c69-911f-6089eb80754c",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:27.545Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "481cc72a-716a-43b0-8707-30982bf603dd",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:27.553Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:14e4510f-0ed3-48c2-8a92-9018c5a01ecb:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:6c40da62-cad3-4c69-911f-6089eb80754c:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:481cc72a-716a-43b0-8707-30982bf603dd:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "c056dcdc-9528-4492-941a-da2ed992fe05",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:31.613Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "1d7efc1b-7de4-4b4c-9945-a219c2eaf598",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:31.613Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ea987894-2a2f-4658-a64a-4277204ac653",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:31.621Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1d7efc1b-7de4-4b4c-9945-a219c2eaf598",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:31.613Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "ea987894-2a2f-4658-a64a-4277204ac653",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:31.621Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "c056dcdc-9528-4492-941a-da2ed992fe05",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-12T18:45:31.613Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:1d7efc1b-7de4-4b4c-9945-a219c2eaf598:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:ea987894-2a2f-4658-a64a-4277204ac653:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:c056dcdc-9528-4492-941a-da2ed992fe05:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ac4f031c-b2f2-4631-a744-8bcfbed591d7",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-12T18:45:35.706Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:ac4f031c-b2f2-4631-a744-8bcfbed591d7:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:ac4f031c-b2f2-4631-a744-8bcfbed591d7:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "ab328691-100b-4ac2-b4d2-3a12a0e4e23a",
    "attributes": {
      "created_at": "2019-09-16T14:56:26.949Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:26.988Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:ab328691-100b-4ac2-b4d2-3a12a0e4e23a:{} (2)'] = {
  "results": {
    "id": "ab328691-100b-4ac2-b4d2-3a12a0e4e23a",
    "type": "tokens",
    "updated_at": "2019-09-16T14:56:26.988Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-16T14:56:26.949Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ab328691-100b-4ac2-b4d2-3a12a0e4e23a",
        "attributes": {
          "created_at": "2019-09-16T14:56:26.949Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:26.988Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:ab328691-100b-4ac2-b4d2-3a12a0e4e23a:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "38a6368e-2cd6-4139-98c2-8541ed1d6741",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:28.477Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:[object Object]:undefined:{} (2)'] = {
  "thrownError": "{\"type\":\"TypeError\",\"message\":\"Cannot convert undefined or null to object\",\"name\":\"TypeError\",\"stack\":\"TypeError: Cannot convert undefined or null to object\\n    at Function.entries (<anonymous>)\\n    at EncryptedSavedObjectsService.entries [as getAAD] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:291:57)\\n    at EncryptedSavedObjectsService.getAAD [as encryptAttributes] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_service.ts:152:32)\\n    at EncryptedSavedObjectsClientWrapper.encryptAttributes [as update] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/encrypted_saved_objects/server/lib/encrypted_saved_objects_client_wrapper.ts:152:36)\\n    at SpacesSavedObjectsClient.update (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/spaces/server/lib/saved_objects_client/spaces_saved_objects_client.ts:209:30)\\n    at SODatabaseAdapter.update (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/saved_objets_database/default.ts:148:42)\\n    at update (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/saved_objets_database/memorize_adapter.ts:145:32)\\n    at Object.memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:57:33)\\n    at MemorizeSODatabaseAdapter.memorize [as update] (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/saved_objets_database/memorize_adapter.ts:139:21)\\n    at TokenAdapter.update (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.ts:93:44)\\n    at Object.update (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/adapters/tokens/default.contract.test.ts:122:21)\\n    at Object.asyncJestTest (/Users/nicolas/Workspace/kibana/node_modules/jest-jasmine2/build/jasmineAsyncInstall.js:102:37)\\n    at resolve (/Users/nicolas/Workspace/kibana/node_modules/jest-jasmine2/build/queueRunner.js:43:12)\\n    at new Promise (<anonymous>)\\n    at mapper (/Users/nicolas/Workspace/kibana/node_modules/jest-jasmine2/build/queueRunner.js:26:19)\\n    at promise.then (/Users/nicolas/Workspace/kibana/node_modules/jest-jasmine2/build/queueRunner.js:73:41)\"}",
  "results": null
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "38a6368e-2cd6-4139-98c2-8541ed1d6741",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:28.477Z",
        "version": "WzIsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:38a6368e-2cd6-4139-98c2-8541ed1d6741:{} (4)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "191da98b-62f1-4a73-85a4-dea95e7b8ffd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:30.516Z",
    "version": "WzQsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "dc94b106-ec59-4500-9445-f2563a8bacce",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:30.516Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"]} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "191da98b-62f1-4a73-85a4-dea95e7b8ffd",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:30.516Z",
        "version": "WzQsMV0="
      },
      {
        "type": "tokens",
        "id": "dc94b106-ec59-4500-9445-f2563a8bacce",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:30.516Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:191da98b-62f1-4a73-85a4-dea95e7b8ffd:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:dc94b106-ec59-4500-9445-f2563a8bacce:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "ced37b4a-6f8d-4c25-8328-650b4930ce7b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:33.571Z",
    "version": "WzgsMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "dc6aec48-bac0-4e10-8d88-bc46175ffe87",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:33.571Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"]} (3)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ced37b4a-6f8d-4c25-8328-650b4930ce7b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:33.571Z",
        "version": "WzgsMV0="
      },
      {
        "type": "tokens",
        "id": "dc6aec48-bac0-4e10-8d88-bc46175ffe87",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:33.571Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:ced37b4a-6f8d-4c25-8328-650b4930ce7b:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:dc6aec48-bac0-4e10-8d88-bc46175ffe87:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "f1436936-e3b6-498c-a8f9-b340c9bdb177",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:36.649Z",
    "version": "WzEyLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "ced83b0f-1383-4f75-bb03-ea13e04979c9",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:36.649Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "8603b6d9-efb8-41a2-a6e9-5ce0f4806044",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:36.655Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"]} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "ced83b0f-1383-4f75-bb03-ea13e04979c9",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:36.649Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "8603b6d9-efb8-41a2-a6e9-5ce0f4806044",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:36.655Z",
        "version": "WzE0LDFd"
      },
      {
        "type": "tokens",
        "id": "f1436936-e3b6-498c-a8f9-b340c9bdb177",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:36.649Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:ced83b0f-1383-4f75-bb03-ea13e04979c9:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:8603b6d9-efb8-41a2-a6e9-5ce0f4806044:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:f1436936-e3b6-498c-a8f9-b340c9bdb177:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "e765b1be-bd09-4c3c-8050-63e5185bc943",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:40.821Z",
    "version": "WzE4LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "3ce5389f-d287-4c6f-9c1f-073441360731",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:40.821Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "5d1f338d-ff71-43bc-ad78-ae61306d1f3d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:40.828Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"]} (4)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_search\",\"query\":{\"size\":20,\"from\":0,\"rest_total_hits_as_int\":true},\"body\":\"{\\\"seq_no_primary_term\\\":true,\\\"query\\\":{\\\"bool\\\":{\\\"filter\\\":[{\\\"bool\\\":{\\\"should\\\":[{\\\"bool\\\":{\\\"must\\\":[{\\\"term\\\":{\\\"type\\\":\\\"tokens\\\"}}],\\\"must_not\\\":[{\\\"exists\\\":{\\\"field\\\":\\\"namespace\\\"}}]}}],\\\"minimum_should_match\\\":1}}]}}}\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_search?size=20&from=0&rest_total_hits_as_int=true]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "e765b1be-bd09-4c3c-8050-63e5185bc943",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:40.821Z",
        "version": "WzE4LDFd"
      },
      {
        "type": "tokens",
        "id": "3ce5389f-d287-4c6f-9c1f-073441360731",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:40.821Z",
        "version": "WzE5LDFd"
      },
      {
        "type": "tokens",
        "id": "5d1f338d-ff71-43bc-ad78-ae61306d1f3d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:40.828Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:e765b1be-bd09-4c3c-8050-63e5185bc943:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:3ce5389f-d287-4c6f-9c1f-073441360731:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:5d1f338d-ff71-43bc-ad78-ae61306d1f3d:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "aaf37935-867e-4065-a08b-c7d84a5df778",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T14:56:45.027Z",
    "version": "WzI0LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:undefined:{} (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/.fleet/_doc/tokens%3A33fa3050-d892-11e9-b2c9-e3720f1d17e6?refresh=wait_for], with { header={ WWW-Authenticate=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } }\",\"path\":\"/.fleet/_doc/tokens%3A33fa3050-d892-11e9-b2c9-e3720f1d17e6\",\"query\":{\"refresh\":\"wait_for\"},\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A33fa3050-d892-11e9-b2c9-e3720f1d17e6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/.fleet/_doc/tokens%3A33fa3050-d892-11e9-b2c9-e3720f1d17e6?refresh=wait_for]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "aaf37935-867e-4065-a08b-c7d84a5df778",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-16T14:56:45.027Z",
        "version": "WzI0LDFd"
      }
    ]
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:aaf37935-867e-4065-a08b-c7d84a5df778:{} (4)'] = {
  "results": {}
}

exports['Token Adapter create allow to create a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "822ff3d5-4e69-46bc-b92d-f43cf53d2d39",
    "attributes": {
      "created_at": "2019-09-16T15:14:40.274Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:40.321Z",
    "version": "WzAsMV0="
  }
}

exports['Token Adapter create allow to create a token - get:tokens:822ff3d5-4e69-46bc-b92d-f43cf53d2d39:{} (2)'] = {
  "results": {
    "id": "822ff3d5-4e69-46bc-b92d-f43cf53d2d39",
    "type": "tokens",
    "updated_at": "2019-09-16T15:14:40.321Z",
    "version": "WzAsMV0=",
    "attributes": {
      "created_at": "2019-09-16T15:14:40.274Z",
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId",
      "active": true
    },
    "references": []
  }
}

exports['Token Adapter create allow to create a token - find:{"type":"tokens","perPage":1000} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "822ff3d5-4e69-46bc-b92d-f43cf53d2d39",
        "attributes": {
          "created_at": "2019-09-16T15:14:40.274Z",
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId",
          "active": true
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:40.321Z",
        "version": "WzAsMV0="
      }
    ]
  }
}

exports['Token Adapter create allow to create a token - delete:tokens:822ff3d5-4e69-46bc-b92d-f43cf53d2d39:{} (4)'] = {
  "results": {}
}

exports['Token Adapter update allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "49ac18b9-e8ce-458c-ade7-10db70ce0984",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:41.933Z",
    "version": "WzIsMV0="
  }
}

exports['Token Adapter update allow to update a token - get:tokens:49ac18b9-e8ce-458c-ade7-10db70ce0984:{"active":false,"token":"notencryptedtoken"}:{} (2)'] = {
  "results": {
    "id": "49ac18b9-e8ce-458c-ade7-10db70ce0984",
    "type": "tokens",
    "updated_at": "2019-09-16T15:14:42.969Z",
    "version": "WzMsMV0=",
    "references": [],
    "attributes": {
      "active": false
    }
  }
}

exports['Token Adapter update allow to update a token - get:tokens:49ac18b9-e8ce-458c-ade7-10db70ce0984:{} (3)'] = {
  "results": {
    "id": "49ac18b9-e8ce-458c-ade7-10db70ce0984",
    "type": "tokens",
    "updated_at": "2019-09-16T15:14:42.969Z",
    "version": "WzMsMV0=",
    "attributes": {
      "active": false,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policyId",
      "policy_shared_id": "sharedId"
    },
    "references": []
  }
}

exports['Token Adapter update allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "49ac18b9-e8ce-458c-ade7-10db70ce0984",
        "attributes": {
          "active": false,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policyId",
          "policy_shared_id": "sharedId"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:42.969Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Token Adapter update allow to update a token - delete:tokens:49ac18b9-e8ce-458c-ade7-10db70ce0984:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "720a997a-059f-444b-b0f7-c5ae20a1402a",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:45.030Z",
    "version": "WzUsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "a9e4dc92-ae7e-4ca6-8cb4-5272fe822170",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:45.031Z",
    "version": "WzYsMV0="
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","searchFields":["tokenHash"],"search":"azerty"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "a9e4dc92-ae7e-4ca6-8cb4-5272fe822170",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:45.031Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - getDecryptedAsInternalUser:tokens:a9e4dc92-ae7e-4ca6-8cb4-5272fe822170 (4)'] = {
  "results": {
    "id": "a9e4dc92-ae7e-4ca6-8cb4-5272fe822170",
    "type": "tokens",
    "updated_at": "2019-09-16T15:14:45.031Z",
    "version": "WzYsMV0=",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": []
  }
}

exports['Token Adapter getByTokenHash allow to find a token - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "720a997a-059f-444b-b0f7-c5ae20a1402a",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:45.030Z",
        "version": "WzUsMV0="
      },
      {
        "type": "tokens",
        "id": "a9e4dc92-ae7e-4ca6-8cb4-5272fe822170",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:45.031Z",
        "version": "WzYsMV0="
      }
    ]
  }
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:720a997a-059f-444b-b0f7-c5ae20a1402a:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash allow to find a token - delete:tokens:a9e4dc92-ae7e-4ca6-8cb4-5272fe822170:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "959bef5f-21a3-426b-ae33-600710a15dbd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:48.116Z",
    "version": "WzksMV0="
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "9d02b8d4-8542-42ed-a78a-b168fb6c6332",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:48.116Z",
    "version": "WzEwLDFd"
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"idonotexists"} (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "959bef5f-21a3-426b-ae33-600710a15dbd",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:48.116Z",
        "version": "WzksMV0="
      },
      {
        "type": "tokens",
        "id": "9d02b8d4-8542-42ed-a78a-b168fb6c6332",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:48.116Z",
        "version": "WzEwLDFd"
      }
    ]
  }
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:959bef5f-21a3-426b-ae33-600710a15dbd:{} (5)'] = {
  "results": {}
}

exports['Token Adapter getByTokenHash return null if the token does not exists - delete:tokens:9d02b8d4-8542-42ed-a78a-b168fb6c6332:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "8b34ebc2-6e05-4c84-a0e5-39de39a77423",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:51.204Z",
    "version": "WzE0LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "9638c6db-4a26-49da-9027-5452cd0c9b7d",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:51.204Z",
    "version": "WzEzLDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "35c5f35b-4c31-4c12-8a8c-00790de4d38f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:51.213Z",
    "version": "WzE1LDFd"
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","searchFields":["policy_id"],"search":"policy12"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "35c5f35b-4c31-4c12-8a8c-00790de4d38f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:51.213Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - getDecryptedAsInternalUser:tokens:35c5f35b-4c31-4c12-8a8c-00790de4d38f (5)'] = {
  "results": {
    "id": "35c5f35b-4c31-4c12-8a8c-00790de4d38f",
    "type": "tokens",
    "updated_at": "2019-09-16T15:14:51.213Z",
    "version": "WzE1LDFd",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "token": "notencryptedtoken",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": []
  }
}

exports['Token Adapter getByPolicyId allow to find a token - find:{"type":"tokens","perPage":1000} (6)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "9638c6db-4a26-49da-9027-5452cd0c9b7d",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:51.204Z",
        "version": "WzEzLDFd"
      },
      {
        "type": "tokens",
        "id": "35c5f35b-4c31-4c12-8a8c-00790de4d38f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:51.213Z",
        "version": "WzE1LDFd"
      },
      {
        "type": "tokens",
        "id": "8b34ebc2-6e05-4c84-a0e5-39de39a77423",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:51.204Z",
        "version": "WzE0LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:9638c6db-4a26-49da-9027-5452cd0c9b7d:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:35c5f35b-4c31-4c12-8a8c-00790de4d38f:{} (8)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId allow to find a token - delete:tokens:8b34ebc2-6e05-4c84-a0e5-39de39a77423:{} (9)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (3)'] = {
  "results": {
    "type": "tokens",
    "id": "8ef19c29-ae59-4afc-aead-73e389728920",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy123"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:55.294Z",
    "version": "WzE5LDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "1f3471a9-6f9b-4d2a-82a7-a647c889a45b",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty",
      "policy_id": "policy1"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:55.293Z",
    "version": "WzIwLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - create:tokens (2)'] = {
  "results": {
    "type": "tokens",
    "id": "18295a65-4409-42aa-89fe-243de095313f",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "azerty",
      "policy_id": "policy12"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:55.302Z",
    "version": "WzIxLDFd"
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","searchFields":["tokenHash"],"search":"policy1234"} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - find:{"type":"tokens","perPage":1000} (5)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 3,
    "saved_objects": [
      {
        "type": "tokens",
        "id": "1f3471a9-6f9b-4d2a-82a7-a647c889a45b",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "qwerty",
          "policy_id": "policy1"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:55.293Z",
        "version": "WzIwLDFd"
      },
      {
        "type": "tokens",
        "id": "18295a65-4409-42aa-89fe-243de095313f",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy12"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:55.302Z",
        "version": "WzIxLDFd"
      },
      {
        "type": "tokens",
        "id": "8ef19c29-ae59-4afc-aead-73e389728920",
        "attributes": {
          "active": true,
          "type": "ACCESS_TOKEN",
          "tokenHash": "azerty",
          "policy_id": "policy123"
        },
        "references": [],
        "updated_at": "2019-09-16T15:14:55.294Z",
        "version": "WzE5LDFd"
      }
    ]
  }
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:1f3471a9-6f9b-4d2a-82a7-a647c889a45b:{} (6)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:18295a65-4409-42aa-89fe-243de095313f:{} (7)'] = {
  "results": {}
}

exports['Token Adapter getByPolicyId return null if the token does not exists - delete:tokens:8ef19c29-ae59-4afc-aead-73e389728920:{} (8)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - create:tokens (1)'] = {
  "results": {
    "type": "tokens",
    "id": "db149f3d-8064-421a-8303-f99a6c629aab",
    "attributes": {
      "active": true,
      "type": "ACCESS_TOKEN",
      "tokenHash": "qwerty"
    },
    "references": [],
    "updated_at": "2019-09-16T15:14:59.375Z",
    "version": "WzI1LDFd"
  }
}

exports['Token Adapter delete allow to update a token - delete:tokens:db149f3d-8064-421a-8303-f99a6c629aab:{} (2)'] = {
  "results": {}
}

exports['Token Adapter delete allow to update a token - get:tokens:db149f3d-8064-421a-8303-f99a6c629aab:{} (3)'] = {
  "results": null
}

exports['Token Adapter delete allow to update a token - find:{"type":"tokens","perPage":1000} (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}
