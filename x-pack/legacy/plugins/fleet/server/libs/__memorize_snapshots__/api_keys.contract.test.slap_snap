
exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - createApiKey (2)'] = {
  "results": {
    "id": "MwfYx24BHcAAABHLmCzN",
    "name": "TEST API KEY: eecae6e3-333c-47b0-ad3d-27bfe1f9597e",
    "api_key": "hqjPotvsSfmJx4QljPuPoA"
  }
}

exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - authenticate (3)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyAccessApiKey should not verify invalid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyAccessApiKey should not verify invalid ApiKey - authenticate (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/_security/_authenticate], with { header={ WWW-Authenticate={ 0=\\\"ApiKey\\\" & 1=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } } }\",\"path\":\"/_security/_authenticate\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"ApiKey, Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - createApiKey (2)'] = {
  "results": {
    "id": "NAfYx24BHcAAABHLmizj",
    "name": "TEST API KEY: 5e00e45e-e865-46f7-beb4-1e475fd884e7",
    "api_key": "QV11wsIfRQeQ1gj-_NqBxg"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - create:enrollment_api_keys (3)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "f6ef5088-027a-4198-80b5-228dc712c84c",
    "attributes": {
      "active": true,
      "api_key_id": "NAfYx24BHcAAABHLmizj"
    },
    "references": [],
    "updated_at": "2019-12-02T18:21:32.671Z",
    "version": "WzIsMV0="
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - authenticate (4)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - find:"enrollment_api_keys" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "f6ef5088-027a-4198-80b5-228dc712c84c",
        "attributes": {
          "active": true,
          "api_key_id": "NAfYx24BHcAAABHLmizj",
          "api_key": "uH8vwvTWND7hNnH3603dLVY9GHZisAVx2wKeiZKud6L1x4MRQB68So/EFP4PlAwV5MguQJDs+u/LrzSXVZi54jVtsNdwdT8F+YT+FON3I2uw2/LGlwuqrU13r8b7j02uxL8a7I3E2Nw2nIxdFfds9t9vEg/nshnR3yIFzpUBypM5LHYVk11lXty6ABLgML3Wcm9xmxL/fE2JuQ=="
        },
        "references": [],
        "updated_at": "2019-12-02T18:21:32.671Z",
        "version": "WzIsMV0="
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - getDecryptedAsInternalUser:enrollment_api_keys:f6ef5088-027a-4198-80b5-228dc712c84c (6)'] = {
  "results": {
    "id": "f6ef5088-027a-4198-80b5-228dc712c84c",
    "type": "enrollment_api_keys",
    "updated_at": "2019-12-02T18:21:32.671Z",
    "version": "WzIsMV0=",
    "attributes": {
      "active": true,
      "api_key_id": "NAfYx24BHcAAABHLmizj",
      "api_key": "TkFmWXgyNEJIY0FBQUJITG1pemo6UVYxMXdzSWZSUWVRMWdqLV9OcUJ4Zw=="
    },
    "references": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "f6ef5088-027a-4198-80b5-228dc712c84c",
        "attributes": {
          "active": true,
          "api_key_id": "NAfYx24BHcAAABHLmizj"
        },
        "references": [],
        "updated_at": "2019-12-02T18:21:32.671Z",
        "version": "WzIsMV0="
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - delete (2)'] = {
  "results": {}
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - createApiKey (3)'] = {
  "results": {
    "id": "NQfYx24BHcAAABHLoizJ",
    "name": "TEST API KEY: 926dcc43-476b-4be7-9882-0d3a257a426f",
    "api_key": "QYuBI5gvSDuvnUUpFV7HwQ"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - create:enrollment_api_keys (4)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "50e62ce1-3307-4877-8864-4f7f5623d57b",
    "attributes": {
      "active": false,
      "api_key_id": "NQfYx24BHcAAABHLoizJ"
    },
    "references": [],
    "updated_at": "2019-12-02T18:21:34.699Z",
    "version": "WzQsMV0="
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - authenticate (5)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - find:"enrollment_api_keys" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "50e62ce1-3307-4877-8864-4f7f5623d57b",
        "attributes": {
          "active": false,
          "api_key_id": "NQfYx24BHcAAABHLoizJ",
          "api_key": "+cenCs4Yw1KRNZ1a8xKnD33Mt6BTcDwswZCP5M+0IGTeiruJhxozMv2/Cux6r5oUrqBeDFhOmkNxM9iyB8SxsLV2m/vv8g6VgyCTVQIvPGaRwCDNKoSsCEFtGkG5T45tkbeSsJ1u6syossAl9vmvbTYNUepSLxLBCGEAR1+2LLrHEExnf43Byvaok1qN24/sRgVXxhuwjzSHGQ=="
        },
        "references": [],
        "updated_at": "2019-12-02T18:21:34.699Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - getDecryptedAsInternalUser:enrollment_api_keys:50e62ce1-3307-4877-8864-4f7f5623d57b (7)'] = {
  "results": {
    "id": "50e62ce1-3307-4877-8864-4f7f5623d57b",
    "type": "enrollment_api_keys",
    "updated_at": "2019-12-02T18:21:34.699Z",
    "version": "WzQsMV0=",
    "attributes": {
      "active": false,
      "api_key_id": "NQfYx24BHcAAABHLoizJ",
      "api_key": "TlFmWXgyNEJIY0FBQUJITG9peko6UVl1Qkk1Z3ZTRHV2blVVcEZWN0h3UQ=="
    },
    "references": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "50e62ce1-3307-4877-8864-4f7f5623d57b",
        "attributes": {
          "active": false,
          "api_key_id": "NQfYx24BHcAAABHLoizJ"
        },
        "references": [],
        "updated_at": "2019-12-02T18:21:34.699Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - delete (2)'] = {
  "results": {}
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - createApiKey (3)'] = {
  "results": {
    "id": "NgfYx24BHcAAABHLqiy3",
    "name": "TEST API KEY: 4999e798-9bd6-4f01-8906-d788004bf2e3",
    "api_key": "LRhSoquWQ5qdeIokYOAt5Q"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - authenticate (4)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - find:"enrollment_api_keys" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify invalid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify invalid ApiKey - authenticate (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/_security/_authenticate], with { header={ WWW-Authenticate={ 0=\\\"ApiKey\\\" & 1=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } } }\",\"path\":\"/_security/_authenticate\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"ApiKey, Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - createApiKey (2)'] = {
  "results": {
    "id": "NwfYx24BHcAAABHLrix5",
    "name": "87fdfc0c-71e3-4fa9-afa2-45566940eaa5",
    "api_key": "DusvTWfGTGufWX_sZU4tDA"
  }
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - create:enrollment_api_keys (3)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "c65148fd-772a-483b-a589-54560d5bbb25",
    "attributes": {
      "created_at": "2019-12-02T18:21:37.721Z",
      "api_key_id": "NwfYx24BHcAAABHLrix5",
      "policy_id": "policy1",
      "active": true,
      "enrollment_rules": [],
      "name": "87fdfc0c-71e3-4fa9-afa2-45566940eaa5"
    },
    "references": [],
    "updated_at": "2019-12-02T18:21:37.734Z",
    "version": "WzYsMV0="
  }
}
