
exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - createApiKey (2)'] = {
  "results": {
    "id": "LYGwYW4BRqAA7lA4uxwZ",
    "name": "TEST API KEY: a2d68f4e-d39b-418f-b7c6-5d394e05e793",
    "api_key": "KWweDwVmQYiGXuJaOrcsZw"
  }
}

exports['ApiKeys Lib verifyAccessApiKey should verify a valid api key - authenticate (3)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyAccessApiKey should not verify invalid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyAccessApiKey should not verify invalid ApiKey - authenticate (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/_security/_authenticate], with { header={ WWW-Authenticate={ 0=\\\"ApiKey\\\" & 1=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } } }\",\"path\":\"/_security/_authenticate\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"ApiKey, Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - createApiKey (2)'] = {
  "results": {
    "id": "LoGwYW4BRqAA7lA4vRzu",
    "name": "TEST API KEY: a80931d8-45ab-4470-ad58-aa77b22b0da5",
    "api_key": "KroDUH-EQoGe2Nba2lwIgg"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - create:enrollment_api_keys (3)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "8079d061-ae22-4d38-b833-7ccfa8e6123e",
    "attributes": {
      "active": true,
      "api_key_id": "LoGwYW4BRqAA7lA4vRzu"
    },
    "references": [],
    "updated_at": "2019-11-12T22:16:44.203Z",
    "version": "WzU2LDFd"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - authenticate (4)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - find:"enrollment_api_keys" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "8079d061-ae22-4d38-b833-7ccfa8e6123e",
        "attributes": {
          "active": true,
          "api_key_id": "LoGwYW4BRqAA7lA4vRzu",
          "api_key": "uSHMysdxzn1+tLY/0nLa98gd3GUd0IKPL4mGZD/foQoXqMBds/3fbTuPVQZSLefXJC7VyAejcguA9PHs9Cv5MSWmhQYJ37XowvqlyjJXmj26+en64wS6a3ARnbJW82enVZMQTK4d1gFDs26/dVQTLGOZDjodwUY4ITfHLuomZ8NjJdmYN7bEWgwSBI71yZXmmg5pdgPMcbOB3Q=="
        },
        "references": [],
        "updated_at": "2019-11-12T22:16:44.203Z",
        "version": "WzU2LDFd"
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should verify a valid api key - getDecryptedAsInternalUser:enrollment_api_keys:8079d061-ae22-4d38-b833-7ccfa8e6123e (6)'] = {
  "results": {
    "id": "8079d061-ae22-4d38-b833-7ccfa8e6123e",
    "type": "enrollment_api_keys",
    "updated_at": "2019-11-12T22:16:44.203Z",
    "version": "WzU2LDFd",
    "attributes": {
      "active": true,
      "api_key_id": "LoGwYW4BRqAA7lA4vRzu",
      "api_key": "TG9Hd1lXNEJScUFBN2xBNHZSenU6S3JvRFVILUVRb0dlMk5iYTJsd0lnZw=="
    },
    "references": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "8079d061-ae22-4d38-b833-7ccfa8e6123e",
        "attributes": {
          "active": true,
          "api_key_id": "LoGwYW4BRqAA7lA4vRzu"
        },
        "references": [],
        "updated_at": "2019-11-12T22:16:44.203Z",
        "version": "WzU2LDFd"
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - delete (2)'] = {
  "results": {}
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - createApiKey (3)'] = {
  "results": {
    "id": "L4GwYW4BRqAA7lA4xhxO",
    "name": "TEST API KEY: d0399733-6375-4452-a144-a6c361bf4729",
    "api_key": "yrgengviTC6Kvpuoeo9Aag"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - create:enrollment_api_keys (4)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "da8f4486-f7c2-421d-814e-9d6145a4e554",
    "attributes": {
      "active": false,
      "api_key_id": "L4GwYW4BRqAA7lA4xhxO"
    },
    "references": [],
    "updated_at": "2019-11-12T22:16:46.241Z",
    "version": "WzU4LDFd"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - authenticate (5)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - find:"enrollment_api_keys" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "da8f4486-f7c2-421d-814e-9d6145a4e554",
        "attributes": {
          "active": false,
          "api_key_id": "L4GwYW4BRqAA7lA4xhxO",
          "api_key": "1zSIPopNRW+24TPjMx11TX7pJP3J28xlmYD4V6FYhv4jnJkSfZycEaOj2sUwVF4qPrf680AdPgKyPXK62F3ggZhpu2d6LmQlDtErdSmZn7JVMNzws0QuVGuvZ9U15VUWVq2XXaLgVI77uHNX4YL+Y0BtadX3tvbCsNYu0dBZKBpv7GgVBj0cQiz2ygnLroh0r7QMEtCcvvpooA=="
        },
        "references": [],
        "updated_at": "2019-11-12T22:16:46.241Z",
        "version": "WzU4LDFd"
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive enrollemnt api key - getDecryptedAsInternalUser:enrollment_api_keys:da8f4486-f7c2-421d-814e-9d6145a4e554 (7)'] = {
  "results": {
    "id": "da8f4486-f7c2-421d-814e-9d6145a4e554",
    "type": "enrollment_api_keys",
    "updated_at": "2019-11-12T22:16:46.241Z",
    "version": "WzU4LDFd",
    "attributes": {
      "active": false,
      "api_key_id": "L4GwYW4BRqAA7lA4xhxO",
      "api_key": "TDRHd1lXNEJScUFBN2xBNHhoeE86eXJnZW5ndmlUQzZLdnB1b2VvOUFhZw=="
    },
    "references": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "enrollment_api_keys",
        "id": "da8f4486-f7c2-421d-814e-9d6145a4e554",
        "attributes": {
          "active": false,
          "api_key_id": "L4GwYW4BRqAA7lA4xhxO"
        },
        "references": [],
        "updated_at": "2019-11-12T22:16:46.241Z",
        "version": "WzU4LDFd"
      }
    ]
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - delete (2)'] = {
  "results": {}
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - createApiKey (3)'] = {
  "results": {
    "id": "MIGwYW4BRqAA7lA4zhw6",
    "name": "TEST API KEY: 7aa86980-2436-40d7-a27c-374f89bbd5ef",
    "api_key": "pLD6RAYQQEu7dtUjtJrnYw"
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - authenticate (4)'] = {
  "results": {
    "username": "elastic",
    "roles": [],
    "full_name": null,
    "email": null,
    "metadata": {
      "_reserved": true
    },
    "enabled": true,
    "authentication_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    },
    "lookup_realm": {
      "name": "_es_api_key",
      "type": "_es_api_key"
    }
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify a inactive an enrollemnt api key not persisted - find:"enrollment_api_keys" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify invalid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib verifyEnrollmentApiKey should not verify invalid ApiKey - authenticate (2)'] = {
  "thrownError": "{\"msg\":\"[security_exception] missing authentication credentials for REST request [/_security/_authenticate], with { header={ WWW-Authenticate={ 0=\\\"ApiKey\\\" & 1=\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\" } } }\",\"path\":\"/_security/_authenticate\",\"statusCode\":401,\"response\":\"{\\\"error\\\":{\\\"root_cause\\\":[{\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}}],\\\"type\\\":\\\"security_exception\\\",\\\"reason\\\":\\\"missing authentication credentials for REST request [/_security/_authenticate]\\\",\\\"header\\\":{\\\"WWW-Authenticate\\\":[\\\"ApiKey\\\",\\\"Basic realm=\\\\\\\"security\\\\\\\" charset=\\\\\\\"UTF-8\\\\\\\"\\\"]}},\\\"status\\\":401}\",\"wwwAuthenticateDirective\":\"ApiKey, Basic realm=\\\"security\\\" charset=\\\"UTF-8\\\"\"}",
  "results": null
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - createApiKey (2)'] = {
  "results": {
    "id": "MYGwYW4BRqAA7lA40Ry1",
    "name": "Fleet:EnrollmentApiKey:518531f3-388b-498b-b6c3-31fb97be0abd:policy1",
    "api_key": "4TERXBlWSh2zG7-sP7Chng"
  }
}

exports['ApiKeys Lib generateEnrollmentApiKey should generate a valid ApiKey - create:enrollment_api_keys (3)'] = {
  "results": {
    "type": "enrollment_api_keys",
    "id": "d014427e-f847-477f-ba03-5726bd0139ba",
    "attributes": {
      "created_at": "2019-11-12T22:16:49.260Z",
      "api_key_id": "MYGwYW4BRqAA7lA40Ry1",
      "policy_id": "policy1",
      "active": true,
      "enrollment_rules": [],
      "name": "Fleet:EnrollmentApiKey:518531f3-388b-498b-b6c3-31fb97be0abd:policy1"
    },
    "references": [],
    "updated_at": "2019-11-12T22:16:49.276Z",
    "version": "WzYwLDFd"
  }
}
