
exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "86bd7020-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-13T14:54:43.233Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-13T14:54:43.234Z",
    "version": "WzIyNywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "86bd7020-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:44.297Z",
    "version": "WzIyOCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "86bd7020-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-13T14:54:43.233Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:44.297Z",
        "version": "WzIyOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-13T14:54:46.387Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-13T14:54:46.388Z",
    "version": "WzIzMCwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:47.399Z",
    "version": "WzIzMSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:48.433Z",
    "version": "WzIzMiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-13T14:54:46.387Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:48.433Z",
        "version": "WzIzMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:49.451Z",
    "version": "WzIzMywxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-13T14:54:49.450Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:50.456Z",
    "version": "WzIzNCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "889eb340-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-13T14:54:49.450Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:50.456Z",
        "version": "WzIzNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8c415570-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-13T14:54:52.486Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-13T14:54:52.487Z",
    "version": "WzIzNiwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "8c415570-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:53.498Z",
    "version": "WzIzNywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8c415570-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-13T14:54:52.486Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:53.498Z",
        "version": "WzIzNywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8c415570-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-13T14:54:52.486Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:53.498Z",
        "version": "WzIzNywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "8e132f40-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-13T14:54:55.538Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-13T14:54:55.540Z",
    "version": "WzIzOSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "8e132f40-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:54:56.551Z",
    "version": "WzI0MCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8e132f40-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-13T14:54:55.538Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:54:56.551Z",
        "version": "WzI0MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "8fe2bf20-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:54:58.578Z",
    "version": "WzI0MiwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "91180ad0-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:00.605Z",
    "version": "WzI0NCwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "91180ad0-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:01.614Z",
    "version": "WzI0NSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "91180ad0-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:01.614Z",
    "version": "WzI0NSwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "91180ad0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:01.614Z",
        "version": "WzI0NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "92e74c90-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:03.641Z",
    "version": "WzI0NywxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "93844fe0-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:04.670Z",
    "version": "WzI0OCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "92e74c90-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:03.641Z",
        "version": "WzI0NywxXQ=="
      },
      {
        "type": "agents",
        "id": "93844fe0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:04.670Z",
        "version": "WzI0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "92e74c90-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:03.641Z",
        "version": "WzI0NywxXQ=="
      },
      {
        "type": "agents",
        "id": "93844fe0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:04.670Z",
        "version": "WzI0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "95578940-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:07.732Z",
    "version": "WzI1MSwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "95578940-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:07.732Z",
        "version": "WzI1MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "95578940-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:07.732Z",
        "version": "WzI1MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "96890460-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:09.734Z",
    "version": "WzI1MywxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "96890460-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:09.734Z",
        "version": "WzI1MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "96890460-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:10.747Z",
    "version": "WzI1NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-13T14:55:10.745Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:97bd3ea0-0625-11ea-9674-75a3ee7c8618",
        "type": "agent_events",
        "updated_at": "2019-11-13T14:55:11.754Z",
        "version": "WzI1NSwxXQ==",
        "attributes": {
          "agent_id": "96890460-0625-11ea-9674-75a3ee7c8618",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "97bd3ea0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "agent_id": "96890460-0625-11ea-9674-75a3ee7c8618",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:11.754Z",
        "version": "WzI1NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "96890460-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-13T14:55:10.745Z"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:10.747Z",
        "version": "WzI1NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "98f71e30-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:13.811Z",
    "version": "WzI1NywxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "98f71e30-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:13.811Z",
        "version": "WzI1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "98f71e30-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:14.823Z",
    "version": "WzI1OCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-13T14:55:14.821Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "98f71e30-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:14.823Z",
    "version": "WzI1OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-13T14:55:14.821Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "98f71e30-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-13T14:55:14.821Z"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:14.823Z",
        "version": "WzI1OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "9ac6d520-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:16.850Z",
    "version": "WzI2MCwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9ac6d520-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:16.850Z",
        "version": "WzI2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "9ac6d520-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:17.873Z",
    "version": "WzI2MSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-13T14:55:17.868Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9ac6d520-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-13T14:55:17.868Z"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:17.873Z",
        "version": "WzI2MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "9c979d80-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:19.895Z",
    "version": "WzI2MywxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9c979d80-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:19.895Z",
        "version": "WzI2MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "9c979d80-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:20.906Z",
    "version": "WzI2NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-13T14:55:20.904Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "9c979d80-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:20.906Z",
    "version": "WzI2NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-13T14:55:20.904Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9c979d80-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-13T14:55:20.904Z"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:20.906Z",
        "version": "WzI2NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "9e677b80-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:22.936Z",
    "version": "WzI2NiwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9e677b80-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:22.936Z",
        "version": "WzI2NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "9e677b80-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:23.960Z",
    "version": "WzI2NywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-13T14:55:23.958Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-13T14:55:23.958Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9e677b80-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-13T14:55:23.958Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-13T14:55:23.958Z"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:23.960Z",
        "version": "WzI2NywxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "a0389200-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:25.984Z",
    "version": "WzI2OSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "a0d32450-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:26.997Z",
    "version": "WzI3MCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "a0389200-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:28.012Z",
    "version": "WzI3MSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "a0d32450-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:29.019Z",
    "version": "WzI3MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "a0389200-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:28.012Z",
    "version": "WzI3MSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "a0d32450-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:29.019Z",
    "version": "WzI3MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a0389200-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:28.012Z",
        "version": "WzI3MSwxXQ=="
      },
      {
        "type": "agents",
        "id": "a0d32450-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:29.019Z",
        "version": "WzI3MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "a3d6ee70-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:32.055Z",
    "version": "WzI3NSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "a4743fe0-0625-11ea-9674-75a3ee7c8618",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-13T14:55:33.086Z",
    "version": "WzI3NiwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a3d6ee70-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:32.055Z",
        "version": "WzI3NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "a4743fe0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:33.086Z",
        "version": "WzI3NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "a3d6ee70-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:34.128Z",
    "version": "WzI3NywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "a4743fe0-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:35.103Z",
    "version": "WzI3OCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "a3d6ee70-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:34.128Z",
    "version": "WzI3NywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "a4743fe0-0625-11ea-9674-75a3ee7c8618",
    "type": "agents",
    "updated_at": "2019-11-13T14:55:35.103Z",
    "version": "WzI3OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a3d6ee70-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:34.128Z",
        "version": "WzI3NywxXQ=="
      },
      {
        "type": "agents",
        "id": "a4743fe0-0625-11ea-9674-75a3ee7c8618",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-13T14:55:35.103Z",
        "version": "WzI3OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "14ddc6b0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T18:47:50.680Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T18:47:50.683Z",
    "version": "WzIxMiwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "14ddc6b0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:47:51.476Z",
    "version": "WzIxMywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "14ddc6b0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T18:47:50.680Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:47:51.476Z",
        "version": "WzIxMywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T18:47:53.509Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T18:47:53.512Z",
    "version": "WzIxNSwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:47:54.520Z",
    "version": "WzIxNiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:47:55.539Z",
    "version": "WzIxNywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T18:47:53.509Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:47:55.539Z",
        "version": "WzIxNywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:47:56.562Z",
    "version": "WzIxOCwxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T18:47:56.558Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:47:57.576Z",
    "version": "WzIxOSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "168d7280-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T18:47:56.558Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T18:47:57.576Z",
        "version": "WzIxOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1a323790-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T18:47:59.622Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T18:47:59.625Z",
    "version": "WzIyMSwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "1a323790-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:00.636Z",
    "version": "WzIyMiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1a323790-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T18:47:59.622Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:00.636Z",
        "version": "WzIyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1a323790-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T18:47:59.622Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:00.636Z",
        "version": "WzIyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "1c02d8e0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T18:48:02.668Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:02.670Z",
    "version": "WzIyNCwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "1c02d8e0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:03.687Z",
    "version": "WzIyNSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1c02d8e0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T18:48:02.668Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:03.687Z",
        "version": "WzIyNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "1dd46490-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:05.721Z",
    "version": "WzIyNywxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "1f0cbd80-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:07.768Z",
    "version": "WzIyOSwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "1f0cbd80-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:08.771Z",
    "version": "WzIzMCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "1f0cbd80-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:08.771Z",
    "version": "WzIzMCwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1f0cbd80-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:08.771Z",
        "version": "WzIzMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "20dbff40-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:10.804Z",
    "version": "WzIzMiwxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "217706c0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:11.820Z",
    "version": "WzIzMywxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "20dbff40-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:10.804Z",
        "version": "WzIzMiwxXQ=="
      },
      {
        "type": "agents",
        "id": "217706c0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:11.820Z",
        "version": "WzIzMywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "20dbff40-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:10.804Z",
        "version": "WzIzMiwxXQ=="
      },
      {
        "type": "agents",
        "id": "217706c0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:11.820Z",
        "version": "WzIzMywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "234cb120-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:14.898Z",
    "version": "WzIzNiwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "234cb120-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:14.898Z",
        "version": "WzIzNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "234cb120-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:14.898Z",
        "version": "WzIzNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "247db710-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:16.897Z",
    "version": "WzIzOCwxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "247db710-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:16.897Z",
        "version": "WzIzOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "247db710-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:17.922Z",
    "version": "WzIzOSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T18:48:17.919Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:25b2dbb0-0fb4-11ea-a923-639dec56bd51",
        "type": "agent_events",
        "updated_at": "2019-11-25T18:48:18.923Z",
        "version": "WzI0MCwxXQ==",
        "attributes": {
          "agent_id": "247db710-0fb4-11ea-a923-639dec56bd51",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "25b2dbb0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "agent_id": "247db710-0fb4-11ea-a923-639dec56bd51",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:18.923Z",
        "version": "WzI0MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "247db710-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T18:48:17.919Z"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:17.922Z",
        "version": "WzIzOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "26e8c3a0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:20.954Z",
    "version": "WzI0MiwxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "26e8c3a0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:20.954Z",
        "version": "WzI0MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "26e8c3a0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:21.971Z",
    "version": "WzI0MywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T18:48:21.969Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "26e8c3a0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:21.971Z",
    "version": "WzI0MywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T18:48:21.969Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "26e8c3a0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T18:48:21.969Z"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:21.971Z",
        "version": "WzI0MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "28b9da20-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:24.002Z",
    "version": "WzI0NSwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "28b9da20-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:24.002Z",
        "version": "WzI0NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "28b9da20-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:25.017Z",
    "version": "WzI0NiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T18:48:25.014Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "28b9da20-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T18:48:25.014Z"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:25.017Z",
        "version": "WzI0NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2a8af0a0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:27.050Z",
    "version": "WzI0OCwxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2a8af0a0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:27.050Z",
        "version": "WzI0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "2a8af0a0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:28.077Z",
    "version": "WzI0OSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T18:48:28.070Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "2a8af0a0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:28.077Z",
    "version": "WzI0OSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T18:48:28.070Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2a8af0a0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T18:48:28.070Z"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:28.077Z",
        "version": "WzI0OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2c5be010-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:30.097Z",
    "version": "WzI1MSwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c5be010-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:30.097Z",
        "version": "WzI1MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "2c5be010-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:31.122Z",
    "version": "WzI1MiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T18:48:31.117Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T18:48:31.117Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c5be010-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T18:48:31.117Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T18:48:31.117Z"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:31.122Z",
        "version": "WzI1MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2e2e0800-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:33.151Z",
    "version": "WzI1NCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "2ec89a50-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:34.165Z",
    "version": "WzI1NSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "2e2e0800-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:35.189Z",
    "version": "WzI1NiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "2ec89a50-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:36.203Z",
    "version": "WzI1NywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "2e2e0800-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:35.189Z",
    "version": "WzI1NiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "2ec89a50-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:36.203Z",
    "version": "WzI1NywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2e2e0800-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:35.189Z",
        "version": "WzI1NiwxXQ=="
      },
      {
        "type": "agents",
        "id": "2ec89a50-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:36.203Z",
        "version": "WzI1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "31d14670-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:39.255Z",
    "version": "WzI2MCwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "326bb1b0-0fb4-11ea-a923-639dec56bd51",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T18:48:40.267Z",
    "version": "WzI2MSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "31d14670-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:39.255Z",
        "version": "WzI2MCwxXQ=="
      },
      {
        "type": "agents",
        "id": "326bb1b0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:40.267Z",
        "version": "WzI2MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "31d14670-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:41.323Z",
    "version": "WzI2MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "326bb1b0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:42.295Z",
    "version": "WzI2MywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "31d14670-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:41.323Z",
    "version": "WzI2MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "326bb1b0-0fb4-11ea-a923-639dec56bd51",
    "type": "agents",
    "updated_at": "2019-11-25T18:48:42.295Z",
    "version": "WzI2MywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "31d14670-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:41.323Z",
        "version": "WzI2MiwxXQ=="
      },
      {
        "type": "agents",
        "id": "326bb1b0-0fb4-11ea-a923-639dec56bd51",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T18:48:42.295Z",
        "version": "WzI2MywxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c2d7e7b0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:21:20.550Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:20.555Z",
    "version": "WzIxNywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "c2d7e7b0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:21.536Z",
    "version": "WzIxOCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c2d7e7b0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:21:20.550Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:21.536Z",
        "version": "WzIxOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:21:23.584Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:23.589Z",
    "version": "WzIyMCwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:24.597Z",
    "version": "WzIyMSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:25.618Z",
    "version": "WzIyMiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:21:23.584Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:25.618Z",
        "version": "WzIyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:26.645Z",
    "version": "WzIyMywxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:21:26.641Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:27.660Z",
    "version": "WzIyNCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c4a6db50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:21:26.641Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:27.660Z",
        "version": "WzIyNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c84cfff0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:21:29.707Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:29.711Z",
    "version": "WzIyNiwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "c84cfff0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:30.714Z",
    "version": "WzIyNywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c84cfff0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:21:29.707Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:30.714Z",
        "version": "WzIyNywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c84cfff0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:21:29.707Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:30.714Z",
        "version": "WzIyNywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ca1e1670-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T19:21:32.755Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:32.759Z",
    "version": "WzIyOSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "ca1e1670-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:33.770Z",
    "version": "WzIzMCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ca1e1670-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T19:21:32.755Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:33.770Z",
        "version": "WzIzMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "cbef2cf0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:35.807Z",
    "version": "WzIzMiwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "cd26e9a0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:37.850Z",
    "version": "WzIzNCwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "cd26e9a0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:38.860Z",
    "version": "WzIzNSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "cd26e9a0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:38.860Z",
    "version": "WzIzNSwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "cd26e9a0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:38.860Z",
        "version": "WzIzNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "cef763e0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:40.894Z",
    "version": "WzIzNywxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "cf924450-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:41.909Z",
    "version": "WzIzOCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "cef763e0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:40.894Z",
        "version": "WzIzNywxXQ=="
      },
      {
        "type": "agents",
        "id": "cf924450-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:41.909Z",
        "version": "WzIzOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "cef763e0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:40.894Z",
        "version": "WzIzNywxXQ=="
      },
      {
        "type": "agents",
        "id": "cf924450-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:41.909Z",
        "version": "WzIzOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "d1664100-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:44.976Z",
    "version": "WzI0MSwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d1664100-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:44.976Z",
        "version": "WzI0MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d1664100-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:44.976Z",
        "version": "WzI0MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:46.982Z",
    "version": "WzI0MywxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:46.982Z",
        "version": "WzI0MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:48.007Z",
    "version": "WzI0NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:21:48.002Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:d3cf78d0-0fb8-11ea-a4d3-4b69a0757d52",
        "type": "agent_events",
        "updated_at": "2019-11-25T19:21:49.020Z",
        "version": "WzI0NSwxXQ==",
        "attributes": {
          "agent_id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "d3cf78d0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "agent_id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:49.020Z",
        "version": "WzI0NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d2985860-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:21:48.002Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:48.007Z",
        "version": "WzI0NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "d5067230-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:51.058Z",
    "version": "WzI0NywxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d5067230-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:51.058Z",
        "version": "WzI0NywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "d5067230-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:52.082Z",
    "version": "WzI0OCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:21:52.074Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "d5067230-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:52.082Z",
    "version": "WzI0OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:21:52.074Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d5067230-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:21:52.074Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:52.082Z",
        "version": "WzI0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "d6d69e50-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:54.101Z",
    "version": "WzI1MCwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d6d69e50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:54.101Z",
        "version": "WzI1MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "d6d69e50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:55.124Z",
    "version": "WzI1MSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:21:55.119Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d6d69e50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:21:55.119Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:55.124Z",
        "version": "WzI1MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "d8a6f180-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:21:57.144Z",
    "version": "WzI1MywxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d8a6f180-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:57.144Z",
        "version": "WzI1MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "d8a6f180-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:58.168Z",
    "version": "WzI1NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:21:58.164Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "d8a6f180-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:21:58.168Z",
    "version": "WzI1NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:21:58.164Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "d8a6f180-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:21:58.164Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:21:58.168Z",
        "version": "WzI1NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "da78cb50-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:22:00.197Z",
    "version": "WzI1NiwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "da78cb50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:00.197Z",
        "version": "WzI1NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "da78cb50-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:01.217Z",
    "version": "WzI1NywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:22:01.213Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T19:22:01.213Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "da78cb50-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T19:22:01.213Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:22:01.213Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:01.217Z",
        "version": "WzI1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "dc48d060-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:22:03.238Z",
    "version": "WzI1OSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "dce3b0d0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:22:04.253Z",
    "version": "WzI2MCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "dc48d060-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:05.265Z",
    "version": "WzI2MSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "dce3b0d0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:06.281Z",
    "version": "WzI2MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "dc48d060-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:05.265Z",
    "version": "WzI2MSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "dce3b0d0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:06.281Z",
    "version": "WzI2MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "dc48d060-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:05.265Z",
        "version": "WzI2MSwxXQ=="
      },
      {
        "type": "agents",
        "id": "dce3b0d0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:06.281Z",
        "version": "WzI2MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "dfebe7c0-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:22:09.340Z",
    "version": "WzI2NSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "e086c830-0fb8-11ea-a4d3-4b69a0757d52",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:22:10.355Z",
    "version": "WzI2NiwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "dfebe7c0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:09.340Z",
        "version": "WzI2NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "e086c830-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:10.355Z",
        "version": "WzI2NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "dfebe7c0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:11.423Z",
    "version": "WzI2NywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "e086c830-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:12.388Z",
    "version": "WzI2OCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "dfebe7c0-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:11.423Z",
    "version": "WzI2NywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "e086c830-0fb8-11ea-a4d3-4b69a0757d52",
    "type": "agents",
    "updated_at": "2019-11-25T19:22:12.388Z",
    "version": "WzI2OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "dfebe7c0-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:11.423Z",
        "version": "WzI2NywxXQ=="
      },
      {
        "type": "agents",
        "id": "e086c830-0fb8-11ea-a4d3-4b69a0757d52",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:22:12.388Z",
        "version": "WzI2OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "a4653010-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:34:48.458Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:34:48.464Z",
    "version": "WzMzOSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "a4653010-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:49.127Z",
    "version": "WzM0MCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a4653010-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:34:48.458Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:34:49.127Z",
        "version": "WzM0MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:34:51.161Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:34:51.166Z",
    "version": "WzM0MiwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:52.174Z",
    "version": "WzM0MywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:53.195Z",
    "version": "WzM0NCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:34:51.161Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:34:53.195Z",
        "version": "WzM0NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:54.221Z",
    "version": "WzM0NSwxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:34:54.215Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:55.230Z",
    "version": "WzM0NiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a60153e0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:34:54.215Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T19:34:55.230Z",
        "version": "WzM0NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "a9a50780-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:34:57.267Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:34:57.272Z",
    "version": "WzM0OCwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "a9a50780-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:34:58.288Z",
    "version": "WzM0OSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a9a50780-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:34:57.267Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:34:58.288Z",
        "version": "WzM0OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "a9a50780-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:34:57.267Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:34:58.288Z",
        "version": "WzM0OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ab764510-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T19:35:00.316Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:00.321Z",
    "version": "WzM1MSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "ab764510-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:01.335Z",
    "version": "WzM1MiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ab764510-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T19:35:00.316Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:01.335Z",
        "version": "WzM1MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ad475b90-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:03.369Z",
    "version": "WzM1NCwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "ae7ea310-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:05.409Z",
    "version": "WzM1NiwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "ae7ea310-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:06.409Z",
    "version": "WzM1NywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "ae7ea310-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:06.409Z",
    "version": "WzM1NywxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ae7ea310-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:06.409Z",
        "version": "WzM1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b04d96b0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:08.443Z",
    "version": "WzM1OSwxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "b0e85010-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:09.457Z",
    "version": "WzM2MCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b04d96b0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:08.443Z",
        "version": "WzM1OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "b0e85010-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:09.457Z",
        "version": "WzM2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b04d96b0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:08.443Z",
        "version": "WzM1OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "b0e85010-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:09.457Z",
        "version": "WzM2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "b2cf86a0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:12.649Z",
    "version": "WzM2MywxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b2cf86a0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:12.649Z",
        "version": "WzM2MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b2cf86a0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:12.649Z",
        "version": "WzM2MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:14.643Z",
    "version": "WzM2NSwxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:14.643Z",
        "version": "WzM2NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:15.663Z",
    "version": "WzM2NiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:35:15.658Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:b53710c0-0fba-11ea-98cf-ed123396606b",
        "type": "agent_events",
        "updated_at": "2019-11-25T19:35:16.684Z",
        "version": "WzM2NywxXQ==",
        "attributes": {
          "agent_id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "b53710c0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "agent_id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:16.684Z",
        "version": "WzM2NywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b3ffa230-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:35:15.658Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:15.663Z",
        "version": "WzM2NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b66bc030-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:18.707Z",
    "version": "WzM2OSwxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b66bc030-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:18.707Z",
        "version": "WzM2OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "b66bc030-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:19.731Z",
    "version": "WzM3MCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:35:19.725Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "b66bc030-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:19.731Z",
    "version": "WzM3MCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:35:19.725Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b66bc030-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:35:19.725Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:19.731Z",
        "version": "WzM3MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b83cafa0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:21.754Z",
    "version": "WzM3MiwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b83cafa0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:21.754Z",
        "version": "WzM3MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "b83cafa0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:22.777Z",
    "version": "WzM3MywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:35:22.771Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b83cafa0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:35:22.771Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:22.777Z",
        "version": "WzM3MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ba0e8970-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:24.807Z",
    "version": "WzM3NSwxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ba0e8970-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:24.807Z",
        "version": "WzM3NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "ba0e8970-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:25.836Z",
    "version": "WzM3NiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:35:25.830Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "ba0e8970-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:25.836Z",
    "version": "WzM3NiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:35:25.830Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ba0e8970-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:35:25.830Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:25.836Z",
        "version": "WzM3NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "bbe01520-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:27.858Z",
    "version": "WzM3OCwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bbe01520-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:27.858Z",
        "version": "WzM3OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "bbe01520-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:28.882Z",
    "version": "WzM3OSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:35:28.877Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T19:35:28.877Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bbe01520-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T19:35:28.877Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:35:28.877Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:28.882Z",
        "version": "WzM3OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "bdb08f60-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:30.902Z",
    "version": "WzM4MSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "be4bbdf0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:31.919Z",
    "version": "WzM4MiwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "bdb08f60-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:32.933Z",
    "version": "WzM4MywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "be4bbdf0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:33.949Z",
    "version": "WzM4NCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "bdb08f60-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:32.933Z",
    "version": "WzM4MywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "be4bbdf0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:33.949Z",
    "version": "WzM4NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bdb08f60-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:32.933Z",
        "version": "WzM4MywxXQ=="
      },
      {
        "type": "agents",
        "id": "be4bbdf0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:33.949Z",
        "version": "WzM4NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c1537fb0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:37.003Z",
    "version": "WzM4NywxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "c1edc3e0-0fba-11ea-98cf-ed123396606b",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:35:38.014Z",
    "version": "WzM4OCwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1537fb0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:37.003Z",
        "version": "WzM4NywxXQ=="
      },
      {
        "type": "agents",
        "id": "c1edc3e0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:38.014Z",
        "version": "WzM4OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "c1537fb0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:39.077Z",
    "version": "WzM4OSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "c1edc3e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:40.048Z",
    "version": "WzM5MCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "c1537fb0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:39.077Z",
    "version": "WzM4OSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "c1edc3e0-0fba-11ea-98cf-ed123396606b",
    "type": "agents",
    "updated_at": "2019-11-25T19:35:40.048Z",
    "version": "WzM5MCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1537fb0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:39.077Z",
        "version": "WzM4OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "c1edc3e0-0fba-11ea-98cf-ed123396606b",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:35:40.048Z",
        "version": "WzM5MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "4ff3f330-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:39:36.284Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:36.291Z",
    "version": "WzM5MywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "4ff3f330-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:36.677Z",
    "version": "WzM5NCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4ff3f330-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:39:36.284Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:36.677Z",
        "version": "WzM5NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:39:38.711Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:38.717Z",
    "version": "WzM5NiwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:39.720Z",
    "version": "WzM5NywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:40.740Z",
    "version": "WzM5OCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:39:38.711Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:40.740Z",
        "version": "WzM5OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:41.765Z",
    "version": "WzM5OSwxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:39:41.756Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:42.766Z",
    "version": "WzQwMCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "516620d0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:39:41.756Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:42.766Z",
        "version": "WzQwMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "550874e0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:39:44.807Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:44.813Z",
    "version": "WzQwMiwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "550874e0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:45.829Z",
    "version": "WzQwMywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "550874e0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:39:44.807Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:45.829Z",
        "version": "WzQwMywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "550874e0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:39:44.807Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:45.829Z",
        "version": "WzQwMywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "56d9b270-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T19:39:47.851Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:47.863Z",
    "version": "WzQwNSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "56d9b270-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:48.872Z",
    "version": "WzQwNiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "56d9b270-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T19:39:47.851Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:48.872Z",
        "version": "WzQwNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "58a91b40-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:50.900Z",
    "version": "WzQwOCwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "59e43350-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:52.961Z",
    "version": "WzQxMCwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "59e43350-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:53.951Z",
    "version": "WzQxMSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "59e43350-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:39:53.951Z",
    "version": "WzQxMSwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "59e43350-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:53.951Z",
        "version": "WzQxMSwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "5bb10410-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:55.985Z",
    "version": "WzQxMywxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "5c4b9660-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:39:56.998Z",
    "version": "WzQxNCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5bb10410-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:55.985Z",
        "version": "WzQxMywxXQ=="
      },
      {
        "type": "agents",
        "id": "5c4b9660-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:56.998Z",
        "version": "WzQxNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5bb10410-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:55.985Z",
        "version": "WzQxMywxXQ=="
      },
      {
        "type": "agents",
        "id": "5c4b9660-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:39:56.998Z",
        "version": "WzQxNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "5e1ef6d0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:00.061Z",
    "version": "WzQxNywxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5e1ef6d0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:00.061Z",
        "version": "WzQxNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5e1ef6d0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:00.061Z",
        "version": "WzQxNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:02.062Z",
    "version": "WzQxOSwxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:02.062Z",
        "version": "WzQxOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:03.088Z",
    "version": "WzQyMCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:40:03.082Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:60880790-0fbb-11ea-bfd6-6bc4b5868001",
        "type": "agent_events",
        "updated_at": "2019-11-25T19:40:04.105Z",
        "version": "WzQyMSwxXQ==",
        "attributes": {
          "agent_id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "60880790-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "agent_id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:04.105Z",
        "version": "WzQyMSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "5f504ae0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:40:03.082Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:03.088Z",
        "version": "WzQyMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "61be3da0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:06.138Z",
    "version": "WzQyMywxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "61be3da0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:06.138Z",
        "version": "WzQyMywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "61be3da0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:07.163Z",
    "version": "WzQyNCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:40:07.157Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "61be3da0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:07.163Z",
    "version": "WzQyNCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:40:07.157Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "61be3da0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:40:07.157Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:07.163Z",
        "version": "WzQyNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "638edef0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:09.183Z",
    "version": "WzQyNiwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "638edef0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:09.183Z",
        "version": "WzQyNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "638edef0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:10.205Z",
    "version": "WzQyNywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:40:10.196Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "638edef0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:40:10.196Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:10.205Z",
        "version": "WzQyNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "655f3220-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:12.226Z",
    "version": "WzQyOSwxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "655f3220-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:12.226Z",
        "version": "WzQyOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "655f3220-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:13.259Z",
    "version": "WzQzMCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:40:13.252Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "655f3220-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:13.259Z",
    "version": "WzQzMCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:40:13.252Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "655f3220-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:40:13.252Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:13.259Z",
        "version": "WzQzMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "67315a10-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:15.281Z",
    "version": "WzQzMiwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "67315a10-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:15.281Z",
        "version": "WzQzMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "67315a10-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:16.309Z",
    "version": "WzQzMywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:40:16.300Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T19:40:16.300Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "67315a10-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T19:40:16.300Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:40:16.300Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:16.309Z",
        "version": "WzQzMywxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "6901d450-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:18.325Z",
    "version": "WzQzNSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "699cb4c0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:19.340Z",
    "version": "WzQzNiwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "6901d450-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:20.357Z",
    "version": "WzQzNywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "699cb4c0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:21.371Z",
    "version": "WzQzOCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "6901d450-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:20.357Z",
    "version": "WzQzNywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "699cb4c0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:21.371Z",
    "version": "WzQzOCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6901d450-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:20.357Z",
        "version": "WzQzNywxXQ=="
      },
      {
        "type": "agents",
        "id": "699cb4c0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:21.371Z",
        "version": "WzQzOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "6ca512c0-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:24.428Z",
    "version": "WzQ0MSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "6d3f7e00-0fbb-11ea-bfd6-6bc4b5868001",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:40:25.440Z",
    "version": "WzQ0MiwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6ca512c0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:24.428Z",
        "version": "WzQ0MSwxXQ=="
      },
      {
        "type": "agents",
        "id": "6d3f7e00-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:25.440Z",
        "version": "WzQ0MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "6ca512c0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:26.506Z",
    "version": "WzQ0MywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "6d3f7e00-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:27.470Z",
    "version": "WzQ0NCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "6ca512c0-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:26.506Z",
    "version": "WzQ0MywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "6d3f7e00-0fbb-11ea-bfd6-6bc4b5868001",
    "type": "agents",
    "updated_at": "2019-11-25T19:40:27.470Z",
    "version": "WzQ0NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6ca512c0-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:26.506Z",
        "version": "WzQ0MywxXQ=="
      },
      {
        "type": "agents",
        "id": "6d3f7e00-0fbb-11ea-bfd6-6bc4b5868001",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:40:27.470Z",
        "version": "WzQ0NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "1a3c2900-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:45:15.655Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:15.664Z",
    "version": "WzQ0NywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "1a3c2900-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:16.272Z",
    "version": "WzQ0OCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1a3c2900-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:45:15.655Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:16.272Z",
        "version": "WzQ0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:45:18.305Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:18.314Z",
    "version": "WzQ1MCwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:19.318Z",
    "version": "WzQ1MSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:20.334Z",
    "version": "WzQ1MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:45:18.305Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:20.334Z",
        "version": "WzQ1MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:21.361Z",
    "version": "WzQ1MywxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:45:21.354Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:22.369Z",
    "version": "WzQ1NCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1bd084a0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:45:21.354Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:22.369Z",
        "version": "WzQ1NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1f7326d0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:45:24.405Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:24.412Z",
    "version": "WzQ1NiwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "1f7326d0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:25.421Z",
    "version": "WzQ1NywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1f7326d0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:45:24.405Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:25.421Z",
        "version": "WzQ1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1f7326d0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:45:24.405Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:25.421Z",
        "version": "WzQ1NywxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "21426890-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T19:45:27.442Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:27.449Z",
    "version": "WzQ1OSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "21426890-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:28.467Z",
    "version": "WzQ2MCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "21426890-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T19:45:27.442Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:28.467Z",
        "version": "WzQ2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2313a620-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:30.498Z",
    "version": "WzQ2MiwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "244c9b50-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:32.549Z",
    "version": "WzQ2NCwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "244c9b50-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:33.541Z",
    "version": "WzQ2NSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "244c9b50-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:33.541Z",
    "version": "WzQ2NSwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "244c9b50-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:33.541Z",
        "version": "WzQ2NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "261a5670-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:35.575Z",
    "version": "WzQ2NywxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "26b4e8c0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:36.588Z",
    "version": "WzQ2OCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "261a5670-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:35.575Z",
        "version": "WzQ2NywxXQ=="
      },
      {
        "type": "agents",
        "id": "26b4e8c0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:36.588Z",
        "version": "WzQ2OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "261a5670-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:35.575Z",
        "version": "WzQ2NywxXQ=="
      },
      {
        "type": "agents",
        "id": "26b4e8c0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:36.588Z",
        "version": "WzQ2OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "288b2f60-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:39.670Z",
    "version": "WzQ3MSwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "288b2f60-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:39.670Z",
        "version": "WzQ3MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "288b2f60-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:39.670Z",
        "version": "WzQ3MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:41.655Z",
    "version": "WzQ3MywxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:41.655Z",
        "version": "WzQ3MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:42.675Z",
    "version": "WzQ3NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:45:42.667Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:2af0e4c0-0fbc-11ea-8d7f-c33870acaebe",
        "type": "agent_events",
        "updated_at": "2019-11-25T19:45:43.692Z",
        "version": "WzQ3NSwxXQ==",
        "attributes": {
          "agent_id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "2af0e4c0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "agent_id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:43.692Z",
        "version": "WzQ3NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "29ba1270-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:45:42.667Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:42.675Z",
        "version": "WzQ3NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2c267e90-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:45.720Z",
    "version": "WzQ3NywxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c267e90-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:45.720Z",
        "version": "WzQ3NywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "2c267e90-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:46.746Z",
    "version": "WzQ3OCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:45:46.738Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "2c267e90-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:46.746Z",
    "version": "WzQ3OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:45:46.738Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c267e90-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:45:46.738Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:46.746Z",
        "version": "WzQ3OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2df746f0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:48.767Z",
    "version": "WzQ4MCwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2df746f0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:48.767Z",
        "version": "WzQ4MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "2df746f0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:49.789Z",
    "version": "WzQ4MSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:45:49.782Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2df746f0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:45:49.782Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:49.789Z",
        "version": "WzQ4MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2fc947d0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:51.821Z",
    "version": "WzQ4MywxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2fc947d0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:51.821Z",
        "version": "WzQ4MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "2fc947d0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:52.835Z",
    "version": "WzQ4NCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:45:52.828Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "2fc947d0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:52.835Z",
    "version": "WzQ4NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:45:52.828Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2fc947d0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:45:52.828Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:52.835Z",
        "version": "WzQ4NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "31981460-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:54.853Z",
    "version": "WzQ4NiwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "31981460-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:54.853Z",
        "version": "WzQ4NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "31981460-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:55.884Z",
    "version": "WzQ4NywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:45:55.876Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T19:45:55.876Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "31981460-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T19:45:55.876Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:45:55.876Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:55.884Z",
        "version": "WzQ4NywxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "3369ee30-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:57.907Z",
    "version": "WzQ4OSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "3404f5b0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:45:58.923Z",
    "version": "WzQ5MCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "3369ee30-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:59.938Z",
    "version": "WzQ5MSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "3404f5b0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:00.955Z",
    "version": "WzQ5MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "3369ee30-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:45:59.938Z",
    "version": "WzQ5MSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "3404f5b0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:00.955Z",
    "version": "WzQ5MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3369ee30-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:45:59.938Z",
        "version": "WzQ5MSwxXQ=="
      },
      {
        "type": "agents",
        "id": "3404f5b0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:46:00.955Z",
        "version": "WzQ5MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "370d53b0-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:46:04.011Z",
    "version": "WzQ5NSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "37a7e600-0fbc-11ea-8d7f-c33870acaebe",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:46:05.024Z",
    "version": "WzQ5NiwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "370d53b0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:46:04.011Z",
        "version": "WzQ5NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "37a7e600-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:46:05.024Z",
        "version": "WzQ5NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "370d53b0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:06.093Z",
    "version": "WzQ5NywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "37a7e600-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:07.054Z",
    "version": "WzQ5OCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "370d53b0-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:06.093Z",
    "version": "WzQ5NywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "37a7e600-0fbc-11ea-8d7f-c33870acaebe",
    "type": "agents",
    "updated_at": "2019-11-25T19:46:07.054Z",
    "version": "WzQ5OCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "370d53b0-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:46:06.093Z",
        "version": "WzQ5NywxXQ=="
      },
      {
        "type": "agents",
        "id": "37a7e600-0fbc-11ea-8d7f-c33870acaebe",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:46:07.054Z",
        "version": "WzQ5OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "e30734b0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:50:52.527Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:50:52.539Z",
    "version": "WzUwMSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "e30734b0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:50:52.842Z",
    "version": "WzUwMiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e30734b0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:50:52.527Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:50:52.842Z",
        "version": "WzUwMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:50:54.866Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:50:54.874Z",
    "version": "WzUwNCwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:50:55.879Z",
    "version": "WzUwNSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:50:56.893Z",
    "version": "WzUwNiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:50:54.866Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:50:56.893Z",
        "version": "WzUwNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:50:57.917Z",
    "version": "WzUwNywxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:50:57.909Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:50:58.916Z",
    "version": "WzUwOCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e46b7fa0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:50:57.909Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T19:50:58.916Z",
        "version": "WzUwOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "e80bd7e0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T19:51:00.949Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:00.958Z",
    "version": "WzUxMCwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "e80bd7e0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:01.964Z",
    "version": "WzUxMSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e80bd7e0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:51:00.949Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:01.964Z",
        "version": "WzUxMSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e80bd7e0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T19:51:00.949Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:01.964Z",
        "version": "WzUxMSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "e9dacb80-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T19:51:03.984Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:03.992Z",
    "version": "WzUxMywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "e9dacb80-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:05.002Z",
    "version": "WzUxNCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "e9dacb80-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T19:51:03.984Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:05.002Z",
        "version": "WzUxNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "eba97100-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:07.024Z",
    "version": "WzUxNiwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "ece23f20-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:09.074Z",
    "version": "WzUxOCwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "ece23f20-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:10.059Z",
    "version": "WzUxOSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "ece23f20-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:10.059Z",
    "version": "WzUxOSwxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ece23f20-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:10.059Z",
        "version": "WzUxOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "eeaec1c0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:12.091Z",
    "version": "WzUyMSwxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "ef481b90-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:13.096Z",
    "version": "WzUyMiwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "eeaec1c0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:12.091Z",
        "version": "WzUyMSwxXQ=="
      },
      {
        "type": "agents",
        "id": "ef481b90-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:13.096Z",
        "version": "WzUyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "eeaec1c0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:12.091Z",
        "version": "WzUyMSwxXQ=="
      },
      {
        "type": "agents",
        "id": "ef481b90-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:13.096Z",
        "version": "WzUyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "f11bf130-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:16.163Z",
    "version": "WzUyNSwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f11bf130-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:16.163Z",
        "version": "WzUyNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f11bf130-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:16.163Z",
        "version": "WzUyNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:18.160Z",
    "version": "WzUyNywxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:18.160Z",
        "version": "WzUyNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:19.183Z",
    "version": "WzUyOCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:51:19.174Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:f382b800-0fbc-11ea-b6f5-8fe62c090ce0",
        "type": "agent_events",
        "updated_at": "2019-11-25T19:51:20.192Z",
        "version": "WzUyOSwxXQ==",
        "attributes": {
          "agent_id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "f382b800-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "agent_id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:20.192Z",
        "version": "WzUyOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f24cd010-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:51:19.174Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:19.183Z",
        "version": "WzUyOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f4b74060-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:22.214Z",
    "version": "WzUzMSwxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f4b74060-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:22.214Z",
        "version": "WzUzMSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "f4b74060-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:23.229Z",
    "version": "WzUzMiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:51:23.221Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "f4b74060-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:23.229Z",
    "version": "WzUzMiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:51:23.221Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f4b74060-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:51:23.221Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:23.229Z",
        "version": "WzUzMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f685e5e0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:25.246Z",
    "version": "WzUzNCwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f685e5e0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:25.246Z",
        "version": "WzUzNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "f685e5e0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:26.285Z",
    "version": "WzUzNSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:51:26.272Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f685e5e0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:51:26.272Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:26.285Z",
        "version": "WzUzNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f85e7670-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:28.343Z",
    "version": "WzUzNywxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f85e7670-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:28.343Z",
        "version": "WzUzNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "f85e7670-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:29.323Z",
    "version": "WzUzOCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:51:29.314Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "f85e7670-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:29.323Z",
    "version": "WzUzOCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T19:51:29.314Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f85e7670-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T19:51:29.314Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:29.323Z",
        "version": "WzUzOCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "fa270170-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:31.335Z",
    "version": "WzU0MCwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fa270170-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:31.335Z",
        "version": "WzU0MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "fa270170-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:32.357Z",
    "version": "WzU0MSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T19:51:32.349Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T19:51:32.349Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fa270170-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T19:51:32.349Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T19:51:32.349Z"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:32.357Z",
        "version": "WzU0MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "fbf754a0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:34.378Z",
    "version": "WzU0MywxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "fc903940-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:35.380Z",
    "version": "WzU0NCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "fbf754a0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:36.392Z",
    "version": "WzU0NSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "fc903940-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:37.409Z",
    "version": "WzU0NiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "fbf754a0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:36.392Z",
    "version": "WzU0NSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "fc903940-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:37.409Z",
    "version": "WzU0NiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fbf754a0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:36.392Z",
        "version": "WzU0NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "fc903940-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:37.409Z",
        "version": "WzU0NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "ff9737b0-0fbc-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:40.458Z",
    "version": "WzU0OSwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "0030b890-0fbd-11ea-b6f5-8fe62c090ce0",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T19:51:41.465Z",
    "version": "WzU1MCwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ff9737b0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:40.458Z",
        "version": "WzU0OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "0030b890-0fbd-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:41.465Z",
        "version": "WzU1MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "ff9737b0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:42.521Z",
    "version": "WzU1MSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "0030b890-0fbd-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:43.488Z",
    "version": "WzU1MiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "ff9737b0-0fbc-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:42.521Z",
    "version": "WzU1MSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "0030b890-0fbd-11ea-b6f5-8fe62c090ce0",
    "type": "agents",
    "updated_at": "2019-11-25T19:51:43.488Z",
    "version": "WzU1MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ff9737b0-0fbc-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:42.521Z",
        "version": "WzU1MSwxXQ=="
      },
      {
        "type": "agents",
        "id": "0030b890-0fbd-11ea-b6f5-8fe62c090ce0",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T19:51:43.488Z",
        "version": "WzU1MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ac803e30-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:03:40.038Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:40.051Z",
    "version": "WzU1NSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "ac803e30-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:40.353Z",
    "version": "WzU1NiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ac803e30-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:03:40.038Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:40.353Z",
        "version": "WzU1NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:03:42.389Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:42.399Z",
    "version": "WzU1OCwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:43.404Z",
    "version": "WzU1OSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:44.421Z",
    "version": "WzU2MCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:03:42.389Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:44.421Z",
        "version": "WzU2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:45.446Z",
    "version": "WzU2MSwxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:03:45.437Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:46.449Z",
    "version": "WzU2MiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ade684f0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:03:45.437Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:46.449Z",
        "version": "WzU2MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "b1890010-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:03:48.486Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:48.497Z",
    "version": "WzU2NCwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "b1890010-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:49.498Z",
    "version": "WzU2NSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b1890010-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:03:48.486Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:49.498Z",
        "version": "WzU2NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b1890010-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:03:48.486Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:49.498Z",
        "version": "WzU2NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b358de10-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T20:03:51.527Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:51.537Z",
    "version": "WzU2NywxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "b358de10-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:52.556Z",
    "version": "WzU2OCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b358de10-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T20:03:51.527Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:52.556Z",
        "version": "WzU2OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b529a670-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:54.582Z",
    "version": "WzU3MCwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "b6670870-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:56.663Z",
    "version": "WzU3MiwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "b6670870-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:57.628Z",
    "version": "WzU3MywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "b6670870-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:03:57.628Z",
    "version": "WzU3MywxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b6670870-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:57.628Z",
        "version": "WzU3MywxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b82ef730-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:03:59.651Z",
    "version": "WzU3NSwxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "b8cb8550-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:00.677Z",
    "version": "WzU3NiwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b82ef730-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:59.651Z",
        "version": "WzU3NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "b8cb8550-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:00.677Z",
        "version": "WzU3NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b82ef730-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:03:59.651Z",
        "version": "WzU3NSwxXQ=="
      },
      {
        "type": "agents",
        "id": "b8cb8550-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:00.677Z",
        "version": "WzU3NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "baa0e190-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:03.753Z",
    "version": "WzU3OSwxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "baa0e190-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:03.753Z",
        "version": "WzU3OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "baa0e190-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:03.753Z",
        "version": "WzU3OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:05.744Z",
    "version": "WzU4MSwxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:05.744Z",
        "version": "WzU4MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:06.771Z",
    "version": "WzU4MiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:04:06.761Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:bd075a40-0fbe-11ea-a954-bd72f7209062",
        "type": "agent_events",
        "updated_at": "2019-11-25T20:04:07.780Z",
        "version": "WzU4MywxXQ==",
        "attributes": {
          "agent_id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "bd075a40-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "agent_id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:07.780Z",
        "version": "WzU4MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bbd0af00-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T20:04:06.761Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:06.771Z",
        "version": "WzU4MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "be3db760-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:09.814Z",
    "version": "WzU4NSwxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "be3db760-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:09.814Z",
        "version": "WzU4NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "be3db760-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:10.840Z",
    "version": "WzU4NiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:04:10.830Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "be3db760-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:10.840Z",
    "version": "WzU4NiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T20:04:10.830Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "be3db760-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:04:10.830Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:10.840Z",
        "version": "WzU4NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c00f4310-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:12.865Z",
    "version": "WzU4OCwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c00f4310-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:12.865Z",
        "version": "WzU4OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "c00f4310-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:13.882Z",
    "version": "WzU4OSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:04:13.873Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c00f4310-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:04:13.873Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:13.882Z",
        "version": "WzU4OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c1dde890-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:15.897Z",
    "version": "WzU5MSwxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1dde890-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:15.897Z",
        "version": "WzU5MSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "c1dde890-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:16.922Z",
    "version": "WzU5MiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:04:16.913Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "c1dde890-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:16.922Z",
    "version": "WzU5MiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T20:04:16.913Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1dde890-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:04:16.913Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:16.922Z",
        "version": "WzU5MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c3b05ea0-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:18.954Z",
    "version": "WzU5NCwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c3b05ea0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:18.954Z",
        "version": "WzU5NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "c3b05ea0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:19.988Z",
    "version": "WzU5NSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:04:19.972Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T20:04:19.972Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c3b05ea0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T20:04:19.972Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T20:04:19.972Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:19.988Z",
        "version": "WzU5NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c58063b0-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:21.995Z",
    "version": "WzU5NywxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c61b6b30-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:23.011Z",
    "version": "WzU5OCwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "c58063b0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:24.023Z",
    "version": "WzU5OSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "c61b6b30-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:25.039Z",
    "version": "WzYwMCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "c58063b0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:24.023Z",
    "version": "WzU5OSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "c61b6b30-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:25.039Z",
    "version": "WzYwMCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c58063b0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:24.023Z",
        "version": "WzU5OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "c61b6b30-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:25.039Z",
        "version": "WzYwMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c92305e0-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:28.094Z",
    "version": "WzYwMywxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "c9bdbf40-0fbe-11ea-a954-bd72f7209062",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:04:29.108Z",
    "version": "WzYwNCwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c92305e0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:28.094Z",
        "version": "WzYwMywxXQ=="
      },
      {
        "type": "agents",
        "id": "c9bdbf40-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:29.108Z",
        "version": "WzYwNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "c92305e0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:30.177Z",
    "version": "WzYwNSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "c9bdbf40-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:31.138Z",
    "version": "WzYwNiwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "c92305e0-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:30.177Z",
    "version": "WzYwNSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "c9bdbf40-0fbe-11ea-a954-bd72f7209062",
    "type": "agents",
    "updated_at": "2019-11-25T20:04:31.138Z",
    "version": "WzYwNiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c92305e0-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:30.177Z",
        "version": "WzYwNSwxXQ=="
      },
      {
        "type": "agents",
        "id": "c9bdbf40-0fbe-11ea-a954-bd72f7209062",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:04:31.138Z",
        "version": "WzYwNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "20997700-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:06:54.814Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:06:54.832Z",
    "version": "WzYwOSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "20997700-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:06:55.608Z",
    "version": "WzYxMCwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "20997700-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:06:54.814Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:06:55.608Z",
        "version": "WzYxMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:06:57.648Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:06:57.659Z",
    "version": "WzYxMiwxXQ=="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:06:58.657Z",
    "version": "WzYxMywxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:06:59.670Z",
    "version": "WzYxNCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:06:57.648Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:06:59.670Z",
        "version": "WzYxNCwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:00.698Z",
    "version": "WzYxNSwxXQ==",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:07:00.686Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:01.701Z",
    "version": "WzYxNiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2248d4b0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:07:00.686Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:01.701Z",
        "version": "WzYxNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "25ea3e60-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-11-25T20:07:03.740Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:03.750Z",
    "version": "WzYxOCwxXQ=="
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "25ea3e60-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:04.744Z",
    "version": "WzYxOSwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "25ea3e60-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:07:03.740Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:04.744Z",
        "version": "WzYxOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "25ea3e60-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-11-25T20:07:03.740Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:04.744Z",
        "version": "WzYxOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "27b93200-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-11-25T20:07:06.773Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:06.784Z",
    "version": "WzYyMSwxXQ=="
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "27b93200-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:07.805Z",
    "version": "WzYyMiwxXQ==",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "27b93200-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-11-25T20:07:06.773Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:07.805Z",
        "version": "WzYyMiwxXQ=="
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2989fa60-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:09.829Z",
    "version": "WzYyNCwxXQ=="
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "2ac33db0-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:11.883Z",
    "version": "WzYyNiwxXQ=="
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "2ac33db0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:12.874Z",
    "version": "WzYyNywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "2ac33db0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:12.874Z",
    "version": "WzYyNywxXQ==",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2ac33db0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:12.874Z",
        "version": "WzYyNywxXQ=="
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "2c905c90-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:14.905Z",
    "version": "WzYyOSwxXQ=="
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "2d2c2760-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:15.926Z",
    "version": "WzYzMCwxXQ=="
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c905c90-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:14.905Z",
        "version": "WzYyOSwxXQ=="
      },
      {
        "type": "agents",
        "id": "2d2c2760-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:15.926Z",
        "version": "WzYzMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2c905c90-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:14.905Z",
        "version": "WzYyOSwxXQ=="
      },
      {
        "type": "agents",
        "id": "2d2c2760-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:15.926Z",
        "version": "WzYzMCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "2f0490e0-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:19.022Z",
    "version": "WzYzMywxXQ=="
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2f0490e0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:19.022Z",
        "version": "WzYzMywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "2f0490e0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:19.022Z",
        "version": "WzYzMywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:20.994Z",
    "version": "WzYzNSwxXQ=="
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:20.994Z",
        "version": "WzYzNSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (5)'] = {
  "results": {
    "id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:22.022Z",
    "version": "WzYzNiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:07:22.010Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:3167fc50-0fbf-11ea-aef6-9b13fc9e1e78",
        "type": "agent_events",
        "updated_at": "2019-11-25T20:07:23.029Z",
        "version": "WzYzNywxXQ==",
        "attributes": {
          "agent_id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "3167fc50-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "agent_id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:23.029Z",
        "version": "WzYzNywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "30317820-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T20:07:22.010Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:22.022Z",
        "version": "WzYzNiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "329e3260-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:25.061Z",
    "version": "WzYzOSwxXQ=="
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "329e3260-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:25.061Z",
        "version": "WzYzOSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "329e3260-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:26.089Z",
    "version": "WzY0MCwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:07:26.077Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "329e3260-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:26.089Z",
    "version": "WzY0MCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T20:07:26.077Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "329e3260-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:07:26.077Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:26.089Z",
        "version": "WzY0MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return the full policy for this agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "346e3770-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:28.103Z",
    "version": "WzY0MiwxXQ=="
  }
}

exports['Agent lib checkin should return the full policy for this agent - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "346e3770-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:28.103Z",
        "version": "WzY0MiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return the full policy for this agent - update:agents (5)'] = {
  "results": {
    "id": "346e3770-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:29.131Z",
    "version": "WzY0MywxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:07:29.120Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "346e3770-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:07:29.120Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:29.131Z",
        "version": "WzY0MywxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "363d2b10-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:31.136Z",
    "version": "WzY0NSwxXQ=="
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "363d2b10-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:31.136Z",
        "version": "WzY0NSwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "363d2b10-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:32.167Z",
    "version": "WzY0NiwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:07:32.156Z",
      "actions": [],
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "363d2b10-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:32.167Z",
    "version": "WzY0NiwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-11-25T20:07:32.156Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "363d2b10-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-11-25T20:07:32.156Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:32.167Z",
        "version": "WzY0NiwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "38101650-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:34.197Z",
    "version": "WzY0OCwxXQ=="
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "38101650-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:34.197Z",
        "version": "WzY0OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "38101650-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:35.232Z",
    "version": "WzY0OSwxXQ==",
    "attributes": {
      "last_checkin": "2019-11-25T20:07:35.221Z",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id",
          "sent_at": "2019-11-25T20:07:35.221Z"
        }
      ]
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "38101650-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-11-25T20:07:35.221Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "this-a-unique-id",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-11-25T20:07:35.221Z"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:35.232Z",
        "version": "WzY0OSwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "39e09090-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:37.241Z",
    "version": "WzY1MSwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "3a7b22e0-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:38.254Z",
    "version": "WzY1MiwxXQ=="
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "39e09090-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:39.268Z",
    "version": "WzY1MywxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "3a7b22e0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:40.290Z",
    "version": "WzY1NCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "39e09090-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:39.268Z",
    "version": "WzY1MywxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "3a7b22e0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:40.290Z",
    "version": "WzY1NCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "39e09090-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:39.268Z",
        "version": "WzY1MywxXQ=="
      },
      {
        "type": "agents",
        "id": "3a7b22e0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:40.290Z",
        "version": "WzY1NCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "3d826f70-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:43.335Z",
    "version": "WzY1NywxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "3e1cb3a0-0fbf-11ea-aef6-9b13fc9e1e78",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-11-25T20:07:44.346Z",
    "version": "WzY1OCwxXQ=="
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3d826f70-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:43.335Z",
        "version": "WzY1NywxXQ=="
      },
      {
        "type": "agents",
        "id": "3e1cb3a0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:44.346Z",
        "version": "WzY1OCwxXQ=="
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "3d826f70-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:45.424Z",
    "version": "WzY1OSwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "3e1cb3a0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:46.375Z",
    "version": "WzY2MCwxXQ==",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "3d826f70-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:45.424Z",
    "version": "WzY1OSwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "3e1cb3a0-0fbf-11ea-aef6-9b13fc9e1e78",
    "type": "agents",
    "updated_at": "2019-11-25T20:07:46.375Z",
    "version": "WzY2MCwxXQ==",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3d826f70-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:45.424Z",
        "version": "WzY1OSwxXQ=="
      },
      {
        "type": "agents",
        "id": "3e1cb3a0-0fbf-11ea-aef6-9b13fc9e1e78",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-11-25T20:07:46.375Z",
        "version": "WzY2MCwxXQ=="
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}
