
exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "aee26a40-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2020-01-09T20:57:44.416Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2020-01-09T20:57:44.419Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "aee26a40-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:45.029Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "aee26a40-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2020-01-09T20:57:44.416Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:45.029Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2020-01-09T20:57:47.310Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2020-01-09T20:57:47.311Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:48.331Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:49.358Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2020-01-09T20:57:47.310Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:49.358Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:50.391Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2020-01-09T20:57:50.390Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:51.405Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b09bb300-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2020-01-09T20:57:50.390Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:51.405Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "b4450bf0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2020-01-09T20:57:53.454Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2020-01-09T20:57:53.455Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "b4450bf0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:54.474Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b4450bf0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2020-01-09T20:57:53.454Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:54.474Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b4450bf0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2020-01-09T20:57:53.454Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:54.474Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b619cbf0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2020-01-09T20:57:56.525Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2020-01-09T20:57:56.527Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "b619cbf0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:57:57.556Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b619cbf0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2020-01-09T20:57:56.525Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:57:57.556Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "b7ee3dd0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:57:59.597Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "b92907c0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:01.660Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "b92907c0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:02.667Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "b92907c0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:02.667Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "b92907c0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:02.667Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "bafc6830-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:04.722Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "bb9796c0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:05.740Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bafc6830-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:04.722Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "bb9796c0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:05.740Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib acknowledgeActions should acknowledge actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bafc6830-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:04.722Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "bb9796c0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:05.740Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib acknowledgeActions should acknowledge actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib acknowledgeActions should acknowledge actions - delete (3)'] = {
  "results": {}
}

exports['Agent lib acknowledgeActions should acknowledge actions - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "bd6997a0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "action-1",
          "sent_at": "2019-09-05T15:42:26+0000"
        },
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "action-2"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "id": "action-3"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:08.794Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib acknowledgeActions should acknowledge actions - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bd6997a0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "action-1",
              "sent_at": "2019-09-05T15:42:26+0000"
            },
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "action-2"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "id": "action-3"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:08.794Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib acknowledgeActions should acknowledge actions - update:agents (6)'] = {
  "results": {
    "id": "bd6997a0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:09.822Z",
    "version": "WzI3LDFd",
    "attributes": {
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "action-1",
          "sent_at": "2019-09-05T15:42:26+0000"
        },
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "action-2",
          "sent_at": "2020-01-09T20:58:09.820Z"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "id": "action-3"
        }
      ]
    }
  }
}

exports['Agent lib acknowledgeActions should acknowledge actions - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bd6997a0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-09-05T15:42:26+0000",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "action-1",
              "type": "PAUSE"
            },
            {
              "sent_at": "2020-01-09T20:58:09.820Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "action-2",
              "type": "PAUSE"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "id": "action-3",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:09.822Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bd6997a0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "sent_at": "2019-09-05T15:42:26+0000",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "action-1",
              "type": "PAUSE"
            },
            {
              "sent_at": "2020-01-09T20:58:09.820Z",
              "created_at": "2019-09-05T15:43:26+0000",
              "id": "action-2",
              "type": "PAUSE"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "id": "action-3",
              "type": "PAUSE"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:09.822Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:11.854Z",
    "version": "WzI5LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:11.854Z",
        "version": "WzI5LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (5)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:bfdae5c0-3322-11ea-b05f-3bd2d1665971",
        "type": "agent_events",
        "updated_at": "2020-01-09T20:58:12.891Z",
        "version": "WzMwLDFd",
        "attributes": {
          "agent_id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (6)'] = {
  "results": {
    "id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:14.243Z",
    "version": "WzMxLDFd",
    "attributes": {
      "last_checkin": "2020-01-09T20:58:12.889Z",
      "current_error_events": "[]"
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "bfdae5c0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "agent_id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:12.891Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "bf3ca9f0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_error_events": "[]",
          "last_checkin": "2020-01-09T20:58:12.889Z"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:14.243Z",
        "version": "WzMxLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c1e00490-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:16.281Z",
    "version": "WzMzLDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1e00490-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:16.281Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "c1e00490-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:17.307Z",
    "version": "WzM0LDFd",
    "attributes": {
      "last_checkin": "2020-01-09T20:58:17.305Z",
      "current_error_events": "[]"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "c1e00490-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:17.307Z",
    "version": "WzM0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "current_error_events": "[]",
      "last_checkin": "2020-01-09T20:58:17.305Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c1e00490-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "current_error_events": "[]",
          "last_checkin": "2020-01-09T20:58:17.305Z"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:17.307Z",
        "version": "WzM0LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c3b22c80-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:19.336Z",
    "version": "WzM2LDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c3b22c80-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:19.336Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "c3b22c80-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:20.355Z",
    "version": "WzM3LDFd",
    "attributes": {
      "last_checkin": "2020-01-09T20:58:20.352Z",
      "current_error_events": "[]",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "c3b22c80-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:20.355Z",
    "version": "WzM3LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "current_error_events": "[]",
      "last_checkin": "2020-01-09T20:58:20.352Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c3b22c80-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "current_error_events": "[]",
          "last_checkin": "2020-01-09T20:58:20.352Z"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:20.355Z",
        "version": "WzM3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c583df40-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:22.388Z",
    "version": "WzM5LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c583df40-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:22.388Z",
        "version": "WzM5LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "c583df40-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:23.423Z",
    "version": "WzQwLDFd",
    "attributes": {
      "last_checkin": "2020-01-09T20:58:23.422Z",
      "current_error_events": "[]"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c583df40-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_error_events": "[]",
          "last_checkin": "2020-01-09T20:58:23.422Z"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:23.423Z",
        "version": "WzQwLDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "c75766c0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:25.452Z",
    "version": "WzQyLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "c7f29550-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:26.469Z",
    "version": "WzQzLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "c75766c0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:27.491Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "c7f29550-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:28.508Z",
    "version": "WzQ1LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "c75766c0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:27.491Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "c7f29550-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:28.508Z",
    "version": "WzQ1LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "c75766c0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:27.491Z",
        "version": "WzQ0LDFd"
      },
      {
        "type": "agents",
        "id": "c7f29550-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:28.508Z",
        "version": "WzQ1LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "cafc79f0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:31.567Z",
    "version": "WzQ4LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "cb99cb60-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:32.597Z",
    "version": "WzQ5LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "cafc79f0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:31.567Z",
        "version": "WzQ4LDFd"
      },
      {
        "type": "agents",
        "id": "cb99cb60-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:32.597Z",
        "version": "WzQ5LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "cafc79f0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:33.652Z",
    "version": "WzUwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "cb99cb60-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:34.633Z",
    "version": "WzUxLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "cafc79f0-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:33.652Z",
    "version": "WzUwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "cb99cb60-3322-11ea-b05f-3bd2d1665971",
    "type": "agents",
    "updated_at": "2020-01-09T20:58:34.633Z",
    "version": "WzUxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "cafc79f0-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:33.652Z",
        "version": "WzUwLDFd"
      },
      {
        "type": "agents",
        "id": "cb99cb60-3322-11ea-b05f-3bd2d1665971",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2020-01-09T20:58:34.633Z",
        "version": "WzUxLDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "cea81cd0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:37.725Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "cf3fa1e0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:38.718Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "cfdcf350-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:39.749Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "d077acb0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2020-01-09T20:53:37.721Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:40.763Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "d116abd0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2020-01-09T20:58:37.721Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:41.805Z",
    "version": "WzU4LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "d1b07ad0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2020-01-09T20:58:37.721Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:42.813Z",
    "version": "WzU5LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "d24b3430-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2020-01-09T20:53:37.721Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:43.827Z",
    "version": "WzYwLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "d2e63bb0-3322-11ea-b05f-3bd2d1665971",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2020-01-09T20:58:37.721Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2020-01-09T20:58:44.843Z",
    "version": "WzYxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agent_events" (13)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 0,
    "saved_objects": []
  }
}
