
exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "674a4f20-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-02T18:41:50.865Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-02T18:41:50.866Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "674a4f20-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:41:51.428Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "674a4f20-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-02T18:41:50.865Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:41:51.428Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-02T18:41:53.482Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-02T18:41:53.483Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:41:54.490Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:41:55.527Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-02T18:41:53.482Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:41:55.527Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:41:56.558Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-02T18:41:56.557Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:41:57.703Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "68d9a1b0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-02T18:41:56.557Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-02T18:41:57.703Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "6c979410-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-02T18:41:59.760Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-02T18:41:59.761Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "6c979410-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:00.776Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6c979410-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-02T18:41:59.760Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:00.776Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6c979410-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-02T18:41:59.760Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:00.776Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "6e6e28d0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-02T18:42:02.844Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:02.845Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "6e6e28d0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:03.864Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "6e6e28d0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-02T18:42:02.844Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:03.864Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "704029b0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:05.899Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "717945f0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:07.951Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "717945f0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:08.959Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "717945f0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:08.959Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "717945f0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:08.959Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "734c0a20-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:11.010Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "73e87130-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:12.035Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "734c0a20-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:11.010Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "73e87130-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:12.035Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "734c0a20-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:11.010Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "73e87130-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:12.035Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "75be90c0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:15.116Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "75be90c0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:15.116Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "75be90c0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:15.116Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:17.138Z",
    "version": "WzI4LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:17.138Z",
        "version": "WzI4LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (5)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:778f8030-1533-11ea-a3c9-5b99a65c0d97",
        "type": "agent_events",
        "updated_at": "2019-12-02T18:42:18.162Z",
        "version": "WzI5LDFd",
        "attributes": {
          "agent_id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (6)'] = {
  "results": {
    "id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:19.177Z",
    "version": "WzMwLDFd",
    "attributes": {
      "last_checkin": "2019-12-02T18:42:18.160Z",
      "actions": []
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "778f8030-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "agent_id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:18.162Z",
        "version": "WzI5LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "76f31920-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-12-02T18:42:18.160Z"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:19.177Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "796355d0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:21.229Z",
    "version": "WzMyLDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "796355d0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:21.229Z",
        "version": "WzMyLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "796355d0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:22.255Z",
    "version": "WzMzLDFd",
    "attributes": {
      "last_checkin": "2019-12-02T18:42:22.253Z"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "796355d0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:22.255Z",
    "version": "WzMzLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-02T18:42:22.253Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "796355d0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-02T18:42:22.253Z"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:22.255Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7b366820-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:24.290Z",
    "version": "WzM1LDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7b366820-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:24.290Z",
        "version": "WzM1LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "7b366820-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:25.318Z",
    "version": "WzM2LDFd",
    "attributes": {
      "last_checkin": "2019-12-02T18:42:25.317Z",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "7b366820-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:25.318Z",
    "version": "WzM2LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-02T18:42:25.317Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7b366820-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-02T18:42:25.317Z"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:25.318Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7d095360-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:27.350Z",
    "version": "WzM4LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7d095360-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:27.350Z",
        "version": "WzM4LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "7d095360-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:28.383Z",
    "version": "WzM5LDFd",
    "attributes": {
      "last_checkin": "2019-12-02T18:42:28.381Z"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7d095360-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-12-02T18:42:28.381Z"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:28.383Z",
        "version": "WzM5LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7edf24d0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:30.429Z",
    "version": "WzQxLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "7f7aa180-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:31.448Z",
    "version": "WzQyLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "7edf24d0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:32.466Z",
    "version": "WzQzLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "7f7aa180-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:33.485Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "7edf24d0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:32.466Z",
    "version": "WzQzLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "7f7aa180-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:33.485Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7edf24d0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:32.466Z",
        "version": "WzQzLDFd"
      },
      {
        "type": "agents",
        "id": "7f7aa180-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:33.485Z",
        "version": "WzQ0LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8282ff80-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:36.536Z",
    "version": "WzQ3LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "831f8da0-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:37.562Z",
    "version": "WzQ4LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8282ff80-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:36.536Z",
        "version": "WzQ3LDFd"
      },
      {
        "type": "agents",
        "id": "831f8da0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:37.562Z",
        "version": "WzQ4LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "8282ff80-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:38.643Z",
    "version": "WzQ5LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "831f8da0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:39.629Z",
    "version": "WzUwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "8282ff80-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:38.643Z",
    "version": "WzQ5LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "831f8da0-1533-11ea-a3c9-5b99a65c0d97",
    "type": "agents",
    "updated_at": "2019-12-02T18:42:39.629Z",
    "version": "WzUwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8282ff80-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:38.643Z",
        "version": "WzQ5LDFd"
      },
      {
        "type": "agents",
        "id": "831f8da0-1533-11ea-a3c9-5b99a65c0d97",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-02T18:42:39.629Z",
        "version": "WzUwLDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "862ea260-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:42.694Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "86cabb50-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:43.717Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8766ad30-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:44.739Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "88016690-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-02T18:37:42.692Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:45.753Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "889b0e80-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-02T18:42:42.692Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:46.760Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "8939bf80-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-02T18:42:42.692Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:47.800Z",
    "version": "WzU4LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "89d31950-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-02T18:37:42.692Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:48.805Z",
    "version": "WzU5LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "8a6f8060-1533-11ea-a3c9-5b99a65c0d97",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-02T18:42:42.692Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-02T18:42:49.830Z",
    "version": "WzYwLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "eefb7a20-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T15:59:51.480Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T15:59:51.489Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "eefb7a20-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T15:59:51.832Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "eefb7a20-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T15:59:51.480Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T15:59:51.832Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T15:59:53.915Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T15:59:53.917Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T15:59:54.917Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T15:59:55.942Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T15:59:53.915Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T15:59:55.942Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T15:59:56.964Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T15:59:56.962Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T15:59:57.977Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f06dced0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T15:59:56.962Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-09T15:59:57.977Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "f4113450-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:00:00.019Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:00.021Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "f4113450-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:01.041Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f4113450-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:00:00.019Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:01.041Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f4113450-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:00:00.019Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:01.041Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f5e46db0-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-09T16:00:03.080Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:03.083Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "f5e46db0-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:04.157Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f5e46db0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-09T16:00:03.080Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:04.157Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "f7bcd730-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:06.179Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "f8f53020-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:08.226Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "f8f53020-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:09.209Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "f8f53020-1a9c-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:09.209Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "f8f53020-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:09.209Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "fac3d5a0-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:11.257Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "fb5d5680-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:12.264Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fac3d5a0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:11.257Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "fb5d5680-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:12.264Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fac3d5a0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:11.257Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "fb5d5680-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:12.264Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should throw if the agens do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should throw if the agens do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should throw is the agent is not active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should throw is the agent is not active - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "fd4f6280-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "actions": [],
      "active": false,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:15.527Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fd4f6280-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "actions": [],
          "active": false,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:15.527Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "fe6abd90-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:17.385Z",
    "version": "WzI4LDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "fe6abd90-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:17.385Z",
        "version": "WzI4LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "ff9ef7d0-1a9c-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:19.404Z",
    "version": "WzMwLDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "ff9ef7d0-1a9c-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:19.404Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "00d5f130-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:21.443Z",
    "version": "WzMyLDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "00d5f130-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:21.443Z",
        "version": "WzMyLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "020b63f0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:23.471Z",
    "version": "WzM0LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "020b63f0-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:23.471Z",
        "version": "WzM0LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "03414be0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:25.502Z",
    "version": "WzM2LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "03dc5360-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:26.518Z",
    "version": "WzM3LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "03414be0-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:27.533Z",
    "version": "WzM4LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "03dc5360-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:28.543Z",
    "version": "WzM5LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "03414be0-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:27.533Z",
    "version": "WzM4LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "03dc5360-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:28.543Z",
    "version": "WzM5LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "03414be0-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:27.533Z",
        "version": "WzM4LDFd"
      },
      {
        "type": "agents",
        "id": "03dc5360-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:28.543Z",
        "version": "WzM5LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "06e41520-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:31.602Z",
    "version": "WzQyLDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "077f1ca0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:32.618Z",
    "version": "WzQzLDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "06e41520-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:31.602Z",
        "version": "WzQyLDFd"
      },
      {
        "type": "agents",
        "id": "077f1ca0-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:32.618Z",
        "version": "WzQzLDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "06e41520-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:33.677Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "077f1ca0-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:34.657Z",
    "version": "WzQ1LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "06e41520-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:33.677Z",
    "version": "WzQ0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "077f1ca0-1a9d-11ea-b7b1-f71b5c3e1516",
    "type": "agents",
    "updated_at": "2019-12-09T16:00:34.657Z",
    "version": "WzQ1LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "06e41520-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:33.677Z",
        "version": "WzQ0LDFd"
      },
      {
        "type": "agents",
        "id": "077f1ca0-1a9d-11ea-b7b1-f71b5c3e1516",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:00:34.657Z",
        "version": "WzQ1LDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "0a87c8c0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:37.707Z",
    "version": "WzQ4LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "0b22f750-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:38.725Z",
    "version": "WzQ5LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "0bbbdbf0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:39.727Z",
    "version": "WzUwLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "0c584300-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T15:55:37.704Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:40.752Z",
    "version": "WzUxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "0cf34a80-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:00:37.704Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:41.768Z",
    "version": "WzUyLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "0d8e2af0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:00:37.704Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:42.783Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "0e293270-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T15:55:37.704Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:43.799Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "0ec439f0-1a9d-11ea-b7b1-f71b5c3e1516",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:00:37.704Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:00:44.815Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "328e1a30-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:08:54.349Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:08:54.354Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "328e1a30-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:08:55.073Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "328e1a30-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:08:54.349Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:08:55.073Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:08:57.116Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:08:57.120Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:08:58.129Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:08:59.149Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:08:57.116Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:08:59.149Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:00.176Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:09:00.173Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:01.189Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "34340200-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:09:00.173Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:01.189Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "37d878f0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:09:03.228Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:03.231Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "37d878f0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:04.244Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "37d878f0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:09:03.228Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:04.244Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "37d878f0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:09:03.228Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:04.244Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "39aaef00-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-09T16:09:06.285Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:06.288Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "39aaef00-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:07.300Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "39aaef00-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-09T16:09:06.285Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:07.300Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "3b855450-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:09.397Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "3cd92480-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:11.624Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "3cd92480-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:12.438Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "3cd92480-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:12.438Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3cd92480-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:12.438Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "3e8d3d20-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:14.482Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "3f281d90-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:15.497Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3e8d3d20-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:14.482Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "3f281d90-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:15.497Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "3e8d3d20-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:14.482Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "3f281d90-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:15.497Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "40fa1e70-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:18.551Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "40fa1e70-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:18.551Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:41961050-1a9e-11ea-a846-67ce6d839a90",
        "type": "agent_events",
        "error": {
          "message": "mapping set to strict, dynamic introduction of [policy_id] within [agent_events] is not allowed"
        }
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (7)'] = {
  "results": {
    "id": "40fa1e70-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:19.590Z",
    "version": "WzI3LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:09:19.567Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (8)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "40fa1e70-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T16:09:19.567Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:19.590Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "42cb8310-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:21.601Z",
    "version": "WzI5LDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "42cb8310-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:21.601Z",
        "version": "WzI5LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "42cb8310-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:22.690Z",
    "version": "WzMwLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:09:22.668Z"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "42cb8310-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:22.690Z",
    "version": "WzMwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:09:22.668Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "42cb8310-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:09:22.668Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:22.690Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "44b2e0b0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:24.795Z",
    "version": "WzMyLDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "44b2e0b0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:24.795Z",
        "version": "WzMyLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "44b2e0b0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:25.810Z",
    "version": "WzMzLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:09:25.807Z",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "44b2e0b0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:25.810Z",
    "version": "WzMzLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:09:25.807Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "44b2e0b0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:09:25.807Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:25.810Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "4681ad40-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:27.828Z",
    "version": "WzM1LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4681ad40-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:27.828Z",
        "version": "WzM1LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "4681ad40-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:28.851Z",
    "version": "WzM2LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:09:28.848Z"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4681ad40-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-12-09T16:09:28.848Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:28.851Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "4850c7f0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:30.863Z",
    "version": "WzM4LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "48ec6bb0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:31.883Z",
    "version": "WzM5LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "4850c7f0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:32.923Z",
    "version": "WzQwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "48ec6bb0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:33.941Z",
    "version": "WzQxLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "4850c7f0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:32.923Z",
    "version": "WzQwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "48ec6bb0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:33.941Z",
    "version": "WzQxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4850c7f0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:32.923Z",
        "version": "WzQwLDFd"
      },
      {
        "type": "agents",
        "id": "48ec6bb0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:33.941Z",
        "version": "WzQxLDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "4bf62940-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:36.980Z",
    "version": "WzQ0LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "4c9109b0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:37.994Z",
    "version": "WzQ1LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4bf62940-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:36.980Z",
        "version": "WzQ0LDFd"
      },
      {
        "type": "agents",
        "id": "4c9109b0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:37.994Z",
        "version": "WzQ1LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "4bf62940-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:39.049Z",
    "version": "WzQ2LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "4c9109b0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:40.043Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "4bf62940-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:39.049Z",
    "version": "WzQ2LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "4c9109b0-1a9e-11ea-a846-67ce6d839a90",
    "type": "agents",
    "updated_at": "2019-12-09T16:09:40.043Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "4bf62940-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:39.049Z",
        "version": "WzQ2LDFd"
      },
      {
        "type": "agents",
        "id": "4c9109b0-1a9e-11ea-a846-67ce6d839a90",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:09:40.043Z",
        "version": "WzQ3LDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "4fa06c90-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:43.129Z",
    "version": "WzUwLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "5035a7b0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:44.107Z",
    "version": "WzUxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "50d0af30-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:45.123Z",
    "version": "WzUyLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "516b8fa0-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:04:43.125Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:46.138Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "5203ff10-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:09:43.125Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:47.136Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "52a03f10-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:09:43.125Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:48.161Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "533af870-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:04:43.125Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:49.175Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "53d47950-1a9e-11ea-a846-67ce6d839a90",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy:1",
      "last_checkin": "2019-12-09T16:09:43.125Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:09:50.181Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agent_events" (13)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"KQLSyntaxError: Expected AND, OR, end of input, whitespace but \\\":\\\" found.\\nagent_events.attributes.policy_id:policy:1\\n----------------------------------------^: Bad Request\",\"name\":\"Error\",\"stack\":\"Error: KQLSyntaxError: Expected AND, OR, end of input, whitespace but \\\":\\\" found.\\nagent_events.attributes.policy_id:policy:1\\n----------------------------------------^: Bad Request\\n    at Function.createBadRequestError (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:91:36)\\n    at SavedObjectsRepository.find (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:458:40)\\n    at SavedObjectsClient.find (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/saved_objects_client.ts:236:35)\\n    at SODatabaseAdapter.find (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/default.ts:122:39)\\n    at _slapshot.default.memorize (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/memorize_adapter.ts:110:32)\\n    at Object.memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:62:33)\\n    at MemorizeSODatabaseAdapter.find (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/memorize_adapter.ts:104:21)\\n    at AgentEventsRepository.list (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/repositories/agent_events/default.ts:73:59)\\n    at AgentEventLib.getEventsCountForPolicyId (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/agent_event.ts:50:56)\\n    at AgentLib.getAgentsStatusForPolicy (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/agent.ts:302:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"isBoom\":true,\"isServer\":false,\"data\":null,\"output\":{\"statusCode\":400,\"payload\":{\"message\":\"KQLSyntaxError: Expected AND, OR, end of input, whitespace but \\\":\\\" found.\\nagent_events.attributes.policy_id:policy:1\\n----------------------------------------^: Bad Request\",\"statusCode\":400,\"error\":\"Bad Request\"},\"headers\":{}}}",
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "04192360-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:14:45.902Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:14:45.910Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "04192360-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:46.005Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "04192360-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:14:45.902Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:46.005Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:14:48.047Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:14:48.052Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:49.093Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:50.124Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:14:48.047Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:50.124Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:51.151Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:14:51.147Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:52.168Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "055ffb40-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:14:51.147Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:52.168Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "090caf90-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:14:54.213Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:14:54.217Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "090caf90-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:55.225Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "090caf90-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:14:54.213Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:55.225Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "090caf90-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:14:54.213Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:55.225Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "0adfc1e0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-09T16:14:57.274Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:14:57.278Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "0adfc1e0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:14:58.301Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "0adfc1e0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-09T16:14:57.274Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:14:58.301Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "0cb32250-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:00.341Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "0deb5430-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:02.387Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "0deb5430-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:03.394Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "0deb5430-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:03.394Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "0deb5430-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:03.394Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "0fbd7c20-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:05.441Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1056d5f0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:06.447Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "0fbd7c20-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:05.441Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "1056d5f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:06.447Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "0fbd7c20-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:05.441Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "1056d5f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:06.447Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "122924f0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:09.503Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "122924f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:09.503Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:12c7fd00-1a9f-11ea-8558-a35c1d99412a",
        "type": "agent_events",
        "error": {
          "message": "mapping set to strict, dynamic introduction of [policy_id] within [agent_events] is not allowed"
        }
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (7)'] = {
  "results": {
    "id": "122924f0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:10.562Z",
    "version": "WzI3LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:15:10.539Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (8)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "122924f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T16:15:10.539Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:10.562Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "13fc3740-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:12.564Z",
    "version": "WzI5LDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "13fc3740-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:12.564Z",
        "version": "WzI5LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "13fc3740-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:13.597Z",
    "version": "WzMwLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:15:13.592Z"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "13fc3740-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:13.597Z",
    "version": "WzMwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:15:13.592Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "13fc3740-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:15:13.592Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:13.597Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "15e23550-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:15.748Z",
    "version": "WzMyLDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "15e23550-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:15.748Z",
        "version": "WzMyLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "15e23550-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:16.780Z",
    "version": "WzMzLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:15:16.775Z",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "15e23550-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:16.780Z",
    "version": "WzMzLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:15:16.775Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "15e23550-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:15:16.775Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:16.780Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "17b8f120-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:18.834Z",
    "version": "WzM1LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "17b8f120-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:18.834Z",
        "version": "WzM1LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "17b8f120-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:19.857Z",
    "version": "WzM2LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:15:19.852Z"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "17b8f120-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-12-09T16:15:19.852Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:19.857Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "19899270-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:21.878Z",
    "version": "WzM4LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1a23fdb0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:22.891Z",
    "version": "WzM5LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "19899270-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:23.918Z",
    "version": "WzQwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "1a23fdb0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:24.937Z",
    "version": "WzQxLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "19899270-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:23.918Z",
    "version": "WzQwLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "1a23fdb0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:24.937Z",
    "version": "WzQxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "19899270-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:23.918Z",
        "version": "WzQwLDFd"
      },
      {
        "type": "agents",
        "id": "1a23fdb0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:24.937Z",
        "version": "WzQxLDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "1d2cf7f0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:27.983Z",
    "version": "WzQ0LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "1dc7d860-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:28.998Z",
    "version": "WzQ1LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1d2cf7f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:27.983Z",
        "version": "WzQ0LDFd"
      },
      {
        "type": "agents",
        "id": "1dc7d860-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:28.998Z",
        "version": "WzQ1LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "1d2cf7f0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:30.060Z",
    "version": "WzQ2LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "1dc7d860-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:31.031Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "1d2cf7f0-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:30.060Z",
    "version": "WzQ2LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "1dc7d860-1a9f-11ea-8558-a35c1d99412a",
    "type": "agents",
    "updated_at": "2019-12-09T16:15:31.031Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "1d2cf7f0-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:30.060Z",
        "version": "WzQ2LDFd"
      },
      {
        "type": "agents",
        "id": "1dc7d860-1a9f-11ea-8558-a35c1d99412a",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:15:31.031Z",
        "version": "WzQ3LDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "20d71430-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:34.130Z",
    "version": "WzUwLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "216dd5f0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:35.119Z",
    "version": "WzUxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "22086840-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:36.132Z",
    "version": "WzUyLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "22a321a0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:10:34.123Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:37.146Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "233e2920-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:15:34.123Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:38.162Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "23d6e6b0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:15:34.123Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:39.162Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "247374d0-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:10:34.123Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:40.189Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "250db900-1a9f-11ea-8558-a35c1d99412a",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:15:34.123Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:15:41.200Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agent_events" (13)'] = {
  "thrownError": "{\"type\":\"Error\",\"message\":\"This key 'agent_events.attributes.policy_id' does NOT exist in agent_events saved object index patterns: Bad Request\",\"name\":\"Error\",\"stack\":\"Error: This key 'agent_events.attributes.policy_id' does NOT exist in agent_events saved object index patterns: Bad Request\\n    at Function.createBadRequestError (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/errors.ts:91:36)\\n    at validateConvertFilterToKueryNode (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/filter_utils.ts:47:38)\\n    at SavedObjectsRepository.find (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/lib/repository.ts:454:21)\\n    at SavedObjectsClient.find (/Users/nicolas/Workspace/kibana/src/core/server/saved_objects/service/saved_objects_client.ts:236:35)\\n    at SODatabaseAdapter.find (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/default.ts:122:39)\\n    at _slapshot.default.memorize (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/memorize_adapter.ts:110:32)\\n    at Object.memorize (/Users/nicolas/Workspace/kibana/node_modules/@mattapperson/slapshot/lib/memorize.js:62:33)\\n    at MemorizeSODatabaseAdapter.find (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/adapters/saved_objects_database/memorize_adapter.ts:104:21)\\n    at AgentEventsRepository.list (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/repositories/agent_events/default.ts:73:59)\\n    at AgentEventLib.getEventsCountForPolicyId (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/agent_event.ts:50:56)\\n    at AgentLib.getAgentsStatusForPolicy (/Users/nicolas/Workspace/kibana/x-pack/legacy/plugins/fleet/server/libs/agent.ts:302:38)\\n    at process._tickCallback (internal/process/next_tick.js:68:7)\",\"isBoom\":true,\"isServer\":false,\"data\":null,\"output\":{\"statusCode\":400,\"payload\":{\"message\":\"This key 'agent_events.attributes.policy_id' does NOT exist in agent_events saved object index patterns: Bad Request\",\"statusCode\":400,\"error\":\"Bad Request\"},\"headers\":{}}}",
  "results": null
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "853f2920-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:25:32.074Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:32.082Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "853f2920-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:32.909Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "853f2920-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:25:32.074Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:32.909Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:25:34.954Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:34.959Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:35.980Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:36.984Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:25:34.954Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:36.984Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:38.019Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:25:38.014Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:39.041Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "86f627f0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:25:38.014Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:39.041Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8a9dfa40-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T16:25:41.087Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:41.092Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "8a9dfa40-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:42.107Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8a9dfa40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:25:41.087Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:42.107Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8a9dfa40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T16:25:41.087Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:42.107Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "8c73a4a0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-09T16:25:44.163Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:44.170Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "8c73a4a0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:45.180Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8c73a4a0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-09T16:25:44.163Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:45.180Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "8e4445f0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:47.215Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "8f8e5220-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:49.378Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "8f8e5220-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:50.379Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "8f8e5220-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:50.379Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8f8e5220-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:50.379Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "915f4190-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:52.425Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "91f91090-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:53.433Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "915f4190-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:52.425Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "91f91090-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:53.433Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "915f4190-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:52.425Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "91f91090-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:53.433Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:25:56.483Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:56.483Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:94664000-1aa0-11ea-a639-c92ca15441cc",
        "type": "agent_events",
        "updated_at": "2019-12-09T16:25:57.504Z",
        "version": "WzI3LDFd",
        "attributes": {
          "agent_id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (7)'] = {
  "results": {
    "id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:25:58.522Z",
    "version": "WzI4LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:25:57.498Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (8)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "94664000-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "agent_id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:57.504Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "93ca9c40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T16:25:57.498Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:25:58.522Z",
        "version": "WzI4LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "9636ba40-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:00.548Z",
    "version": "WzMwLDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9636ba40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:00.548Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "9636ba40-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:01.590Z",
    "version": "WzMxLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:26:01.585Z"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "9636ba40-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:01.590Z",
    "version": "WzMxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:26:01.585Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9636ba40-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:26:01.585Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:01.590Z",
        "version": "WzMxLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "980a41c0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:03.612Z",
    "version": "WzMzLDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "980a41c0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:03.612Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "980a41c0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:04.638Z",
    "version": "WzM0LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:26:04.632Z",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "980a41c0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:04.638Z",
    "version": "WzM0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "last_checkin": "2019-12-09T16:26:04.632Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "980a41c0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "last_checkin": "2019-12-09T16:26:04.632Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:04.638Z",
        "version": "WzM0LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "99db0a20-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:06.657Z",
    "version": "WzM2LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "99db0a20-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:06.657Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "99db0a20-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:07.689Z",
    "version": "WzM3LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T16:26:07.683Z"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "99db0a20-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "last_checkin": "2019-12-09T16:26:07.683Z"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:07.689Z",
        "version": "WzM3LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "9bafca20-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:09.729Z",
    "version": "WzM5LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "9c4a5c70-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:10.743Z",
    "version": "WzQwLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "9bafca20-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:11.761Z",
    "version": "WzQxLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "9c4a5c70-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:12.777Z",
    "version": "WzQyLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "9bafca20-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:11.761Z",
    "version": "WzQxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "9c4a5c70-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:12.777Z",
    "version": "WzQyLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9bafca20-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:11.761Z",
        "version": "WzQxLDFd"
      },
      {
        "type": "agents",
        "id": "9c4a5c70-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:12.777Z",
        "version": "WzQyLDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "9f56b210-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:15.857Z",
    "version": "WzQ1LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "9ff27ce0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:16.878Z",
    "version": "WzQ2LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9f56b210-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:15.857Z",
        "version": "WzQ1LDFd"
      },
      {
        "type": "agents",
        "id": "9ff27ce0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:16.878Z",
        "version": "WzQ2LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "9f56b210-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:17.933Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "9ff27ce0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:18.909Z",
    "version": "WzQ4LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "9f56b210-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:17.933Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "9ff27ce0-1aa0-11ea-a639-c92ca15441cc",
    "type": "agents",
    "updated_at": "2019-12-09T16:26:18.909Z",
    "version": "WzQ4LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "9f56b210-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:17.933Z",
        "version": "WzQ3LDFd"
      },
      {
        "type": "agents",
        "id": "9ff27ce0-1aa0-11ea-a639-c92ca15441cc",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T16:26:18.909Z",
        "version": "WzQ4LDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "a2ffbce0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:21.998Z",
    "version": "WzUxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "a3976900-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:22.992Z",
    "version": "WzUyLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "a432e5b0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:24.011Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "a4cf25b0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:21:21.992Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:25.035Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "a56d3a70-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:26:21.992Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:26.071Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "a6086900-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:26:21.992Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:27.088Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "a6a23800-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:21:21.992Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:28.096Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "a73ddbc0-1aa0-11ea-a639-c92ca15441cc",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T16:26:21.992Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T16:26:29.116Z",
    "version": "WzU4LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agent_events" (13)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should throw if the enrollment api key is not valid - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - find:"agents" (2)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "73ea57a0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "policy_id": "policyId",
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T18:33:53.938Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T18:33:53.946Z",
    "version": "WzIsMV0="
  }
}

exports['Agent lib Enroll Should enroll a new PERMANENT agent - update:agents (4)'] = {
  "results": {
    "id": "73ea57a0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:33:54.400Z",
    "version": "WzMsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "73ea57a0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "policy_id": "policyId",
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T18:33:53.938Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:33:54.400Z",
        "version": "WzMsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T18:33:56.446Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T18:33:56.452Z",
    "version": "WzUsMV0="
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (5)'] = {
  "results": {
    "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:33:57.456Z",
    "version": "WzYsMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (6)'] = {
  "results": {
    "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:33:58.479Z",
    "version": "WzcsMV0=",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - find:"agents" (7)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "shared_id": "agent-1",
          "active": false,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T18:33:56.446Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:33:58.479Z",
        "version": "WzcsMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (8)'] = {
  "results": {
    "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:33:59.515Z",
    "version": "WzgsMV0=",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T18:33:59.509Z"
    }
  }
}

exports['Agent lib Enroll Should allow to enroll a new PERMANENT agent again if this agent is active - update:agents (9)'] = {
  "results": {
    "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:00.541Z",
    "version": "WzksMV0=",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-2"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7568e150-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T18:33:59.509Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-2"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:00.541Z",
        "version": "WzksMV0="
      }
    ]
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (3)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "791128d0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "shared_id": "agent-1",
      "active": true,
      "type": "PERMANENT",
      "enrolled_at": "2019-12-09T18:34:02.583Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:02.589Z",
    "version": "WzExLDFd"
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - update:agents (5)'] = {
  "results": {
    "id": "791128d0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:03.765Z",
    "version": "WzEyLDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Enroll Should not enroll a new PERMANENT agent if this agent is already active - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "791128d0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T18:34:02.583Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:03.765Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "791128d0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "shared_id": "agent-1",
          "active": true,
          "type": "PERMANENT",
          "enrolled_at": "2019-12-09T18:34:02.583Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:03.765Z",
        "version": "WzEyLDFd"
      }
    ]
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - delete (2)'] = {
  "results": {}
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7afa3420-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "active": true,
      "policy_id": "policyId",
      "type": "EPHEMERAL",
      "enrolled_at": "2019-12-09T18:34:05.788Z",
      "user_provided_metadata": "{}",
      "local_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:05.794Z",
    "version": "WzE0LDFd"
  }
}

exports['Agent lib Enroll Should enroll a new EPHEMERAL agent - update:agents (4)'] = {
  "results": {
    "id": "7afa3420-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:06.820Z",
    "version": "WzE1LDFd",
    "attributes": {
      "access_api_key_id": "mock-access-api-key-id-1"
    }
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7afa3420-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "active": true,
          "policy_id": "policyId",
          "type": "EPHEMERAL",
          "enrolled_at": "2019-12-09T18:34:05.788Z",
          "user_provided_metadata": "{}",
          "local_metadata": "{}",
          "actions": [],
          "access_api_key_id": "mock-access-api-key-id-1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:06.820Z",
        "version": "WzE1LDFd"
      }
    ]
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (2)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7ccd4670-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "EPHEMERAL",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:08.855Z",
    "version": "WzE3LDFd"
  }
}

exports['Agent lib Delete should delete ephemeral instances - find:"agent_events" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should delete ephemeral instances - delete (5)'] = {
  "results": {}
}

exports['Agent lib Delete should delete ephemeral instances - get:agents (6)'] = {
  "results": null
}

exports['Agent lib Delete should desactivate other agent - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib Delete should desactivate other agent - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "7e0662b0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:10.907Z",
    "version": "WzE5LDFd"
  }
}

exports['Agent lib Delete should desactivate other agent - update:agents (3)'] = {
  "results": {
    "id": "7e0662b0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:11.904Z",
    "version": "WzIwLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib Delete should desactivate other agent - get:agents (4)'] = {
  "results": {
    "id": "7e0662b0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:11.904Z",
    "version": "WzIwLDFd",
    "attributes": {
      "type": "PERMANENT",
      "active": false,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": []
  }
}

exports['Agent lib list should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7e0662b0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "type": "PERMANENT",
          "active": false,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:11.904Z",
        "version": "WzIwLDFd"
      }
    ]
  }
}

exports['Agent lib list should return all agents - delete (2)'] = {
  "results": {}
}

exports['Agent lib list should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "7fd6b5e0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:13.950Z",
    "version": "WzIyLDFd"
  }
}

exports['Agent lib list should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8072ced0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:14.973Z",
    "version": "WzIzLDFd"
  }
}

exports['Agent lib list should return all agents - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7fd6b5e0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:13.950Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "8072ced0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:14.973Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "7fd6b5e0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:13.950Z",
        "version": "WzIyLDFd"
      },
      {
        "type": "agents",
        "id": "8072ced0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "type": "PERMANENT",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:14.973Z",
        "version": "WzIzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - delete (3)'] = {
  "results": {}
}

exports['Agent lib checkin should persist new events - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:18.026Z",
    "version": "WzI2LDFd"
  }
}

exports['Agent lib checkin should persist new events - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:18.026Z",
        "version": "WzI2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - bulkCreate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:82e09a80-1ab2-11ea-87f3-15c6e4c52a46",
        "type": "agent_events",
        "updated_at": "2019-12-09T18:34:19.047Z",
        "version": "WzI3LDFd",
        "attributes": {
          "agent_id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": []
      }
    ]
  }
}

exports['Agent lib checkin should persist new events - update:agents (7)'] = {
  "results": {
    "id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:20.060Z",
    "version": "WzI4LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T18:34:19.041Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib checkin should persist new events - find:"agent_events" (8)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "82e09a80-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "agent_id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
          "timestamp": "2019-09-05T15:41:26+0000",
          "type": "STATE",
          "subtype": "STARTING",
          "message": "State changed from PAUSE to STARTING",
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:19.047Z",
        "version": "WzI3LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8244a8a0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T18:34:19.041Z"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:20.060Z",
        "version": "WzI4LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should not update agent metadata if none are provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "84b1ff20-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:22.097Z",
    "version": "WzMwLDFd"
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "84b1ff20-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:22.097Z",
        "version": "WzMwLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - update:agents (5)'] = {
  "results": {
    "id": "84b1ff20-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:23.144Z",
    "version": "WzMxLDFd",
    "attributes": {
      "last_checkin": "2019-12-09T18:34:23.138Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib checkin should not update agent metadata if none are provided - get:agents (6)'] = {
  "results": {
    "id": "84b1ff20-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:23.144Z",
    "version": "WzMxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "current_errors_events": "[]",
      "last_checkin": "2019-12-09T18:34:23.138Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "84b1ff20-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T18:34:23.138Z"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:23.144Z",
        "version": "WzMxLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should update agent metadata if provided - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "86869810-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:25.169Z",
    "version": "WzMzLDFd"
  }
}

exports['Agent lib checkin should update agent metadata if provided - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "86869810-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:25.169Z",
        "version": "WzMzLDFd"
      }
    ]
  }
}

exports['Agent lib checkin should update agent metadata if provided - update:agents (5)'] = {
  "results": {
    "id": "86869810-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:26.196Z",
    "version": "WzM0LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T18:34:26.190Z",
      "current_errors_events": "[]",
      "local_metadata": "{\"key\":\"local2\"}"
    }
  }
}

exports['Agent lib checkin should update agent metadata if provided - get:agents (6)'] = {
  "results": {
    "id": "86869810-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:26.196Z",
    "version": "WzM0LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local2\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "current_errors_events": "[]",
      "last_checkin": "2019-12-09T18:34:26.190Z"
    },
    "references": []
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "86869810-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local2\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T18:34:26.190Z"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:26.196Z",
        "version": "WzM0LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - delete (2)'] = {
  "results": {}
}

exports['Agent lib checkin should return new actions - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "88593530-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "active": true,
      "policy_id": "policy:1",
      "access_api_key_id": "key1",
      "actions": [
        {
          "created_at": "2019-09-05T15:43:26+0000",
          "type": "PAUSE",
          "id": "this-a-unique-id"
        },
        {
          "created_at": "2019-09-05T15:41:26+0000",
          "type": "PAUSE",
          "sent_at": "2019-09-05T15:42:26+0000",
          "id": "this-a-unique-id-already-sent"
        }
      ],
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:28.227Z",
    "version": "WzM2LDFd"
  }
}

exports['Agent lib checkin should return new actions - find:"agents" (4)'] = {
  "results": {
    "page": 1,
    "per_page": 20,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "88593530-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:28.227Z",
        "version": "WzM2LDFd"
      }
    ]
  }
}

exports['Agent lib checkin should return new actions - update:agents (5)'] = {
  "results": {
    "id": "88593530-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:29.246Z",
    "version": "WzM3LDFd",
    "attributes": {
      "last_checkin": "2019-12-09T18:34:29.239Z",
      "current_errors_events": "[]"
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agents",
        "id": "88593530-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "active": true,
          "policy_id": "policy:1",
          "access_api_key_id": "key1",
          "actions": [
            {
              "created_at": "2019-09-05T15:43:26+0000",
              "type": "PAUSE",
              "id": "this-a-unique-id"
            },
            {
              "created_at": "2019-09-05T15:41:26+0000",
              "type": "PAUSE",
              "sent_at": "2019-09-05T15:42:26+0000",
              "id": "this-a-unique-id-already-sent"
            }
          ],
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "current_errors_events": "[]",
          "last_checkin": "2019-12-09T18:34:29.239Z"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:29.246Z",
        "version": "WzM3LDFd"
      }
    ]
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "8a2876f0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:31.263Z",
    "version": "WzM5LDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8ac7eb40-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:32.308Z",
    "version": "WzQwLDFd"
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (5)'] = {
  "results": {
    "id": "8a2876f0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:33.328Z",
    "version": "WzQxLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - update:agents (6)'] = {
  "results": {
    "id": "8ac7eb40-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:34.346Z",
    "version": "WzQyLDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (7)'] = {
  "results": {
    "id": "8a2876f0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:33.328Z",
    "version": "WzQxLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenroll should set the list of agents as inactive - get:agents (8)'] = {
  "results": {
    "id": "8ac7eb40-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:34.346Z",
    "version": "WzQyLDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8a2876f0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:33.328Z",
        "version": "WzQxLDFd"
      },
      {
        "type": "agents",
        "id": "8ac7eb40-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:34.346Z",
        "version": "WzQyLDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (2)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - delete (3)'] = {
  "results": {}
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "8dd26c20-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:37.410Z",
    "version": "WzQ1LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "8e6d9ab0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": true,
      "policy_id": "policy:1"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:38.427Z",
    "version": "WzQ2LDFd"
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (6)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8dd26c20-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:37.410Z",
        "version": "WzQ1LDFd"
      },
      {
        "type": "agents",
        "id": "8e6d9ab0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": true,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:38.427Z",
        "version": "WzQ2LDFd"
      }
    ]
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (7)'] = {
  "results": {
    "id": "8dd26c20-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:39.482Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - update:agents (8)'] = {
  "results": {
    "id": "8e6d9ab0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:40.454Z",
    "version": "WzQ4LDFd",
    "attributes": {
      "active": false
    }
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - find:"agents" (9)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (10)'] = {
  "results": {
    "id": "8dd26c20-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:39.482Z",
    "version": "WzQ3LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib unenrollForPolicy should set all the of agents for this policy as inactive - get:agents (11)'] = {
  "results": {
    "id": "8e6d9ab0-1ab2-11ea-87f3-15c6e4c52a46",
    "type": "agents",
    "updated_at": "2019-12-09T18:34:40.454Z",
    "version": "WzQ4LDFd",
    "attributes": {
      "local_metadata": "{\"key\":\"local1\"}",
      "user_provided_metadata": "{\"key\":\"user1\"}",
      "actions": [],
      "active": false,
      "policy_id": "policy:1"
    },
    "references": []
  }
}

exports['Agent lib addAction should throw if the agent do not exists - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 2,
    "saved_objects": [
      {
        "type": "agents",
        "id": "8dd26c20-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:39.482Z",
        "version": "WzQ3LDFd"
      },
      {
        "type": "agents",
        "id": "8e6d9ab0-1ab2-11ea-87f3-15c6e4c52a46",
        "attributes": {
          "local_metadata": "{\"key\":\"local1\"}",
          "user_provided_metadata": "{\"key\":\"user1\"}",
          "actions": [],
          "active": false,
          "policy_id": "policy:1"
        },
        "references": [],
        "updated_at": "2019-12-09T18:34:40.454Z",
        "version": "WzQ4LDFd"
      }
    ]
  }
}

exports['Agent lib addAction should throw if the agent do not exists - delete (2)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - delete (3)'] = {
  "results": {}
}

exports['Agent lib addAction should throw if the agent do not exists - get:agents (4)'] = {
  "results": null
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "9182a2e0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy2",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:43.597Z",
    "version": "WzUxLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "921286d0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:44.540Z",
    "version": "WzUyLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "92ac55d0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy3",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:45.549Z",
    "version": "WzUzLDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (5)'] = {
  "results": {
    "type": "agents",
    "id": "93453a70-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T18:29:43.559Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:46.551Z",
    "version": "WzU0LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (6)'] = {
  "results": {
    "type": "agents",
    "id": "93f80fb0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T18:34:43.559Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:47.723Z",
    "version": "WzU1LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (7)'] = {
  "results": {
    "type": "agents",
    "id": "949009f0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "PERMANENT",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T18:34:43.559Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:48.719Z",
    "version": "WzU2LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (8)'] = {
  "results": {
    "type": "agents",
    "id": "95360df0-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T18:29:43.559Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:49.807Z",
    "version": "WzU3LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - create:agents (9)'] = {
  "results": {
    "type": "agents",
    "id": "95d3d490-1ab2-11ea-87f3-15c6e4c52a46",
    "attributes": {
      "type": "TEMPORARY",
      "active": true,
      "policy_id": "policy1",
      "last_checkin": "2019-12-09T18:34:43.559Z",
      "local_metadata": "{}",
      "user_provided_metadata": "{}"
    },
    "references": [],
    "updated_at": "2019-12-09T18:34:50.841Z",
    "version": "WzU4LDFd"
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (10)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 5,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (11)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agents" (12)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 1,
    "saved_objects": []
  }
}

exports['Agent lib getAgentsStatusForPolicy should return all agents - find:"agent_events" (13)'] = {
  "results": {
    "page": 1,
    "per_page": 0,
    "total": 0,
    "saved_objects": []
  }
}
