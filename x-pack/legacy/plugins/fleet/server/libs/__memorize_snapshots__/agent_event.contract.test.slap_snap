
exports['AgentEvent Lib processEventsForCheckin Should do nothing if there is no events - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should do nothing if there is no events - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should do nothing if there is no events - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a stream if there is a stream error event - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a stream if there is a stream error event - bulkCreate (2)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:50440b40-1b7d-11ea-a706-097226cc247e",
        "type": "agent_events",
        "updated_at": "2019-12-10T18:46:01.972Z",
        "version": "WzIsMV0=",
        "attributes": {
          "message": "Invalid path /foo",
          "type": "ERROR",
          "subtype": "CONFIG",
          "stream_id": "stream-1",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": []
      }
    ]
  }
}

exports['AgentEvent Lib processEventsForCheckin Should do nothing if there is no events - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should clear error for a stream if there is a stream error event - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentEvent Lib processEventsForCheckin Should clear error for a stream if there is a stream error event - bulkCreate (2)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:f17b40f0-1b7d-11ea-be45-fd29436e34d2",
        "type": "agent_events",
        "updated_at": "2019-12-10T18:50:32.446Z",
        "version": "WzIsMV0=",
        "attributes": {
          "message": "Restarting",
          "type": "STATE",
          "subtype": "IN_PROGRESS",
          "stream_id": "stream-1",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": []
      }
    ]
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a stream if there is a stream error event - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "f17b40f0-1b7d-11ea-be45-fd29436e34d2",
        "attributes": {
          "message": "Restarting",
          "type": "STATE",
          "subtype": "IN_PROGRESS",
          "stream_id": "stream-1",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": [],
        "updated_at": "2019-12-10T18:50:32.446Z",
        "version": "WzIsMV0="
      }
    ]
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a stream if there is a stream error event - delete (2)'] = {
  "results": {}
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a stream if there is a stream error event - bulkCreate (3)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:f23ff080-1b7d-11ea-be45-fd29436e34d2",
        "type": "agent_events",
        "updated_at": "2019-12-10T18:50:33.736Z",
        "version": "WzQsMV0=",
        "attributes": {
          "message": "Invalid path /foo",
          "type": "ERROR",
          "subtype": "CONFIG",
          "stream_id": "stream-1",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": []
      }
    ]
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a policy if there is a global error event - find:"agent_events" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 1,
    "saved_objects": [
      {
        "type": "agent_events",
        "id": "f23ff080-1b7d-11ea-be45-fd29436e34d2",
        "attributes": {
          "message": "Invalid path /foo",
          "type": "ERROR",
          "subtype": "CONFIG",
          "stream_id": "stream-1",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": [],
        "updated_at": "2019-12-10T18:50:33.736Z",
        "version": "WzQsMV0="
      }
    ]
  }
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a policy if there is a global error event - delete (2)'] = {
  "results": {}
}

exports['AgentEvent Lib processEventsForCheckin Should set error for a policy if there is a global error event - bulkCreate (3)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "agent_events:f3751520-1b7d-11ea-be45-fd29436e34d2",
        "type": "agent_events",
        "updated_at": "2019-12-10T18:50:35.762Z",
        "version": "WzYsMV0=",
        "attributes": {
          "message": "Invalid path /foo",
          "type": "ERROR",
          "subtype": "CONFIG",
          "timestamp": "2019-11-07T18:43:46.773Z"
        },
        "references": []
      }
    ]
  }
}
