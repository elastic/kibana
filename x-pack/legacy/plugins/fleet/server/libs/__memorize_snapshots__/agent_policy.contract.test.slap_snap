
exports['AgentPolicy Lib updateAgentForPolicyId Should update the agent with the new policy - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentPolicy Lib updateAgentForPolicyId Should update the agent with the new policy - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-03T20:46:48.861Z",
    "version": "WzIsMV0="
  }
}

exports['AgentPolicy Lib updateAgentForPolicyId Should update the agent with the new policy - get:agents (3)'] = {
  "results": {
    "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:48.861Z",
    "version": "WzIsMV0=",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": []
  }
}

exports['AgentPolicy Lib updateAgentForPolicyId Should update the agent with the new policy - update:agents (4)'] = {
  "results": {
    "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:49.451Z",
    "version": "WzMsMV0=",
    "attributes": {
      "actions": [
        {
          "id": "b89e5542-f40e-4f4c-810f-d9b3f8322f14",
          "type": "POLICY_CHANGE",
          "created_at": "2019-12-03T20:46:49.450Z",
          "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}"
        }
      ]
    }
  }
}

exports['AgentPolicy Lib updateAgentForPolicyId Should update the agent with the new policy - get:agents (5)'] = {
  "results": {
    "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:49.451Z",
    "version": "WzMsMV0=",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": [
        {
          "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}",
          "created_at": "2019-12-03T20:46:49.450Z",
          "id": "b89e5542-f40e-4f4c-810f-d9b3f8322f14",
          "type": "POLICY_CHANGE"
        }
      ]
    },
    "references": []
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - find:"enrollment_api_keys" (1)'] = {
  "results": {
    "page": 1,
    "per_page": 1000,
    "total": 0,
    "saved_objects": []
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - create:agents (2)'] = {
  "results": {
    "type": "agents",
    "id": "07d2f340-160e-11ea-989f-e12ac0a7162a",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-03T20:46:50.484Z",
    "version": "WzQsMV0="
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - create:agents (3)'] = {
  "results": {
    "type": "agents",
    "id": "086a9f60-160e-11ea-989f-e12ac0a7162a",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-03T20:46:51.478Z",
    "version": "WzUsMV0="
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - create:agents (4)'] = {
  "results": {
    "type": "agents",
    "id": "0906b850-160e-11ea-989f-e12ac0a7162a",
    "attributes": {
      "policy_id": "policy2",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": [],
    "updated_at": "2019-12-03T20:46:52.501Z",
    "version": "WzYsMV0="
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - find:"agents" (5)'] = {
  "results": {
    "page": 1,
    "per_page": 100,
    "total": 3,
    "saved_objects": [
      {
        "type": "agents",
        "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
        "attributes": {
          "policy_id": "default",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "actions": [
            {
              "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}",
              "created_at": "2019-12-03T20:46:49.450Z",
              "id": "b89e5542-f40e-4f4c-810f-d9b3f8322f14",
              "type": "POLICY_CHANGE"
            }
          ]
        },
        "references": [],
        "updated_at": "2019-12-03T20:46:49.451Z",
        "version": "WzMsMV0="
      },
      {
        "type": "agents",
        "id": "07d2f340-160e-11ea-989f-e12ac0a7162a",
        "attributes": {
          "policy_id": "default",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "actions": []
        },
        "references": [],
        "updated_at": "2019-12-03T20:46:50.484Z",
        "version": "WzQsMV0="
      },
      {
        "type": "agents",
        "id": "086a9f60-160e-11ea-989f-e12ac0a7162a",
        "attributes": {
          "policy_id": "default",
          "active": true,
          "local_metadata": "{}",
          "user_provided_metadata": "{}",
          "actions": []
        },
        "references": [],
        "updated_at": "2019-12-03T20:46:51.478Z",
        "version": "WzUsMV0="
      }
    ]
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - bulkUpdate (6)'] = {
  "results": {
    "saved_objects": [
      {
        "id": "06db4cd0-160e-11ea-989f-e12ac0a7162a",
        "type": "agents",
        "updated_at": "2019-12-03T20:46:53.571Z",
        "version": "WzcsMV0=",
        "attributes": {
          "actions": [
            {
              "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}",
              "created_at": "2019-12-03T20:46:49.450Z",
              "id": "b89e5542-f40e-4f4c-810f-d9b3f8322f14",
              "type": "POLICY_CHANGE"
            },
            {
              "id": "57d10e58-be39-4d60-b946-e638750fc688",
              "type": "POLICY_CHANGE",
              "created_at": "2019-12-03T20:46:53.567Z",
              "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}"
            }
          ]
        }
      },
      {
        "id": "07d2f340-160e-11ea-989f-e12ac0a7162a",
        "type": "agents",
        "updated_at": "2019-12-03T20:46:53.571Z",
        "version": "WzgsMV0=",
        "attributes": {
          "actions": [
            {
              "id": "4b7fa740-4b30-47cd-8a41-5391fbbb235c",
              "type": "POLICY_CHANGE",
              "created_at": "2019-12-03T20:46:53.567Z",
              "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}"
            }
          ]
        }
      },
      {
        "id": "086a9f60-160e-11ea-989f-e12ac0a7162a",
        "type": "agents",
        "updated_at": "2019-12-03T20:46:53.571Z",
        "version": "WzksMV0=",
        "attributes": {
          "actions": [
            {
              "id": "f15986fa-fa64-4bca-981f-968fc37ae014",
              "type": "POLICY_CHANGE",
              "created_at": "2019-12-03T20:46:53.567Z",
              "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}"
            }
          ]
        }
      }
    ]
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - find:"agents" (7)'] = {
  "results": {
    "page": 2,
    "per_page": 100,
    "total": 3,
    "saved_objects": []
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - get:agents (8)'] = {
  "results": {
    "id": "07d2f340-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:53.571Z",
    "version": "WzgsMV0=",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": [
        {
          "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}",
          "created_at": "2019-12-03T20:46:53.567Z",
          "id": "4b7fa740-4b30-47cd-8a41-5391fbbb235c",
          "type": "POLICY_CHANGE"
        }
      ]
    },
    "references": []
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - get:agents (9)'] = {
  "results": {
    "id": "086a9f60-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:53.571Z",
    "version": "WzksMV0=",
    "attributes": {
      "policy_id": "default",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": [
        {
          "data": "{\"policy\":{\"outputs\":{\"default\":{\"api_token\":\"slfhsdlfhjjkshfkjh:sdfsdfsdfsdf\",\"id\":\"default\",\"name\":\"Default\",\"type\":\"elasticsearch\",\"url\":\"https://localhost:9200\",\"tlsCert\":\"ldsjfldsjfljsdalkfjl;ksadh;kjsdha;kjhslgkjhsdalkghasdkgh\"}},\"streams\":[{\"metricsets\":[\"container\",\"cpu\"],\"id\":\"string\",\"type\":\"etc\",\"output\":{\"use_output\":\"default\"}}]}}",
          "created_at": "2019-12-03T20:46:53.567Z",
          "id": "f15986fa-fa64-4bca-981f-968fc37ae014",
          "type": "POLICY_CHANGE"
        }
      ]
    },
    "references": []
  }
}

exports['AgentPolicy Lib updateAgentsForPolicyId Should updates all agents with the new policy - get:agents (10)'] = {
  "results": {
    "id": "0906b850-160e-11ea-989f-e12ac0a7162a",
    "type": "agents",
    "updated_at": "2019-12-03T20:46:52.501Z",
    "version": "WzYsMV0=",
    "attributes": {
      "policy_id": "policy2",
      "active": true,
      "local_metadata": "{}",
      "user_provided_metadata": "{}",
      "actions": []
    },
    "references": []
  }
}
