/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: Anonymization Common Attributes
 *   version: 2026-02-10
 */

import { z } from '@kbn/zod';

export type ErrorResponse = z.infer<typeof ErrorResponse>;
export const ErrorResponse = z.object({
  /**
   * Human-readable error message.
   */
  message: z.string(),
});

export type AnonymizationTargetType = z.infer<typeof AnonymizationTargetType>;
export const AnonymizationTargetType = z.enum(['data_view', 'index_pattern', 'index']);
export type AnonymizationTargetTypeEnum = typeof AnonymizationTargetType.enum;
export const AnonymizationTargetTypeEnum = AnonymizationTargetType.enum;

export type SortOrder = z.infer<typeof SortOrder>;
export const SortOrder = z.enum(['asc', 'desc']);
export type SortOrderEnum = typeof SortOrder.enum;
export const SortOrderEnum = SortOrder.enum;

export type ProfileSortField = z.infer<typeof ProfileSortField>;
export const ProfileSortField = z.enum(['created_at', 'name', 'updated_at']);
export type ProfileSortFieldEnum = typeof ProfileSortField.enum;
export const ProfileSortFieldEnum = ProfileSortField.enum;

export type ReplacementsScopeType = z.infer<typeof ReplacementsScopeType>;
export const ReplacementsScopeType = z.enum(['thread', 'execution']);
export type ReplacementsScopeTypeEnum = typeof ReplacementsScopeType.enum;
export const ReplacementsScopeTypeEnum = ReplacementsScopeType.enum;

export type FieldRule = z.infer<typeof FieldRule>;
export const FieldRule = z.object({
  field: z.string(),
  allowed: z.boolean(),
  anonymized: z.boolean(),
  entityClass: z.string().optional(),
});

export type RegexRule = z.infer<typeof RegexRule>;
export const RegexRule = z.object({
  id: z.string(),
  type: z.literal('regex'),
  entityClass: z.string(),
  pattern: z.string(),
  enabled: z.boolean(),
});

export type NerRule = z.infer<typeof NerRule>;
export const NerRule = z.object({
  id: z.string(),
  type: z.literal('ner'),
  modelId: z.string(),
  allowedEntityClasses: z.array(z.string()),
  enabled: z.boolean(),
});

export type AnonymizationProfileRules = z.infer<typeof AnonymizationProfileRules>;
export const AnonymizationProfileRules = z.object({
  fieldRules: z.array(FieldRule),
  regexRules: z.array(RegexRule).optional().default([]),
  nerRules: z.array(NerRule).optional().default([]),
});

export type CreateAnonymizationProfileRequest = z.infer<typeof CreateAnonymizationProfileRequest>;
export const CreateAnonymizationProfileRequest = z.object({
  name: z.string(),
  description: z.string().optional(),
  targetType: AnonymizationTargetType,
  targetId: z.string(),
  rules: AnonymizationProfileRules,
});

export type UpdateAnonymizationProfileRequest = z.infer<typeof UpdateAnonymizationProfileRequest>;
export const UpdateAnonymizationProfileRequest = z.object({
  name: z.string().optional(),
  description: z.string().optional(),
  rules: AnonymizationProfileRules.optional(),
});

export type AnonymizationProfile = z.infer<typeof AnonymizationProfile>;
export const AnonymizationProfile = z.object({
  id: z.string(),
  name: z.string(),
  description: z.string().optional(),
  targetType: AnonymizationTargetType,
  targetId: z.string(),
  rules: AnonymizationProfileRules,
  saltId: z.string(),
  namespace: z.string(),
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime(),
  createdBy: z.string(),
  updatedBy: z.string(),
});

export type FindProfilesResponse = z.infer<typeof FindProfilesResponse>;
export const FindProfilesResponse = z.object({
  page: z.number().int().min(1),
  perPage: z.number().int().min(1).max(1000),
  total: z.number().int().min(0),
  data: z.array(AnonymizationProfile),
});

export type ReplacementsSetResponse = z.infer<typeof ReplacementsSetResponse>;
export const ReplacementsSetResponse = z.object({
  id: z.string(),
  tokenToOriginal: z.object({}).catchall(z.string()),
  scopeType: ReplacementsScopeType,
  scopeId: z.string(),
  profileId: z.string(),
});

export type DeanonymizeRequest = z.infer<typeof DeanonymizeRequest>;
export const DeanonymizeRequest = z.object({
  text: z.string(),
  replacementsId: z.string(),
});

export type DeanonymizeResponse = z.infer<typeof DeanonymizeResponse>;
export const DeanonymizeResponse = z.object({
  text: z.string(),
});

export type ImportReplacementsRequest = z.infer<typeof ImportReplacementsRequest>;
export const ImportReplacementsRequest = z.object({
  sourceId: z.string(),
  destinationId: z.string(),
});

export type ImportReplacementsResponse = z.infer<typeof ImportReplacementsResponse>;
export const ImportReplacementsResponse = z.object({
  id: z.string(),
  merged: z.boolean(),
});
