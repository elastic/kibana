openapi: 3.0.0
info:
  title: An Attack discovery that is persisted as a (security) alert - Public API
  version: 'not applicable'
paths: {}
components:
  x-codegen-enabled: true
  schemas:
    AttackDiscoveryApiAlert:
      type: object
      description: An attack discovery that's also an alert (Public API with snake_case)
      required:
        - 'alert_ids'
        - 'connector_id'
        - 'connector_name'
        - 'details_markdown'
        - 'generation_uuid'
        - 'id'
        - 'summary_markdown'
        - 'timestamp'
        - 'title'
      properties:
        alert_ids:
          description: The alert IDs that the attack discovery is based on
          items:
            type: string
          type: array
        alert_rule_uuid:
          description: The optional kibana.alert.rule.uuid of the rule that generated this attack discovery (not applicable to ad hock runs)
          type: string
        alert_workflow_status:
          description: The optional kibana.alert.workflow_status of this attack discovery
          type: string
        connector_id:
          description: The ID of the connector that generated the attack discovery
          type: string
        connector_name:
          description: The (human readable) name of the connector that generated the attack discovery
          type: string
        alert_start:
          description: The optional time the attack discovery alert was created
          type: string
        alert_updated_at:
          description: The optional time the attack discovery alert was last updated
          type: string
        alert_updated_by_user_id:
          description: The optional id of the user who last updated the attack discovery alert
          type: string
        alert_updated_by_user_name:
          description: The optional username of the user who updated the attack discovery alert
          type: string
        alert_workflow_status_updated_at:
          description: The optional time the attack discovery alert workflow status was last updated
          type: string
        details_markdown:
          description: Details of the attack with bulleted markdown that always uses special syntax for field names and values from the source data.
          type: string
        entity_summary_markdown:
          description: An optional, short (no more than a sentence) summary of the attack discovery featuring only the host.name and user.name fields (when they are applicable), using the same syntax
          type: string
        generation_uuid:
          description: The generation ID of the run that created the attack discovery
          type: string
        id:
          description: The unique ID of the attack discovery
          type: string
        mitre_attack_tactics:
          description: An optional array of MITRE ATT&CK tactic for the attack discovery
          items:
            type: string
          type: array
        replacements:
          description: Key-value pairs that are used to replace placeholders in the markdown fields
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/Replacements'
        risk_score:
          description: The optional, (but typically populated after generation) risk score of the alert
          type: integer
        summary_markdown:
          description: A markdown summary of attack discovery, using the same syntax
          type: string
        timestamp:
          description: The time the attack discovery was generated
          $ref: '../common_attributes.schema.yaml#/components/schemas/NonEmptyTimestamp'
        title:
          description: A title for the attack discovery, in plain text
          type: string
        user_id:
          description: The optional id of the user who generated the attack discovery
          type: string
        user_name:
          description: The optional username of the user who generated the attack discovery, (not applicable to attack discoveries generated by rules)
          type: string
        users:
          type: array
          description: The optional array of users who may view the attack discovery. When empty, (or not present), all users may view the attack discovery.
          items:
            $ref: '../common_attributes.schema.yaml#/components/schemas/User'
        assignees:
          type: array
          description: The optional array of user-IDs who have been assigned the attack
          items:
            type: string
        tags:
          type: array
          description: The optional array of tags assigned the attack
          items:
            type: string
