/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: An Attack discovery that is persisted as a (security) alert - Public API
 *   version: not applicable
 */

import { z } from '@kbn/zod';

import { Replacements } from '../conversations/common_attributes.gen';
import { NonEmptyTimestamp, User } from '../common_attributes.gen';

/**
 * An attack discovery that's also an alert (Public API with snake_case)
 */
export type AttackDiscoveryApiAlert = z.infer<typeof AttackDiscoveryApiAlert>;
export const AttackDiscoveryApiAlert = z.object({
  /**
   * The alert IDs that the attack discovery is based on
   */
  alert_ids: z.array(z.string()),
  /**
   * The optional kibana.alert.rule.uuid of the rule that generated this attack discovery (not applicable to ad hock runs)
   */
  alert_rule_uuid: z.string().optional(),
  /**
   * The optional kibana.alert.workflow_status of this attack discovery
   */
  alert_workflow_status: z.string().optional(),
  /**
   * The ID of the connector that generated the attack discovery
   */
  connector_id: z.string(),
  /**
   * The (human readable) name of the connector that generated the attack discovery
   */
  connector_name: z.string(),
  /**
   * The optional time the attack discovery alert was created
   */
  alert_start: z.string().optional(),
  /**
   * The optional time the attack discovery alert was last updated
   */
  alert_updated_at: z.string().optional(),
  /**
   * The optional id of the user who last updated the attack discovery alert
   */
  alert_updated_by_user_id: z.string().optional(),
  /**
   * The optional username of the user who updated the attack discovery alert
   */
  alert_updated_by_user_name: z.string().optional(),
  /**
   * The optional time the attack discovery alert workflow status was last updated
   */
  alert_workflow_status_updated_at: z.string().optional(),
  /**
   * Details of the attack with bulleted markdown that always uses special syntax for field names and values from the source data.
   */
  details_markdown: z.string(),
  /**
   * An optional, short (no more than a sentence) summary of the attack discovery featuring only the host.name and user.name fields (when they are applicable), using the same syntax
   */
  entity_summary_markdown: z.string().optional(),
  /**
   * The generation ID of the run that created the attack discovery
   */
  generation_uuid: z.string(),
  /**
   * The unique ID of the attack discovery
   */
  id: z.string(),
  /**
   * An optional array of MITRE ATT&CK tactic for the attack discovery
   */
  mitre_attack_tactics: z.array(z.string()).optional(),
  /**
   * Key-value pairs that are used to replace placeholders in the markdown fields
   */
  replacements: Replacements.optional(),
  /**
   * The optional, (but typically populated after generation) risk score of the alert
   */
  risk_score: z.number().int().optional(),
  /**
   * A markdown summary of attack discovery, using the same syntax
   */
  summary_markdown: z.string(),
  /**
   * The time the attack discovery was generated
   */
  timestamp: NonEmptyTimestamp,
  /**
   * A title for the attack discovery, in plain text
   */
  title: z.string(),
  /**
   * The optional id of the user who generated the attack discovery
   */
  user_id: z.string().optional(),
  /**
   * The optional username of the user who generated the attack discovery, (not applicable to attack discoveries generated by rules)
   */
  user_name: z.string().optional(),
  /**
   * The optional array of users who may view the attack discovery. When empty, (or not present), all users may view the attack discovery.
   */
  users: z.array(User).optional(),
  /**
   * The optional array of user-IDs who have been assigned the attack
   */
  assignees: z.array(z.string()).optional(),
  /**
   * The optional array of tags assigned the attack
   */
  tags: z.array(z.string()).optional(),
});
