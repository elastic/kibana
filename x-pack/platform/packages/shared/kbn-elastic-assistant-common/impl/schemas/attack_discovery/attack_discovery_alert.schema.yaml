openapi: 3.0.0
info:
  title: An Attack discovery that is persisted as a (security) alert
  version: 'not applicable'
paths: {}
components:
  x-codegen-enabled: true
  schemas:
    AttackDiscoveryAlert:
      type: object
      description: An attack discovery that's also an alert
      required:
        - 'alertIds'
        - 'connectorId'
        - 'connectorName'
        - 'detailsMarkdown'
        - 'generationUuid'
        - 'id'
        - 'summaryMarkdown'
        - 'timestamp'
        - 'title'
      properties:
        alertIds:
          description: The alert IDs that the attack discovery is based on
          items:
            type: string
          type: array
        alertRuleUuid:
          description: The optional kibana.alert.rule.uuid of the rule that generated this attack discovery (not applicable to ad hock runs)
          type: string
        alertWorkflowStatus:
          description: The optional kibana.alert.workflow_status of this attack discovery
          type: string
        connectorId:
          description: The ID of the connector that generated the attack discovery
          type: string
        connectorName:
          description: The (human readable) name of the connector that generated the attack discovery
          type: string
        detailsMarkdown:
          description: Details of the attack with bulleted markdown that always uses special syntax for field names and values from the source data.
          type: string
        entitySummaryMarkdown:
          description: An optional, short (no more than a sentence) summary of the attack discovery featuring only the host.name and user.name fields (when they are applicable), using the same syntax
          type: string
        generationUuid:
          description: The generation ID of the run that created the attack discovery
          type: string
        id:
          description: The unique ID of the attack discovery
          type: string
        mitreAttackTactics:
          description: An optional array of MITRE ATT&CK tactic for the attack discovery
          items:
            type: string
          type: array
        replacements:
          description: Optional Key-value pairs that are used to replace placeholders in the markdown fields
          $ref: '../conversations/common_attributes.schema.yaml#/components/schemas/Replacements'
        riskScore:
          description: The optional, (but typically populated after generation) risk score of the alert
          type: integer
        summaryMarkdown:
          description: A markdown summary of attack discovery, using the same syntax
          type: string
        timestamp:
          description: The time the attack discovery was generated
          $ref: '../common_attributes.schema.yaml#/components/schemas/NonEmptyString'
        title:
          description: A title for the attack discovery, in plain text
          type: string
        userId:
          description: The optional id of the user who generated the attack discovery
          type: string
        userName:
          description: The optional username of the user who generated the attack discovery, (not applicable to attack discoveries generated by rules)
          type: string
        users:
          type: array
          description: The optional array of users who may view the attack discovery. When empty, (or not present), all users may view the attack discovery.
          items:
            $ref: '../common_attributes.schema.yaml#/components/schemas/User'
