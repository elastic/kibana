/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

/*
 * NOTICE: Do not edit this file manually.
 * This file is automatically generated by the OpenAPI Generator, @kbn/openapi-generator.
 *
 * info:
 *   title: Dismiss attack discovery generations API endpoint
 *   version: 2023-10-31
 */

import { z } from '@kbn/zod';

import { NonEmptyString } from '../../../../common_attributes.gen';

export type PostAttackDiscoveryGenerationsDismissRequestParams = z.infer<
  typeof PostAttackDiscoveryGenerationsDismissRequestParams
>;
export const PostAttackDiscoveryGenerationsDismissRequestParams = z.object({
  /**
   * The unique identifier for the Attack discovery generation execution. This UUID is returned when an attack discovery generation is created and can be found in generation responses.
   */
  execution_uuid: NonEmptyString,
});
export type PostAttackDiscoveryGenerationsDismissRequestParamsInput = z.input<
  typeof PostAttackDiscoveryGenerationsDismissRequestParams
>;

export type PostAttackDiscoveryGenerationsDismissResponse = z.infer<
  typeof PostAttackDiscoveryGenerationsDismissResponse
>;
export const PostAttackDiscoveryGenerationsDismissResponse = z.object({
  /**
   * The number of alerts that were sent as context to the LLM for this generation.
   */
  alerts_context_count: z.number().optional(),
  /**
   * The unique identifier of the connector used to generate the attack discoveries.
   */
  connector_id: z.string(),
  /**
   * Statistical information about the connector's performance for this user, providing insights into usage patterns and success rates.
   */
  connector_stats: z
    .object({
      /**
       * The average duration in nanoseconds for successful generations using this connector by the current user.
       */
      average_successful_duration_nanoseconds: z.number().optional(),
      /**
       * The total number of Attack discoveries successfully created for this generation
       */
      successful_generations: z.number().optional(),
    })
    .optional(),
  /**
   * The number of attack discoveries that were generated during this execution.
   */
  discoveries: z.number(),
  /**
   * The timestamp when the generation process completed, in ISO 8601 format. This field may be absent for generations that haven't finished.
   */
  end: z.string().optional(),
  /**
   * The unique identifier for this attack discovery generation execution. This UUID can be used to reference this specific generation in other API calls.
   */
  execution_uuid: z.string(),
  /**
   * A human-readable message describing the current state or progress of the generation process. Provides context about what the AI is analyzing.
   */
  loading_message: z.string(),
  /**
   * Additional context or reasoning provided when a generation fails or encounters issues. This field helps diagnose problems with the generation process.
   */
  reason: z.string().optional(),
  /**
   * The timestamp when the generation process began, in ISO 8601 format. This marks the beginning of the AI analysis.
   */
  start: z.string(),
  /**
   * The current status of the attack discovery generation. After dismissing, this will be set to "dismissed".
   */
  status: z.enum(['canceled', 'dismissed', 'failed', 'started', 'succeeded']),
});
