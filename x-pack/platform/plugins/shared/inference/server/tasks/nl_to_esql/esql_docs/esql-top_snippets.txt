# TOP_SNIPPETS

The TOP_SNIPPETS function extracts the best matching snippets for a given query string from a text field. It works with fields from the text family, such as `text` and `semantic_text`, and allows you to control the number and length of the returned snippets.

## Syntax

`TOP_SNIPPETS(field, query, options, num_words, num_snippets)`

### Parameters

#### field

The input text field to extract snippets from.

#### query

The input text containing only query terms for snippet extraction. Lucene query syntax, operators, and wildcards are not allowed.

#### options

(Optional) Additional options for snippet extraction, provided as function named parameters.

#### num_words

(integer) The maximum number of words to return in each snippet. This helps control the size of tokens per snippet and manage inference costs.

#### num_snippets

(integer) The maximum number of matching snippets to return.

## Examples

The following query extracts the best matching snippets from the `description` field for each book, using the query term "Tolkien". The resulting snippets are stored in a new column called `snippets`.

```esql
FROM books
| EVAL snippets = TOP_SNIPPETS(description, "Tolkien")
```

This query filters the books to only those whose title contains the word "Return". For each of these books, it extracts up to 3 snippets from the `description` field, with each snippet containing a maximum of 25 words, based on the query term "Tolkien". The extracted snippets are stored in the `snippets` column.

```esql
FROM books
| WHERE MATCH(title, "Return")
| EVAL snippets = TOP_SNIPPETS(description, "Tolkien", { "num_snippets": 3, "num_words": 25 })
```