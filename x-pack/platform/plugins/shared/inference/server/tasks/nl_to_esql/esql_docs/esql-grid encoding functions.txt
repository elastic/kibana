# GRID ENCODING FUNCTIONS

Calculates the `geotile` of the supplied geo_point at the specified precision. The result is long encoded. Use TO_STRING to convert the result to a string, TO_LONG to convert it to a `long`, or TO_GEOSHAPE to calculate the `geo_shape` bounding geometry.  These functions are related to the `geo_grid` query and the `geotile_grid` aggregation.

### `ST_GEOTILE`

```
stack: preview
serverless: preview
```

**Syntax**
`GRID ENCODING FUNCTIONS(geometry, precision, bounds, geometry, precision, bounds, geometry, precision, bounds)`

### Parameters

#### `geometry`

Expression of type `geo_point`. If `null`, the function returns `null`.

#### `precision`

Expression of type `integer`. If `null`, the function returns `null`. Valid values are between 0 and 29.

#### `bounds`

Optional bounds to filter the grid tiles, a `geo_shape` of type `BBOX`. Use `ST_ENVELOPE` if the `geo_shape` is of any other type.

**Supported types**

**Example**
```esql
FROM airports
| EVAL geotile = ST_GEOTILE(location, 2)
| STATS
    count = COUNT(geotile),
    centroid = ST_CENTROID_AGG(location)
      BY geotile
| EVAL geotileString = TO_STRING(geotile)
| SORT count DESC, geotileString ASC
| KEEP count, centroid, geotileString
```

### `ST_GEOHEX`

```
stack: preview
serverless: preview
```

**Syntax**
`GRID ENCODING FUNCTIONS(geometry, precision, bounds, geometry, precision, bounds, geometry, precision, bounds)`

### Parameters

#### `geometry`

Expression of type `geo_point`. If `null`, the function returns `null`.

#### `precision`

Expression of type `integer`. If `null`, the function returns `null`. Valid values are between 0 and 15.

#### `bounds`

Optional bounds to filter the grid tiles, a `geo_shape` of type `BBOX`. Use `ST_ENVELOPE` if the `geo_shape` is of any other type.

**Description**
Calculates the `geohex`, the H3 cell-id, of the supplied geo_point at the specified precision. The result is long encoded. Use TO_STRING to convert the result to a string, TO_LONG to convert it to a `long`, or TO_GEOSHAPE to calculate the `geo_shape` bounding geometry.  These functions are related to the `geo_grid` query and the `geohex_grid` aggregation.
**Supported types**

**Example**
```esql
FROM airports
| EVAL geohex = ST_GEOHEX(location, 1)
| STATS
    count = COUNT(geohex),
    centroid = ST_CENTROID_AGG(location)
      BY geohex
| WHERE count >= 10
| EVAL geohexString = TO_STRING(geohex)
| KEEP count, centroid, geohexString
| SORT count DESC, geohexString ASC
```

### `ST_GEOHASH`

```
stack: preview
serverless: preview
```

**Syntax**
`GRID ENCODING FUNCTIONS(geometry, precision, bounds, geometry, precision, bounds, geometry, precision, bounds)`

### Parameters

#### `geometry`

Expression of type `geo_point`. If `null`, the function returns `null`.

#### `precision`

Expression of type `integer`. If `null`, the function returns `null`. Valid values are between 1 and 12.

#### `bounds`

Optional bounds to filter the grid tiles, a `geo_shape` of type `BBOX`. Use `ST_ENVELOPE` if the `geo_shape` is of any other type.

**Description**
Calculates the `geohash` of the supplied geo_point at the specified precision. The result is long encoded. Use TO_STRING to convert the result to a string, TO_LONG to convert it to a `long`, or TO_GEOSHAPE to calculate the `geo_shape` bounding geometry.  These functions are related to the `geo_grid` query and the `geohash_grid` aggregation.
**Supported types**

**Example**
```esql
FROM airports
| EVAL geohash = ST_GEOHASH(location, 1)
| STATS
    count = COUNT(geohash),
    centroid = ST_CENTROID_AGG(location)
      BY geohash
| WHERE count >= 10
| EVAL geohashString = TO_STRING(geohash)
| KEEP count, centroid, geohashString
| SORT count DESC, geohashString ASC
```

