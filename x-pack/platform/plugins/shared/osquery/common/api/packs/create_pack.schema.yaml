openapi: 3.0.0
info:
  title: Create Pack Schema
  version: '2023-10-31'
paths: { }
components:
  schemas:
    CreatePacksRequestBody:
      type: object
      example:
        name: "my_pack"
        description: "My pack"
        enabled: true
        policy_ids:
          - "my_policy_id"
          - "fleet-server-policy"
        shards:
          my_policy_id: 35,
          fleet-server-policy: 58
        queries:
          my_query:
            query: "SELECT * FROM listening_ports;"
            interval: 60
            timeout: 120
            ecs_mapping:
              client.port:
                field: "port"
              tags:
                value:
                  - "tag1"
                  - "tag2"
      properties:
        name:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/PackName'
        description:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/PackDescriptionOrUndefined'
        enabled:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/EnabledOrUndefined'
        policy_ids:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/PolicyIdsOrUndefined'
        shards:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/Shards'
        queries:
          $ref: '../model/schema/common_attributes.schema.yaml#/components/schemas/ObjectQueries'

    CreatePacksResponse:
      type: object
      properties: { }
      example:
        data: { }
