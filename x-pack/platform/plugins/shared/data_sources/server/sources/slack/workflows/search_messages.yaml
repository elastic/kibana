version: '1'
name: 'sources.slack.search_messages'
description: 'Search Slack messages and return compact results suitable for LLM summaries and follow-up navigation. Actions and inputs: searchMessages (query, optional in_channel, optional from_user, optional after, optional before, optional sort, optional sort_dir, optional count, optional page, optional highlight, optional raw). Output (compact default): matches with text, channel {id,name}, sender, mentions, and permalink. Requires a user token with search:read.'
tags: ['agent-builder-tool']
enabled: true
triggers:
  - type: 'manual'
inputs:
  - name: query
    type: string
    description: 'Search query. You can include Slack search operators directly (e.g. in:#general from:@user after:2026-02-10).'
  - name: in_channel
    type: string
    required: false
    description: 'Optional constraint. Appends `in:<channel_name>` to the query (e.g. general).'
  - name: from_user
    type: string
    required: false
    description: 'Optional constraint. Appends `from:<@UserID>` or `from:username` to the query.'
  - name: after
    type: string
    required: false
    description: 'Optional constraint. Appends `after:<date>` to the query (e.g. 2026-02-10).'
  - name: before
    type: string
    required: false
    description: 'Optional constraint. Appends `before:<date>` to the query (e.g. 2026-02-10).'
  - name: sort
    type: string
    required: false
    default: "score"
    description: 'Sort order. Valid values: score, timestamp.'
  - name: sort_dir
    type: string
    required: false
    default: "desc"
    description: 'Sort direction. Valid values: asc, desc.'
  - name: count
    type: number
    required: false
    default: 20
    description: 'Results per page (1-100).'
  - name: page
    type: number
    required: false
    default: 1
    description: 'Page number (1-indexed).'
  - name: highlight
    type: boolean
    required: false
    default: false
    description: 'Include highlight markers in returned message text.'
  - name: raw
    type: boolean
    required: false
    default: false
    description: 'If true, return the full raw Slack API response (very verbose). If false, return compact results.'
steps:
  - name: search-messages
    type: slack2.searchMessages
    connector-id: <%= stackConnectorId %>
    with:
      query: "${{inputs.query}}"
      inChannel: "${{inputs.in_channel}}"
      fromUser: "${{inputs.from_user}}"
      after: "${{inputs.after}}"
      before: "${{inputs.before}}"
      sort: "${{inputs.sort}}"
      sortDir: "${{inputs.sort_dir}}"
      count: ${{inputs.count}}
      page: ${{inputs.page}}
      highlight: ${{inputs.highlight}}
      raw: ${{inputs.raw}}

