version: '1'
name: 'sources.sharepoint.list'
description: 'List/fetch SharePoint resources. Actions and inputs: getAllSites (no inputs); getSite (site_id OR relative_url); getSitePages (site_id); getSiteDrives (site_id); getSiteLists (site_id); getSiteListItems (site_id, list_id); getDriveItems (drive_id, optional path).'
tags: ['agent-builder-tool']
enabled: true
triggers:
  - type: 'manual'
inputs:
  - name: list_action
    type: choice
    options:
      - "getAllSites"
      - "getSite"
      - "getSitePages"
      - "getSiteDrives"
      - "getSiteLists"
      - "getSiteListItems"
      - "getDriveItems"
    required: true
  - name: site_id
    type: string
    required: false
  - name: relative_url
    type: string
    required: false
  - name: list_id
    type: string
    required: false
  - name: drive_id
    type: string
    required: false
  - name: path
    type: string
    required: false
steps:
  - name: get-all-sites
    type: sharepoint-online.getAllSites
    if: "${{ inputs.list_action == 'getAllSites' }}"
    connector-id: <%= stackConnectorId %>
    with: {}
  - name: get-site-by-id
    type: sharepoint-online.getSite
    if: "${{ inputs.list_action == 'getSite' and inputs.site_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      siteId: "${{ inputs.site_id }}"
  - name: get-site-by-relative-url
    type: sharepoint-online.getSite
    if: "${{ inputs.list_action == 'getSite' and inputs.relative_url }}"
    connector-id: <%= stackConnectorId %>
    with:
      relativeUrl: "${{ inputs.relative_url }}"
  - name: get-site-pages
    type: sharepoint-online.getSitePages
    if: "${{ inputs.list_action == 'getSitePages' and inputs.site_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      siteId: "${{ inputs.site_id }}"
  - name: get-site-drives
    type: sharepoint-online.getSiteDrives
    if: "${{ inputs.list_action == 'getSiteDrives' and inputs.site_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      siteId: "${{ inputs.site_id }}"
  - name: get-site-lists
    type: sharepoint-online.getSiteLists
    if: "${{ inputs.list_action == 'getSiteLists' and inputs.site_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      siteId: "${{ inputs.site_id }}"
  - name: get-site-list-items
    type: sharepoint-online.getSiteListItems
    if: "${{ inputs.list_action == 'getSiteListItems' and inputs.site_id and inputs.list_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      siteId: "${{ inputs.site_id }}"
      listId: "${{ inputs.list_id }}"
  - name: get-drive-items
    type: sharepoint-online.getDriveItems
    if: "${{ inputs.list_action == 'getDriveItems' and inputs.drive_id }}"
    connector-id: <%= stackConnectorId %>
    with:
      driveId: "${{ inputs.drive_id }}"
      path: "${{ inputs.path }}"
