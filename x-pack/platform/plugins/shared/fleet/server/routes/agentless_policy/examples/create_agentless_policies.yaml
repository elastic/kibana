requestBody:
  content:
    application/json:
      examples:
        createAgentlessPoliciesRequestExample:
          description: 'Example request to create agentless policies'
          value:
            package:
              name: ess_billing
              version: 1.6.0
            name: ess_billing-1
            description: test
            namespace: default
            inputs:
              ESS Billing-cel:
                enabled: true
                vars:
                  organization_id: '1234'
                  api_key: '<REPLACE_WITH_YOUR_API_KEY>'
                streams:
                  ess_billing.billing:
                    enabled: true
                    vars:
                      lookbehind: 365
                      hide_sensitive: true
                      http_client_timeout: 30s
                      tags:
                        - forwarded
                        - billing
                  ess_billing.credits:
                    enabled: false

responses:
  200:
    description: 'Indicates a successful response'
    content:
      application/json:
        examples:
          createAgentlessPoliciesResponseExample:
            description: 'Example response showing the successful result of communication initialisation over MCP protocol'
            value:
              item:
                id: d52a7812-5736-4fdc-aed8-72152afa1ffa
                version: WzE0OTgsMV0=
                name: ess_billing-1
                namespace: default
                description: test
                package:
                  name: ess_billing
                  title: Elasticsearch Service Billing
                  version: 1.6.0
                enabled: true
                inputs:
                  ESS Billing-cel:
                    enabled: true
                    vars:
                      organization_id: '1234'
                      api_key:
                        id: QY1sWpoBbWcMW-edr0Ee
                        isSecretRef: true
                      url: 'https://billing.elastic-cloud.com'
                    streams:
                      ess_billing.billing:
                        enabled: true
                        vars:
                          lookbehind: 365
                          hide_sensitive: true
                          http_client_timeout: 30s
                          tags:
                            - forwarded
                            - billing
                      ess_billing.credits:
                        enabled: false
                supports_agentless: true
                secret_references:
                  - id: QY1sWpoBbWcMW-edr0Ee
                revision: 1
                created_at: '2025-11-06T18:27:43.541Z'
                created_by: test_user
                updated_at: '2025-11-06T18:27:43.541Z'
                updated_by: test_user
  400:
    description: 'Bad Request'
    content:
      application/json:
        examples:
          genericErrorResponseExample:
            description: 'Example of a generic error response'
            value:
              statusCode: 400
              error: 'Bad Request'
              message: 'An error message describing what went wrong'
  409:
    description: 'Conflict'
    content:
      application/json:
        examples:
          conflictErrorResponseExample:
            description: 'Example of a conflict error response'
            value:
              statusCode: 409
              error: 'Conflict'
              message: 'An error message describing what went wrong'
