requestBody:
  content:
    application/json:
      examples:
        createEsqlToolRequest:
          description: "Example request to create an ESQL query tool with a pre-defined query"
          value:
            id: example-esql-tool
            type: esql
            description: Example ES|QL query tool for analyzing financial trades with time filtering
            tags:
              - analytics
              - finance
            configuration:
              query: "FROM financial_trades | WHERE execution_timestamp >= ?startTime | STATS trade_count=COUNT(*), avg_price=AVG(execution_price) BY symbol | SORT trade_count DESC | LIMIT ?limit"
              params:
                startTime:
                  type: date
                  description: Start time for the analysis in ISO format
                limit:
                  type: integer
                  description: Maximum number of results to return
        createIndexSearchToolRequest:
          description: "Example request to create an index_search tool with a pre-defined index pattern"
          value:
            id: example-index-search-tool
            type: index_search
            description: Search tool specifically for financial data analysis and reporting
            tags:
              - search
              - finance
            configuration:
              pattern: financial_*
responses:
  200:
    description: "Indicates a successful response"
    content:
      application/json:
        examples:
          createEsqlToolExample:
            description: "Example response returning a definition of ESQL tool created"
            value:
              id: example-esql-tool
              type: esql
              description: Example ES|QL query tool for analyzing financial trades with time filtering
              tags:
                - analytics
                - finance
              configuration:
                query: "FROM financial_trades | WHERE execution_timestamp >= ?startTime | STATS trade_count=COUNT(*), avg_price=AVG(execution_price) BY symbol | SORT trade_count DESC | LIMIT ?limit"
                params:
                  startTime:
                    type: date
                    description: Start time for the analysis in ISO format
                  limit:
                    type: integer
                    description: Maximum number of results to return
              readonly: false
              schema:
                type: object
                properties:
                  startTime:
                    type: string
                    format: date-time
                    description: Start time for the analysis in ISO format
                  limit:
                    type: integer
                    description: Maximum number of results to return
                required:
                  - startTime
                  - limit
                additionalProperties: false
                description: Parameters needed to execute the query
                "$schema": http://json-schema.org/draft-07/schema#
          createIndexSearchToolExample:
            description: "Example response returning a definition of search tool tool created"
            value:
              id: example-index-search-tool
              type: index_search
              description: Search tool specifically for financial data analysis and reporting
              tags:
                - search
                - finance
              configuration:
                pattern: financial_*
              readonly: false
              schema:
                type: object
                properties:
                  nlQuery:
                    type: string
                    description: A natural language query expressing the search request
                required:
                  - nlQuery
                additionalProperties: false
                "$schema": http://json-schema.org/draft-07/schema#
x-codeSamples:
- lang: curl
  source: |
    curl \
     -X POST "https://${KIBANA_URL}/api/agent_builder/tools" \
     -H "Authorization: ApiKey ${API_KEY}" \
     -H "kbn-xsrf: true" \
     -H "Content-Type: application/json" \
     -d '{
       "id": "example-esql-tool",
       "type": "esql",
       "description": "Example ES|QL query tool for analyzing financial trades with time filtering",
       "tags": ["analytics", "finance"],
       "configuration": {
         "query": "FROM financial_trades | WHERE execution_timestamp >= ?startTime | STATS trade_count=COUNT(*), avg_price=AVG(execution_price) BY symbol | SORT trade_count DESC | LIMIT ?limit",
         "params": {
           "startTime": {
             "type": "date",
             "description": "Start time for the analysis in ISO format"
           },
           "limit": {
             "type": "integer",
             "description": "Maximum number of results to return"
           }
         }
       }
     }'
- lang: Console
  source: |
    POST kbn:/api/agent_builder/tools
    {
      "id": "example-esql-tool",
      "type": "esql",
      "description": "An ES|QL query tool for analyzing financial trades with time filtering",
      "tags": ["analytics", "finance", "updated"],
      "configuration": {
        "query": "FROM financial_trades | WHERE execution_timestamp >= ?startTime | STATS trade_count=COUNT(*), avg_price=AVG(execution_price) BY symbol | SORT trade_count DESC | LIMIT ?limit",
        "params": {
          "startTime": {
            "type": "date",
            "description": "Start time for the analysis in ISO format"
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of results to return"
          }
        }
      }
    }
