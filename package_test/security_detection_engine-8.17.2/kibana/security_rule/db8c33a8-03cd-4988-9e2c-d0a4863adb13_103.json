{
  "attributes": {
    "author": [
      "Elastic"
    ],
    "description": "Elastic Endgame prevented Credential Dumping. Click the Elastic Endgame icon in the event.module column or the link in the rule.reference column for additional information.",
    "from": "now-15m",
    "index": [
      "endgame-*"
    ],
    "interval": "10m",
    "language": "kuery",
    "license": "Elastic License v2",
    "max_signals": 10000,
    "name": "Credential Dumping - Prevented - Elastic Endgame",
    "query": "event.kind:alert and event.module:endgame and endgame.metadata.type:prevention and (event.action:cred_theft_event or endgame.event_subtype_full:cred_theft_event)\n",
    "required_fields": [
      {
        "ecs": false,
        "name": "endgame.event_subtype_full",
        "type": "unknown"
      },
      {
        "ecs": false,
        "name": "endgame.metadata.type",
        "type": "unknown"
      },
      {
        "ecs": true,
        "name": "event.action",
        "type": "keyword"
      },
      {
        "ecs": true,
        "name": "event.kind",
        "type": "keyword"
      },
      {
        "ecs": true,
        "name": "event.module",
        "type": "keyword"
      }
    ],
    "risk_score": 47,
    "rule_id": "db8c33a8-03cd-4988-9e2c-d0a4863adb13",
    "setup": "## Setup\n\nThis rule is configured to generate more **Max alerts per run** than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.\n\n**IMPORTANT:** The rule's **Max alerts per run** setting can be superseded by the `xpack.alerting.rules.run.alerts.max` Kibana config setting, which determines the maximum alerts generated by _any_ rule in the Kibana alerting framework. For example, if `xpack.alerting.rules.run.alerts.max` is set to 1000, this rule will still generate no more than 1000 alerts even if its own **Max alerts per run** is set higher.\n\nTo make sure this rule can generate as many alerts as it's configured in its own **Max alerts per run** setting, increase the `xpack.alerting.rules.run.alerts.max` system setting accordingly.\n\n**NOTE:** Changing `xpack.alerting.rules.run.alerts.max` is not possible in Serverless projects.",
    "severity": "medium",
    "tags": [
      "Data Source: Elastic Endgame",
      "Use Case: Threat Detection",
      "Tactic: Credential Access"
    ],
    "threat": [
      {
        "framework": "MITRE ATT&CK",
        "tactic": {
          "id": "TA0006",
          "name": "Credential Access",
          "reference": "https://attack.mitre.org/tactics/TA0006/"
        },
        "technique": [
          {
            "id": "T1003",
            "name": "OS Credential Dumping",
            "reference": "https://attack.mitre.org/techniques/T1003/",
            "subtechnique": [
              {
                "id": "T1003.001",
                "name": "LSASS Memory",
                "reference": "https://attack.mitre.org/techniques/T1003/001/"
              }
            ]
          }
        ]
      }
    ],
    "timestamp_override": "event.ingested",
    "type": "query",
    "version": 103
  },
  "id": "db8c33a8-03cd-4988-9e2c-d0a4863adb13_103",
  "type": "security-rule"
}