{
  "attributes": {
    "author": [
      "Elastic"
    ],
    "description": "Generates a detection alert for each external alert written to the configured indices. Enabling this rule allows you to immediately begin investigating external alerts in the app.",
    "index": [
      "apm-*-transaction*",
      "traces-apm*",
      "auditbeat-*",
      "filebeat-*",
      "logs-*",
      "packetbeat-*",
      "winlogbeat-*"
    ],
    "language": "kuery",
    "license": "Elastic License v2",
    "max_signals": 10000,
    "name": "External Alerts",
    "query": "event.kind:alert and not event.module:(endgame or endpoint or cloud_defend)\n",
    "required_fields": [
      {
        "ecs": true,
        "name": "event.kind",
        "type": "keyword"
      },
      {
        "ecs": true,
        "name": "event.module",
        "type": "keyword"
      }
    ],
    "risk_score": 47,
    "risk_score_mapping": [
      {
        "field": "event.risk_score",
        "operator": "equals",
        "value": ""
      }
    ],
    "rule_id": "eb079c62-4481-4d6e-9643-3ca499df7aaa",
    "rule_name_override": "message",
    "setup": "## Setup\n\nThis rule is configured to generate more **Max alerts per run** than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.\n\n**IMPORTANT:** The rule's **Max alerts per run** setting can be superseded by the `xpack.alerting.rules.run.alerts.max` Kibana config setting, which determines the maximum alerts generated by _any_ rule in the Kibana alerting framework. For example, if `xpack.alerting.rules.run.alerts.max` is set to 1000, this rule will still generate no more than 1000 alerts even if its own **Max alerts per run** is set higher.\n\nTo make sure this rule can generate as many alerts as it's configured in its own **Max alerts per run** setting, increase the `xpack.alerting.rules.run.alerts.max` system setting accordingly.\n\n**NOTE:** Changing `xpack.alerting.rules.run.alerts.max` is not possible in Serverless projects.",
    "severity": "medium",
    "severity_mapping": [
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "low",
        "value": "21"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "medium",
        "value": "47"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "high",
        "value": "73"
      },
      {
        "field": "event.severity",
        "operator": "equals",
        "severity": "critical",
        "value": "99"
      }
    ],
    "tags": [
      "OS: Windows",
      "Data Source: APM",
      "OS: macOS",
      "OS: Linux"
    ],
    "timestamp_override": "event.ingested",
    "type": "query",
    "version": 103
  },
  "id": "eb079c62-4481-4d6e-9643-3ca499df7aaa_103",
  "type": "security-rule"
}