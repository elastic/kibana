# overlays.yaml
overlay: 1.0.0
info:
  title: Overlays for the connector objects and examples
  version: 0.0.1
actions:
  # Fix some optional path parameters
  - target: "$.paths['/api/actions/connector/{id}']['post'].parameters[?(@.name=='id')]"
    description: Remove optional indicator from path parameter
    update:
      required: true
  # Add some connector API examples
  - target: "$.paths['/api/actions/connector/{id}']['post']"
    description: "Add examples to create connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              createEmailConnectorRequest:
                $ref: "../examples/create_email_connector_request.yaml"
              createIndexConnectorRequest:
                $ref: "../examples/create_index_connector_request.yaml"
              createWebhookConnectorRequest:
                $ref: "../examples/create_webhook_connector_request.yaml"
              createXmattersConnectorRequest:
                $ref: "../examples/create_xmatters_connector_request.yaml"
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                createEmailConnectorResponse:
                  $ref: "../examples/create_email_connector_response.yaml"
                createIndexConnectorResponse:
                  $ref: "../examples/create_index_connector_response.yaml"
                createWebhookConnectorResponse:
                  $ref: "../examples/create_webhook_connector_response.yaml"
                createXmattersConnectorResponse:
                  $ref: "../examples/get_connector_response.yaml"
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post']"
    description: "Add examples to run connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              runIndexConnectorRequest:
                $ref: "../examples/run_index_connector_request.yaml"
              runJiraConnectorRequest:
                $ref: "../examples/run_jira_connector_request.yaml"
              runServerLogConnectorRequest:
                $ref: "../examples/run_servicenow_itom_connector_request.yaml"
              runSlackConnectorRequest:
                $ref: "../examples/run_slack_api_connector_request.yaml"
              runSwimlaneConnectorRequest:
                $ref: "../examples/run_swimlane_connector_request.yaml"
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                runIndexConnectorResponse:
                  $ref: "../examples/run_index_connector_response.yaml"
                runJiraConnectorResponse:
                  $ref: "../examples/run_jira_connector_response.yaml"
                runServerLogConnectorResponse:
                  $ref: "../examples/run_server_log_connector_response.yaml"
                runServiceNowITOMConnectorResponse:
                  $ref: "../examples/run_servicenow_itom_connector_response.yaml"
                runSlackConnectorResponse:
                  $ref: "../examples/run_slack_api_connector_response.yaml"
                runSwimlaneConnectorResponse:
                  $ref: "../examples/run_swimlane_connector_response.yaml"
  - target: "$.paths['/api/actions/connector/{id}']['get']"
    description: "Add examples to get connector API"
    update:
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorResponse:
                  $ref: '../examples/get_connector_response.yaml'
  - target: "$.paths['/api/actions/connector_types']['get']"
    description: "Add examples to get connector types API"
    update:
      responses:
        200:
          description: Indicates a successful call.
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorTypesServerlessResponse:
                  $ref: '../examples/get_connector_types_generativeai_response.yaml'
  - target: "$.paths['/api/actions/connectors']['get']"
    description: "Add examples to get all connectors API"
    update:
      responses:
        200:
          description: Indicates a successful call.
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorsResponse:
                  $ref: '../examples/get_connectors_response.yaml'
  - target: "$.paths['/api/actions/connector/{id}']['put']"
    description: "Add examples to update connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            examples:
              updateIndexConnectorRequest:
                $ref: '../examples/update_index_connector_request.yaml'
  # Remove the automated empty connector config and secrets
  - target: "$.paths['/api/actions/connector/{id}']['post'].requestBody.content.*.schema.properties.config"
    description: "Remove config in create connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['put'].requestBody.content.*.schema.properties.config"
    description: "Remove config in update connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['post'].requestBody.content.*.schema.properties.secrets"
    description: "Remove secrets in create connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['put'].requestBody.content.*.schema.properties.secrets"
    description: "Remove secrets in update connector API"
    remove: true
  # Add some connector configuration schemas
  - target: "$.paths['/api/actions/connector/{id}']['post']"
    description: "Add config and secrets to create connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            schema:
              properties:
                config:
                  additionalProperties: {}
                  default: {}
                  description: The connector configuration details.
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_bedrock.yaml'
                    # Crowdstrike (.crowdstrike) TBD
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_d3security.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_email.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_gemini.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_resilient.yaml'
                    # Index (.index)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_index.yaml'
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_jira.yaml'
                    # Microsoft Teams (.teams) N/A
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # Azue OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_genai_azure.yaml'
                   # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_genai_openai.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_opsgenie.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_pagerduty.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_sentinelone.yaml'
                    # Server log (.server-log) N/A
                    # ServiceNow ITSM (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_servicenow.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_servicenow_itom.yaml'
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_slack_api.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_swimlane.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_tines.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_torq.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_webhook.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_cases_webhook.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_xmatters.yaml'
                secrets:
                  additionalProperties: {}
                  default: {}
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_bedrock.yaml'
                    # Crowdstrike (.crowdstrike) TBD
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_d3security.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_email.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_gemini.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_resilient.yaml'
                    # Index (.index) N/A
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_jira.yaml'
                    # Microsoft Teams (.teams)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_teams.yaml'
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_genai.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_opsgenie.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_pagerduty.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_sentinelone.yaml'
                    # ServiceNow (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_servicenow.yaml'
                    # ServiceNow Sec Ops (.servicenow-sir) TBD
                    # ServiceNow (.servicenow-itom) TBD
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_slack_api.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_swimlane.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_tines.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_torq.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_webhook.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_cases_webhook.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_xmatters.yaml'
  - target: "$.paths['/api/actions/connector/{id}']['put']"
    description: "Add config and secrets to update connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            schema:
              properties:
                config:
                  additionalProperties: {}
                  default: {}
                  description: The connector configuration details.
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_bedrock.yaml'
                    # Crowdstrike (.crowdstrike) TBD
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_d3security.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_email.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_gemini.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_resilient.yaml'
                    # Index (.index)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_index.yaml'
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_jira.yaml'
                    # Microsoft Teams (.teams) N/A
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # Azue OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_genai_azure.yaml'
                   # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_genai_openai.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_opsgenie.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_pagerduty.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_sentinelone.yaml'
                    # Server log (.server-log) N/A
                    # ServiceNow ITSM (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_servicenow.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_servicenow_itom.yaml'
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_slack_api.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_swimlane.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_tines.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_torq.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_webhook.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_cases_webhook.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/config_properties_xmatters.yaml'
                secrets:
                  additionalProperties: {}
                  default: {}
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_bedrock.yaml'
                    # Crowdstrike (.crowdstrike) TBD
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_d3security.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_email.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_gemini.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_resilient.yaml'
                    # Index (.index) N/A
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_jira.yaml'
                    # Microsoft Teams (.teams)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_teams.yaml'
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_genai.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_opsgenie.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_pagerduty.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_sentinelone.yaml'
                    # ServiceNow (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_servicenow.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom) TBD
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_slack_api.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_swimlane.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_tines.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_torq.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_webhook.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_cases_webhook.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/secrets_properties_xmatters.yaml'
  # Remove the automated empty run connector params
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post'].requestBody.content.*.schema.properties.params"
    description: "Remove params in run connector API"
    remove: true
  # Add some run connector params  
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post']"
    description: "Add examples to run connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            schema:
              properties:
                params:
                  additionalProperties: {}
                  oneOf:
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_acknowledge_resolve_pagerduty.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_documents.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_message_email.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_message_serverlog.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_message_slack.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_params_trigger_pagerduty.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_addevent.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_closealert.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_closeincident.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_createalert.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_fieldsbyissuetype.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_getchoices.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_getfields.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_getincident.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_issue.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_issues.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_issuetypes.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_postmessage.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_pushtoservice.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_connector_subaction_validchannelid.yaml'