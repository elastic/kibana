# overlays.yaml
overlay: 1.0.0
info:
  title: Overlays that are applicable to both serverless and non-serverless documentas
  version: 0.0.1
actions:
# Add some alerting API examples
  - target: "$.paths['/api/alerting/rule/{id}']['post']"
    description: "Add examples to create rule API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              createEsQueryEsqlRuleRequest:
                $ref: "../examples/create_es_query_esql_rule_request.yaml"
              createEsQueryRuleRequest:
                $ref: "../examples/create_es_query_rule_request.yaml"
              createEsQueryKqlRuleRequest:
                $ref: "../examples/create_es_query_kql_rule_request.yaml"
              createIndexThresholdRuleRequest:
                $ref: "../examples/create_index_threshold_rule_request.yaml"
              createTrackingContainmentRuleRequest:
                $ref: "../examples/create_tracking_containment_rule_request.yaml"
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                createEsQueryEsqlRuleResponse:
                  $ref: "../examples/create_es_query_esql_rule_response.yaml"
                createEsQueryRuleResponse:
                  $ref: "../examples/create_es_query_rule_response.yaml"
                createEsQueryKqlRuleResponse:
                  $ref: "../examples/create_es_query_kql_rule_response.yaml"
                createIndexThresholdRuleResponse:
                  $ref: "../examples/create_index_threshold_rule_response.yaml"
                createTrackingContainmentRuleResponse:
                  $ref: "../examples/create_tracking_containment_rule_response.yaml"
  - target: "$.paths['/api/alerting/rule/{id}']['put']"
    description: "Add examples to update rule API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            examples:
              updateRuleRequest:
                $ref: '../examples/update_rule_request.yaml'
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                updateRuleResponse:
                  $ref: '../examples/update_rule_response.yaml'
  - target: "$.paths['/api/alerting/rules/_find']['get']"
    description: "Add examples to find rules API"
    update:
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                findRulesResponse:
                  $ref: '../examples/find_rules_response.yaml'
                findConditionalActionRulesResponse:
                  $ref: '../examples/find_rules_response_conditional_action.yaml'
  # Fix some optional path parameters
  - target: "$.paths['/api/alerting/rule/{id}']['post'].parameters[?(@.name=='id')]"
    description: Remove optional indicator from path parameter
    update:
      required: true
  # Remove the alerting rule parameters
  - target: "$.paths['/api/alerting/rule/{id}']['post'].requestBody.content.*.schema.properties.params"
    description: "Remove params type in create rule API"
    remove: true
  # Add some alerting rule parameters
  - target: "$.paths['/api/alerting/rule/{id}']['post']"
    description: "Add params to create rule API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            schema:
              properties:
                params:
                  additionalProperties: {}
                  default: {}
                  description: The parameters for the rule.
                  anyOf:
                    # APM anomaly rule (apm.anomaly)
                    - $ref: '../../x-pack/plugins/observability_solution/apm/server/routes/alerts/rule_types/docs/params_property_apm_anomaly.yaml'
                    # APM error count rule (apm.error_rate)
                    - $ref: '../../x-pack/plugins/observability_solution/apm/server/routes/alerts/rule_types/docs/params_property_apm_error_count.yaml'
                    # APM transaction duration rule (apm.transaction_duration)
                    - $ref: '../../x-pack/plugins/observability_solution/apm/server/routes/alerts/rule_types/docs/params_property_apm_transaction_duration.yaml'
                    # APM transaction error rate rule (apm.transaction_error_rate)
                    - $ref: '../../x-pack/plugins/observability_solution/apm/server/routes/alerts/rule_types/docs/params_property_apm_transaction_error_rate.yaml'
                    # Elasticsearch DSL query rule (.es-query)
                    - $ref: '../../x-pack/plugins/alerting/docs/openapi/components/schemas/params_es_query_dsl_rule.yaml'
                    # Elasticsearch ES|QL query rule (.es-query)
                    - $ref: '../../x-pack/plugins/alerting/docs/openapi/components/schemas/params_es_query_esql_rule.yaml'
                    # Elasticsearch KQL query rule (.es-query)
                    - $ref: '../../x-pack/plugins/alerting/docs/openapi/components/schemas/params_es_query_kql_rule.yaml'
                    # Index threshold rule ()
                    - $ref: '../../x-pack/plugins/alerting/docs/openapi/components/schemas/params_index_threshold_rule.yaml'
                    # Infra inventory rule (metrics.alert.inventory.threshold)
                    - $ref: '../../x-pack/plugins/observability_solution/infra/server/lib/alerting/docs/params_property_infra_inventory.yaml'
                    # Log threshold rule (logs.alert.document.count)
                    - $ref: '../../x-pack/plugins/observability_solution/infra/server/lib/alerting/docs/params_property_log_threshold.yaml'
                    # Infra metric threshold rule (metrics.alert.threshold)
                    - $ref: '../../x-pack/plugins/observability_solution/infra/server/lib/alerting/docs/params_property_infra_metric_threshold.yaml'
                    # SLO burn rate (slo.rules.burnRate)
                    - $ref:  '../../x-pack/plugins/observability_solution/slo/server/lib/rules/slo_burn_rate/docs/params_property_slo_burn_rate.yaml'
                    # Synthetics uptime TLS rule (xpack.uptime.alerts.tls)
                    - $ref: '../../x-pack/plugins/observability_solution/uptime/server/legacy_uptime/lib/alerts/docs/params_property_synthetics_uptime_tls.yaml'
                    # Uptime monitor status rule (xpack.uptime.alerts.monitorStatus)
                    - $ref: '../../x-pack/plugins/observability_solution/uptime/server/legacy_uptime/lib/alerts/docs/params_property_synthetics_monitor_status.yaml'
                  # TBD
                    # Anomaly detection alert rule (xpack.ml.anomaly_detection_alert)
                    # Anomaly detection jobs health rule (xpack.ml.anomaly_detection_jobs_health)
                    # Tracking containment rule (.geo-containment)
                    # Infrastructure anomaly rule (metrics.alert.anomaly)
                    # CCR read exceptions rule (monitoring_ccr_read_exceptions)
                    # Cluster health rule (monitoring_alert_cluster_health)
                    # CPU usage rule (monitoring_alert_cpu_usage)
                    # Custom query rule (siem.queryRule)
                    # Disk usage rule (monitoring_alert_disk_usage)
                    # Elasticsearch version mismatch rule (monitoring_alert_elasticsearch_version_mismatch)
                    # Event correlation rule (siem.eqlRule)
                    # Indicator match rule (siem.indicatorRule)
                    # JVM memory usage rule (monitoring_alert_jvm_memory_usage)
                    # Kibana version mismatch rule ( monitoring_alert_kibana_version_mismatch)
                    # License expiration rule (monitoring_alert_license_expiration)
                    # Logstash version mismatch rule (monitoring_alert_logstash_version_mismatch)
                    # Machine learning rule (siem.mlRule)
                    # Missing monitoring data rule (monitoring_alert_missing_monitoring_data)
                    # New terms rule (siem.newTermsRule)
                    # Nodes changed rule (monitoring_alert_nodes_changed)
                    # Saved query rule (siem.savedQueryRule)
                    # Security solution notification (legacy) rule (siem.notifications)
                    # Shard size rule (monitoring_shard_size)
                    # Synthetics monitor status rule (xpack.synthetics.alerts.monitorStatus)
                    # Synthetics uptime duration anomaly rule (xpack.uptime.alerts.durationAnomaly)
                    # Thread pool search rejections rule (monitoring_alert_thread_pool_search_rejections)
                    # Thread pool write rejections rule (monitoring_alert_thread_pool_write_rejections)
                    # Threshold rule (siem.thresholdRule)
                    # TLS certificate rule (xpack.uptime.alerts.tlsCertificate)
                    # Transform health (transform_health)
# Fix some optional path parameters
  - target: "$.paths['/api/actions/connector/{id}']['post'].parameters[?(@.name=='id')]"
    description: Remove optional indicator from path parameter
    update:
      required: true
# Add some connector API examples
  - target: "$.paths['/api/actions/connector/{id}']['post']"
    description: "Add examples to create connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              createEmailConnectorRequest:
                $ref: "../examples/create_email_connector_request.yaml"
              createIndexConnectorRequest:
                $ref: "../examples/create_index_connector_request.yaml"
              createWebhookConnectorRequest:
                $ref: "../examples/create_webhook_connector_request.yaml"
              createXmattersConnectorRequest:
                $ref: "../examples/create_xmatters_connector_request.yaml"
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                createEmailConnectorResponse:
                  $ref: "../examples/create_email_connector_response.yaml"
                createIndexConnectorResponse:
                  $ref: "../examples/create_index_connector_response.yaml"
                createWebhookConnectorResponse:
                  $ref: "../examples/create_webhook_connector_response.yaml"
                createXmattersConnectorResponse:
                  $ref: "../examples/get_connector_response.yaml"
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post']"
    description: "Add examples to run connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              runIndexConnectorRequest:
                $ref: "../examples/run_index_connector_request.yaml"
              runJiraConnectorRequest:
                $ref: "../examples/run_jira_connector_request.yaml"
              runServerLogConnectorRequest:
                $ref: "../examples/run_servicenow_itom_connector_request.yaml"
              runSlackConnectorRequest:
                $ref: "../examples/run_slack_api_connector_request.yaml"
              runSwimlaneConnectorRequest:
                $ref: "../examples/run_swimlane_connector_request.yaml"
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                runIndexConnectorResponse:
                  $ref: "../examples/run_index_connector_response.yaml"
                runJiraConnectorResponse:
                  $ref: "../examples/run_jira_connector_response.yaml"
                runServerLogConnectorResponse:
                  $ref: "../examples/run_server_log_connector_response.yaml"
                runServiceNowITOMConnectorResponse:
                  $ref: "../examples/run_servicenow_itom_connector_response.yaml"
                runSlackConnectorResponse:
                  $ref: "../examples/run_slack_api_connector_response.yaml"
                runSwimlaneConnectorResponse:
                  $ref: "../examples/run_swimlane_connector_response.yaml"
  - target: "$.paths['/api/actions/connector/{id}']['get']"
    description: "Add examples to get connector API"
    update:
      responses:
        200:
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorResponse:
                  $ref: '../examples/get_connector_response.yaml'
  - target: "$.paths['/api/actions/connector_types']['get']"
    description: "Add examples to get connector types API"
    update:
      responses:
        200:
          description: Indicates a successful call.
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorTypesServerlessResponse:
                  $ref: '../examples/get_connector_types_generativeai_response.yaml'
  - target: "$.paths['/api/actions/connectors']['get']"
    description: "Add examples to get all connectors API"
    update:
      responses:
        200:
          description: Indicates a successful call.
          content:
            application/json; Elastic-Api-Version=2023-10-31:
              examples:
                getConnectorsResponse:
                  $ref: '../examples/get_connectors_response.yaml'
  - target: "$.paths['/api/actions/connector/{id}']['put']"
    description: "Add examples to update connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            examples:
              updateIndexConnectorRequest:
                $ref: '../examples/update_index_connector_request.yaml'
  # Remove the automated empty connector config and secrets
  - target: "$.paths['/api/actions/connector/{id}']['post'].requestBody.content.*.schema.properties.config"
    description: "Remove config in create connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['put'].requestBody.content.*.schema.properties.config"
    description: "Remove config in update connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['post'].requestBody.content.*.schema.properties.secrets"
    description: "Remove secrets in create connector API"
    remove: true
  - target: "$.paths['/api/actions/connector/{id}']['put'].requestBody.content.*.schema.properties.secrets"
    description: "Remove secrets in update connector API"
    remove: true
  # Add some connector configuration schemas
  - target: "$.paths['/api/actions/connector/{id}']['post']"
    description: "Add config and secrets to create connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            schema:
              properties:
                config:
                  additionalProperties: {}
                  default: {}
                  description: The connector configuration details.
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/bedrock_config.yaml'
                    # Crowdstrike (.crowdstrike)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/crowdstrike_config.yaml'
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/d3security_config.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/email_config.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/gemini_config.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/resilient_config.yaml'
                    # Index (.index)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/index_config.yaml'
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/jira_config.yaml'
                    # Microsoft Teams (.teams) N/A
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # Azure OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_azure_config.yaml'
                    # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_openai_config.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/opsgenie_config.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/pagerduty_config.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/sentinelone_config.yaml'
                    # Server log (.server-log) N/A
                    # ServiceNow ITSM (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_config.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_itom_config.yaml'
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/slack_api_config.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/swimlane_config.yaml'
                    # TheHive (.thehive)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/thehive_config.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/tines_config.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/torq_config.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/webhook_config.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/cases_webhook_config.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/xmatters_config.yaml'
                secrets:
                  additionalProperties: {}
                  default: {}
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/bedrock_secrets.yaml'
                    # Crowdstrike (.crowdstrike)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/crowdstrike_secrets.yaml'
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/d3security_secrets.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/email_secrets.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/gemini_secrets.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/resilient_secrets.yaml'
                    # Index (.index) N/A
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/jira_secrets.yaml'
                    # Microsoft Teams (.teams)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/teams_secrets.yaml'
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_secrets.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/opsgenie_secrets.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/pagerduty_secrets.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/sentinelone_secrets.yaml'
                    # ServiceNow (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_secrets.yaml'
                    # ServiceNow Sec Ops (.servicenow-sir) TBD
                    # ServiceNow (.servicenow-itom) TBD
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/slack_api_secrets.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/swimlane_secrets.yaml'
                    # TheHive (.thehive)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/thehive_secrets.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/tines_secrets.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/torq_secrets.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/webhook_secrets.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/cases_webhook_secrets.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/xmatters_secrets.yaml'
  - target: "$.paths['/api/actions/connector/{id}']['put']"
    description: "Add config and secrets to update connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31:
            schema:
              properties:
                config:
                  additionalProperties: {}
                  default: {}
                  description: The connector configuration details.
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/bedrock_config.yaml'
                    # Crowdstrike (.crowdstrike)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/crowdstrike_config.yaml'
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/d3security_config.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/email_config.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/gemini_config.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/resilient_config.yaml'
                    # Index (.index)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/index_config.yaml'
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/jira_config.yaml'
                    # Microsoft Teams (.teams) N/A
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # Azue OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_azure_config.yaml'
                   # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_openai_config.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/opsgenie_config.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/pagerduty_config.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/sentinelone_config.yaml'
                    # Server log (.server-log) N/A
                    # ServiceNow ITSM (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_config.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_itom_config.yaml'
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/slack_api_config.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/swimlane_config.yaml'
                    # TheHive (.thehive)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/thehive_config.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/tines_config.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/torq_config.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/webhook_config.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/cases_webhook_config.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/xmatters_config.yaml'
                secrets:
                  additionalProperties: {}
                  default: {}
                  oneOf:
                    # Bedrock (.bedrock)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/bedrock_secrets.yaml'
                    # Crowdstrike (.crowdstrike)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/crowdstrike_secrets.yaml'
                    # D3 Security (.d3security)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/d3security_secrets.yaml'
                    # Email (.email)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/email_secrets.yaml'
                    # Google Gemini (.gemini)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/gemini_secrets.yaml'
                    # IBM Resilient (.resilient)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/resilient_secrets.yaml'
                    # Index (.index) N/A
                    # Jira (.jira)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/jira_secrets.yaml'
                    # Microsoft Teams (.teams)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/teams_secrets.yaml'
                    # Observability AI Assistant (.observability-ai-assistant) TBD
                    # OpenAI (.gen-ai)
                    - $ref:  '../../x-pack/plugins/actions/docs/openapi/components/schemas/genai_secrets.yaml'
                    # Opsgenie (.opsgenie)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/opsgenie_secrets.yaml'
                    # PagerDuty (.pagerduty)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/pagerduty_secrets.yaml'
                    # SentinelOne (.sentinelone)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/sentinelone_secrets.yaml'
                    # ServiceNow (.servicenow)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/servicenow_secrets.yaml'
                    # ServiceNow SecOps (.servicenow-sir) TBD
                    # ServiceNow ITOM (.servicenow-itom) TBD
                    # Slack (.slack_api)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/slack_api_secrets.yaml'
                    # Swimlane (.swimlane)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/swimlane_secrets.yaml'
                    # TheHive (.thehive)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/thehive_secrets.yaml'
                    # Tines (.tines)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/tines_secrets.yaml'
                    # Torq (.torq)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/torq_secrets.yaml'
                    # Webhook (.webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/webhook_secrets.yaml'
                    # Webhook - Case Management (.cases-webhook)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/cases_webhook_secrets.yaml'
                    # xMatters (.xmatters)
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/xmatters_secrets.yaml'
  # Remove the automated empty run connector params
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post'].requestBody.content.*.schema.properties.params"
    description: "Remove params in run connector API"
    remove: true
  # Add some run connector params  
  - target: "$.paths['/api/actions/connector/{id}/_execute']['post']"
    description: "Add examples to run connector API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            schema:
              properties:
                params:
                  additionalProperties: {}
                  oneOf:
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_acknowledge_resolve_pagerduty.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_documents.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_message_email.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_message_serverlog.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_message_slack.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_trigger_pagerduty.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_addevent.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_closealert.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_closeincident.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_createalert.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_fieldsbyissuetype.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_getchoices.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_getfields.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_getincident.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_issue.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_issues.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_issuetypes.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_postmessage.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_pushtoservice.yaml'
                    - $ref: '../../x-pack/plugins/actions/docs/openapi/components/schemas/run_validchannelid.yaml'
# Add some spaces API examples
  - target: "$.paths['/api/spaces/space']['post']"
    description: "Add example to create space API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              createSpaceRequest:
                $ref: "../examples/create_space_request.yaml"
  - target: "$.paths['/api/spaces/space/{id}']['put']"
    description: "Add example to update space API"
    update: 
      requestBody: 
        content: 
          application/json; Elastic-Api-Version=2023-10-31: 
            examples:
              updateSpaceRequest:
                $ref: "../examples/update_space_request.yaml"
