{"attributes":{"name":"Attempts to Brute Force a Microsoft 365 User Account v101.0.2","rule_id":"26f68dba-ce29-497b-8e13-b4fde1db5a2d:101.0.2","rule_version":"101.0.2","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies attempts to brute force a Microsoft 365 user account. An adversary may attempt a brute force attack to obtain unauthorized access to user accounts.","risk_score":73,"severity":"high","license":"Elastic License v2","note":"","author":["Elastic","Willem D'Haese","Austin Songer"],"false_positives":["Automated processes that attempt to authenticate using expired credentials and unbounded retries may lead to false positives."],"from":"now-30m","references":["https://blueteamblog.com/7-ways-to-monitor-your-office-365-logs-using-siem"],"tags":["Elastic","Cloud","Microsoft 365","Continuous Monitoring","SecOps","Identity and Access"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1110","name":"Brute Force","reference":"https://attack.mitre.org/techniques/T1110/"}]}],"query":"event.dataset:o365.audit and event.provider:(AzureActiveDirectory or Exchange) and\n  event.category:authentication and event.action:(UserLoginFailed or PasswordLogonInitialAuthUsingPassword) and\n  not o365.audit.LogonError:(UserAccountNotFound or EntitlementGrantsNotFound or UserStrongAuthEnrollmentRequired or\n                             UserStrongAuthClientAuthNRequired or InvalidReplyTo)\n","threshold":{"field":["user.id"],"value":10},"type":"threshold","index":["filebeat-*","logs-o365*"],"language":"kuery","related_integrations":[{"package":"o365","version":"^1.3.0"}],"required_fields":[{"ecs":true,"name":"event.action","type":"keyword"},{"ecs":true,"name":"event.category","type":"keyword"},{"ecs":true,"name":"event.dataset","type":"keyword"},{"ecs":true,"name":"event.provider","type":"keyword"},{"ecs":false,"name":"o365.audit.LogonError","type":"keyword"}],"setup":"The Office 365 Logs Fleet integration, Filebeat module, or similarly structured data is required to be compatible with this rule."},"id":"26f68dba-ce29-497b-8e13-b4fde1db5a2d:101.0.2","type":"security-rule"}