{"attributes":{"name":"InstallUtil Process Making Network Connections v101.0.2","rule_id":"a13167f1-eec2-4015-9631-1fee60406dcf:101.0.2","rule_version":"101.0.2","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies InstallUtil.exe making outbound network connections. This may indicate adversarial activity as InstallUtil is often leveraged by adversaries to execute code and evade detection.","risk_score":47,"severity":"medium","license":"Elastic License v2","author":["Elastic"],"from":"now-9m","tags":["Elastic","Host","Windows","Threat Detection","Defense Evasion"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218/","subtechnique":[{"id":"T1218.004","name":"InstallUtil","reference":"https://attack.mitre.org/techniques/T1218/004/"}]}]}],"language":"eql","query":"/* the benefit of doing this as an eql sequence vs kql is this will limit to alerting only on the first network connection */\n\nsequence by process.entity_id\n  [process where event.type == \"start\" and process.name : \"installutil.exe\"]\n  [network where process.name : \"installutil.exe\" and network.direction : (\"outgoing\", \"egress\")]\n","type":"eql","index":["logs-endpoint.events.*","winlogbeat-*","logs-windows.*"],"required_fields":[{"ecs":true,"name":"event.type","type":"keyword"},{"ecs":true,"name":"network.direction","type":"keyword"},{"ecs":true,"name":"process.entity_id","type":"keyword"},{"ecs":true,"name":"process.name","type":"keyword"}]},"id":"a13167f1-eec2-4015-9631-1fee60406dcf:101.0.2","type":"security-rule"}