{"attributes":{"name":"Suspicious Managed Code Hosting Process v100.0.0","rule_id":"acf738b5-b5b2-4acc-bad9-1e18ee234f40:100.0.0","rule_version":"100.0.0","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies a suspicious managed code hosting process which could indicate code injection or other form of suspicious code execution.","risk_score":73,"severity":"high","license":"Elastic License v2","author":["Elastic"],"from":"now-9m","references":["https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html"],"tags":["Elastic","Host","Windows","Threat Detection","Defense Evasion"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055/"}]}],"language":"eql","query":"sequence by process.entity_id with maxspan=5m\n [process where event.type == \"start\" and\n  process.name : (\"wscript.exe\", \"cscript.exe\", \"mshta.exe\", \"wmic.exe\", \"regsvr32.exe\", \"svchost.exe\", \"dllhost.exe\", \"cmstp.exe\")]\n [file where event.type != \"deletion\" and\n  file.name : (\"wscript.exe.log\",\n               \"cscript.exe\",\n               \"mshta.exe.log\",\n               \"wmic.exe.log\",\n               \"svchost.exe.log\",\n               \"dllhost.exe.log\",\n               \"cmstp.exe.log\",\n               \"regsvr32.exe.log\")]\n","type":"eql","index":["winlogbeat-*","logs-endpoint.events.*","logs-windows.*"],"required_fields":[{"ecs":true,"name":"event.type","type":"keyword"},{"ecs":true,"name":"file.name","type":"keyword"},{"ecs":true,"name":"process.entity_id","type":"keyword"},{"ecs":true,"name":"process.name","type":"keyword"}]},"id":"acf738b5-b5b2-4acc-bad9-1e18ee234f40:100.0.0","type":"security-rule"}