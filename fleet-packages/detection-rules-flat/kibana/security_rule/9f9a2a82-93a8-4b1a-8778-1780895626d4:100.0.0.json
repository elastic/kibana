{"attributes":{"name":"File Permission Modification in Writable Directory v100.0.0","rule_id":"9f9a2a82-93a8-4b1a-8778-1780895626d4:100.0.0","rule_version":"100.0.0","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution.","risk_score":21,"severity":"low","license":"Elastic License v2","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Certain programs or applications may modify files or change ownership in writable directories. These can be exempted by username."],"from":"now-9m","tags":["Elastic","Host","Linux","Threat Detection","Defense Evasion"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/"}]}],"type":"query","index":["auditbeat-*","logs-endpoint.events.*"],"language":"kuery","query":"event.category:process and event.type:(start or process_started) and\n  process.name:(chmod or chown or chattr or chgrp) and\n  process.working_directory:(/tmp or /var/tmp or /dev/shm) and\n  not user.name:root\n","required_fields":[{"ecs":true,"name":"event.category","type":"keyword"},{"ecs":true,"name":"event.type","type":"keyword"},{"ecs":true,"name":"process.name","type":"keyword"},{"ecs":true,"name":"process.working_directory","type":"keyword"},{"ecs":true,"name":"user.name","type":"keyword"}]},"id":"9f9a2a82-93a8-4b1a-8778-1780895626d4:100.0.0","type":"security-rule"}