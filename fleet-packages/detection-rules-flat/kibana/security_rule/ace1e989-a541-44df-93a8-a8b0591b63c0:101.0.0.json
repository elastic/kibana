{"attributes":{"name":"Potential macOS SSH Brute Force Detected v101.0.0","rule_id":"ace1e989-a541-44df-93a8-a8b0591b63c0:101.0.0","rule_version":"101.0.0","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies a high number (20) of macOS SSH KeyGen process executions from the same host. An adversary may attempt a brute force attack to obtain unauthorized access to user accounts.","risk_score":47,"severity":"medium","license":"Elastic License v2","author":["Elastic"],"from":"now-9m","references":["https://themittenmac.com/detecting-ssh-activity-via-process-monitoring/"],"tags":["Elastic","Host","macOS","Threat Detection","Credential Access"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1110","name":"Brute Force","reference":"https://attack.mitre.org/techniques/T1110/"}]}],"query":"event.category:process and event.type:start and process.name:\"sshd-keygen-wrapper\" and process.parent.name:launchd\n","threshold":{"field":["host.id"],"value":20},"type":"threshold","index":["auditbeat-*","logs-endpoint.events.*"],"language":"kuery","required_fields":[{"ecs":true,"name":"event.category","type":"keyword"},{"ecs":true,"name":"event.type","type":"keyword"},{"ecs":true,"name":"process.name","type":"keyword"},{"ecs":true,"name":"process.parent.name","type":"keyword"}]},"id":"ace1e989-a541-44df-93a8-a8b0591b63c0:101.0.0","type":"security-rule"}