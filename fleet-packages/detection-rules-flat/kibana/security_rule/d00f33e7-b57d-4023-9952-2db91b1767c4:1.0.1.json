{"attributes":{"name":"Namespace Manipulation Using Unshare v1.0.1","rule_id":"d00f33e7-b57d-4023-9952-2db91b1767c4:1.0.1","rule_version":"1.0.1","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies  suspicious usage of unshare to manipulate system namespaces. Unshare can be utilized to escalate privileges or escape container security boundaries. Threat actors have utilized this binary to allow themselves to escape to the host and access other resources or escalate privileges.","risk_score":47,"severity":"medium","license":"Elastic License v2","timestamp_override":"event.ingested","author":["Elastic"],"from":"now-9m","references":["https://man7.org/linux/man-pages/man1/unshare.1.html","https://www.crowdstrike.com/blog/cve-2022-0185-kubernetes-container-escape-using-linux-kernel-exploit/"],"tags":["Elastic","Host","Linux","Threat Detection","Privilege Escalation"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1543","name":"Create or Modify System Process","reference":"https://attack.mitre.org/techniques/T1543/"}]}],"language":"eql","query":"process where event.type == \"start\" and event.action == \"exec\" and\nprocess.executable: \"/usr/bin/unshare\" and\nnot process.parent.executable: (\"/usr/bin/udevadm\", \"*/lib/systemd/systemd-udevd\", \"/usr/bin/unshare\") and\nnot process.args : \"/usr/bin/snap\"\n","type":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"required_fields":[{"ecs":true,"name":"event.action","type":"keyword"},{"ecs":true,"name":"event.type","type":"keyword"},{"ecs":true,"name":"process.args","type":"keyword"},{"ecs":true,"name":"process.executable","type":"keyword"},{"ecs":true,"name":"process.parent.executable","type":"keyword"}]},"id":"d00f33e7-b57d-4023-9952-2db91b1767c4:1.0.1","type":"security-rule"}