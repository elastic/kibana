{"attributes":{"name":"Microsoft 365 Exchange DKIM Signing Configuration Disabled v101.0.2","rule_id":"514121ce-c7b6-474a-8237-68ff71672379:101.0.2","rule_version":"101.0.2","stack_version_min":"8.5.0","stack_version_max":"8.7.0","description":"Identifies when a DomainKeys Identified Mail (DKIM) signing configuration is disabled in Microsoft 365. With DKIM in Microsoft 365, messages that are sent from Exchange Online will be cryptographically signed. This will allow the receiving email system to validate that the messages were generated by a server that the organization authorized and were not spoofed.","risk_score":47,"severity":"medium","license":"Elastic License v2","note":"","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Disabling a DKIM configuration may be done by a system or network administrator. Verify that the configuration change was expected. Exceptions can be added to this rule to filter expected behavior."],"from":"now-30m","references":["https://docs.microsoft.com/en-us/powershell/module/exchange/set-dkimsigningconfig?view=exchange-ps"],"tags":["Elastic","Cloud","Microsoft 365","Continuous Monitoring","SecOps","Data Protection","Persistence"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556/"}]}],"type":"query","index":["filebeat-*","logs-o365*"],"language":"kuery","query":"event.dataset:o365.audit and event.provider:Exchange and event.category:web and event.action:\"Set-DkimSigningConfig\" and o365.audit.Parameters.Enabled:False and event.outcome:success\n","related_integrations":[{"package":"o365","version":"^1.3.0"}],"required_fields":[{"ecs":true,"name":"event.action","type":"keyword"},{"ecs":true,"name":"event.category","type":"keyword"},{"ecs":true,"name":"event.dataset","type":"keyword"},{"ecs":true,"name":"event.outcome","type":"keyword"},{"ecs":true,"name":"event.provider","type":"keyword"},{"ecs":false,"name":"o365.audit.Parameters.Enabled","type":"unknown"}],"setup":"The Office 365 Logs Fleet integration, Filebeat module, or similarly structured data is required to be compatible with this rule."},"id":"514121ce-c7b6-474a-8237-68ff71672379:101.0.2","type":"security-rule"}